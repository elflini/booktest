<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 예제1 | Insurance Claims Data Analysis with R</title>
  <meta name="description" content="This is a R manual for analysis of insurance claims data" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 예제1 | Insurance Claims Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a R manual for analysis of insurance claims data" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 예제1 | Insurance Claims Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a R manual for analysis of insurance claims data" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2021-12-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter11.html"/>

<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Claims Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> R이란?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#r-설치"><i class="fa fa-check"></i><b>1.1</b> R 설치</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#r-프로그램의-구성"><i class="fa fa-check"></i><b>1.2</b> R 프로그램의 구성</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chapter1.html"><a href="chapter1.html#파일"><i class="fa fa-check"></i><b>1.2.1</b> 파일</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapter1.html"><a href="chapter1.html#편집"><i class="fa fa-check"></i><b>1.2.2</b> 편집</a></li>
<li class="chapter" data-level="1.2.3" data-path="chapter1.html"><a href="chapter1.html#기타"><i class="fa fa-check"></i><b>1.2.3</b> 기타</a></li>
<li class="chapter" data-level="1.2.4" data-path="chapter1.html"><a href="chapter1.html#패키지"><i class="fa fa-check"></i><b>1.2.4</b> 패키지</a></li>
<li class="chapter" data-level="1.2.5" data-path="chapter1.html"><a href="chapter1.html#윈도우즈"><i class="fa fa-check"></i><b>1.2.5</b> 윈도우즈</a></li>
<li class="chapter" data-level="1.2.6" data-path="chapter1.html"><a href="chapter1.html#도움말"><i class="fa fa-check"></i><b>1.2.6</b> 도움말</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#r-프로그램-특징"><i class="fa fa-check"></i><b>1.3</b> R 프로그램 특징</a></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#rstudio-설치"><i class="fa fa-check"></i><b>1.4</b> RStudio 설치</a></li>
<li class="chapter" data-level="1.5" data-path="chapter1.html"><a href="chapter1.html#r-패키지-이용"><i class="fa fa-check"></i><b>1.5</b> R 패키지 이용</a></li>
<li class="chapter" data-level="1.6" data-path="chapter1.html"><a href="chapter1.html#r-패키지-관리"><i class="fa fa-check"></i><b>1.6</b> R 패키지 관리</a></li>
<li class="chapter" data-level="1.7" data-path="chapter1.html"><a href="chapter1.html#산술-연산자"><i class="fa fa-check"></i><b>1.7</b> 산술 연산자</a></li>
<li class="chapter" data-level="1.8" data-path="chapter1.html"><a href="chapter1.html#논리-연산자와-비교-연산자"><i class="fa fa-check"></i><b>1.8</b> 논리 연산자와 비교 연산자</a></li>
<li class="chapter" data-level="1.9" data-path="chapter1.html"><a href="chapter1.html#기초-산술-함수"><i class="fa fa-check"></i><b>1.9</b> 기초 산술 함수</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="chapter1.html"><a href="chapter1.html#통계-함수"><i class="fa fa-check"></i><b>1.9.1</b> 통계 함수</a></li>
<li class="chapter" data-level="1.9.2" data-path="chapter1.html"><a href="chapter1.html#로그-및-지수-함수-logarithms-and-exponentials"><i class="fa fa-check"></i><b>1.9.2</b> 로그 및 지수 함수 (Logarithms and Exponentials)</a></li>
<li class="chapter" data-level="1.9.3" data-path="chapter1.html"><a href="chapter1.html#삼각-함수"><i class="fa fa-check"></i><b>1.9.3</b> 삼각 함수</a></li>
<li class="chapter" data-level="1.9.4" data-path="chapter1.html"><a href="chapter1.html#기타-수학-함수"><i class="fa fa-check"></i><b>1.9.4</b> 기타 수학 함수</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="chapter1.html"><a href="chapter1.html#객체의-명명과-할당"><i class="fa fa-check"></i><b>1.10</b> 객체의 명명과 할당</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="chapter1.html"><a href="chapter1.html#객체변수-만들기"><i class="fa fa-check"></i><b>1.10.1</b> 객체(변수) 만들기</a></li>
<li class="chapter" data-level="1.10.2" data-path="chapter1.html"><a href="chapter1.html#객체-목록-보기"><i class="fa fa-check"></i><b>1.10.2</b> 객체 목록 보기</a></li>
<li class="chapter" data-level="1.10.3" data-path="chapter1.html"><a href="chapter1.html#객체변수-지우기"><i class="fa fa-check"></i><b>1.10.3</b> 객체(변수) 지우기</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="chapter1.html"><a href="chapter1.html#데이터-유형"><i class="fa fa-check"></i><b>1.11</b> 데이터 유형</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="chapter1.html"><a href="chapter1.html#데이터의-기본-유형"><i class="fa fa-check"></i><b>1.11.1</b> 데이터의 기본 유형</a></li>
<li class="chapter" data-level="1.11.2" data-path="chapter1.html"><a href="chapter1.html#특수-데이터"><i class="fa fa-check"></i><b>1.11.2</b> 특수 데이터</a></li>
<li class="chapter" data-level="1.11.3" data-path="chapter1.html"><a href="chapter1.html#데이터-유형-함수"><i class="fa fa-check"></i><b>1.11.3</b> 데이터 유형 함수</a></li>
<li class="chapter" data-level="1.11.4" data-path="chapter1.html"><a href="chapter1.html#데이터-유형-변경"><i class="fa fa-check"></i><b>1.11.4</b> 데이터 유형 변경</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="chapter1.html"><a href="chapter1.html#자료의-입력"><i class="fa fa-check"></i><b>1.12</b> 자료의 입력</a>
<ul>
<li class="chapter" data-level="1.12.1" data-path="chapter1.html"><a href="chapter1.html#read.table"><i class="fa fa-check"></i><b>1.12.1</b> read.table()</a></li>
<li class="chapter" data-level="1.12.2" data-path="chapter1.html"><a href="chapter1.html#read.csv"><i class="fa fa-check"></i><b>1.12.2</b> read.csv()</a></li>
<li class="chapter" data-level="1.12.3" data-path="chapter1.html"><a href="chapter1.html#read.delim"><i class="fa fa-check"></i><b>1.12.3</b> read.delim()</a></li>
<li class="chapter" data-level="1.12.4" data-path="chapter1.html"><a href="chapter1.html#read_excel"><i class="fa fa-check"></i><b>1.12.4</b> read_excel()</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="chapter1.html"><a href="chapter1.html#자료의-출력"><i class="fa fa-check"></i><b>1.13</b> 자료의 출력</a>
<ul>
<li class="chapter" data-level="1.13.1" data-path="chapter1.html"><a href="chapter1.html#write.table"><i class="fa fa-check"></i><b>1.13.1</b> write.table()</a></li>
<li class="chapter" data-level="1.13.2" data-path="chapter1.html"><a href="chapter1.html#write_xlsx"><i class="fa fa-check"></i><b>1.13.2</b> write_xlsx()</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="chapter1.html"><a href="chapter1.html#r-manual"><i class="fa fa-check"></i><b>1.14</b> R Manual</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Tidyverse Package</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#filter"><i class="fa fa-check"></i><b>2.1</b> filter()</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#filter---연속형-변수-처리"><i class="fa fa-check"></i><b>2.1.1</b> filter() - 연속형 변수 처리</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#filter---이산형-변수-처리"><i class="fa fa-check"></i><b>2.1.2</b> filter() - 이산형 변수 처리</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter2.html"><a href="chapter2.html#filter---문자형-변수-처리"><i class="fa fa-check"></i><b>2.1.3</b> filter() - 문자형 변수 처리</a></li>
<li class="chapter" data-level="2.1.4" data-path="chapter2.html"><a href="chapter2.html#filter---일반적인-변수-처리"><i class="fa fa-check"></i><b>2.1.4</b> filter() - 일반적인 변수 처리</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#pipe"><i class="fa fa-check"></i><b>2.2</b> Pipe : %&gt;%</a></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#select"><i class="fa fa-check"></i><b>2.3</b> select()</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter2.html"><a href="chapter2.html#select---선택"><i class="fa fa-check"></i><b>2.3.1</b> select() - 선택</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter2.html"><a href="chapter2.html#select---제거"><i class="fa fa-check"></i><b>2.3.2</b> select() - 제거</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapter2.html"><a href="chapter2.html#filter-와-select-혼합"><i class="fa fa-check"></i><b>2.3.3</b> filter() 와 select() 혼합</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#group_by와-summarise"><i class="fa fa-check"></i><b>2.4</b> group_by()와 summarise()</a></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#arrange"><i class="fa fa-check"></i><b>2.5</b> arrange()</a></li>
<li class="chapter" data-level="2.6" data-path="chapter2.html"><a href="chapter2.html#결측값-처리"><i class="fa fa-check"></i><b>2.6</b> 결측값 처리</a></li>
<li class="chapter" data-level="2.7" data-path="chapter2.html"><a href="chapter2.html#mutate"><i class="fa fa-check"></i><b>2.7</b> mutate()</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> 공단표본코호트 데모자료</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#자격-db---자격-및-보험료-테이블"><i class="fa fa-check"></i><b>3.1</b> 자격 DB - 자격 및 보험료 테이블</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#사망-db---출생-및-사망테이블"><i class="fa fa-check"></i><b>3.2</b> 사망 DB - 출생 및 사망테이블</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#요양기관-db"><i class="fa fa-check"></i><b>3.3</b> 요양기관 DB</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#진료-db---20-테이블"><i class="fa fa-check"></i><b>3.4</b> 진료 DB - 20 테이블</a></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#진료-db---30-테이블"><i class="fa fa-check"></i><b>3.5</b> 진료 DB - 30 테이블</a></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#진료-db---40-테이블"><i class="fa fa-check"></i><b>3.6</b> 진료 DB - 40 테이블</a></li>
<li class="chapter" data-level="3.7" data-path="chapter3.html"><a href="chapter3.html#진료-db---60-테이블"><i class="fa fa-check"></i><b>3.7</b> 진료 DB - 60 테이블</a></li>
<li class="chapter" data-level="3.8" data-path="chapter3.html"><a href="chapter3.html#작업공간-저장-및-불러오기"><i class="fa fa-check"></i><b>3.8</b> 작업공간 저장 및 불러오기</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="chapter3.html"><a href="chapter3.html#객체-목록-확인"><i class="fa fa-check"></i><b>3.8.1</b> 객체 목록 확인</a></li>
<li class="chapter" data-level="3.8.2" data-path="chapter3.html"><a href="chapter3.html#작업공간-저장"><i class="fa fa-check"></i><b>3.8.2</b> 작업공간 저장</a></li>
<li class="chapter" data-level="3.8.3" data-path="chapter3.html"><a href="chapter3.html#작업공간-불러오기"><i class="fa fa-check"></i><b>3.8.3</b> 작업공간 불러오기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> 데이터프레임의 활용</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#데이터-프레임"><i class="fa fa-check"></i><b>4.1</b> 데이터 프레임</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#데이터-프레임-인덱싱"><i class="fa fa-check"></i><b>4.2</b> 데이터 프레임 인덱싱</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#공단자료와-필요패키지-불러오기"><i class="fa fa-check"></i><b>4.3</b> 공단자료와 필요패키지 불러오기</a></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#특정-변수만-남기기"><i class="fa fa-check"></i><b>4.4</b> 특정 변수만 남기기</a></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#특정-변수-지우기"><i class="fa fa-check"></i><b>4.5</b> 특정 변수 지우기</a></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#변수-이름-바꾸기"><i class="fa fa-check"></i><b>4.6</b> 변수 이름 바꾸기</a></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#특정-위치의-관찰값-추출"><i class="fa fa-check"></i><b>4.7</b> 특정 위치의 관찰값 추출</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> 새로운 변수 생성</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#기존-변수의-값-바꾸기"><i class="fa fa-check"></i><b>5.1</b> 기존 변수의 값 바꾸기</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#새로운-변수-만들기"><i class="fa fa-check"></i><b>5.2</b> 새로운 변수 만들기</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#round-함수-이용"><i class="fa fa-check"></i><b>5.3</b> Round 함수 이용</a></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#순자를-문자로-문자를-숫자로"><i class="fa fa-check"></i><b>5.4</b> 순자를 문자로, 문자를 숫자로</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#substr-함수-이용"><i class="fa fa-check"></i><b>5.5</b> substr 함수 이용</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#날짜-함수-이용"><i class="fa fa-check"></i><b>5.6</b> 날짜 함수 이용</a></li>
<li class="chapter" data-level="5.7" data-path="chapter5.html"><a href="chapter5.html#누적합-함수-이용"><i class="fa fa-check"></i><b>5.7</b> 누적합 함수 이용</a></li>
<li class="chapter" data-level="5.8" data-path="chapter5.html"><a href="chapter5.html#lag과-diff-함수-이용"><i class="fa fa-check"></i><b>5.8</b> lag과 diff 함수 이용</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> 조건문</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#특정-조건을-만족하는-관찰값-선택하기"><i class="fa fa-check"></i><b>6.1</b> 특정 조건을 만족하는 관찰값 선택하기</a></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#특정-조건을-만족하는-관찰값-삭제하기"><i class="fa fa-check"></i><b>6.2</b> 특정 조건을 만족하는 관찰값 삭제하기</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#조건문-활용하기"><i class="fa fa-check"></i><b>6.3</b> 조건문 활용하기</a></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#조건문-일반화하기"><i class="fa fa-check"></i><b>6.4</b> 조건문 일반화하기</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> 자료의 정렬</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#하나의-변수에-의한-관찰값의-정렬"><i class="fa fa-check"></i><b>7.1</b> 하나의 변수에 의한 관찰값의 정렬</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#여러-개의-변수에-의한-관찰값의-정렬"><i class="fa fa-check"></i><b>7.2</b> 여러 개의 변수에 의한 관찰값의 정렬</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#처음과-마지막-개체-추출하기"><i class="fa fa-check"></i><b>7.3</b> 처음과 마지막 개체 추출하기</a></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#동일한-관찰값의-제거"><i class="fa fa-check"></i><b>7.4</b> 동일한 관찰값의 제거</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> 반복문</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#조건에-의한-반복"><i class="fa fa-check"></i><b>8.1</b> 조건에 의한 반복</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#개체에-의한-반복"><i class="fa fa-check"></i><b>8.2</b> 개체에 의한 반복</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#다중-반복"><i class="fa fa-check"></i><b>8.3</b> 다중 반복</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> 데이터셋 합치기</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#변수-기준-개체-통합"><i class="fa fa-check"></i><b>9.1</b> 변수 기준 개체 통합</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#개체-기준-변수-통합"><i class="fa fa-check"></i><b>9.2</b> 개체 기준 변수 통합</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter10.html"><a href="chapter10.html"><i class="fa fa-check"></i><b>10</b> Tidyverse 활용</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter10.html"><a href="chapter10.html#tidyverse-dplyr-기본-구조"><i class="fa fa-check"></i><b>10.1</b> Tidyverse (dplyr) 기본 구조</a></li>
<li class="chapter" data-level="10.2" data-path="chapter10.html"><a href="chapter10.html#단일-데이터셋-다루기"><i class="fa fa-check"></i><b>10.2</b> 단일 데이터셋 다루기</a></li>
<li class="chapter" data-level="10.3" data-path="chapter10.html"><a href="chapter10.html#여러-데이터셋-다루기"><i class="fa fa-check"></i><b>10.3</b> 여러 데이터셋 다루기</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter11.html"><a href="chapter11.html"><i class="fa fa-check"></i><b>11</b> 사용자 정의 함수</a></li>
<li class="chapter" data-level="12" data-path="chapter12.html"><a href="chapter12.html"><i class="fa fa-check"></i><b>12</b> 예제1</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chapter12.html"><a href="chapter12.html#연구-설계"><i class="fa fa-check"></i><b>12.1</b> 연구 설계</a></li>
<li class="chapter" data-level="12.2" data-path="chapter12.html"><a href="chapter12.html#프로그램"><i class="fa fa-check"></i><b>12.2</b> 프로그램</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Insurance Claims Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter12" class="section level1" number="12">
<h1><span class="header-section-number">Chapter 12</span> 예제1</h1>
<p>공단자료와 필요 패키지 불러오기</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter12.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;claim.RData&quot;</span>)</span>
<span id="cb1-2"><a href="chapter12.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="chapter12.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># 날짜 함수</span></span></code></pre></div>
<div id="연구-설계" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> 연구 설계</h2>
<p>공단 표본코호트 데모 자료를 이용하여 다음과 같은 분석을 시행하고자 한다. 이를 위한 데이터셋을 구성해보자.</p>
<p><br /></p>
<ul>
<li>연구 설계
<ul>
<li>연구기간: 2002년 1월 1일 ~ 2015년 12월 31일</li>
<li>선별기간: 2003년 1월 1일 ~ 2014년 12월 31일</li>
<li>관찰기간: indexdate를 기준으로 이후 6개월</li>
<li>indexdate: 선별기간동안 ‘L20’(아토피성 피부염)으로 인한 첫 방문일 - <strong>모든 주/부상병 고려</strong></li>
</ul></li>
</ul>
<p><br /></p>
<ul>
<li>연구 대상
<ul>
<li>환자군:
<ol style="list-style-type: decimal">
<li>Index date 이후 6개월 동안 전신 면역조절제 또는 전신 스테로이드 또는 광선치료를 사용하지 않고, 국소 calcineurin inhibitor 또는 국소 스테로이드 치료를 실시한 아토피 환자</li>
<li>또는, 6개월 관찰기간 동안 어떠한 아토피 치료를 하지 않은 환자</li>
</ol></li>
</ul></li>
</ul>
<p><br /></p>
<ul>
<li>Outcome
<ol style="list-style-type: decimal">
<li>AD-related cost: outpatient cost, hospitalization cost, total cost</li>
<li>All-cause cost: outpatient cost, hospitalization cost, total cost</li>
</ol>
<ul>
<li><ul>
<li>Cost = 심결요양급여비용총액 + 처방약가</li>
</ul></li>
</ul></li>
</ul>
<p><br /></p>
<ul>
<li>Covariate
<ol style="list-style-type: decimal">
<li>보험자구분: 건강보험 명세서만 고려</li>
<li>연령: 9세이하, 9세초과</li>
<li>성별</li>
<li>의료기관종별: 상급종합병원, 종합병원, 병원, 의원</li>
<li>아토피 치료제 사용유무(중복가능): index 이전 고려</li>
</ol>
<ul>
<li>국소스테로이드제</li>
<li>국소 Calcineurin inhibitor</li>
<li>광선요법</li>
<li>전신 면역조절제</li>
<li>전신 스테로이드제</li>
</ul></li>
</ul>
</div>
<div id="프로그램" class="section level2" number="12.2">
<h2><span class="header-section-number">12.2</span> 프로그램</h2>
<ul>
<li>성별, 보험종별 자료 추가</li>
</ul>
<pre><code>  t20_1 &lt;- t20 %&gt;% 
    left_join(jk %&gt;% select(rn_indi, sex, gaibja_type, std_yyyy), by=c(&quot;rn_indi&quot;,&quot;std_yyyy&quot;))</code></pre>
<ul>
<li>요양기관 정보 불러오기</li>
</ul>
<pre><code>t20_1 &lt;- t20_1 %&gt;% 
    left_join(inst %&gt;% select(rn_inst, std_yyyy, y_jong=inst_clsfc_cd), by=c(&quot;rn_inst&quot;,&quot;std_yyyy&quot;))</code></pre>
<ul>
<li>20 Table 정리</li>
</ul>
<pre><code>t20_2 &lt;- t20_1 %&gt;%
      mutate(
      #입원/내원 시작 일시  
      date1=ymd(mdcare_strt_dt),
    # 요양기관종별
           yko=case_when(y_jong==&#39;0&#39; ~ 1,
                y_jong==&#39;1&#39; ~ 2,
                y_jong==&#39;20&#39; ~ 3,
                y_jong==&#39;3&#39; ~ 4),
    # 입원/외래 구분
           inp=ifelse(form_cd==&#39;02&#39;, 1, 0),
           outp=ifelse(form_cd==&#39;03&#39;, 1, 0),
    # 심결요양급여비용총액     
           tcost=ed_rc_tot_amt,
    ) %&gt;% 
    # 자료 클리닝
      filter(tcost!=0 , gaibja_type %in% c(&#39;1&#39;, &#39;2&#39;, &#39;5&#39;, &#39;6&#39;) , yko %in% c(1,2,3,4)) %&gt;% 
    # 변수 선택
    select(rn_indi, rn_key, date1, sex, yko, inp, outp, tcost)</code></pre>
<ul>
<li>40 Table 정리</li>
</ul>
<pre><code>t40_1 &lt;- t40 %&gt;% 
    mutate(
      sick3=substr(mcex_sick_sym, 1, 3),
      disease=ifelse(sick3 %in% c(&#39;L20&#39;), 1, 0),
    ) %&gt;% 
     select(rn_key, disease)</code></pre>
<pre><code> t40_2 &lt;- t40_1 %&gt;% 
   group_by(rn_key) %&gt;% 
   summarise(
     disease=max(disease),
     # asthma=max(asthma),
     # depress=max(depress),
     # disorder=max(disorder)
     )</code></pre>
<ul>
<li>30 Table 정리</li>
</ul>
<pre><code>#국소 스테로이드
  d1_drug &lt;- scan(what=&quot;&quot;)
  &#39;103433CCM&#39;   &#39;547100CCM&#39; &#39;547400CCM&#39; &#39;528300CCM&#39; &#39;528400CCM&#39; &#39;528700CCM&#39; &#39;547300CCM&#39; &#39;548600COM&#39; &#39;549300COM&#39; &#39;657500CCM&#39; &#39;548600CCM&#39; &#39;548700CCM&#39; &#39;548800CCM&#39; &#39;548900CCM&#39; &#39;549300CCM&#39; &#39;549400CCM&#39; 
  &#39;549700CCM&#39;   &#39;549700CEN&#39; &#39;549700COM&#39; &#39;549800CCM&#39; &#39;549800COM&#39; &#39;800500CCM&#39; &#39;800600COM&#39; &#39;135833CLQ&#39; &#39;135835CLQ&#39; &#39;135836CLQ&#39; &#39;135837CLQ&#39; &#39;135830COM&#39; &#39;135831CCM&#39; &#39;135831COM&#39; &#39;135842CCM&#39; &#39;135842COM&#39;
  &#39;135844CCM&#39;   &#39;135844COM&#39; &#39;135845COM&#39; &#39;135834CLQ&#39; &#39;135838CLQ&#39; &#39;135839CLT&#39; &#39;135930CCM&#39; &#39;135930COM&#39; &#39;144430CCM&#39; &#39;144431CCM&#39; &#39;144432CCM&#39; &#39;144433CCM&#39; &#39;144434CCM&#39; &#39;141531CCM&#39; &#39;141533CCM&#39; &#39;141536CCM&#39; &#39;141542CCM&#39;
  &#39;141535CLT&#39;   &#39;141537CLT&#39; &#39;141540CLT&#39; &#39;141543CLT&#39; &#39;141631CCM&#39; &#39;141632CCM&#39; &#39;141636CCM&#39; &#39;141633CLT&#39; &#39;141634CLT&#39; &#39;144430CCM&#39; &#39;144431CCM&#39; &#39;144432CCM&#39; &#39;144433CCM&#39; &#39;144434CCM&#39; &#39;144530COM&#39; &#39;144531COM&#39; &#39;144532CLT&#39;
  &#39;528800CCM&#39;   &#39;528900CCM&#39; &#39;548200CCM&#39; &#39;548300CCM&#39; &#39;160830CCM&#39; &#39;160832CCM&#39; &#39;160835CCM&#39; &#39;160836CCM&#39; &#39;160834CLQ&#39; &#39;162234CCM&#39; &#39;167830COM&#39; &#39;170931COM&#39; &#39;170932CCM&#39; &#39;170947COM&#39; &#39;170937CLT&#39; &#39;170938CLT&#39; &#39;170939CLT&#39;
  &#39;170943CLT&#39;   &#39;170933CSS&#39; &#39;170950CLT&#39; &#39;170941CLT&#39; &#39;170944CLT&#39; &#39;170945CLT&#39; &#39;170946CLT&#39; &#39;170949CLT&#39; &#39;170934CSS&#39; &#39;171030CCM&#39; &#39;171130CCM&#39; &#39;171332CCM&#39; &#39;546600CCM&#39; &#39;546700CCM&#39; &#39;546900CCM&#39; &#39;193431CLT&#39; &#39;193432CCM&#39; &#39;193432CLT&#39;
  &#39;193432COM&#39;   &#39;193433CCM&#39; &#39;193433COM&#39; &#39;193434CLT&#39; &#39;193435CLT&#39; &#39;193436CCM&#39; &#39;193438CLT&#39; &#39;361330CCM&#39; &#39;361332CCM&#39; &#39;361333CCM&#39; &#39;361333COM&#39; &#39;361334CCM&#39; &#39;361334COM&#39; &#39;361336CCM&#39; &#39;361338CCM&#39; &#39;361341CCM&#39; &#39;361341COM&#39;
  &#39;361345CCM&#39;   &#39;361346CCM&#39; &#39;361346COM&#39; &#39;361347CCM&#39; &#39;361347COM&#39; &#39;361335CLT&#39; &#39;361337CLT&#39; &#39;361339CLT&#39; &#39;361340CLT&#39; &#39;361342CLT&#39; &#39;361344CLT&#39; &#39;216931COM&#39; &#39;216932CCM&#39; &#39;216932COM&#39; &#39;216933CCM&#39; &#39;216933COM&#39; &#39;216935CCM&#39;
  &#39;216935CLT&#39;   &#39;216935COM&#39; &#39;216939CCM&#39; &#39;216939COM&#39; &#39;216944COM&#39; &#39;216945CLT&#39; &#39;216946CCM&#39; &#39;216947CCM&#39; &#39;216947CLT&#39; &#39;216947COM&#39; &#39;216936CLQ&#39; &#39;216940CLQ&#39; &#39;216941CLQ&#39; &#39;216943CLQ&#39; &#39;216949CLQ&#39; &#39;243331CCM&#39; &#39;243333COM&#39;
  &#39;243338CCM&#39;   &#39;243339COM&#39; &#39;545500CCM&#39; &#39;545600CCM&#39; &#39;545800CCM&#39; &#39;545900CCM&#39;</code></pre>
<pre><code>  #국소 Calcineurin inhibitor
  d2_drug &lt;- scan(what=&quot;&quot;)
  &#39;426330COM&#39;   &#39;426331COM&#39; &#39;426332COM&#39; &#39;426333COM&#39; &#39;446430CCM&#39; &#39;446431CCM&#39;</code></pre>
<pre><code> #광선치료
 d3_drug &lt;- scan(what=&quot;&quot;)
 &#39;MM341&#39;   &#39;MM342&#39; &#39;MM343&#39; &#39;MM344&#39; &#39;MM331&#39; &#39;MM332&#39; &#39;MM333&#39; &#39;MM334&#39;</code></pre>
<pre><code>  #전신 면역조절제
  d4_drug &lt;- scan(what=&quot;&quot;)
  &#39;139201ACS&#39;   &#39;139204ACS&#39; &#39;194701ACS&#39; &#39;194702ACS&#39; &#39;194730ALQ&#39;</code></pre>
<pre><code>  #전신 스테로이드제
  d5_drug &lt;- scan(what=&quot;&quot;)
  &#39;116401ATB&#39;   &#39;296900ATB&#39; &#39;160201ATB&#39; &#39;170901ATB&#39; &#39;170906ATB&#39; &#39;193302ATB&#39; &#39;193305ATB&#39; &#39;217001ATB&#39; &#39;217034ASY&#39; &#39;217035ASY&#39; &#39;243201ATB&#39; &#39;243202ATB&#39; &#39;243203ATB&#39; &#39;141901ATB&#39; &#39;141903ATB&#39; &#39;116530BIJ&#39;
  &#39;142030BIJ&#39;   &#39;142230BIJ&#39; &#39;142232BIJ&#39; &#39;142233BIJ&#39; &#39;171201BIJ&#39; &#39;193601BIJ&#39; &#39;193603BIJ&#39; &#39;193604BIJ&#39; &#39;243336BIJ&#39; &#39;243335BIJ&#39; &#39;243337BIJ&#39;</code></pre>
<pre><code>  t30_1 &lt;- t30 %&gt;% 
    mutate(
      d1=ifelse(mcare_div_cd %in% d1_drug,1,0),
      d2=ifelse(mcare_div_cd %in% d2_drug,1,0),
      d3=ifelse(mcare_div_cd %in% d3_drug,1,0),
      d4=ifelse(mcare_div_cd %in% d4_drug,1,0),
      d5=ifelse(mcare_div_cd %in% d5_drug,1,0)
    ) %&gt;% 
    select(rn_key, d1, d2, d3, d4, d5, clsf_pttn_cd, amt)</code></pre>
<pre><code>  t30_2 &lt;- t30_1 %&gt;% 
     group_by(rn_key) %&gt;% 
     summarise(
      d130=max(d1),
      d230=max(d2),
      d330=max(d3),
      d430=max(d4),
      d530=max(d5),
      drug_30=sum(ifelse(clsf_pttn_cd==&#39;3&#39;,amt,0)),
      drug_30_d1=sum(ifelse(d1==&#39;1&#39;,amt,0)),
      drug_30_d2=sum(ifelse(d2==&#39;1&#39;,amt,0)),
      drug_30_d3=sum(ifelse(d3==&#39;1&#39;,amt,0)),
      drug_30_d4=sum(ifelse(d4==&#39;1&#39;,amt,0)),
      drug_30_d5=sum(ifelse(d5==&#39;1&#39;,amt,0))
    )</code></pre>
<ul>
<li>60 Table 정리</li>
</ul>
<pre><code>  t60_1 &lt;- t60 %&gt;% 
     mutate(
      d1=ifelse(gnl_nm_cd %in% d1_drug,1,0),
      d2=ifelse(gnl_nm_cd %in% d2_drug,1,0),
      d3=ifelse(gnl_nm_cd %in% d3_drug,1,0),
      d4=ifelse(gnl_nm_cd %in% d4_drug,1,0),
      d5=ifelse(gnl_nm_cd %in% d5_drug,1,0)
    ) %&gt;% 
    select(rn_key, d1, d2, d3, d4, d5, amt)</code></pre>
<pre><code>  t60_2 &lt;- t60_1 %&gt;% 
     group_by(rn_key) %&gt;% 
     summarise(
      d160=max(d1),
      d260=max(d2),
      d460=max(d4),
      d560=max(d5),
      drug_60=sum(amt),
      drug_60_d1=sum(ifelse(d1==&#39;1&#39;,amt,0)),
      drug_60_d2=sum(ifelse(d2==&#39;1&#39;,amt,0)),
      drug_60_d4=sum(ifelse(d4==&#39;1&#39;,amt,0)),
      drug_60_d5=sum(ifelse(d5==&#39;1&#39;,amt,0))
    )</code></pre>
<ul>
<li>40, 30 and 60 to 20 합쳐서 fullset 정의</li>
</ul>
<pre><code>  fulldata &lt;- t20_2 %&gt;% 
    left_join(t40_2, by=c(&quot;rn_key&quot;)) %&gt;% 
    left_join(t30_2, by=c(&quot;rn_key&quot;)) %&gt;% 
    left_join(t60_2, by=c(&quot;rn_key&quot;))</code></pre>
<pre><code>  fulldata[is.na(fulldata)] &lt;- 0</code></pre>
<ul>
<li>변수 정의</li>
</ul>
<pre><code>  fulldata1 &lt;- fulldata %&gt;% 
    group_by(rn_key) %&gt;% 
    mutate(
      d1=max(d130,d160),
      d2=max(d230,d260),
      d3=max(d330),
      d4=max(d430,d460),
      d5=max(d530,d560)
    ) %&gt;% 
    select(-c(d130,d160,d230,d260,d330,d430,d460,d530,d560))</code></pre>
<ul>
<li>index date 정의</li>
</ul>
<pre><code>  # 날짜 조건
  index &lt;- fulldata1$date1&gt;= ymd(20030101) &amp; fulldata1$date1 &lt;= ymd(20141231)
  indexdata &lt;- fulldata1[index,]</code></pre>
<pre><code>  indexdata &lt;- indexdata %&gt;% 
    select(rn_indi:disease)</code></pre>
<pre><code>  indexdata2 &lt;- indexdata %&gt;% 
    filter(disease==1) %&gt;% 
    group_by(rn_indi) %&gt;% 
    arrange(rn_indi, date1) %&gt;% 
    filter(row_number()==1) </code></pre>
<ul>
<li>Follow-up period</li>
</ul>
<pre><code>  followdata &lt;- fulldata1 %&gt;% 
    inner_join(indexdata2 %&gt;% select(rn_indi,indexdate=date1), by=c(&quot;rn_indi&quot;)) %&gt;% 
    filter(date1 &gt;= indexdate, date1 &lt;= (indexdate+182))</code></pre>
<ul>
<li>Pre-index pesriod</li>
</ul>
<pre><code>  predata &lt;- fulldata1 %&gt;% 
    inner_join(indexdata2 %&gt;% select(rn_indi,indexdate=date1), by=c(&quot;rn_indi&quot;)) %&gt;% 
    filter(date1 &lt; indexdate)</code></pre>
<ul>
<li>index 이전 이후 약제 사용정보 통합합</li>
</ul>
<pre><code>  followdata_1 &lt;- followdata %&gt;% 
    group_by(rn_indi) %&gt;% 
    summarise(d1=max(d1), d2=max(d2), d3=max(d3), d4=max(d4), d5=max(d5))</code></pre>
<pre><code>  predata_1 &lt;- predata %&gt;% 
    group_by(rn_indi) %&gt;% 
    summarise(pred1=max(d1), pred2=max(d2), pred3=max(d3), pred4=max(d4), pred5=max(d5))</code></pre>
<ul>
<li>조건 통합 / 환자군 생성</li>
</ul>
<pre><code>  candidate &lt;- followdata_1 %&gt;% 
    left_join(predata_1, by=&quot;rn_indi&quot;)</code></pre>
<pre><code> candidate[is.na(candidate)] &lt;- 0</code></pre>
<pre><code> candidate &lt;- candidate %&gt;% 
   group_by(rn_indi) %&gt;% 
   mutate(cad=ifelse(((d3==0 &amp; d4==0 &amp; d5==0) &amp; (d1==1 | d2==1)) | (d1==0 &amp; d2==0 &amp; d3==0 &amp; d4==0 &amp; d5==0),
                     1,0))
 
    # ifelse(any(all(sum(d3,d4,d5)==0,any(d1==1,d2==1)),sum(d1,d2,d3,d4,d5)==0),0,1)</code></pre>
<ul>
<li>데이터 통합</li>
</ul>
<pre><code> indexdata3 &lt;- indexdata2 %&gt;% 
   left_join(candidate, by=&quot;rn_indi&quot;)</code></pre>
<pre><code># 변수정의
  followdata2 &lt;- followdata %&gt;% 
    group_by(rn_key) %&gt;% 
    mutate(total_cost=sum(tcost,drug_60))</code></pre>
<pre><code>  followdata3 &lt;- followdata2 %&gt;% 
    group_by(rn_indi) %&gt;% 
    summarise(total_cost_all=sum(total_cost),
              total_cost_out=sum(ifelse(outp==1,total_cost,0)),
              total_cost_in=sum(ifelse(inp==1,total_cost,0)),
              total_cost_ad=sum(ifelse(disease==1,total_cost,0)),
              total_cost_out_ad=sum(ifelse(disease==1 &amp; outp==1,total_cost,0)),
              total_cost_in_ad=sum(ifelse(disease==1 &amp; inp==1,total_cost,0))
                            )</code></pre>
<pre><code>  indexdata4 &lt;- indexdata3 %&gt;% 
    left_join(followdata3, by=&quot;rn_indi&quot;)</code></pre>
<ul>
<li>AGE 계산</li>
</ul>
<pre><code>  indexdata5 &lt;- indexdata4 %&gt;% 
    left_join(death %&gt;% select(rn_indi,bth_yyyy), by=&quot;rn_indi&quot;)</code></pre>
<ul>
<li>Final data</li>
</ul>
<pre><code>  final &lt;- indexdata5 %&gt;% 
    group_by(rn_indi) %&gt;% 
    mutate(birth=as.numeric(substr(bth_yyyy,1,4)),
           age=year(date1)-birth,
           age_group=ifelse(age&lt;=9,1,2),
           notreat=ifelse(sum(pred1,pred2,pred3,pred4,pred5)==0,1,0),)</code></pre>
<ul>
<li>최종 데이터셋 저장</li>
</ul>
<pre><code>  save.image(&quot;claims_final.RData&quot;)</code></pre>
<pre><code>  str(final)
  glimpse(final)</code></pre>
<ul>
<li>Baseline Chracteristic</li>
</ul>
<pre><code>  a &lt;- c(&quot;age_group&quot;,&quot;sex&quot;,&quot;yko&quot;,&quot;notreat&quot;,
         paste(&quot;pred&quot;,1:5,sep=&quot;&quot;))
  
  contingency &lt;- function(data,var) {
  
  a &lt;- var
  result &lt;- NULL
  for (i in 1:length(a)) {
    
    m &lt;- data[a[i]]
    m.freq &lt;- table(m)
    m.prop &lt;- prop.table(m.freq)
    re &lt;- data.frame(Var=a[i],Value=rownames(m.freq),cbind(m.freq,m.prop))
    rownames(re) &lt;- NULL
    
    result &lt;- rbind(result,re)
  }
  
  result
  }
  
  contingency(final,a)</code></pre>
<!-------- End ------------>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter11.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rmanual.pdf", "rmanual.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
