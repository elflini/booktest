<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 새로운 변수 생성 | Insurance Claims Data Analysis with R</title>
  <meta name="description" content="This is a R manual for analysis of insurance claims data" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 새로운 변수 생성 | Insurance Claims Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a R manual for analysis of insurance claims data" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 새로운 변수 생성 | Insurance Claims Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a R manual for analysis of insurance claims data" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2021-12-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter4.html"/>
<link rel="next" href="chapter6.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Claims Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> R이란?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#r-설치"><i class="fa fa-check"></i><b>1.1</b> R 설치</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#r-프로그램의-구성"><i class="fa fa-check"></i><b>1.2</b> R 프로그램의 구성</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chapter1.html"><a href="chapter1.html#파일"><i class="fa fa-check"></i><b>1.2.1</b> 파일</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapter1.html"><a href="chapter1.html#편집"><i class="fa fa-check"></i><b>1.2.2</b> 편집</a></li>
<li class="chapter" data-level="1.2.3" data-path="chapter1.html"><a href="chapter1.html#기타"><i class="fa fa-check"></i><b>1.2.3</b> 기타</a></li>
<li class="chapter" data-level="1.2.4" data-path="chapter1.html"><a href="chapter1.html#패키지"><i class="fa fa-check"></i><b>1.2.4</b> 패키지</a></li>
<li class="chapter" data-level="1.2.5" data-path="chapter1.html"><a href="chapter1.html#윈도우즈"><i class="fa fa-check"></i><b>1.2.5</b> 윈도우즈</a></li>
<li class="chapter" data-level="1.2.6" data-path="chapter1.html"><a href="chapter1.html#도움말"><i class="fa fa-check"></i><b>1.2.6</b> 도움말</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#r-프로그램-특징"><i class="fa fa-check"></i><b>1.3</b> R 프로그램 특징</a></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#rstudio-설치"><i class="fa fa-check"></i><b>1.4</b> RStudio 설치</a></li>
<li class="chapter" data-level="1.5" data-path="chapter1.html"><a href="chapter1.html#r-패키지-이용"><i class="fa fa-check"></i><b>1.5</b> R 패키지 이용</a></li>
<li class="chapter" data-level="1.6" data-path="chapter1.html"><a href="chapter1.html#r-패키지-관리"><i class="fa fa-check"></i><b>1.6</b> R 패키지 관리</a></li>
<li class="chapter" data-level="1.7" data-path="chapter1.html"><a href="chapter1.html#산술-연산자"><i class="fa fa-check"></i><b>1.7</b> 산술 연산자</a></li>
<li class="chapter" data-level="1.8" data-path="chapter1.html"><a href="chapter1.html#논리-연산자와-비교-연산자"><i class="fa fa-check"></i><b>1.8</b> 논리 연산자와 비교 연산자</a></li>
<li class="chapter" data-level="1.9" data-path="chapter1.html"><a href="chapter1.html#기초-산술-함수"><i class="fa fa-check"></i><b>1.9</b> 기초 산술 함수</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="chapter1.html"><a href="chapter1.html#통계-함수"><i class="fa fa-check"></i><b>1.9.1</b> 통계 함수</a></li>
<li class="chapter" data-level="1.9.2" data-path="chapter1.html"><a href="chapter1.html#로그-및-지수-함수-logarithms-and-exponentials"><i class="fa fa-check"></i><b>1.9.2</b> 로그 및 지수 함수 (Logarithms and Exponentials)</a></li>
<li class="chapter" data-level="1.9.3" data-path="chapter1.html"><a href="chapter1.html#삼각-함수"><i class="fa fa-check"></i><b>1.9.3</b> 삼각 함수</a></li>
<li class="chapter" data-level="1.9.4" data-path="chapter1.html"><a href="chapter1.html#기타-수학-함수"><i class="fa fa-check"></i><b>1.9.4</b> 기타 수학 함수</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="chapter1.html"><a href="chapter1.html#객체의-명명과-할당"><i class="fa fa-check"></i><b>1.10</b> 객체의 명명과 할당</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="chapter1.html"><a href="chapter1.html#객체변수-만들기"><i class="fa fa-check"></i><b>1.10.1</b> 객체(변수) 만들기</a></li>
<li class="chapter" data-level="1.10.2" data-path="chapter1.html"><a href="chapter1.html#객체-목록-보기"><i class="fa fa-check"></i><b>1.10.2</b> 객체 목록 보기</a></li>
<li class="chapter" data-level="1.10.3" data-path="chapter1.html"><a href="chapter1.html#객체변수-지우기"><i class="fa fa-check"></i><b>1.10.3</b> 객체(변수) 지우기</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="chapter1.html"><a href="chapter1.html#데이터-유형"><i class="fa fa-check"></i><b>1.11</b> 데이터 유형</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="chapter1.html"><a href="chapter1.html#데이터의-기본-유형"><i class="fa fa-check"></i><b>1.11.1</b> 데이터의 기본 유형</a></li>
<li class="chapter" data-level="1.11.2" data-path="chapter1.html"><a href="chapter1.html#특수-데이터"><i class="fa fa-check"></i><b>1.11.2</b> 특수 데이터</a></li>
<li class="chapter" data-level="1.11.3" data-path="chapter1.html"><a href="chapter1.html#데이터-유형-함수"><i class="fa fa-check"></i><b>1.11.3</b> 데이터 유형 함수</a></li>
<li class="chapter" data-level="1.11.4" data-path="chapter1.html"><a href="chapter1.html#데이터-유형-변경"><i class="fa fa-check"></i><b>1.11.4</b> 데이터 유형 변경</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="chapter1.html"><a href="chapter1.html#자료의-입력"><i class="fa fa-check"></i><b>1.12</b> 자료의 입력</a>
<ul>
<li class="chapter" data-level="1.12.1" data-path="chapter1.html"><a href="chapter1.html#read.table"><i class="fa fa-check"></i><b>1.12.1</b> read.table()</a></li>
<li class="chapter" data-level="1.12.2" data-path="chapter1.html"><a href="chapter1.html#read.csv"><i class="fa fa-check"></i><b>1.12.2</b> read.csv()</a></li>
<li class="chapter" data-level="1.12.3" data-path="chapter1.html"><a href="chapter1.html#read.delim"><i class="fa fa-check"></i><b>1.12.3</b> read.delim()</a></li>
<li class="chapter" data-level="1.12.4" data-path="chapter1.html"><a href="chapter1.html#read_excel"><i class="fa fa-check"></i><b>1.12.4</b> read_excel()</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="chapter1.html"><a href="chapter1.html#자료의-출력"><i class="fa fa-check"></i><b>1.13</b> 자료의 출력</a>
<ul>
<li class="chapter" data-level="1.13.1" data-path="chapter1.html"><a href="chapter1.html#write.table"><i class="fa fa-check"></i><b>1.13.1</b> write.table()</a></li>
<li class="chapter" data-level="1.13.2" data-path="chapter1.html"><a href="chapter1.html#write_xlsx"><i class="fa fa-check"></i><b>1.13.2</b> write_xlsx()</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="chapter1.html"><a href="chapter1.html#r-manual"><i class="fa fa-check"></i><b>1.14</b> R Manual</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Tidyverse Package</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#filter"><i class="fa fa-check"></i><b>2.1</b> filter()</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#filter---연속형-변수-처리"><i class="fa fa-check"></i><b>2.1.1</b> filter() - 연속형 변수 처리</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#filter---이산형-변수-처리"><i class="fa fa-check"></i><b>2.1.2</b> filter() - 이산형 변수 처리</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter2.html"><a href="chapter2.html#filter---문자형-변수-처리"><i class="fa fa-check"></i><b>2.1.3</b> filter() - 문자형 변수 처리</a></li>
<li class="chapter" data-level="2.1.4" data-path="chapter2.html"><a href="chapter2.html#filter---일반적인-변수-처리"><i class="fa fa-check"></i><b>2.1.4</b> filter() - 일반적인 변수 처리</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#pipe"><i class="fa fa-check"></i><b>2.2</b> Pipe : %&gt;%</a></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#select"><i class="fa fa-check"></i><b>2.3</b> select()</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter2.html"><a href="chapter2.html#select---선택"><i class="fa fa-check"></i><b>2.3.1</b> select() - 선택</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter2.html"><a href="chapter2.html#select---제거"><i class="fa fa-check"></i><b>2.3.2</b> select() - 제거</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapter2.html"><a href="chapter2.html#filter-와-select-혼합"><i class="fa fa-check"></i><b>2.3.3</b> filter() 와 select() 혼합</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#group_by와-summarise"><i class="fa fa-check"></i><b>2.4</b> group_by()와 summarise()</a></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#arrange"><i class="fa fa-check"></i><b>2.5</b> arrange()</a></li>
<li class="chapter" data-level="2.6" data-path="chapter2.html"><a href="chapter2.html#결측값-처리"><i class="fa fa-check"></i><b>2.6</b> 결측값 처리</a></li>
<li class="chapter" data-level="2.7" data-path="chapter2.html"><a href="chapter2.html#mutate"><i class="fa fa-check"></i><b>2.7</b> mutate()</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> 공단표본코호트 데모자료</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#자격-db---자격-및-보험료-테이블"><i class="fa fa-check"></i><b>3.1</b> 자격 DB - 자격 및 보험료 테이블</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#사망-db---출생-및-사망테이블"><i class="fa fa-check"></i><b>3.2</b> 사망 DB - 출생 및 사망테이블</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#요양기관-db"><i class="fa fa-check"></i><b>3.3</b> 요양기관 DB</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#진료-db---20-테이블"><i class="fa fa-check"></i><b>3.4</b> 진료 DB - 20 테이블</a></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#진료-db---30-테이블"><i class="fa fa-check"></i><b>3.5</b> 진료 DB - 30 테이블</a></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#진료-db---40-테이블"><i class="fa fa-check"></i><b>3.6</b> 진료 DB - 40 테이블</a></li>
<li class="chapter" data-level="3.7" data-path="chapter3.html"><a href="chapter3.html#진료-db---60-테이블"><i class="fa fa-check"></i><b>3.7</b> 진료 DB - 60 테이블</a></li>
<li class="chapter" data-level="3.8" data-path="chapter3.html"><a href="chapter3.html#작업공간-저장-및-불러오기"><i class="fa fa-check"></i><b>3.8</b> 작업공간 저장 및 불러오기</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="chapter3.html"><a href="chapter3.html#객체-목록-확인"><i class="fa fa-check"></i><b>3.8.1</b> 객체 목록 확인</a></li>
<li class="chapter" data-level="3.8.2" data-path="chapter3.html"><a href="chapter3.html#작업공간-저장"><i class="fa fa-check"></i><b>3.8.2</b> 작업공간 저장</a></li>
<li class="chapter" data-level="3.8.3" data-path="chapter3.html"><a href="chapter3.html#작업공간-불러오기"><i class="fa fa-check"></i><b>3.8.3</b> 작업공간 불러오기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> 데이터프레임의 활용</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#데이터-프레임"><i class="fa fa-check"></i><b>4.1</b> 데이터 프레임</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#데이터-프레임-인덱싱"><i class="fa fa-check"></i><b>4.2</b> 데이터 프레임 인덱싱</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#공단자료와-필요패키지-불러오기"><i class="fa fa-check"></i><b>4.3</b> 공단자료와 필요패키지 불러오기</a></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#특정-변수만-남기기"><i class="fa fa-check"></i><b>4.4</b> 특정 변수만 남기기</a></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#특정-변수-지우기"><i class="fa fa-check"></i><b>4.5</b> 특정 변수 지우기</a></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#변수-이름-바꾸기"><i class="fa fa-check"></i><b>4.6</b> 변수 이름 바꾸기</a></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#특정-위치의-관찰값-추출"><i class="fa fa-check"></i><b>4.7</b> 특정 위치의 관찰값 추출</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> 새로운 변수 생성</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#기존-변수의-값-바꾸기"><i class="fa fa-check"></i><b>5.1</b> 기존 변수의 값 바꾸기</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#새로운-변수-만들기"><i class="fa fa-check"></i><b>5.2</b> 새로운 변수 만들기</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#round-함수-이용"><i class="fa fa-check"></i><b>5.3</b> Round 함수 이용</a></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#순자를-문자로-문자를-숫자로"><i class="fa fa-check"></i><b>5.4</b> 순자를 문자로, 문자를 숫자로</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#substr-함수-이용"><i class="fa fa-check"></i><b>5.5</b> substr 함수 이용</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#날짜-함수-이용"><i class="fa fa-check"></i><b>5.6</b> 날짜 함수 이용</a></li>
<li class="chapter" data-level="5.7" data-path="chapter5.html"><a href="chapter5.html#누적합-함수-이용"><i class="fa fa-check"></i><b>5.7</b> 누적합 함수 이용</a></li>
<li class="chapter" data-level="5.8" data-path="chapter5.html"><a href="chapter5.html#lag과-diff-함수-이용"><i class="fa fa-check"></i><b>5.8</b> lag과 diff 함수 이용</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> 조건문</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#특정-조건을-만족하는-관찰값-선택하기"><i class="fa fa-check"></i><b>6.1</b> 특정 조건을 만족하는 관찰값 선택하기</a></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#특정-조건을-만족하는-관찰값-삭제하기"><i class="fa fa-check"></i><b>6.2</b> 특정 조건을 만족하는 관찰값 삭제하기</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#조건문-활용하기"><i class="fa fa-check"></i><b>6.3</b> 조건문 활용하기</a></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#조건문-일반화하기"><i class="fa fa-check"></i><b>6.4</b> 조건문 일반화하기</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> 자료의 정렬</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#하나의-변수에-의한-관찰값의-정렬"><i class="fa fa-check"></i><b>7.1</b> 하나의 변수에 의한 관찰값의 정렬</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#여러-개의-변수에-의한-관찰값의-정렬"><i class="fa fa-check"></i><b>7.2</b> 여러 개의 변수에 의한 관찰값의 정렬</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#처음과-마지막-개체-추출하기"><i class="fa fa-check"></i><b>7.3</b> 처음과 마지막 개체 추출하기</a></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#동일한-관찰값의-제거"><i class="fa fa-check"></i><b>7.4</b> 동일한 관찰값의 제거</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> 반복문</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#조건에-의한-반복"><i class="fa fa-check"></i><b>8.1</b> 조건에 의한 반복</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#개체에-의한-반복"><i class="fa fa-check"></i><b>8.2</b> 개체에 의한 반복</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#다중-반복"><i class="fa fa-check"></i><b>8.3</b> 다중 반복</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> 데이터셋 합치기</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#변수-기준-개체-통합"><i class="fa fa-check"></i><b>9.1</b> 변수 기준 개체 통합</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#개체-기준-변수-통합"><i class="fa fa-check"></i><b>9.2</b> 개체 기준 변수 통합</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter10.html"><a href="chapter10.html"><i class="fa fa-check"></i><b>10</b> Tidyverse 활용</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter10.html"><a href="chapter10.html#tidyverse-dplyr-기본-구조"><i class="fa fa-check"></i><b>10.1</b> Tidyverse (dplyr) 기본 구조</a></li>
<li class="chapter" data-level="10.2" data-path="chapter10.html"><a href="chapter10.html#단일-데이터셋-다루기"><i class="fa fa-check"></i><b>10.2</b> 단일 데이터셋 다루기</a></li>
<li class="chapter" data-level="10.3" data-path="chapter10.html"><a href="chapter10.html#여러-데이터셋-다루기"><i class="fa fa-check"></i><b>10.3</b> 여러 데이터셋 다루기</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter11.html"><a href="chapter11.html"><i class="fa fa-check"></i><b>11</b> 사용자 정의 함수</a></li>
<li class="chapter" data-level="12" data-path="chapter12.html"><a href="chapter12.html"><i class="fa fa-check"></i><b>12</b> 예제1</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chapter12.html"><a href="chapter12.html#연구-설계"><i class="fa fa-check"></i><b>12.1</b> 연구 설계</a></li>
<li class="chapter" data-level="12.2" data-path="chapter12.html"><a href="chapter12.html#프로그램"><i class="fa fa-check"></i><b>12.2</b> 프로그램</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Insurance Claims Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter5" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> 새로운 변수 생성</h1>
<p>공단자료와 필요 패키지 불러오기</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter5.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;claim.RData&quot;</span>)</span>
<span id="cb1-2"><a href="chapter5.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="chapter5.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># 날짜 함수</span></span></code></pre></div>
<div id="기존-변수의-값-바꾸기" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> 기존 변수의 값 바꾸기</h2>
<p>이번 장에서는 새로운 변수를 어떻게 생성하는지 알아보자. 새로운 변수 생성 시 두 가지 경우를 생각해 볼 수 있다. 첫 번째는 기존에 존재하는 변수의 값을 바꾸는 것이고 두 번째는 완전히 새로운 변수를 생성하는 경우이다. 우선 기존에 존재하는 변수의 값을 바꾸는 여러 가지 형태를 알아보자. 사용법은 다음과 같다.</p>
<pre><code>기존에 존재하는 변수 = 원하는 형태의 식</code></pre>
<p>우선 t20 데이터셋에서 개인고유번호(rn_indi), 심결요양급여비용총액(ed_rc_tot_amt), 심결본인부담금(edc_sba), 심결보험자부담금(edc_insur_brdn_amt) 네 개의 변수만 남겨서 t20_new 데이터셋을 생성하자.</p>
<ul>
<li>방법1</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter5.html#cb3-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20[<span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>, <span class="st">&quot;ed_rc_tot_amt&quot;</span>, <span class="st">&quot;edc_sba&quot;</span>, <span class="st">&quot;edc_insur_brdn_amt&quot;</span>)]</span>
<span id="cb3-2"><a href="chapter5.html#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="chapter5.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(t20_new) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;id&quot;</span>,<span class="st">&quot;tcost&quot;</span>,<span class="st">&quot;acost&quot;</span>,<span class="st">&quot;bcost&quot;</span>)</span>
<span id="cb3-4"><a href="chapter5.html#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="chapter5.html#cb3-5" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 4
##        id tcost acost bcost
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 746491 10590  3000  7590
##  2 848340 10590  3000  7590
##  3 992522 10590  3000  7590
##  4 543044 10590  3000  7590
##  5 928716 10590  3000  7590
##  6 633585 10590  3000  7590
##  7 706339 10590  3000  7590
##  8 515572 10590  3000  7590
##  9  71582 10590  3000  7590
## 10 701404 10590  3000  7590
## # ... with 135,514 more rows</code></pre>
<ul>
<li>방법2</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="chapter5.html#cb5-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="chapter5.html#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(rn_indi, ed_rc_tot_amt<span class="sc">:</span>edc_insur_brdn_amt) <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="chapter5.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">acost=</span>edc_sba, <span class="at">bcost=</span>edc_insur_brdn_amt)</span>
<span id="cb5-4"><a href="chapter5.html#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="chapter5.html#cb5-5" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 4
##        id tcost acost bcost
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 746491 10590  3000  7590
##  2 848340 10590  3000  7590
##  3 992522 10590  3000  7590
##  4 543044 10590  3000  7590
##  5 928716 10590  3000  7590
##  6 633585 10590  3000  7590
##  7 706339 10590  3000  7590
##  8 515572 10590  3000  7590
##  9  71582 10590  3000  7590
## 10 701404 10590  3000  7590
## # ... with 135,514 more rows</code></pre>
<ul>
<li>방법3</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="chapter5.html#cb7-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="chapter5.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">acost=</span>edc_sba, <span class="at">bcost=</span>edc_insur_brdn_amt)</span>
<span id="cb7-3"><a href="chapter5.html#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="chapter5.html#cb7-4" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 4
##        id tcost acost bcost
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 746491 10590  3000  7590
##  2 848340 10590  3000  7590
##  3 992522 10590  3000  7590
##  4 543044 10590  3000  7590
##  5 928716 10590  3000  7590
##  6 633585 10590  3000  7590
##  7 706339 10590  3000  7590
##  8 515572 10590  3000  7590
##  9  71582 10590  3000  7590
## 10 701404 10590  3000  7590
## # ... with 135,514 more rows</code></pre>
<p>여기서 ed_rc_tot_amt : edc_insur_brdn_amt의 의미는 데이터셋 상의 변수 순서로 봤을 때 ed_rc_tot_amt부터 edc_insur_brdn_amt까지 모든 변수를 의미한다. 이때 편의를 위해 남겨진 변수의 이름을 id, tcost, acost, bcost로 변경했으며, tcost는 acost와 bcost의 합과 같은 관계를 지닌다.</p>
<ul>
<li>방법1</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapter5.html#cb9-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="chapter5.html#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">acost=</span>edc_sba, <span class="at">bcost=</span>edc_insur_brdn_amt)</span>
<span id="cb9-3"><a href="chapter5.html#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="chapter5.html#cb9-4" aria-hidden="true" tabindex="-1"></a>t20_new<span class="sc">$</span>tcost <span class="ot">&lt;-</span> t20_new<span class="sc">$</span>tcost<span class="sc">+</span><span class="dv">1000</span></span>
<span id="cb9-5"><a href="chapter5.html#cb9-5" aria-hidden="true" tabindex="-1"></a>t20_new<span class="sc">$</span>acost <span class="ot">&lt;-</span> t20_new<span class="sc">$</span>acost<span class="sc">+</span>t20_new<span class="sc">$</span>bcost<span class="sc">+</span><span class="dv">1000</span></span>
<span id="cb9-6"><a href="chapter5.html#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="chapter5.html#cb9-7" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 4
##        id tcost acost bcost
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 746491 11590 11590  7590
##  2 848340 11590 11590  7590
##  3 992522 11590 11590  7590
##  4 543044 11590 11590  7590
##  5 928716 11590 11590  7590
##  6 633585 11590 11590  7590
##  7 706339 11590 11590  7590
##  8 515572 11590 11590  7590
##  9  71582 11590 11590  7590
## 10 701404 11590 11590  7590
## # ... with 135,514 more rows</code></pre>
<ul>
<li>방법2</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="chapter5.html#cb11-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="chapter5.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">acost=</span>edc_sba, <span class="at">bcost=</span>edc_insur_brdn_amt)</span>
<span id="cb11-3"><a href="chapter5.html#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="chapter5.html#cb11-4" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20_new <span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="chapter5.html#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tcost=</span>tcost<span class="sc">+</span><span class="dv">1000</span>, <span class="at">acost=</span>acost<span class="sc">+</span>bcost<span class="sc">+</span><span class="dv">1000</span>)</span>
<span id="cb11-6"><a href="chapter5.html#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="chapter5.html#cb11-7" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 4
##        id tcost acost bcost
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 746491 11590 11590  7590
##  2 848340 11590 11590  7590
##  3 992522 11590 11590  7590
##  4 543044 11590 11590  7590
##  5 928716 11590 11590  7590
##  6 633585 11590 11590  7590
##  7 706339 11590 11590  7590
##  8 515572 11590 11590  7590
##  9  71582 11590 11590  7590
## 10 701404 11590 11590  7590
## # ... with 135,514 more rows</code></pre>
<ul>
<li>방법3</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter5.html#cb13-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="chapter5.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">acost=</span>edc_sba, <span class="at">bcost=</span>edc_insur_brdn_amt)</span>
<span id="cb13-3"><a href="chapter5.html#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="chapter5.html#cb13-4" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20_new <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="chapter5.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb13-6"><a href="chapter5.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tcost=</span><span class="fu">sum</span>(tcost,<span class="dv">1000</span>), <span class="at">acost=</span><span class="fu">sum</span>(acost,bcost,<span class="dv">1000</span>))</span>
<span id="cb13-7"><a href="chapter5.html#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="chapter5.html#cb13-8" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 4
## # Rowwise: 
##        id tcost acost bcost
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 746491 11590 11590  7590
##  2 848340 11590 11590  7590
##  3 992522 11590 11590  7590
##  4 543044 11590 11590  7590
##  5 928716 11590 11590  7590
##  6 633585 11590 11590  7590
##  7 706339 11590 11590  7590
##  8 515572 11590 11590  7590
##  9  71582 11590 11590  7590
## 10 701404 11590 11590  7590
## # ... with 135,514 more rows</code></pre>
<p>다음으로 t20_new 데이터셋을 참조하여 t20_new 데이터셋으로 덧 씌우며, 이때 tcost와 acost의 값을 바꾸기 위해 두 줄의 명령문을 추가하였다. 우선 [tcost=tcost+1000]의 경우, 원래 가지고 있던 tcost의 값에 1000을 더하여 다시 tcost에 저장을 한다. 즉, 기존의 tcost 값은 사라지고 원래 tcost 값보다 1000씩 커진 값을 가진 새로운 tcost 생성된다. [acost=acost+bcost+1000]은 원래 가지고 있는 acost와 bcost를 더하고 여기에 다시 1000을 더한 값을 acost에 저장하라는 의미이다. 기본적으로 acost와 bcost를 합하면 tcost와 같아지게 되고 여기에 1000을 더하여 acost에 저장을 하였기 때문에, 결론적으로 새로 생성된 acost는 새로 생성된 tcost와 같은 값을 가지게 된다.</p>
<p>결과를 살펴보면 tcost는 기존의 값에 1000을 더한 값이 저장되었고, acost는 기존의 acost 값에 bcost와 1000을 더한 값이 생성되었다는 것을 알 수 있다. 기존에 존재하는 변수명으로 새로운 값을 부여하게 되면 기존의 값이 사라지게 되므로 기존 변수의 값을 바꿀 때에는 신중히 처리해야 한다.</p>
</div>
<div id="새로운-변수-만들기" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> 새로운 변수 만들기</h2>
<p>새로운 변수를 생성하는 방법은 기존 변수의 값을 바꾸는 방법과 다르지 않다. 다만, “=”을 기준으로 왼쪽에 새로운 값을 가질 변수명 대신 새로운 변수명을 입력하면 된다. 사용하는 방법은 다음과 같다.</p>
<pre><code>새로운 변수 = 원하는 형태의 식</code></pre>
<p>우선 기본적인 사칙연산을 이용한 새로운 변수 생성 방법을 알아보자. 기존 변수의 값 바꾸기와 같이 t20 데이터셋에서 개인고유번호(rn_indi), 심결요양급여비용총액(ed_rc_tot_amt), 심결본인부담금(edc_sba), 심결보험자부담금(edc_insur_brdn_amt) 네 개의 변수만 남겨서 t20_new 데이터셋을 생성한다. 여기서 acost와 bcost를 합해서 새로운 변수 totalcost를 생성하고 acost와 bcost의 비율을 costratio 변수로 생성해보자.</p>
<ul>
<li>방법1</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter5.html#cb16-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="chapter5.html#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">acost=</span>edc_sba, <span class="at">bcost=</span>edc_insur_brdn_amt)</span>
<span id="cb16-3"><a href="chapter5.html#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="chapter5.html#cb16-4" aria-hidden="true" tabindex="-1"></a>t20_new<span class="sc">$</span>totalcost <span class="ot">&lt;-</span> t20_new<span class="sc">$</span>acost<span class="sc">+</span>t20_new<span class="sc">$</span>bcost</span>
<span id="cb16-5"><a href="chapter5.html#cb16-5" aria-hidden="true" tabindex="-1"></a>t20_new<span class="sc">$</span>costratio <span class="ot">&lt;-</span> t20_new<span class="sc">$</span>acost<span class="sc">/</span>t20_new<span class="sc">$</span>bcost</span>
<span id="cb16-6"><a href="chapter5.html#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="chapter5.html#cb16-7" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 6
##        id tcost acost bcost totalcost costratio
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 746491 10590  3000  7590     10590     0.395
##  2 848340 10590  3000  7590     10590     0.395
##  3 992522 10590  3000  7590     10590     0.395
##  4 543044 10590  3000  7590     10590     0.395
##  5 928716 10590  3000  7590     10590     0.395
##  6 633585 10590  3000  7590     10590     0.395
##  7 706339 10590  3000  7590     10590     0.395
##  8 515572 10590  3000  7590     10590     0.395
##  9  71582 10590  3000  7590     10590     0.395
## 10 701404 10590  3000  7590     10590     0.395
## # ... with 135,514 more rows</code></pre>
<ul>
<li>방법2</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter5.html#cb18-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="chapter5.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">acost=</span>edc_sba, <span class="at">bcost=</span>edc_insur_brdn_amt)</span>
<span id="cb18-3"><a href="chapter5.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="chapter5.html#cb18-4" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20_new <span class="sc">%&gt;%</span> </span>
<span id="cb18-5"><a href="chapter5.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">totalcost=</span>acost<span class="sc">+</span>bcost, <span class="at">costratio=</span>acost<span class="sc">/</span>bcost)</span>
<span id="cb18-6"><a href="chapter5.html#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="chapter5.html#cb18-7" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 6
##        id tcost acost bcost totalcost costratio
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
##  1 746491 10590  3000  7590     10590     0.395
##  2 848340 10590  3000  7590     10590     0.395
##  3 992522 10590  3000  7590     10590     0.395
##  4 543044 10590  3000  7590     10590     0.395
##  5 928716 10590  3000  7590     10590     0.395
##  6 633585 10590  3000  7590     10590     0.395
##  7 706339 10590  3000  7590     10590     0.395
##  8 515572 10590  3000  7590     10590     0.395
##  9  71582 10590  3000  7590     10590     0.395
## 10 701404 10590  3000  7590     10590     0.395
## # ... with 135,514 more rows</code></pre>
<p>R은 사용자 편의를 위해 무수히 많은 함수를 제공한다. 예를 들어 변수의 합을 구하는 함수는 “sum”을 이용하고 평균을 구할 때는 “mean”을 이용한다. 이처럼 내장된 함수를 이용하여 간단하게 여러 가지 형태의 식을 구현할 수 있다. R에서 제공하는 내장함수 중 수학 또는 통계와 관련된 내장함수는 다음을 참조하기 바란다. <a href="https://elflini.github.io/study/rmanual/index.html">https://elflini.github.io/study/rmanual/index.html</a></p>
<p>위의 예제에 이어서 내장함수를 이용하여 다음과 같은 변수를 생성해보자.</p>
<p>totalcost = acost와 bcost의 합</p>
<p>meancost = acost와 bcost의 평균</p>
<p>프로그램은 다음과 같다.</p>
<ul>
<li>방법1</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapter5.html#cb20-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="chapter5.html#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">acost=</span>edc_sba, <span class="at">bcost=</span>edc_insur_brdn_amt)</span>
<span id="cb20-3"><a href="chapter5.html#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="chapter5.html#cb20-4" aria-hidden="true" tabindex="-1"></a>t20_new<span class="sc">$</span>totalcost <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(t20_new[<span class="fu">c</span>(<span class="st">&quot;acost&quot;</span>,<span class="st">&quot;bcost&quot;</span>)]) </span>
<span id="cb20-5"><a href="chapter5.html#cb20-5" aria-hidden="true" tabindex="-1"></a>t20_new<span class="sc">$</span>meancost <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(t20_new[<span class="fu">c</span>(<span class="st">&quot;acost&quot;</span>,<span class="st">&quot;bcost&quot;</span>)])</span>
<span id="cb20-6"><a href="chapter5.html#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="chapter5.html#cb20-7" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 6
##        id tcost acost bcost totalcost meancost
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 746491 10590  3000  7590     10590     5295
##  2 848340 10590  3000  7590     10590     5295
##  3 992522 10590  3000  7590     10590     5295
##  4 543044 10590  3000  7590     10590     5295
##  5 928716 10590  3000  7590     10590     5295
##  6 633585 10590  3000  7590     10590     5295
##  7 706339 10590  3000  7590     10590     5295
##  8 515572 10590  3000  7590     10590     5295
##  9  71582 10590  3000  7590     10590     5295
## 10 701404 10590  3000  7590     10590     5295
## # ... with 135,514 more rows</code></pre>
<ul>
<li>방법2</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter5.html#cb22-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="chapter5.html#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">acost=</span>edc_sba, <span class="at">bcost=</span>edc_insur_brdn_amt)</span>
<span id="cb22-3"><a href="chapter5.html#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="chapter5.html#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="chapter5.html#cb22-5" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20_new <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href="chapter5.html#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href="chapter5.html#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">totalcost=</span><span class="fu">sum</span>(<span class="fu">c</span>(acost,bcost)), <span class="at">meancost=</span><span class="fu">mean</span>(<span class="fu">c</span>(acost,bcost)))</span>
<span id="cb22-8"><a href="chapter5.html#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="chapter5.html#cb22-9" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 135,524 x 6
## # Rowwise: 
##        id tcost acost bcost totalcost meancost
##     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 746491 10590  3000  7590     10590     5295
##  2 848340 10590  3000  7590     10590     5295
##  3 992522 10590  3000  7590     10590     5295
##  4 543044 10590  3000  7590     10590     5295
##  5 928716 10590  3000  7590     10590     5295
##  6 633585 10590  3000  7590     10590     5295
##  7 706339 10590  3000  7590     10590     5295
##  8 515572 10590  3000  7590     10590     5295
##  9  71582 10590  3000  7590     10590     5295
## 10 701404 10590  3000  7590     10590     5295
## # ... with 135,514 more rows</code></pre>
<p>R에서 사칙연산 또는 내장함수를 이용할 때 결측값(missing value)은 주의해서 처리해야 한다. 예를 들어 acost와 bcost의 합을 구할 때, 만약 acost에 결측값이 존재한다면 사칙연산 결과는 결측값으로 나온다. 즉, 사칙연산은 결측값이 하나라도 존재한다면 연산이 되지 않고 결측으로 처리를 하게 된다. 또한, 내장함수 SUM을 이용하는 경우에도 결측값으로 결과를 제시한다. 다만 “na.rm=T”와 같은 옵션을 통해 합을 구하게 되면 결측값은 없는 값으로 처리하고 존재하는 값으로 연산을 하게 된다. 다음의 예제를 살펴보자.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter5.html#cb24-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="chapter5.html#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt, <span class="at">bcost=</span>edc_insur_brdn_amt) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="chapter5.html#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">acost=</span><span class="cn">NA</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="chapter5.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span>
<span id="cb24-5"><a href="chapter5.html#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="chapter5.html#cb24-6" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20_new <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="chapter5.html#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="chapter5.html#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">totalcost1=</span>acost<span class="sc">+</span>bcost,</span>
<span id="cb24-9"><a href="chapter5.html#cb24-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">totalcost2=</span><span class="fu">sum</span>(<span class="fu">c</span>(acost,bcost)),</span>
<span id="cb24-10"><a href="chapter5.html#cb24-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">totalcost3=</span><span class="fu">sum</span>(<span class="fu">c</span>(acost,bcost),<span class="at">na.rm=</span>T),</span>
<span id="cb24-11"><a href="chapter5.html#cb24-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">meancost1=</span><span class="fu">mean</span>(<span class="fu">c</span>(acost,bcost)),</span>
<span id="cb24-12"><a href="chapter5.html#cb24-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">meancost2=</span><span class="fu">mean</span>(<span class="fu">c</span>(acost,bcost),<span class="at">na.rm=</span>T))</span>
<span id="cb24-13"><a href="chapter5.html#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="chapter5.html#cb24-14" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 6 x 9
## # Rowwise: 
##       id tcost bcost acost totalcost1 totalcost2 totalcost3 meancost1 meancost2
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 746491 10590  7590 NA            NA         NA       7590        NA      7590
## 2 848340 10590  7590 NA            NA         NA       7590        NA      7590
## 3 992522 10590  7590 NA            NA         NA       7590        NA      7590
## 4 543044 10590  7590 NA            NA         NA       7590        NA      7590
## 5 928716 10590  7590 NA            NA         NA       7590        NA      7590
## 6 633585 10590  7590 NA            NA         NA       7590        NA      7590</code></pre>
<p>acost 변수를 모두 결측 처리하고 bcost와의 합 또는 평균을 구할때, 결측값이 어떤 영향을 주는지 살펴보았다. 이때 “na.rm=T” 옵션은 합계와 평균을 구하는 함수에 적용이 가능하지만 모든 함수에 적용이 가능한 것은 아니기 때문에 결측값이 있는 경우에 어떻게 처리해야 할 지 고민해봐야 한다.</p>
</div>
<div id="round-함수-이용" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Round 함수 이용</h2>
<p>주어진 값을 반올림해야 하는 경우 사용하는 함수는 round이다.</p>
<pre><code>round(x, digits = n)</code></pre>
<p>’round(x, digits = n)’는 x를 소수점 n+1 자리에서 반올림하여 소수점 n번째 자리까지 반환한다. 만일 digits의 값이 음수이면 10<sup>n-1</sup> 자리에서 반올림하여 0을 10<sup>n</sup> 자리까지 만들어 반환한다. digits 인자의 기본값은 0으로 지정되어 있다.</p>
<p>R의 반올림 함수는 국제표준(IEEE 754:2008, ISO/IEC/IEEE 60559:2011)을 따르고 있기 때문에 Excel의 반올림 함수와는 다른 결과를 보여준다. 예를 들면 Excel에서 <code>=round(2.5, 0)</code>을 하면 3이 나오지만, R에서는 <code>round(2.5, digits = 0)</code>을 하게 되면 2가 나오게 된다. 이는 위 부동소숫점 실수와 관련된 국제표준에서 반올림의 모드로 제시된 5가지 방법 중 <strong>짝수로 반올림(round to nearest, ties to even)</strong>를 기본모드로 선택했기 때문이다. ‘짝수로 반올림’ 모드는 ‘은행원의 반올림,’ ’오사오입’이라고도 불리우는 방법으로 반올림으로 인한 오류의 기대값을 0으로 하는 효과가 있다. 이 방법은 가장 가까운 표현 가능한 숫자로 반올림하되, 원래 값이 가능한 숫자 두 개의 중간에 걸쳐 있으면 둘 중 가수부의 마지막 자리가 짝수인 값으로 반올림한다. 예를 들면 52.5는 52, 51.5는 52로 반올림한다.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chapter5.html#cb27-1" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="chapter5.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">tcost=</span>ed_rc_tot_amt) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="chapter5.html#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>()</span>
<span id="cb27-4"><a href="chapter5.html#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="chapter5.html#cb27-5" aria-hidden="true" tabindex="-1"></a>t20_new <span class="ot">&lt;-</span> t20_new <span class="sc">%&gt;%</span> </span>
<span id="cb27-6"><a href="chapter5.html#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">round1=</span><span class="fu">round</span>(tcost,<span class="dv">1</span>),</span>
<span id="cb27-7"><a href="chapter5.html#cb27-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">round2=</span><span class="fu">round</span>(tcost),</span>
<span id="cb27-8"><a href="chapter5.html#cb27-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">round3=</span><span class="fu">round</span>(tcost,<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb27-9"><a href="chapter5.html#cb27-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">round4=</span><span class="fu">round</span>(tcost,<span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb27-10"><a href="chapter5.html#cb27-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">round5=</span><span class="fu">round</span>(tcost,<span class="sc">-</span><span class="dv">3</span>))</span>
<span id="cb27-11"><a href="chapter5.html#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="chapter5.html#cb27-12" aria-hidden="true" tabindex="-1"></a>t20_new</span></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##        id   tcost  round1  round2  round3  round4  round5
##     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1  914987  712040  712040  712040  712040  712000  712000
## 2 2046765  459330  459330  459330  459330  459300  459000
## 3  549602 1418280 1418280 1418280 1418280 1418300 1418000
## 4   84322 1112430 1112430 1112430 1112430 1112400 1112000
## 5  978767  899320  899320  899320  899320  899300  899000
## 6  418137  261240  261240  261240  261240  261200  261000</code></pre>
</div>
<div id="순자를-문자로-문자를-숫자로" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> 순자를 문자로, 문자를 숫자로</h2>
<p>데이터를 분석하다 보면 숫자를 문자로 변환하거나, 문자 변수로 읽혀진 숫자를 다시 숫자 변수로 변환해야 하는 경우가 빈번히 일어난다. 숫자형 변수를 문자형 변수로 변환할 때 사용하는 함수는 as.character()이며 문자형 변수를 숫자형 변수로 변환하는 함수는 as.numeric()이다. 사용법은 다음과 같다.</p>
<pre><code>새로운 변수 = as.character(숫자 변수)
새로운 변수 = as.numeric(문자 변수)</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapter5.html#cb30-1" aria-hidden="true" tabindex="-1"></a>t60_new <span class="ot">&lt;-</span> t60 <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="chapter5.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">id=</span>rn_indi, <span class="at">drugcost=</span>amt) <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="chapter5.html#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tail</span>()</span>
<span id="cb30-4"><a href="chapter5.html#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="chapter5.html#cb30-5" aria-hidden="true" tabindex="-1"></a>t60_new <span class="ot">&lt;-</span> t60_new <span class="sc">%&gt;%</span> </span>
<span id="cb30-6"><a href="chapter5.html#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">drug_char=</span><span class="fu">as.character</span>(drugcost),</span>
<span id="cb30-7"><a href="chapter5.html#cb30-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">drug_numeric=</span><span class="fu">as.numeric</span>(drug_char))</span>
<span id="cb30-8"><a href="chapter5.html#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="chapter5.html#cb30-9" aria-hidden="true" tabindex="-1"></a>t60_new</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##        id drugcost drug_char drug_numeric
##     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;
## 1  481697    13140 13140            13140
## 2  138307      563 563                563
## 3  836057     1589 1589              1589
## 4  668438    53580 53580            53580
## 5 2082311      168 168                168
## 6    9866    14160 14160            14160</code></pre>
<p>데이터셋의 정렬상태를 살펴보면, 문자형(<chr>)은 왼쪽 정렬, 숫자형(<dbl>)은 오른쪽 정렬되었음을 알 수 있다.</p>
</div>
<div id="substr-함수-이용" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> substr 함수 이용</h2>
<p>기존에 존재하는 값에서 특정한 위치의 값을 추출할 때 substr 함수를 이용하며 사용법은 다음과 같다.</p>
<pre><code>새로운 변수 = substr(변수, 추출시작 위치, 추출끝 위치);</code></pre>
<p>예를 들어 변수 a가 ‘abcd1234’ 값을 가지고 있다고 할 때, 처음부터 3개의 값을 뽑으면 ‘abc’가 되고 이때 함수는 [a3 = substr(a,1,3)]와 같은 형태로 작성하면 된다. 만약 4번째부터 2개의 값만 뽑고 싶으면 [a4 = substr(a,4,5)]와 같은 형태로 작성하면 되고 이때 결과는 ‘d1’이 될 것이다.
t40 데이터셋에서 데이터 개체수는 10, 변수는 요양급여상병기호(mcex_sick_sym)만 남겨서 t40_substr 데이터셋을 생성하고, 이때 substr 함수를 이용하여 처음부터 3자리 값만 뽑아서 sick3 변수를 만들어 보도록 하자. 프로그램은 다음과 같다.</p>
<ul>
<li>방법1</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter5.html#cb33-1" aria-hidden="true" tabindex="-1"></a>t40_substr <span class="ot">&lt;-</span> t40[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span>
<span id="cb33-2"><a href="chapter5.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="chapter5.html#cb33-3" aria-hidden="true" tabindex="-1"></a>t40_substr<span class="sc">$</span>sick3 <span class="ot">&lt;-</span> <span class="fu">substr</span>(t40_substr<span class="sc">$</span>mcex_sick_sym,<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb33-4"><a href="chapter5.html#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="chapter5.html#cb33-5" aria-hidden="true" tabindex="-1"></a>t40_substr</span></code></pre></div>
<pre><code>## # A tibble: 10 x 9
##    rn_indi rn_key        mdcare_strt_dt form_cd mcex_sick_sym detail_tmsg_subj_~
##      &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt;             
##  1  596535 2002120187152 20021202       03      J209          &lt;NA&gt;              
##  2  615374 2002121012274 20021202       03      J209          &lt;NA&gt;              
##  3 1005547 2002120808216 20021202       03      J209          &lt;NA&gt;              
##  4  226594 2002120381612 20021202       03      J209          &lt;NA&gt;              
##  5  204930 2002120790182 20021202       03      J209          &lt;NA&gt;              
##  6  798943 2002040446183 20020401       03      J209          &lt;NA&gt;              
##  7  920001 2002040802704 20020401       03      J209          &lt;NA&gt;              
##  8  986222 2002120261569 20021203       03      J209          &lt;NA&gt;              
##  9  633007 2002120734373 20021203       03      J209          &lt;NA&gt;              
## 10  886653 2002120868879 20021203       03      J209          &lt;NA&gt;              
## # ... with 3 more variables: sick_clsf_type &lt;chr&gt;, std_yyyy &lt;chr&gt;, sick3 &lt;chr&gt;</code></pre>
<ul>
<li>방법2</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="chapter5.html#cb35-1" aria-hidden="true" tabindex="-1"></a>t40_substr <span class="ot">&lt;-</span> t40 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="cb35-2"><a href="chapter5.html#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="chapter5.html#cb35-3" aria-hidden="true" tabindex="-1"></a>t40_substr <span class="ot">&lt;-</span> t40_substr <span class="sc">%&gt;%</span> </span>
<span id="cb35-4"><a href="chapter5.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sick3=</span><span class="fu">substr</span>(mcex_sick_sym,<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb35-5"><a href="chapter5.html#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="chapter5.html#cb35-6" aria-hidden="true" tabindex="-1"></a>t40_substr</span></code></pre></div>
<pre><code>## # A tibble: 10 x 9
##    rn_indi rn_key        mdcare_strt_dt form_cd mcex_sick_sym detail_tmsg_subj_~
##      &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;          &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt;             
##  1  596535 2002120187152 20021202       03      J209          &lt;NA&gt;              
##  2  615374 2002121012274 20021202       03      J209          &lt;NA&gt;              
##  3 1005547 2002120808216 20021202       03      J209          &lt;NA&gt;              
##  4  226594 2002120381612 20021202       03      J209          &lt;NA&gt;              
##  5  204930 2002120790182 20021202       03      J209          &lt;NA&gt;              
##  6  798943 2002040446183 20020401       03      J209          &lt;NA&gt;              
##  7  920001 2002040802704 20020401       03      J209          &lt;NA&gt;              
##  8  986222 2002120261569 20021203       03      J209          &lt;NA&gt;              
##  9  633007 2002120734373 20021203       03      J209          &lt;NA&gt;              
## 10  886653 2002120868879 20021203       03      J209          &lt;NA&gt;              
## # ... with 3 more variables: sick_clsf_type &lt;chr&gt;, std_yyyy &lt;chr&gt;, sick3 &lt;chr&gt;</code></pre>
</div>
<div id="날짜-함수-이용" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> 날짜 함수 이용</h2>
<p>R에서 날짜 변수를 만드는 함수는 ’as.Date()’가 있다. 하지만 여러가지 면에서 불편한 점이 있기 때문에 날짜 함수를 전문으로 다루는 패키지인 ’lubridate’를 같이 이용하기로 한다.</p>
<p>먼저 내장 함수인 as.Date() 사용법은 다음과 같다.</p>
<pre><code>날짜 변수 = as.Date(변수, 지정양식)</code></pre>
<p>다음 예제를 통해 살펴보자. t20 데이터셋에서 요양개시일자(mdcare_strt_dt) 변수만 남겨서(10개의 개체만 남김) 새로운 날짜 변수를 생성해보자. 또한 요양개시일자를 이용하여 date1 변수를 생성하여 t20_date 데이터셋을 생성시켜보자. 프로그램은 다음과 같다.</p>
<ul>
<li>방법1</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="chapter5.html#cb38-1" aria-hidden="true" tabindex="-1"></a>t20_date <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">start=</span>t20<span class="sc">$</span>mdcare_strt_dt[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb38-2"><a href="chapter5.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="chapter5.html#cb38-3" aria-hidden="true" tabindex="-1"></a>t20_date<span class="sc">$</span>date1 <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(t20_date<span class="sc">$</span>start, <span class="st">&quot;%y%m%d&quot;</span>)</span>
<span id="cb38-4"><a href="chapter5.html#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="chapter5.html#cb38-5" aria-hidden="true" tabindex="-1"></a>t20_date</span></code></pre></div>
<pre><code>##       start      date1
## 1  20021016 2020-02-10
## 2  20020712 2020-02-07
## 3  20020923 2020-02-09
## 4  20020930 2020-02-09
## 5  20020826 2020-02-08
## 6  20020528 2020-02-05
## 7  20020415 2020-02-04
## 8  20020708 2020-02-07
## 9  20020715 2020-02-07
## 10 20020715 2020-02-07</code></pre>
<ul>
<li>방법2</li>
</ul>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="chapter5.html#cb40-1" aria-hidden="true" tabindex="-1"></a>t20_date <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="chapter5.html#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">as.numeric</span>(<span class="fu">rownames</span>(t20))<span class="sc">&lt;=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="chapter5.html#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">start=</span>mdcare_strt_dt)</span>
<span id="cb40-4"><a href="chapter5.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-5"><a href="chapter5.html#cb40-5" aria-hidden="true" tabindex="-1"></a>t20_date <span class="ot">&lt;-</span> t20_date <span class="sc">%&gt;%</span> </span>
<span id="cb40-6"><a href="chapter5.html#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date1=</span><span class="fu">as.Date</span>(start, <span class="st">&quot;%y%m%d&quot;</span>))</span>
<span id="cb40-7"><a href="chapter5.html#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="chapter5.html#cb40-8" aria-hidden="true" tabindex="-1"></a>t20_date</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    start    date1     
##    &lt;chr&gt;    &lt;date&gt;    
##  1 20021016 2020-02-10
##  2 20020712 2020-02-07
##  3 20020923 2020-02-09
##  4 20020930 2020-02-09
##  5 20020826 2020-02-08
##  6 20020528 2020-02-05
##  7 20020415 2020-02-04
##  8 20020708 2020-02-07
##  9 20020715 2020-02-07
## 10 20020715 2020-02-07</code></pre>
<p>예제에 쓰인 요양개시일자는 ’년도월일’의 형태로 기록이 되어있다.as.Date() 함수는 이러한 형태의 자료를 직접적으로 인식을 하지 못하기 때문에 “%y%m%d”와 같이 년/월/일을 인식가능하게 옵션을 조절해야 한다. as.Date()함수는 “%Y-%m-%d,” “%Y/%m/%d”를 기본으로 인식하게 되어 있다. 즉, 2021-12-31 이나 2021/12/31과 같은 형태의 날짜자료는 자동으로 인식가능하다.</p>
<p>다음은 ‘lubridate’ 패키지의 함수를 이용하여 날짜 변수를 생성해보자.</p>
<ul>
<li>방법1</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="chapter5.html#cb42-1" aria-hidden="true" tabindex="-1"></a>t20_date <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">start=</span>t20<span class="sc">$</span>mdcare_strt_dt[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb42-2"><a href="chapter5.html#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="chapter5.html#cb42-3" aria-hidden="true" tabindex="-1"></a>t20_date<span class="sc">$</span>date1 <span class="ot">&lt;-</span> <span class="fu">ymd</span>(t20_date<span class="sc">$</span>start)</span>
<span id="cb42-4"><a href="chapter5.html#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="chapter5.html#cb42-5" aria-hidden="true" tabindex="-1"></a>t20_date</span></code></pre></div>
<pre><code>##       start      date1
## 1  20021016 2002-10-16
## 2  20020712 2002-07-12
## 3  20020923 2002-09-23
## 4  20020930 2002-09-30
## 5  20020826 2002-08-26
## 6  20020528 2002-05-28
## 7  20020415 2002-04-15
## 8  20020708 2002-07-08
## 9  20020715 2002-07-15
## 10 20020715 2002-07-15</code></pre>
<ul>
<li>방법2</li>
</ul>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="chapter5.html#cb44-1" aria-hidden="true" tabindex="-1"></a>t20_date <span class="ot">&lt;-</span> t20 <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="chapter5.html#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>()<span class="sc">&lt;=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="chapter5.html#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">start=</span>mdcare_strt_dt)</span>
<span id="cb44-4"><a href="chapter5.html#cb44-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-5"><a href="chapter5.html#cb44-5" aria-hidden="true" tabindex="-1"></a>t20_date <span class="ot">&lt;-</span> t20_date <span class="sc">%&gt;%</span> </span>
<span id="cb44-6"><a href="chapter5.html#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date1=</span><span class="fu">ymd</span>(start))</span>
<span id="cb44-7"><a href="chapter5.html#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="chapter5.html#cb44-8" aria-hidden="true" tabindex="-1"></a>t20_date</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    start    date1     
##    &lt;chr&gt;    &lt;date&gt;    
##  1 20021016 2002-10-16
##  2 20020712 2002-07-12
##  3 20020923 2002-09-23
##  4 20020930 2002-09-30
##  5 20020826 2002-08-26
##  6 20020528 2002-05-28
##  7 20020415 2002-04-15
##  8 20020708 2002-07-08
##  9 20020715 2002-07-15
## 10 20020715 2002-07-15</code></pre>
<p>예제에 쓰인 요양개시일자는 ‘년도월일’의 형태로 기록이 되어있다. ’lubridate’ 패키지의 ymd는 이러한 형태의 자료를 자동적으로 인식하여 날짜 변수로 변환한다. 이외에도 mdy()나 dmy()와 같이 년, 월, 일이 뒤섞여 있거나 ’January 10th 2020’와 같이 영문자로 표기한 형태도 자연스럽게 인식한다.</p>
<pre><code>year(): 연도 추출
month(): 달 추출
day(): 날짜 추출
week(): 그 해의 몇 번째 주인지 추출
wday(,label=T): 요일 추출(1~7까지 순서대로 일요일~토요일)
yday(): 그 해의 몇 번째 날인지 추출
semester(), quarter(): 상하반기와 4분기 추출</code></pre>
<p>이 외에도 ‘lubridate’ 패키지에는 날짜와 관련된 유용한 함수가 많이 있으며 <a href="https://cran.r-project.org/web/packages/lubridate/lubridate.pdf">https://cran.r-project.org/web/packages/lubridate/lubridate.pdf</a>를 참조하기 바란다.</p>
</div>
<div id="누적합-함수-이용" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> 누적합 함수 이용</h2>
<p>R에서 누적합은 간단하게 cumsum() 함수를 이용한다.
t30 데이터셋에서 금액(amt) 변수만 남겨서(10개의 개체만 남김) 금액의 누적값(ccost)을 생성하고 t30_cumul 데이터셋에 저장해보자. 프로그램은 다음과 같다.</p>
<ul>
<li>방법1</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="chapter5.html#cb47-1" aria-hidden="true" tabindex="-1"></a>t30_cumul <span class="ot">&lt;-</span> t30 <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="chapter5.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href="chapter5.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(amt)</span>
<span id="cb47-4"><a href="chapter5.html#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="chapter5.html#cb47-5" aria-hidden="true" tabindex="-1"></a>t30_cumul <span class="ot">&lt;-</span> t30_cumul <span class="sc">%&gt;%</span> </span>
<span id="cb47-6"><a href="chapter5.html#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ccost=</span><span class="fu">cumsum</span>(amt))</span>
<span id="cb47-7"><a href="chapter5.html#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="chapter5.html#cb47-8" aria-hidden="true" tabindex="-1"></a>t30_cumul</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##      amt ccost
##    &lt;dbl&gt; &lt;dbl&gt;
##  1   940   940
##  2   940  1880
##  3  1570  3450
##  4  2210  5660
##  5  4100  9760
##  6   300 10060
##  7   290 10350
##  8   780 11130
##  9   780 11910
## 10  2630 14540</code></pre>
<ul>
<li>방법2</li>
</ul>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="chapter5.html#cb49-1" aria-hidden="true" tabindex="-1"></a>t30_cumul <span class="ot">&lt;-</span> t30 <span class="sc">%&gt;%</span> </span>
<span id="cb49-2"><a href="chapter5.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(,<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="chapter5.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(amt) <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href="chapter5.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ccost=</span><span class="fu">cumsum</span>(amt))</span>
<span id="cb49-5"><a href="chapter5.html#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="chapter5.html#cb49-6" aria-hidden="true" tabindex="-1"></a>t30_cumul</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##      amt ccost
##    &lt;dbl&gt; &lt;dbl&gt;
##  1   940   940
##  2   940  1880
##  3  1570  3450
##  4  2210  5660
##  5  4100  9760
##  6   300 10060
##  7   290 10350
##  8   780 11130
##  9   780 11910
## 10  2630 14540</code></pre>
<p>방법1과 방법2는 같은결과를 보여준다. 즉, Pipe 라인을 통해 분산된 명령어를 하나의 라인으로 묶어 연산이 가능하다.</p>
</div>
<div id="lag과-diff-함수-이용" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> lag과 diff 함수 이용</h2>
<p>lag 함수는 관측값을 특정 시점 뒤로 밀어주는 역할을 하며 diff는 이전 시점 관측값과의 차이값을 계산한다. 사용법은 다음과 같다.</p>
<pre><code>새로운 변수명 = lag(기존 변수, k=n);
새로운 변수명 = diff(기존 변수, lag=n);</code></pre>
<p>여기서 n은 숫자값으로 지정하며 계산 단위의 크기를 지정한다. 예를 들어 lag의 경우 k=1이면 한 시점 뒤로 밀어주며 k=2의 경우 두 시점 뒤로 밀어준다. 마찬가지로 diff의 경우 lag=1이면 한 시점 이전과의 차이값을 만들어주며, lag=2의 경우 두 시점 이전과의 차이값을 만들어준다. 이때 한 시점을 결정하는 1은 쓰지 않아도 무방하다. 즉, lag(기존 변수) 또는 diff(기존 변수)는 한 시점 이전과의 연산 결과를 보여준다.</p>
<p>위에서 생성한 t30_cumul 데이터셋을 이용하여 lag과 diff 함수를 이용하여 새로운 변수를 생성시켜보자. 이때 ccost 변수를 한 시점 뒤로 이동한 변수를 lagcost로 두고, 다시 ccost 변수를 이용하여 한 시점 이전과의 차이를 difcost로 두자. 또한 ccost와 lagcost와의 차이값을 difcost2로 생성하고 t30_cumul2로 저장하자. 여기서 difcost2 변수는 ccost와 ccost를 한 시점 뒤로 미룬 lagcost와의 차이이기 때문에 결론적으로 difcost와 같아져야 한다. 이를 위한 프로그램은 다음과 같다.</p>
<ul>
<li>방법1</li>
</ul>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="chapter5.html#cb52-1" aria-hidden="true" tabindex="-1"></a>t30_cumul2 <span class="ot">&lt;-</span> t30_cumul</span>
<span id="cb52-2"><a href="chapter5.html#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="chapter5.html#cb52-3" aria-hidden="true" tabindex="-1"></a>t30_cumul2<span class="sc">$</span>lagcost <span class="ot">&lt;-</span> <span class="fu">lag</span>(t30_cumul<span class="sc">$</span>ccost)</span>
<span id="cb52-4"><a href="chapter5.html#cb52-4" aria-hidden="true" tabindex="-1"></a>t30_cumul2<span class="sc">$</span>difcost <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(t30_cumul<span class="sc">$</span>ccost))</span>
<span id="cb52-5"><a href="chapter5.html#cb52-5" aria-hidden="true" tabindex="-1"></a>t30_cumul2<span class="sc">$</span>difcost2 <span class="ot">&lt;-</span> t30_cumul2<span class="sc">$</span>ccost<span class="sc">-</span>t30_cumul2<span class="sc">$</span>lagcost</span>
<span id="cb52-6"><a href="chapter5.html#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="chapter5.html#cb52-7" aria-hidden="true" tabindex="-1"></a>t30_cumul2</span></code></pre></div>
<pre><code>## # A tibble: 10 x 5
##      amt ccost lagcost difcost difcost2
##    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1   940   940      NA      NA       NA
##  2   940  1880     940     940      940
##  3  1570  3450    1880    1570     1570
##  4  2210  5660    3450    2210     2210
##  5  4100  9760    5660    4100     4100
##  6   300 10060    9760     300      300
##  7   290 10350   10060     290      290
##  8   780 11130   10350     780      780
##  9   780 11910   11130     780      780
## 10  2630 14540   11910    2630     2630</code></pre>
<ul>
<li>방법2</li>
</ul>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="chapter5.html#cb54-1" aria-hidden="true" tabindex="-1"></a>t30_cumul2 <span class="ot">&lt;-</span> t30_cumul <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="chapter5.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lagcost=</span><span class="fu">lag</span>(ccost),</span>
<span id="cb54-3"><a href="chapter5.html#cb54-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">difcost=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="fu">diff</span>(ccost)),</span>
<span id="cb54-4"><a href="chapter5.html#cb54-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">difcost2=</span>ccost<span class="sc">-</span>lagcost)</span>
<span id="cb54-5"><a href="chapter5.html#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="chapter5.html#cb54-6" aria-hidden="true" tabindex="-1"></a>t30_cumul2</span></code></pre></div>
<pre><code>## # A tibble: 10 x 5
##      amt ccost lagcost difcost difcost2
##    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1   940   940      NA      NA       NA
##  2   940  1880     940     940      940
##  3  1570  3450    1880    1570     1570
##  4  2210  5660    3450    2210     2210
##  5  4100  9760    5660    4100     4100
##  6   300 10060    9760     300      300
##  7   290 10350   10060     290      290
##  8   780 11130   10350     780      780
##  9   780 11910   11130     780      780
## 10  2630 14540   11910    2630     2630</code></pre>
<p>결과를 살펴보면 lagcost는 ccost 값을 한 시점씩 뒤로 이동시킨 형태를 보여준다. 첫 번째 관측값을 뒤로 밀었기 때문에 lagcost의 첫 번째 값은 결측값으로 나타나며, 제일 마지막 값은 밀려서 삭제 된 형태로 나타난다. difcost 또한 한 시점 이전의 값과의 차이를 나타내기 때문에 첫 번째 행은 결측으로 나타난다. 여기서 difcost는 amt를 누적시킨 ccost 변수를 이용하여 한 시점 이전과의 차이값을 만들었기 때문에 결과 값이 amt와 같다는 것을 알 수 있다. 또한 difcost2는 ccost와 lagcost의 차이값이기 때문에 역시 difcost 또는 amt와 같아짐을 알 수 있다. difcost2의 첫 번째 행은 ccost의 980에서 lagcost의 ‘NA’(결측값)을 뺀 형태이기 때문에 결과가 결측값으로 나타난다.</p>
<!-------- End ------------>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rmanual.pdf", "rmanual.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
