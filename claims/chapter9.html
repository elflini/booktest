<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 데이터셋 합치기 | Insurance Claims Data Analysis with R</title>
  <meta name="description" content="This is a R manual for analysis of insurance claims data" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 데이터셋 합치기 | Insurance Claims Data Analysis with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a R manual for analysis of insurance claims data" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 데이터셋 합치기 | Insurance Claims Data Analysis with R" />
  
  <meta name="twitter:description" content="This is a R manual for analysis of insurance claims data" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2021-12-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter8.html"/>
<link rel="next" href="chapter10.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Claims Data Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> R이란?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#r-설치"><i class="fa fa-check"></i><b>1.1</b> R 설치</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#r-프로그램의-구성"><i class="fa fa-check"></i><b>1.2</b> R 프로그램의 구성</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chapter1.html"><a href="chapter1.html#파일"><i class="fa fa-check"></i><b>1.2.1</b> 파일</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapter1.html"><a href="chapter1.html#편집"><i class="fa fa-check"></i><b>1.2.2</b> 편집</a></li>
<li class="chapter" data-level="1.2.3" data-path="chapter1.html"><a href="chapter1.html#기타"><i class="fa fa-check"></i><b>1.2.3</b> 기타</a></li>
<li class="chapter" data-level="1.2.4" data-path="chapter1.html"><a href="chapter1.html#패키지"><i class="fa fa-check"></i><b>1.2.4</b> 패키지</a></li>
<li class="chapter" data-level="1.2.5" data-path="chapter1.html"><a href="chapter1.html#윈도우즈"><i class="fa fa-check"></i><b>1.2.5</b> 윈도우즈</a></li>
<li class="chapter" data-level="1.2.6" data-path="chapter1.html"><a href="chapter1.html#도움말"><i class="fa fa-check"></i><b>1.2.6</b> 도움말</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#r-프로그램-특징"><i class="fa fa-check"></i><b>1.3</b> R 프로그램 특징</a></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#rstudio-설치"><i class="fa fa-check"></i><b>1.4</b> RStudio 설치</a></li>
<li class="chapter" data-level="1.5" data-path="chapter1.html"><a href="chapter1.html#r-패키지-이용"><i class="fa fa-check"></i><b>1.5</b> R 패키지 이용</a></li>
<li class="chapter" data-level="1.6" data-path="chapter1.html"><a href="chapter1.html#r-패키지-관리"><i class="fa fa-check"></i><b>1.6</b> R 패키지 관리</a></li>
<li class="chapter" data-level="1.7" data-path="chapter1.html"><a href="chapter1.html#산술-연산자"><i class="fa fa-check"></i><b>1.7</b> 산술 연산자</a></li>
<li class="chapter" data-level="1.8" data-path="chapter1.html"><a href="chapter1.html#논리-연산자와-비교-연산자"><i class="fa fa-check"></i><b>1.8</b> 논리 연산자와 비교 연산자</a></li>
<li class="chapter" data-level="1.9" data-path="chapter1.html"><a href="chapter1.html#기초-산술-함수"><i class="fa fa-check"></i><b>1.9</b> 기초 산술 함수</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="chapter1.html"><a href="chapter1.html#통계-함수"><i class="fa fa-check"></i><b>1.9.1</b> 통계 함수</a></li>
<li class="chapter" data-level="1.9.2" data-path="chapter1.html"><a href="chapter1.html#로그-및-지수-함수-logarithms-and-exponentials"><i class="fa fa-check"></i><b>1.9.2</b> 로그 및 지수 함수 (Logarithms and Exponentials)</a></li>
<li class="chapter" data-level="1.9.3" data-path="chapter1.html"><a href="chapter1.html#삼각-함수"><i class="fa fa-check"></i><b>1.9.3</b> 삼각 함수</a></li>
<li class="chapter" data-level="1.9.4" data-path="chapter1.html"><a href="chapter1.html#기타-수학-함수"><i class="fa fa-check"></i><b>1.9.4</b> 기타 수학 함수</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="chapter1.html"><a href="chapter1.html#객체의-명명과-할당"><i class="fa fa-check"></i><b>1.10</b> 객체의 명명과 할당</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="chapter1.html"><a href="chapter1.html#객체변수-만들기"><i class="fa fa-check"></i><b>1.10.1</b> 객체(변수) 만들기</a></li>
<li class="chapter" data-level="1.10.2" data-path="chapter1.html"><a href="chapter1.html#객체-목록-보기"><i class="fa fa-check"></i><b>1.10.2</b> 객체 목록 보기</a></li>
<li class="chapter" data-level="1.10.3" data-path="chapter1.html"><a href="chapter1.html#객체변수-지우기"><i class="fa fa-check"></i><b>1.10.3</b> 객체(변수) 지우기</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="chapter1.html"><a href="chapter1.html#데이터-유형"><i class="fa fa-check"></i><b>1.11</b> 데이터 유형</a>
<ul>
<li class="chapter" data-level="1.11.1" data-path="chapter1.html"><a href="chapter1.html#데이터의-기본-유형"><i class="fa fa-check"></i><b>1.11.1</b> 데이터의 기본 유형</a></li>
<li class="chapter" data-level="1.11.2" data-path="chapter1.html"><a href="chapter1.html#특수-데이터"><i class="fa fa-check"></i><b>1.11.2</b> 특수 데이터</a></li>
<li class="chapter" data-level="1.11.3" data-path="chapter1.html"><a href="chapter1.html#데이터-유형-함수"><i class="fa fa-check"></i><b>1.11.3</b> 데이터 유형 함수</a></li>
<li class="chapter" data-level="1.11.4" data-path="chapter1.html"><a href="chapter1.html#데이터-유형-변경"><i class="fa fa-check"></i><b>1.11.4</b> 데이터 유형 변경</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="chapter1.html"><a href="chapter1.html#자료의-입력"><i class="fa fa-check"></i><b>1.12</b> 자료의 입력</a>
<ul>
<li class="chapter" data-level="1.12.1" data-path="chapter1.html"><a href="chapter1.html#read.table"><i class="fa fa-check"></i><b>1.12.1</b> read.table()</a></li>
<li class="chapter" data-level="1.12.2" data-path="chapter1.html"><a href="chapter1.html#read.csv"><i class="fa fa-check"></i><b>1.12.2</b> read.csv()</a></li>
<li class="chapter" data-level="1.12.3" data-path="chapter1.html"><a href="chapter1.html#read.delim"><i class="fa fa-check"></i><b>1.12.3</b> read.delim()</a></li>
<li class="chapter" data-level="1.12.4" data-path="chapter1.html"><a href="chapter1.html#read_excel"><i class="fa fa-check"></i><b>1.12.4</b> read_excel()</a></li>
</ul></li>
<li class="chapter" data-level="1.13" data-path="chapter1.html"><a href="chapter1.html#자료의-출력"><i class="fa fa-check"></i><b>1.13</b> 자료의 출력</a>
<ul>
<li class="chapter" data-level="1.13.1" data-path="chapter1.html"><a href="chapter1.html#write.table"><i class="fa fa-check"></i><b>1.13.1</b> write.table()</a></li>
<li class="chapter" data-level="1.13.2" data-path="chapter1.html"><a href="chapter1.html#write_xlsx"><i class="fa fa-check"></i><b>1.13.2</b> write_xlsx()</a></li>
</ul></li>
<li class="chapter" data-level="1.14" data-path="chapter1.html"><a href="chapter1.html#r-manual"><i class="fa fa-check"></i><b>1.14</b> R Manual</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Tidyverse Package</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#filter"><i class="fa fa-check"></i><b>2.1</b> filter()</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#filter---연속형-변수-처리"><i class="fa fa-check"></i><b>2.1.1</b> filter() - 연속형 변수 처리</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#filter---이산형-변수-처리"><i class="fa fa-check"></i><b>2.1.2</b> filter() - 이산형 변수 처리</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter2.html"><a href="chapter2.html#filter---문자형-변수-처리"><i class="fa fa-check"></i><b>2.1.3</b> filter() - 문자형 변수 처리</a></li>
<li class="chapter" data-level="2.1.4" data-path="chapter2.html"><a href="chapter2.html#filter---일반적인-변수-처리"><i class="fa fa-check"></i><b>2.1.4</b> filter() - 일반적인 변수 처리</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#pipe"><i class="fa fa-check"></i><b>2.2</b> Pipe : %&gt;%</a></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#select"><i class="fa fa-check"></i><b>2.3</b> select()</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter2.html"><a href="chapter2.html#select---선택"><i class="fa fa-check"></i><b>2.3.1</b> select() - 선택</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter2.html"><a href="chapter2.html#select---제거"><i class="fa fa-check"></i><b>2.3.2</b> select() - 제거</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapter2.html"><a href="chapter2.html#filter-와-select-혼합"><i class="fa fa-check"></i><b>2.3.3</b> filter() 와 select() 혼합</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#group_by와-summarise"><i class="fa fa-check"></i><b>2.4</b> group_by()와 summarise()</a></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#arrange"><i class="fa fa-check"></i><b>2.5</b> arrange()</a></li>
<li class="chapter" data-level="2.6" data-path="chapter2.html"><a href="chapter2.html#결측값-처리"><i class="fa fa-check"></i><b>2.6</b> 결측값 처리</a></li>
<li class="chapter" data-level="2.7" data-path="chapter2.html"><a href="chapter2.html#mutate"><i class="fa fa-check"></i><b>2.7</b> mutate()</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> 공단표본코호트 데모자료</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#자격-db---자격-및-보험료-테이블"><i class="fa fa-check"></i><b>3.1</b> 자격 DB - 자격 및 보험료 테이블</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#사망-db---출생-및-사망테이블"><i class="fa fa-check"></i><b>3.2</b> 사망 DB - 출생 및 사망테이블</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#요양기관-db"><i class="fa fa-check"></i><b>3.3</b> 요양기관 DB</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#진료-db---20-테이블"><i class="fa fa-check"></i><b>3.4</b> 진료 DB - 20 테이블</a></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#진료-db---30-테이블"><i class="fa fa-check"></i><b>3.5</b> 진료 DB - 30 테이블</a></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#진료-db---40-테이블"><i class="fa fa-check"></i><b>3.6</b> 진료 DB - 40 테이블</a></li>
<li class="chapter" data-level="3.7" data-path="chapter3.html"><a href="chapter3.html#진료-db---60-테이블"><i class="fa fa-check"></i><b>3.7</b> 진료 DB - 60 테이블</a></li>
<li class="chapter" data-level="3.8" data-path="chapter3.html"><a href="chapter3.html#작업공간-저장-및-불러오기"><i class="fa fa-check"></i><b>3.8</b> 작업공간 저장 및 불러오기</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="chapter3.html"><a href="chapter3.html#객체-목록-확인"><i class="fa fa-check"></i><b>3.8.1</b> 객체 목록 확인</a></li>
<li class="chapter" data-level="3.8.2" data-path="chapter3.html"><a href="chapter3.html#작업공간-저장"><i class="fa fa-check"></i><b>3.8.2</b> 작업공간 저장</a></li>
<li class="chapter" data-level="3.8.3" data-path="chapter3.html"><a href="chapter3.html#작업공간-불러오기"><i class="fa fa-check"></i><b>3.8.3</b> 작업공간 불러오기</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> 데이터프레임의 활용</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#데이터-프레임"><i class="fa fa-check"></i><b>4.1</b> 데이터 프레임</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#데이터-프레임-인덱싱"><i class="fa fa-check"></i><b>4.2</b> 데이터 프레임 인덱싱</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#공단자료와-필요패키지-불러오기"><i class="fa fa-check"></i><b>4.3</b> 공단자료와 필요패키지 불러오기</a></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#특정-변수만-남기기"><i class="fa fa-check"></i><b>4.4</b> 특정 변수만 남기기</a></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#특정-변수-지우기"><i class="fa fa-check"></i><b>4.5</b> 특정 변수 지우기</a></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#변수-이름-바꾸기"><i class="fa fa-check"></i><b>4.6</b> 변수 이름 바꾸기</a></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#특정-위치의-관찰값-추출"><i class="fa fa-check"></i><b>4.7</b> 특정 위치의 관찰값 추출</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> 새로운 변수 생성</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#기존-변수의-값-바꾸기"><i class="fa fa-check"></i><b>5.1</b> 기존 변수의 값 바꾸기</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#새로운-변수-만들기"><i class="fa fa-check"></i><b>5.2</b> 새로운 변수 만들기</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#round-함수-이용"><i class="fa fa-check"></i><b>5.3</b> Round 함수 이용</a></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#순자를-문자로-문자를-숫자로"><i class="fa fa-check"></i><b>5.4</b> 순자를 문자로, 문자를 숫자로</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#substr-함수-이용"><i class="fa fa-check"></i><b>5.5</b> substr 함수 이용</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#날짜-함수-이용"><i class="fa fa-check"></i><b>5.6</b> 날짜 함수 이용</a></li>
<li class="chapter" data-level="5.7" data-path="chapter5.html"><a href="chapter5.html#누적합-함수-이용"><i class="fa fa-check"></i><b>5.7</b> 누적합 함수 이용</a></li>
<li class="chapter" data-level="5.8" data-path="chapter5.html"><a href="chapter5.html#lag과-diff-함수-이용"><i class="fa fa-check"></i><b>5.8</b> lag과 diff 함수 이용</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> 조건문</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#특정-조건을-만족하는-관찰값-선택하기"><i class="fa fa-check"></i><b>6.1</b> 특정 조건을 만족하는 관찰값 선택하기</a></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#특정-조건을-만족하는-관찰값-삭제하기"><i class="fa fa-check"></i><b>6.2</b> 특정 조건을 만족하는 관찰값 삭제하기</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#조건문-활용하기"><i class="fa fa-check"></i><b>6.3</b> 조건문 활용하기</a></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#조건문-일반화하기"><i class="fa fa-check"></i><b>6.4</b> 조건문 일반화하기</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> 자료의 정렬</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#하나의-변수에-의한-관찰값의-정렬"><i class="fa fa-check"></i><b>7.1</b> 하나의 변수에 의한 관찰값의 정렬</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#여러-개의-변수에-의한-관찰값의-정렬"><i class="fa fa-check"></i><b>7.2</b> 여러 개의 변수에 의한 관찰값의 정렬</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#처음과-마지막-개체-추출하기"><i class="fa fa-check"></i><b>7.3</b> 처음과 마지막 개체 추출하기</a></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#동일한-관찰값의-제거"><i class="fa fa-check"></i><b>7.4</b> 동일한 관찰값의 제거</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> 반복문</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#조건에-의한-반복"><i class="fa fa-check"></i><b>8.1</b> 조건에 의한 반복</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#개체에-의한-반복"><i class="fa fa-check"></i><b>8.2</b> 개체에 의한 반복</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#다중-반복"><i class="fa fa-check"></i><b>8.3</b> 다중 반복</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> 데이터셋 합치기</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#변수-기준-개체-통합"><i class="fa fa-check"></i><b>9.1</b> 변수 기준 개체 통합</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#개체-기준-변수-통합"><i class="fa fa-check"></i><b>9.2</b> 개체 기준 변수 통합</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter10.html"><a href="chapter10.html"><i class="fa fa-check"></i><b>10</b> Tidyverse 활용</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter10.html"><a href="chapter10.html#tidyverse-dplyr-기본-구조"><i class="fa fa-check"></i><b>10.1</b> Tidyverse (dplyr) 기본 구조</a></li>
<li class="chapter" data-level="10.2" data-path="chapter10.html"><a href="chapter10.html#단일-데이터셋-다루기"><i class="fa fa-check"></i><b>10.2</b> 단일 데이터셋 다루기</a></li>
<li class="chapter" data-level="10.3" data-path="chapter10.html"><a href="chapter10.html#여러-데이터셋-다루기"><i class="fa fa-check"></i><b>10.3</b> 여러 데이터셋 다루기</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter11.html"><a href="chapter11.html"><i class="fa fa-check"></i><b>11</b> 사용자 정의 함수</a></li>
<li class="chapter" data-level="12" data-path="chapter12.html"><a href="chapter12.html"><i class="fa fa-check"></i><b>12</b> 예제1</a>
<ul>
<li class="chapter" data-level="12.1" data-path="chapter12.html"><a href="chapter12.html#연구-설계"><i class="fa fa-check"></i><b>12.1</b> 연구 설계</a></li>
<li class="chapter" data-level="12.2" data-path="chapter12.html"><a href="chapter12.html#프로그램"><i class="fa fa-check"></i><b>12.2</b> 프로그램</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Insurance Claims Data Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter9" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> 데이터셋 합치기</h1>
<p>공단자료와 필요 패키지 불러오기</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter9.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;claim.RData&quot;</span>)</span>
<span id="cb1-2"><a href="chapter9.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="chapter9.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># 날짜 함수</span></span></code></pre></div>
<p>하나의 데이터셋을 여러 데이터셋으로 분리하는 것과는 반대로 분리된 데이터셋을 하나의 데이터셋으로 통합할 때는 기본적으로 rbind(), cbind(), merge() 문이나 bind_rows(), bind_cols()등 다양한 함수를 이용할 수 있다. 예를 들어, a병원과 b병운 환자로부터 동일한 설문조사를 시행했다고 하면, 같은 항목으로 이루어진 두 개의 데이터셋이 생성된다. 이때 두 데이터셋을 통합할 때는 rbind() 또는 bind_rows() 등을 이용한다. 이와같은 명령문은 기본적으로 동일한 변수를 가진 여러 데이터셋을 이용하여 하나의 데이터셋을 생성함으로써 개체 수가 증가되는 효과를 가지게 된다. 반면, merge() 등은 개체 수의 증가가 아니라 변수의 수가 증가 되는 효과를 가지게 된다. 예를 들어 a병원에서 설문조사를 수행한 후 추가적인 항목을 조사하는 경우 먼저 시행한 조사와 후에 시행된 조사로 이루어진 두 개의 데이터셋을 통합하는 경우 merge() 문을 사용한다. 즉, 기본적으로 동일한 개체로 이루어진 여러 데이터셋을 이용하여 하나의 데이터셋을 생성함으로써 변수의 수가 증가되는 효과를 가지게 된다.</p>
<div id="변수-기준-개체-통합" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> 변수 기준 개체 통합</h2>
<p>변수를 기준으로 개체수를 늘리는 데이터셋 통합은 여러가지 방법이 가능하나 여기서는 bind_rows() 함수를 기준으로 살펴보자.</p>
<pre><code>통합 데이터 &lt;- bind_rows(데이터셋1, 데이터셋2)</code></pre>
<p>t20 데이터셋에서 개체만 다르고 변수는 같은 두 개의 데이터셋을 생성해보자. 첫 번째 데이터셋은 t20_set1으로 t20 데이터셋으로부터 개체는 처음부터 5개의 개체만 남기고 변수는 개인고유번호(rn_indi), 요양개시일자(mdcare_strt_dt), 주상병(sick_sym1)이다. 두 번째 데이터셋은 t20_set2로 t20 데이터셋으로부터 6번 개체부터 10번 개체까지만 남기고 변수는 동일하게 개인고유번호, 요양개시일자, 주상병만 남겨보자. 이를 위한 프로그램은 다음과 같다.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter9.html#cb3-1" aria-hidden="true" tabindex="-1"></a>t20_set1 <span class="ot">&lt;-</span> t20[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>,<span class="st">&quot;mdcare_strt_dt&quot;</span>,<span class="st">&quot;sick_sym1&quot;</span>)]</span>
<span id="cb3-2"><a href="chapter9.html#cb3-2" aria-hidden="true" tabindex="-1"></a>t20_set2 <span class="ot">&lt;-</span> t20[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>,<span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>,<span class="st">&quot;mdcare_strt_dt&quot;</span>,<span class="st">&quot;sick_sym1&quot;</span>)]</span>
<span id="cb3-3"><a href="chapter9.html#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="chapter9.html#cb3-4" aria-hidden="true" tabindex="-1"></a>t20_set1; t20_set2</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   rn_indi mdcare_strt_dt sick_sym1
##     &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    
## 1  746491 20021016       L218     
## 2  848340 20020712       B351     
## 3  992522 20020923       N_       
## 4  543044 20020930       J304     
## 5  928716 20020826       J311</code></pre>
<pre><code>## # A tibble: 5 x 3
##   rn_indi mdcare_strt_dt sick_sym1
##     &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    
## 1  633585 20020528       L02      
## 2  706339 20020415       L239     
## 3  515572 20020708       N_       
## 4   71582 20020715       L24      
## 5  701404 20020715       N_</code></pre>
<p>두 데이터셋을 합쳐서 t20_set_ex1 데이터셋을 생성해보자. 이를 위한 프로그램은 다음과 같다.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="chapter9.html#cb6-1" aria-hidden="true" tabindex="-1"></a>t20_set_ex1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(t20_set1, t20_set2)</span>
<span id="cb6-2"><a href="chapter9.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="chapter9.html#cb6-3" aria-hidden="true" tabindex="-1"></a>t20_set_ex1</span></code></pre></div>
<pre><code>## # A tibble: 10 x 3
##    rn_indi mdcare_strt_dt sick_sym1
##      &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    
##  1  746491 20021016       L218     
##  2  848340 20020712       B351     
##  3  992522 20020923       N_       
##  4  543044 20020930       J304     
##  5  928716 20020826       J311     
##  6  633585 20020528       L02      
##  7  706339 20020415       L239     
##  8  515572 20020708       N_       
##  9   71582 20020715       L24      
## 10  701404 20020715       N_</code></pre>
<p>이번에는 중복되는 개체가 있는 경우를 살펴보자. 이를 위해 t20_set3를 t20 데이터셋으로부터 4번 개체부터 10번 개체까지만 남기고 변수는 동일하게 개인고유번호, 요양개시일자, 주상병만 남겨보자. t20_set1과 t20_set3은 t20 데이터셋의 4번과 5번 개체가 중복되는 형태이다. 두 데이터셋을 합쳐서 t20_set_ex2 데이터셋을 생성해보자. 이를 위한 프로그램은 다음과 같다.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="chapter9.html#cb8-1" aria-hidden="true" tabindex="-1"></a>t20_set3 <span class="ot">&lt;-</span> t20[<span class="dv">4</span><span class="sc">:</span><span class="dv">10</span>,<span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>,<span class="st">&quot;mdcare_strt_dt&quot;</span>,<span class="st">&quot;sick_sym1&quot;</span>)]</span>
<span id="cb8-2"><a href="chapter9.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="chapter9.html#cb8-3" aria-hidden="true" tabindex="-1"></a>t20_set_ex2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(t20_set1, t20_set3)</span>
<span id="cb8-4"><a href="chapter9.html#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="chapter9.html#cb8-5" aria-hidden="true" tabindex="-1"></a>t20_set_ex2</span></code></pre></div>
<pre><code>## # A tibble: 12 x 3
##    rn_indi mdcare_strt_dt sick_sym1
##      &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    
##  1  746491 20021016       L218     
##  2  848340 20020712       B351     
##  3  992522 20020923       N_       
##  4  543044 20020930       J304     
##  5  928716 20020826       J311     
##  6  543044 20020930       J304     
##  7  928716 20020826       J311     
##  8  633585 20020528       L02      
##  9  706339 20020415       L239     
## 10  515572 20020708       N_       
## 11   71582 20020715       L24      
## 12  701404 20020715       N_</code></pre>
<p>결과를 살펴보면 t20_set1이 위에 위치하고 t20_set3이 아래에 위치한다. 이때 t20_set1의 4번과 5번 개체는 t20_set3의 1번과 2번 개체와 같으며, 두 데이터셋을 합친 경우에 중복을 제거하지 않고 그대로 합쳐진다는 것을 알 수 있다. 따라서 중복되는 개체가 발생할 여지가 있는 경우에는 추후 분석에서 중복을 제거하고 사용하는 것이 좋다.</p>
<p>다음으로 변수가 다르게 구성되는 경우를 살펴보자. 이를 위해 t20_set4를 생성해보자. 이때 개체는 t20의 6번부터 10번 개체로 구성되며, 변수는 개인고유번호, 요양개시일자, 심결요양급여비용총액(ed_rc_tot_amt)으로 구성된다. t20_set1과 t20_set4를 합쳐서 t20_set_ex3 데이터셋을 생성해보자. 이를 위한 프로그램은 다음과 같다.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapter9.html#cb10-1" aria-hidden="true" tabindex="-1"></a>t20_set4 <span class="ot">&lt;-</span> t20[<span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>,<span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>,<span class="st">&quot;mdcare_strt_dt&quot;</span>,<span class="st">&quot;ed_rc_tot_amt&quot;</span>)]</span>
<span id="cb10-2"><a href="chapter9.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="chapter9.html#cb10-3" aria-hidden="true" tabindex="-1"></a>t20_set_ex3 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(t20_set1, t20_set4)</span>
<span id="cb10-4"><a href="chapter9.html#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="chapter9.html#cb10-5" aria-hidden="true" tabindex="-1"></a>t20_set_ex3</span></code></pre></div>
<pre><code>## # A tibble: 10 x 4
##    rn_indi mdcare_strt_dt sick_sym1 ed_rc_tot_amt
##      &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;             &lt;dbl&gt;
##  1  746491 20021016       L218                 NA
##  2  848340 20020712       B351                 NA
##  3  992522 20020923       N_                   NA
##  4  543044 20020930       J304                 NA
##  5  928716 20020826       J311                 NA
##  6  633585 20020528       &lt;NA&gt;              10590
##  7  706339 20020415       &lt;NA&gt;              10590
##  8  515572 20020708       &lt;NA&gt;              10590
##  9   71582 20020715       &lt;NA&gt;              10590
## 10  701404 20020715       &lt;NA&gt;              10590</code></pre>
<p>결과를 살펴보면 t20_set1에는 ed_rc_tot_amt 변수가 존재하지 않고 t20_set4에만 존재하기 때문에 두 데이터셋을 통합시키면 t20_set1에 존재하는 개체들은 ed_rc_tot_amt가 모두 결측값(NA)으로 나타난다. 마찬가지로 sick_sym1은 t20_set1에는 존재하고 t20_set4에는 존재하지 않기 때문에 t20_set4 개체는 결측값으로 나타난다.</p>
</div>
<div id="개체-기준-변수-통합" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> 개체 기준 변수 통합</h2>
<p>bind_rows() 문은 서로 다른 개체로 이루어진 데이터셋을 통합할 때 사용하며 merge() 문은 기본적으로 동일한 개체로 이루어지고 서로 다른 변수를 가지고 있을 때 사용한다. 따라서 bind_rows() 문은 데이터셋이 결합되는 형태가 나열되는 데이터셋의 순서에 따라 위/아래로 통합이 되며 merge() 문은 개체를 기준으로 좌/우로 통합되어 변수가 추가되는 형태로 데이터셋이 합쳐진다. merge() 문을 사용하는 방법은 다음과 같다.</p>
<pre><code>통합 데이터 &lt;- merge(데이터1, 데이터2, by=&quot;기준변수&quot;)
통합 데이터 &lt;- merge(데이터1, 데이터2, by.x=&quot;기준변수&quot;, by.y=&quot;기준변수&quot;)</code></pre>
<p>다음과 같은 두 개의 데이터셋을 생성해보자. t20 데이터셋에서 개체는 같고 변수만 다른 두 개의 데이터셋을 생성해보자. 첫 번째 데이터셋은 t20_merge1으로 t20 데이터셋으로부터 개체는 처음부터 5개의 개체만 남기고 변수는 개인고유번호(rn_indi), 요양개시일자(mdcare_strt_dt), 주상병(sick_sym1)이다. 두 번째 데이터셋은 t20_merge2로 t20_merge1과 마찬가지로 t20 데이터셋으로부터 1번 개체부터 5번 개체까지만 남기고 변수는 동일하게 개인고유번호, 요양개시일자와 새로운 변수 심결요양급여비용총액(ed_rc_tot_amt)을 남기자. 이를 위한 프로그램은 다음과 같다.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter9.html#cb13-1" aria-hidden="true" tabindex="-1"></a>t20_merge1 <span class="ot">&lt;-</span> t20[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>,<span class="st">&quot;mdcare_strt_dt&quot;</span>, <span class="st">&quot;sick_sym1&quot;</span>)]</span>
<span id="cb13-2"><a href="chapter9.html#cb13-2" aria-hidden="true" tabindex="-1"></a>t20_merge2 <span class="ot">&lt;-</span> t20[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>,<span class="st">&quot;mdcare_strt_dt&quot;</span>, <span class="st">&quot;ed_rc_tot_amt&quot;</span>)]</span>
<span id="cb13-3"><a href="chapter9.html#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="chapter9.html#cb13-4" aria-hidden="true" tabindex="-1"></a>t20_merge1; t20_merge2</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##   rn_indi mdcare_strt_dt sick_sym1
##     &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;    
## 1  746491 20021016       L218     
## 2  848340 20020712       B351     
## 3  992522 20020923       N_       
## 4  543044 20020930       J304     
## 5  928716 20020826       J311</code></pre>
<pre><code>## # A tibble: 5 x 3
##   rn_indi mdcare_strt_dt ed_rc_tot_amt
##     &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt;
## 1  746491 20021016               10590
## 2  848340 20020712               10590
## 3  992522 20020923               10590
## 4  543044 20020930               10590
## 5  928716 20020826               10590</code></pre>
<p>두 데이터셋을 merge 문을 이용하여 통합시켜보자. 프로그램은 다음과 같다.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter9.html#cb16-1" aria-hidden="true" tabindex="-1"></a>t20_merge_ex1 <span class="ot">&lt;-</span> <span class="fu">merge</span>(t20_merge1, t20_merge2)</span>
<span id="cb16-2"><a href="chapter9.html#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="chapter9.html#cb16-3" aria-hidden="true" tabindex="-1"></a>t20_merge_ex1</span></code></pre></div>
<pre><code>##   rn_indi mdcare_strt_dt sick_sym1 ed_rc_tot_amt
## 1  543044       20020930      J304         10590
## 2  746491       20021016      L218         10590
## 3  848340       20020712      B351         10590
## 4  928716       20020826      J311         10590
## 5  992522       20020923        N_         10590</code></pre>
<p>통합된 두 데이터셋 모두 동일한 기준변수 즉, 일련번호와 요양개시일자를 가지고 있으며 통합된 데이터셋에서도 일련번호와 요양개시일자에 맞게 데이터셋이 통합된 것을 알 수 있다. 예제에서 두 데이터셋에 동일하게 존재하는 rn_indi와 mdcare_strt_dt의 경우 두 기준 변수의 값이 완전히 동일하기 때문에 기준변수는 하나씩만 남기고 데이터셋이 형성되는 것을 알 수 있다.</p>
<p>다음은 t20_merge2와 동일한 변수를 가지면서 개체는 t20 데이터셋에서 3번부터 7번까지 개체를 불러와서 t20_merge3으로 저장하고 t20_merge1과 결합하여 t20_merge_ex2 데이터셋을 생성해보자. 프로그램은 다음과 같다.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter9.html#cb18-1" aria-hidden="true" tabindex="-1"></a>t20_merge3 <span class="ot">&lt;-</span> t20[<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>,<span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>,<span class="st">&quot;mdcare_strt_dt&quot;</span>, <span class="st">&quot;ed_rc_tot_amt&quot;</span>)]</span>
<span id="cb18-2"><a href="chapter9.html#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="chapter9.html#cb18-3" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(t20_merge1, t20_merge3)</span>
<span id="cb18-4"><a href="chapter9.html#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="chapter9.html#cb18-5" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2</span></code></pre></div>
<pre><code>##   rn_indi mdcare_strt_dt sick_sym1 ed_rc_tot_amt
## 1  543044       20020930      J304         10590
## 2  928716       20020826      J311         10590
## 3  992522       20020923        N_         10590</code></pre>
<p>결과를 살펴보면, rn_indi와 mdcare_strt_dt가 동일하게 매칭되는 개체만 통합하는것을 알 수 있다. 매칭이 되지 않는 모든 개체를 표현하려면 “all=T” 옵션을 사용한다.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapter9.html#cb20-1" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(t20_merge1, t20_merge3, <span class="at">all=</span>T)</span>
<span id="cb20-2"><a href="chapter9.html#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="chapter9.html#cb20-3" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2</span></code></pre></div>
<pre><code>##   rn_indi mdcare_strt_dt sick_sym1 ed_rc_tot_amt
## 1  543044       20020930      J304         10590
## 2  633585       20020528      &lt;NA&gt;         10590
## 3  706339       20020415      &lt;NA&gt;         10590
## 4  746491       20021016      L218            NA
## 5  848340       20020712      B351            NA
## 6  928716       20020826      J311         10590
## 7  992522       20020923        N_         10590</code></pre>
<p>다음은 기준변수를 적용하는 방법을 알아보자. 기준 변수를 직접 적용할때는 by=“기준변수” 옵션을 이용하거나, by.x=기준변수, by.y=기준변수 처럼 두 데이터에서 사용되는 기준 변수의 이름이 다른 경우에는 각각 지정이 가능하다. rn_indi를 기준으로 두 데이터셋을 통합해보자.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter9.html#cb22-1" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(t20_merge1, t20_merge3, <span class="at">by=</span><span class="st">&quot;rn_indi&quot;</span>)</span>
<span id="cb22-2"><a href="chapter9.html#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="chapter9.html#cb22-3" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2</span></code></pre></div>
<pre><code>##   rn_indi mdcare_strt_dt.x sick_sym1 mdcare_strt_dt.y ed_rc_tot_amt
## 1  543044         20020930      J304         20020930         10590
## 2  928716         20020826      J311         20020826         10590
## 3  992522         20020923        N_         20020923         10590</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter9.html#cb24-1" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(t20_merge1, t20_merge3, <span class="at">by=</span><span class="st">&quot;rn_indi&quot;</span>, <span class="at">all=</span>T)</span>
<span id="cb24-2"><a href="chapter9.html#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="chapter9.html#cb24-3" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2</span></code></pre></div>
<pre><code>##   rn_indi mdcare_strt_dt.x sick_sym1 mdcare_strt_dt.y ed_rc_tot_amt
## 1  543044         20020930      J304         20020930         10590
## 2  633585             &lt;NA&gt;      &lt;NA&gt;         20020528         10590
## 3  706339             &lt;NA&gt;      &lt;NA&gt;         20020415         10590
## 4  746491         20021016      L218             &lt;NA&gt;            NA
## 5  848340         20020712      B351             &lt;NA&gt;            NA
## 6  928716         20020826      J311         20020826         10590
## 7  992522         20020923        N_         20020923         10590</code></pre>
<p>결과를 살펴보면, 기준 변수를 하나만 주었을때, 나머지 모든 변수들이 겹치지 않게 표현되고 있다. mdcare_strt_dt의 경우 두 데이터셋에 모두 존재하기 때문에 mdcare_strt_dt.x와 mdcare_strt_dt.y 이름으로 각각 데이터셋에 존재한다. 이번에는 rn_indi와 mdcare_strt_dt를 기준으로 데이터셋을 통합해보자.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapter9.html#cb26-1" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(t20_merge1, t20_merge3, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>,<span class="st">&quot;mdcare_strt_dt&quot;</span>))</span>
<span id="cb26-2"><a href="chapter9.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="chapter9.html#cb26-3" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2</span></code></pre></div>
<pre><code>##   rn_indi mdcare_strt_dt sick_sym1 ed_rc_tot_amt
## 1  543044       20020930      J304         10590
## 2  928716       20020826      J311         10590
## 3  992522       20020923        N_         10590</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chapter9.html#cb28-1" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(t20_merge1, t20_merge3, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;rn_indi&quot;</span>,<span class="st">&quot;mdcare_strt_dt&quot;</span>), <span class="at">all=</span>T)</span>
<span id="cb28-2"><a href="chapter9.html#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="chapter9.html#cb28-3" aria-hidden="true" tabindex="-1"></a>t20_merge_ex2</span></code></pre></div>
<pre><code>##   rn_indi mdcare_strt_dt sick_sym1 ed_rc_tot_amt
## 1  543044       20020930      J304         10590
## 2  633585       20020528      &lt;NA&gt;         10590
## 3  706339       20020415      &lt;NA&gt;         10590
## 4  746491       20021016      L218            NA
## 5  848340       20020712      B351            NA
## 6  928716       20020826      J311         10590
## 7  992522       20020923        N_         10590</code></pre>
<p>기준변수를 rn_indi와 mdcare_strt_dt를 사용한 경우 rn_indi와 mdcare_strt_dt 변수는 통합되어 하나의 변수로 표현된다.</p>
<p>이번에는 by문을 이용하여 동일한 id 별로 매칭할 경우 만약, 중복된 아이디가 존재한다면 merge 문이 어떤 식으로 작용하는지 다음과 같은 예제를 통해 살펴보자.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapter9.html#cb30-1" aria-hidden="true" tabindex="-1"></a>temp1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">a=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb30-2"><a href="chapter9.html#cb30-2" aria-hidden="true" tabindex="-1"></a>temp2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="at">b=</span><span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb30-3"><a href="chapter9.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="chapter9.html#cb30-4" aria-hidden="true" tabindex="-1"></a>temp1; temp2</span></code></pre></div>
<pre><code>##   group a
## 1     1 1
## 2     2 2
## 3     3 3
## 4     4 4
## 5     5 5</code></pre>
<pre><code>##   group  b
## 1     1  5
## 2     2  6
## 3     2  7
## 4     3  8
## 5     3  9
## 6     4 10</code></pre>
<p>데이터셋 temp1은 group 변수 값이 (1, 2, 3, 4, 5)로 유일한 값으로 되어 있고 temp2는 group 변수 값이 (1, 2, 3, 4) 이지만 2가 2개 3이 두 개로 중복되어 있다. 이러한 경우 merge과 by 문을 이용하여 group 변수를 기준으로 데이터셋을 통합하면 다음과 같이 나타난다.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter9.html#cb33-1" aria-hidden="true" tabindex="-1"></a>temp_ex1 <span class="ot">&lt;-</span> <span class="fu">merge</span>(temp1, temp2, <span class="at">by=</span><span class="st">&quot;group&quot;</span>)</span>
<span id="cb33-2"><a href="chapter9.html#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="chapter9.html#cb33-3" aria-hidden="true" tabindex="-1"></a>temp_ex1</span></code></pre></div>
<pre><code>##   group a  b
## 1     1 1  5
## 2     2 2  6
## 3     2 2  7
## 4     3 3  8
## 5     3 3  9
## 6     4 4 10</code></pre>
<p>group 값이 중복되는 2와 3의 경우를 살펴보면, 먼저 group=2의 경우 a=2의 값을 가지고 b=6과 7의 값을 가진다. 즉, temp2의 데이터셋에 동일한 id를 가지는 개체가 더 많기 때문에 b 변수의 값은 그대로 가져오면서, a 변수의 경우에는 temp1 데이터셋에서 group=2인 경우 a=2의 값 하나밖에 없기 때문에 새로 들어오는 개체에 대해서는 원래 가진 값을 그대로 복제하여 채워놓게 된다. 다시 말해서, 중복되는 아이디가 있는 경우 개체수는 중복이 많은 데이터셋 개수만큼 복제가 되고 그때 중복되지만 개체수가 적은쪽에 존재하는 변수의 경우에는 자기자신의 값을 복제하여 대체하게 된다. 이번에는 두 데이터셋 모두 group 변수가 중복되지만 유일한 값을 가지지 않는 경우를 살펴보자. 이를 위해 temp3 데이터셋을 다음과 같이 생성한다.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="chapter9.html#cb35-1" aria-hidden="true" tabindex="-1"></a>temp3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">group=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="at">a=</span><span class="dv">5</span><span class="sc">:</span><span class="dv">13</span>)</span>
<span id="cb35-2"><a href="chapter9.html#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="chapter9.html#cb35-3" aria-hidden="true" tabindex="-1"></a>temp3</span></code></pre></div>
<pre><code>##   group  a
## 1     1  5
## 2     2  6
## 3     2  7
## 4     2  8
## 5     3  9
## 6     3 10
## 7     3 11
## 8     3 12
## 9     4 13</code></pre>
<p>temp3 데이터셋을 생성하면 group 변수와 a 변수를 가지며 group 변수는 (1, 2, 3, 4)의 값을 가지지만, 2가 세 번 3이 4번 반복되는 형태를 지닌다. temp3와 temp2를 결합하면 어떻게 적용되는지 살펴보자.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="chapter9.html#cb37-1" aria-hidden="true" tabindex="-1"></a>temp_ex2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(temp2, temp3, <span class="at">by=</span><span class="st">&quot;group&quot;</span>)</span>
<span id="cb37-2"><a href="chapter9.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="chapter9.html#cb37-3" aria-hidden="true" tabindex="-1"></a>temp_ex2</span></code></pre></div>
<pre><code>##    group  b  a
## 1      1  5  5
## 2      2  6  6
## 3      2  6  7
## 4      2  6  8
## 5      2  7  6
## 6      2  7  7
## 7      2  7  8
## 8      3  8  9
## 9      3  8 10
## 10     3  8 11
## 11     3  8 12
## 12     3  9  9
## 13     3  9 10
## 14     3  9 11
## 15     3  9 12
## 16     4 10 13</code></pre>
<p>temp2에는 group 변수의 값이 2가 두 번, temp3는 2가 세 번 반복된다. 통합된 데이터셋에서는 이 둘의 곱인 2가 여섯 번 나타나는 것으로 결합된다. 이때 a 변수는 temp3에 존재하기 때문에 3 개체의 값을 고스란히 그대로 가져온다. 그리고 b 변수는 temp2에 존재하며 반복이 두번이기 때문에 반복해서 채워 넣게 된다. 이러한 현상은 group=3인 경우에 좀 더 확실하게 알 수 있다. group=3인 경우 temp2는 두 번 반복 temp3 는 네 번 반복으로 이루어져있다. 따라서 통합된 데이터셋에서는 group=3인 경우 b=8일때 a는 9, 10, 11, 12가 들어가고, b=9 일때 역시 a는 9, 10, 11, 12가 들어가는 형태로 데이터셋이 구성된다. 따라서 merge문과 by 문을 이용하여 데이터셋을 통합하는 경우에는 중복되는 id가 없는지 잘 살펴야 하며, 그러한 경우 통합 전 혹은 통합 후 어떻게 처리할지에 대해서 조심스럽게 접근하여야 한다.</p>
<!-------- End ------------>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter8.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter10.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rmanual.pdf", "rmanual.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
