<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 조건문 | Insurance Claims Data Analysis with SAS</title>
  <meta name="description" content="This is a SAS manual for analysis of insurance claims data" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 조건문 | Insurance Claims Data Analysis with SAS" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a SAS manual for analysis of insurance claims data" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 조건문 | Insurance Claims Data Analysis with SAS" />
  
  <meta name="twitter:description" content="This is a SAS manual for analysis of insurance claims data" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2021-12-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter4.html"/>
<link rel="next" href="chapter6.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Claims Data Analysis with SAS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> SAS 개요</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#sas"><i class="fa fa-check"></i><b>1.1</b> SAS?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="chapter1.html"><a href="chapter1.html#sas-프로그램-구성"><i class="fa fa-check"></i><b>1.1.1</b> SAS 프로그램 구성</a></li>
<li class="chapter" data-level="1.1.2" data-path="chapter1.html"><a href="chapter1.html#sas-프로그램-장점"><i class="fa fa-check"></i><b>1.1.2</b> SAS 프로그램 장점</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#sas-구성요소"><i class="fa fa-check"></i><b>1.2</b> SAS 구성요소</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chapter1.html"><a href="chapter1.html#sas-화면구성"><i class="fa fa-check"></i><b>1.2.1</b> SAS 화면구성</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapter1.html"><a href="chapter1.html#메뉴"><i class="fa fa-check"></i><b>1.2.2</b> 메뉴</a></li>
<li class="chapter" data-level="1.2.3" data-path="chapter1.html"><a href="chapter1.html#도구-모음"><i class="fa fa-check"></i><b>1.2.3</b> 도구 모음</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#sas-기본-형식"><i class="fa fa-check"></i><b>1.3</b> SAS 기본 형식</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> 자료의 입출력</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#자료의-입력"><i class="fa fa-check"></i><b>2.1</b> 자료의 입력</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#cards문-이용"><i class="fa fa-check"></i><b>2.1.1</b> CARDS문 이용</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#infile-구문-이용"><i class="fa fa-check"></i><b>2.1.2</b> INFILE 구문 이용</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter2.html"><a href="chapter2.html#위저드wizard-이용"><i class="fa fa-check"></i><b>2.1.3</b> 위저드(Wizard) 이용</a></li>
<li class="chapter" data-level="2.1.4" data-path="chapter2.html"><a href="chapter2.html#proc-import-이용"><i class="fa fa-check"></i><b>2.1.4</b> PROC IMPORT 이용</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#자료의-출력"><i class="fa fa-check"></i><b>2.2</b> 자료의 출력</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter2.html"><a href="chapter2.html#위저드-이용"><i class="fa fa-check"></i><b>2.2.1</b> 위저드 이용</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter2.html"><a href="chapter2.html#proc-export-이용"><i class="fa fa-check"></i><b>2.2.2</b> PROC EXPORT 이용</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#공단-표본코호트-자료-불러오기"><i class="fa fa-check"></i><b>2.3</b> 공단 표본코호트 자료 불러오기</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter2.html"><a href="chapter2.html#자격-db-자격-및-보험료테이블"><i class="fa fa-check"></i><b>2.3.1</b> 자격 DB – 자격 및 보험료테이블</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter2.html"><a href="chapter2.html#사망-db-출생-및-사망테이블"><i class="fa fa-check"></i><b>2.3.2</b> 사망 DB – 출생 및 사망테이블</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapter2.html"><a href="chapter2.html#table-20---진료-db-명세서"><i class="fa fa-check"></i><b>2.3.3</b> Table 20 - 진료 DB 명세서</a></li>
<li class="chapter" data-level="2.3.4" data-path="chapter2.html"><a href="chapter2.html#table-30-진료-db-진료내역"><i class="fa fa-check"></i><b>2.3.4</b> Table 30 – 진료 DB 진료내역</a></li>
<li class="chapter" data-level="2.3.5" data-path="chapter2.html"><a href="chapter2.html#table-40-진료-db-상병내역"><i class="fa fa-check"></i><b>2.3.5</b> Table 40 – 진료 DB 상병내역</a></li>
<li class="chapter" data-level="2.3.6" data-path="chapter2.html"><a href="chapter2.html#table-60-진료-db-처방전교부-상세내역"><i class="fa fa-check"></i><b>2.3.6</b> Table 60 – 진료 DB 처방전교부 상세내역</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Set문 활용</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#변수에-이름-붙이기"><i class="fa fa-check"></i><b>3.1</b> 변수에 이름 붙이기</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#특정-변수를-취하여-새로운-데이터셋-만들기"><i class="fa fa-check"></i><b>3.2</b> 특정 변수를 취하여 새로운 데이터셋 만들기</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#특정-변수를-제외하고-새로운-데이터셋-만들기"><i class="fa fa-check"></i><b>3.3</b> 특정 변수를 제외하고 새로운 데이터셋 만들기</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#변수-이름-바꾸기"><i class="fa fa-check"></i><b>3.4</b> 변수 이름 바꾸기</a></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#특정-관찰값부터-시작하여-데이터셋-만들기"><i class="fa fa-check"></i><b>3.5</b> 특정 관찰값부터 시작하여 데이터셋 만들기</a></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#기존-데이터셋으로-다수의-새로운-데이터셋-만들기"><i class="fa fa-check"></i><b>3.6</b> 기존 데이터셋으로 다수의 새로운 데이터셋 만들기</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> 새로운 변수 생성</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#기존-변수의-값-바꾸기"><i class="fa fa-check"></i><b>4.1</b> 기존 변수의 값 바꾸기</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#새로운-변수-만들기"><i class="fa fa-check"></i><b>4.2</b> 새로운 변수 만들기</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#round-함수를-이용한-새로운-변수-만들기"><i class="fa fa-check"></i><b>4.3</b> ROUND 함수를 이용한 새로운 변수 만들기</a></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#숫자-변수를-문자-변수로-문자-변수를-숫자-변수로"><i class="fa fa-check"></i><b>4.4</b> 숫자 변수를 문자 변수로, 문자 변수를 숫자 변수로</a></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#substr-함수를-이용한-새로운-변수-만들기"><i class="fa fa-check"></i><b>4.5</b> Substr 함수를 이용한 새로운 변수 만들기</a></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#날짜-함수를-이용한-새로운-변수-만들기"><i class="fa fa-check"></i><b>4.6</b> 날짜 함수를 이용한 새로운 변수 만들기</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chapter4.html"><a href="chapter4.html#날짜-변수의-생성"><i class="fa fa-check"></i><b>4.6.1</b> 날짜 변수의 생성</a></li>
<li class="chapter" data-level="4.6.2" data-path="chapter4.html"><a href="chapter4.html#날짜-계산"><i class="fa fa-check"></i><b>4.6.2</b> 날짜 계산</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#누적값을-이용한-새로운-변수-만들기"><i class="fa fa-check"></i><b>4.7</b> 누적값을 이용한 새로운 변수 만들기</a></li>
<li class="chapter" data-level="4.8" data-path="chapter4.html"><a href="chapter4.html#lag과-dif를-이용한-새로운-변수-만들기"><i class="fa fa-check"></i><b>4.8</b> Lag과 Dif를 이용한 새로운 변수 만들기</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> 조건문</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#특정-조건을-만족하는-관찰값-선택하기"><i class="fa fa-check"></i><b>5.1</b> 특정 조건을 만족하는 관찰값 선택하기</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#특정-조건을-만족하는-관찰값-삭제하기"><i class="fa fa-check"></i><b>5.2</b> 특정 조건을 만족하는 관찰값 삭제하기</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#조건문-활용하기"><i class="fa fa-check"></i><b>5.3</b> 조건문 활용하기</a></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#조건문-확장하기"><i class="fa fa-check"></i><b>5.4</b> 조건문 확장하기</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#조건문-일반화하기"><i class="fa fa-check"></i><b>5.5</b> 조건문 일반화하기</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#output문을-이용한-여러-데이터셋-생성하기"><i class="fa fa-check"></i><b>5.6</b> Output문을 이용한 여러 데이터셋 생성하기</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> 자료의 정렬</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#하나의-변수에-의한-관찰값의-정렬"><i class="fa fa-check"></i><b>6.1</b> 하나의 변수에 의한 관찰값의 정렬</a></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#여러-개의-변수에-의한-관찰값의-정렬"><i class="fa fa-check"></i><b>6.2</b> 여러 개의 변수에 의한 관찰값의 정렬</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#first-변수와-last-변수-사용하기"><i class="fa fa-check"></i><b>6.3</b> First 변수와 Last 변수 사용하기</a></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#동일한-관찰값의-제거"><i class="fa fa-check"></i><b>6.4</b> 동일한 관찰값의 제거</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> 반복문</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#단순-do문"><i class="fa fa-check"></i><b>7.1</b> 단순 DO문</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#반복-do문"><i class="fa fa-check"></i><b>7.2</b> 반복 DO문</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#다중-반복-do문"><i class="fa fa-check"></i><b>7.3</b> 다중 반복 DO문</a></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#array문의-활용"><i class="fa fa-check"></i><b>7.4</b> ARRAY문의 활용</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> 데이터셋 합치기</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#set문을-이용한-데이터셋-합치기"><i class="fa fa-check"></i><b>8.1</b> SET문을 이용한 데이터셋 합치기</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#merge문을-이용한-데이터셋-합치기"><i class="fa fa-check"></i><b>8.2</b> MERGE문을 이용한 데이터셋 합치기</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> SQL과 MACRO</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#proc-sql-기본-구조"><i class="fa fa-check"></i><b>9.1</b> PROC SQL 기본 구조</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#단일-데이터셋-다루기"><i class="fa fa-check"></i><b>9.2</b> 단일 데이터셋 다루기</a></li>
<li class="chapter" data-level="9.3" data-path="chapter9.html"><a href="chapter9.html#여러-데이터셋-다루기"><i class="fa fa-check"></i><b>9.3</b> 여러 데이터셋 다루기</a></li>
<li class="chapter" data-level="9.4" data-path="chapter9.html"><a href="chapter9.html#macro"><i class="fa fa-check"></i><b>9.4</b> MACRO</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter10.html"><a href="chapter10.html"><i class="fa fa-check"></i><b>10</b> Appendix</a>
<ul>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#arithmetic-functions"><i class="fa fa-check"></i>Arithmetic Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#character-functions"><i class="fa fa-check"></i>Character Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#date-and-time-functions"><i class="fa fa-check"></i>Date and Time Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#mathematical-functions"><i class="fa fa-check"></i>Mathematical Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#noncentrality-functions"><i class="fa fa-check"></i>Noncentrality Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#probability-and-density-functions"><i class="fa fa-check"></i>Probability and Density Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#quantile-functions"><i class="fa fa-check"></i>Quantile Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#sample-statistics-functions"><i class="fa fa-check"></i>Sample Statistics Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#state-and-zip-code-functions"><i class="fa fa-check"></i>State and ZIP Code Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#trigonometric-and-hyperbolic-functions"><i class="fa fa-check"></i>Trigonometric and Hyperbolic Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#truncation-functions"><i class="fa fa-check"></i>Truncation Functions</a></li>
<li class="chapter" data-level="" data-path="chapter10.html"><a href="chapter10.html#variable-information-functions"><i class="fa fa-check"></i>Variable Information Functions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Insurance Claims Data Analysis with SAS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter5" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> 조건문</h1>
<div id="특정-조건을-만족하는-관찰값-선택하기" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> 특정 조건을 만족하는 관찰값 선택하기</h2>
<p>SAS DATA step에서 특정 조건을 만족하는 개체만 선택하거나, 특정 조건을 만족하는 경우 변수의 값을 변경하는 등의 명령을 수행하기 위해서 조건문을 담당하는 IF 문을 사용한다. IF 문은 [IF 조건;], [IF 조건 THEN 명령문;], [IF 조건 THEN 명령문; ELSE 명령문;] 등과 같이 여러 가지 형태로 사용할 수 있으며, 먼저 특정 조건을 만족하는 개체를 선택해서 새로운 데이터셋을 구성하는 IF 문에 대해서 알아보자. 사용 방법은 다음과 같다.</p>
<pre><code>IF 조건문1 AND/OR 조건문2 ...;</code></pre>
<p>하나 이상의 조건문을 나열할 수 있으며, 나열된 조건을 만족하는 개체들만으로 새로운 데이터셋을 구성한다. 이때 IF 문은 개체의 선택에만 관여한다.</p>
<p>BB.T20 데이터셋에서 주상병(SICK_SYM1) 코드를 첫 세자리만 추출하여 주상병이 제2형 당뇨(‘E11’)인 명세서만 추출하여 BB.T20_IF 데이터셋을 생성해보자. 프로그램은 다음과 같다.</p>
<pre><code>data bb.t20_if; set bb.t20;
mainsick=substr(sick_sym1,1,3);
if mainsick=&#39;E11&#39;; run;

proc print data=bb.t20_if (obs=10); var rn_indi rn_key sick_sym1 mainsick;
format rn_key 15.; run;</code></pre>
<p>여기서 IF 다음에 나오는 “MAINSICK=’E11’”이 조건식이며, 3자리 코드로 이루어진 주상병이 ‘E11’인 개체를 의미한다. 이때 변수가 가지는 값이 문자형일 때는 값을 입력할 때 반드시 ‘ ’를 이용하여 입력해야 한다.</p>
<p><img src="fig5/f1.png" /></p>
<p>결과를 살펴보면 총 135,524개의 명세서 중에서 ‘E11’을 주상병으로 갖는 명세서는 2,708개가 선택되어 BB.T20_IF 데이터셋이 구성된다. 조건을 조금 더 확장하여 주상병이 제2형 당뇨(‘E11’)이면서 동시에 내과 진료과목이 기재된 명세서만 추출하여 BB.T20_IF2 데이터셋을 구성해보자. 이때 진료과목코드(MCARE_SUBJ_CD)의 값이 ‘01’인 경우 내과를 의미하며 이를 위한 프로그램은 다음과 같다.</p>
<pre><code>data bb.t20_if2;
set bb.t20;
mainsick=substr(sick_sym1,1,3);
if mainsick=&#39;E11&#39; and mcare_subj_cd=&#39;01&#39;;
run;

proc print data=bb.t20_if2 (obs=10); 
var rn_indi rn_key sick_sym1 mainsick;
format rn_key 15.;
run;</code></pre>
<p>여기서 IF 다음에 나오는 “MAINSICK=’E11’”과 “MCARE_SUBJ_CD=’01’”이 조건식이며, 두 조건이 동시에 일어나야 하므로 “AND”로 연결하였다. 진료과목코드(MCARE_SUBJ_CD)는 숫자 값으로 이루어져 있지만 SAS에서는 문자형 변수로 인식하고 있기 때문에 값을 입력할 때 ‘ ’를 이용하여 값을 줘야 한다.</p>
<p><img src="fig5/f2.png" /></p>
<p>결과를 살펴보면 총 135,524개의 명세서 중에서 ‘E11’이 주상병이면서 진료과목코드 내과인 명세서는 2,174개가 선택되어 BB.T20_IF2 데이터셋이 구성된다.</p>
<p>조건문에서 사용되는 조건 연산자와 논리 연산자는 다음과 같다.</p>
<p><img src="fig5/f3.png" /></p>
<p>A가 B보다 크다를 표현할 때 “A &gt; B” 또는 “A GT B”로 표현해도 무방하다.</p>
</div>
<div id="특정-조건을-만족하는-관찰값-삭제하기" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> 특정 조건을 만족하는 관찰값 삭제하기</h2>
<p>특정 조건을 만족하는 개체에 대해서 명령문을 실행하는 방법은 “IF 조건 THEN 명령문” 형태로 사용하는 것이다. 이번 장에서는 특정 조건을 만족하는 개체를 남기는 방법과 반대로 특정 조건에 해당하는 개체를 삭제하는 방법을 살펴보자. 사용 방법은 다음과 같다.</p>
<pre><code>IF 조건문1 AND/OR 조건문2 ... THEN DELETE;</code></pre>
<p>BB.T40 데이터셋에서 상병분류구분코드(SICK_CLSF_TYPE)를 이용하여 주상병(‘1’)만 남기고 부상병(‘2’) 및 배제된 상병(‘3) 그리고 결측값을 가진 개체를 제거한 다음 BB.T40_DELETE 데이터셋에 저장해보자.</p>
<pre><code>data bb.t40_delete;
set bb.t40;
if sick_clsf_type=&#39;&#39; or sick_clsf_type=&#39;2&#39; or sick_clsf_type=&#39;3&#39; then delete;
run;

proc print data=bb.t40_delete (obs=10); 
var rn_indi mcex_sick_sym sick_clsf_type;
run;</code></pre>
<p>문자형 변수의 결측값을 표기할 때는 ’ ‘로 두면 되고, 숫자형 변수의 결측값은 “.”으로 표기한다. 조건이 여러 개의 값을 가져야 하므로 OR로 조건을 묶어 표시하였다. 이처럼 하나의 변수가 여러 개의 값을 가질 수 있는 조건에서는 IN 명령문을 이용하여 좀 더 편하게 조건을 줄 수 있다. 다음과 같은 명령문을 이용해도 위와 같은 결과를 보여준다.</p>
<pre><code>data bb.t40_delete;
set bb.t40;
if sick_clsf_type in (&#39;&#39; &#39;2&#39; &#39;3&#39;) then delete;
run;</code></pre>
<p><img src="fig5/f4.png" /></p>
<p>결과를 살펴보면 BB.T40의 개체수는 340,596개로 이 중 상병분류구분코드(SICK_CLSF_TYPE) 값이 ’1‘인 101,561개의 개체값을 남기고 모두 삭제되었다는 것을 알 수 있다.</p>
<p>개체를 남기거나 삭제하는 문제는 서로 반대되는 역할을 하므로 상황에 따라 편한 구문을 선택하면 된다. 예를 들어 위의 예제의 경우, 상병분류구분코드(SICK_CLSF_TYPE) 값은 ’1‘, ’2‘, ’3‘, 그리고 결측값이 전부이므로 ’2‘, ’3‘, 결측값을 지우는 문제는 ’1‘을 제외한 나머지를 지우거나, 반대로 ’1‘인 값만 선택하는 문제와 같다. 따라서 아래의 두 구문 중 어느 구문을 사용해도 위와 같은 결과를 보여준다.</p>
<pre><code>IF SICK_CLSF_TYPE ^= ‘1’ THEN DELETE; 
또는
IF SICK_CLSF_TYPE = ‘1’;</code></pre>
</div>
<div id="조건문-활용하기" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> 조건문 활용하기</h2>
<p>IF ~ THEN DELETE 명령문은 IF ~ THEN 실행문의 특수한 형태이다. 이번 장에서는 일반적인 형태의 IF ~ THEN 문을 살펴보자. 사용 방법은 다음과 같다.</p>
<pre><code>IF 조건문1 AND/OR 조건문2 ... THEN 실행문;</code></pre>
<p>여기서 여러 연산자가 혼합해서 사용되는 경우에 연산 순서는 괄호( ) ⇨ 산술연산자 ⇨ 비교연산자 ⇨ 논리 연산자 순으로 인식되며, 같은 연산자 내에서는 먼저 지정된 연산부터 실행한다. 다음과 같은 프로그램을 살펴보자.</p>
<pre><code>data bb.t30_ifthen;
set bb.t30;
date = input(mdcare_strt_dt, yymmdd8.);
if mdy(5,25,2015) &lt;= date le mdy(5,30,2015) and mcexp_type_cd in (&#39;1&#39; &#39;3&#39;);
if mcexp_type_cd in (&#39;3&#39;) then drugcost=uprc*dd1_mqty_freq*tot_mcnt;
if drugcost=. then drugcost=0;
run;

proc print data=bb.t30_ifthen (firstobs=360);
var rn_indi date mcexp_type_cd uprc dd1_mqty_freq tot_mcnt drugcost;
format date yymmdd10.;
run;</code></pre>
<p>위의 프로그램은 BB.T30 데이터셋으로부터 요양개시일자(MDCARE_STRT_DT)를 날짜 변수 DATE로 만들고 요양개시일자가 2015년 5월 25일부터 2015년 5월 30일까지이면서 동시에 진료비구분코드(MCEXP_TYPE_CD)가 기본진료료(’1‘) 또는 약품비(’3‘)인 개체만 남겨서 BB.T30_IFTHEN 데이터셋을 구성한다. 이때 진료비구분코드(MCEXP_TYPE_CD)가 약품비(’3’)라면, DRUGCOST 변수를 생성하라는 조건문이 사용되었으며 DRUGCOST는 단가(UPRC)<em>1일투여량 또는 횟수(DD1_MQTY_FREQ)</em>총투여일수 또는 실시횟수(TOT_MCNT) 형태로 산출된다. DRUGCOST는 조건이 진료비구분코드(MCEXP_TYPE_CD)가 약품비(’3’) 일 때만 산출되므로 약품비(‘3’)가 아닌 다른 진료비구분코드가 있다면(여기서는 기본진료료(‘1’)) 결측값으로 결과가 나타난다. DRUGCOST는 수치형 변수로 생성되기 때문에 결측값은 “.”으로 인식되며, 따라서 마지막 조건문은 DRUGCOST가 결측값을 가지고 있다면 0으로 대체하라는 명령문이다.</p>
<p><img src="fig5/f5.png" /></p>
<p>결과를 살펴보면 요양개시일자(MDCARE_STRT_DT)가 2015년 5월 25일부터 2015년 5월 30일 사이에 있으면서 진료비구분코드(MCEXP_TYPE_CD)가 기본진료료(’1‘) 또는 약품비(’3‘)인 개체만 남아있으며, 진료비구분코드가 약품비인 경우에 DRUGCOST 값이 존재하고 기본진료료인 경우에는 DRUGCOST가 0인 것을 알 수 있다.</p>
</div>
<div id="조건문-확장하기" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> 조건문 확장하기</h2>
<p>IF ~ THEN 문은 조건이 참일 때 명령문을 실행하는 조건문이다. 즉, 조건이 참일 때만 시행하고 그 외의 조건에 대해서는 시행을 하지 않기 때문에 결측값으로 결과를 내어준다. 따라서 그 외에 조건에 대해서도 특정 명령문을 시행하게 하려면 새로운 IF ~ THEN 문을 시행해야 한다. 만약 조건이 참인 경우와 그 외의 경우로 나누어질 때 IF ~ THEN ~; ELSE ~ 구문으로 쉽게 사용 가능하며, 이러한 형태는 앞으로 이어질 여러 조건에서 사용되는 조건문의 기본 형태가 된다. IF ~ THEN ~; ELSE ~ 구문의 사용법의 다음과 같다.</p>
<pre><code>IF 조건문1 AND/OR 조건문2 ... THEN 실행문1;
ELSE 실행문2;</code></pre>
<p>여기서 ELSE 다음의 실행문2는 IF 다음의 “조건문1 AND/OR 조건문2 …”이 거짓인 경우에 시행된다. 즉, “조건문1 AND/OR 조건문2 …”을 만족하는 개체 이외의 나머지 모든 개채에 한해서 실행문2가 시행된다.</p>
<p>위의 IF ~ THEN 문의 예제를 다시 살펴보자. 위의 예제 프로그램에서 진료비구분코드(MCEXP_TYPE_CD)가 약품비(’3’)라면, DRUGCOST 변수를 생성하라는 조건문이 사용되었으며 조건을 만족하지 않는 개체는 DRUGCOST가 결측값으로 생성된다. 따라서 결측값을 0으로 대체하기 위해 새로운 IF ~ THEN 문을 지정하였다. 여기서는 이러한 두 단계의 IF ~ THEN 문을 IF ~ THEN ~; ELSE ~; 문을 이용하여 만들어 본다. 프로그램은 다음과 같다.</p>
<pre><code>data bb.t30_ifthenelse;
set bb.t30;
date = input(mdcare_strt_dt, yymmdd8.);
if mdy(5,25,2015) &lt;= date le mdy(5,30,2015) and mcexp_type_cd in (&#39;1&#39; &#39;3&#39;);
if mcexp_type_cd in (&#39;3&#39;) then drugcost=uprc*dd1_mqty_freq*tot_mcnt;
else drugcost=0;
run;

proc print data=bb.t30_ifthenelse (firstobs=360);
var rn_indi date mcexp_type_cd uprc dd1_mqty_freq tot_mcnt drugcost;
format date yymmdd10.;
run;</code></pre>
<p><img src="fig5/f6.png" /></p>
<p>IF ~ THEN ~; ELSE ~ 구문은 모든 개체를 두 개의 서로 보완적인 조건으로 모든 개체를 나누어서 명령문을 시행하기 때문에 성공(=“1”)과 실패(=“0”)의 개념을 지닌 변수를 생성할 때 유용하다. 즉, 특정 조건을 만족하면 1의 값을 갖고 조건을 만족하지 않으면 0의 값을 갖는 형태의 새로운 변수를 생성할 때 사용하기 좋다. BB.T20 데이터셋에서 주상병(SICK_SYM1) 코드 3자리 값이 ‘L02’ 이면 1, 아니면 0의 값을 갖는 새로운 변수 SICK을 생성하여 BB.T20_IFELSE에 저장해보자. 프로그램은 다음과 같다.</p>
<pre><code>data bb.t20_ifelse; set bb.t20;
if substr(sick_sym1,1,3)=&#39;L02&#39; then sick=1; else sick=0;
sick2=(substr(sick_sym1,1,3)=&#39;L02&#39;);
run;

proc print data=bb.t20_ifelse (obs=10); var rn_indi sick_sym1 sick sick2;
run;</code></pre>
<p><img src="fig5/f7.png" /></p>
<p>결과를 살펴보면 주상병(SICK_SYM1)의 3자리 값이 ‘L02’인 개체는 SICK 변수가 1의 값을 가지고 나머지 다른 개체는 0의 값을 가진 것을 알 수 있다. 이처럼 간단하게 두 조건으로 ‘0,’ ‘1’ 값을 생성시키는 경우에 SAS에서는 다음과 같은 방법으로 시행할 수 있다.</p>
<pre><code>새로운 변수 = (기존 변수 = 값);</code></pre>
<p>위의 예제에서 SICK2 변수는 주상병(SICK_SYM1)의 3자리 값이 ‘L02’ 이면 1, 아니면 0의 값을 가지는 것과 같은 결과를 보여준다.</p>
</div>
<div id="조건문-일반화하기" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> 조건문 일반화하기</h2>
<p>일반적으로 전체 개체가 여러 조건으로 쪼개어져서 명령문을 실행해야 하는 경우 IF 문과 ELSE 문을 중첩하여 조건과 명령문을 지정한다. 사용 방법은 다음과 같다.</p>
<pre><code>IF 조건문1 THEN 실행문1;
ELSE IF 조건문2 THEN 실행문2;
ELSE IF 조건문3 THEN 실행문3;
...
ELSE IF 조건문p THEN 실행문p;
ELSE 실행문(p+1);</code></pre>
<p>이와 같은 경우 조건문1이 참인 경우 실행문1을 시행하고, 조건문1이 참인 개체를 제외하고 나머지 중에서 조건문2가 참인 경우 실행문2를 시행한다. 마찬가지로 조건문1과 2가 참인 경우를 제외한 개체중에서 조건문3이 참인 경우 실행문3을 시행하고 이와 같은 과정을 계속 반복한다. 마지막으로 앞의 모든 조건문이 참인 경우를 제외한 나머지 개체에 대해서 실행문(p+1)을 시행한다. 이와 같은 형태는 세분화된 조건에 따라 새로운 변수를 생성하는 것뿐만 아니라 그룹(group) 변수를 생성할 때도 유용하게 쓰인다.</p>
<p>BB.DEATH 데이터셋으로부터 2020년을 기준으로 나이 변수(AGE)를 생성하고, 나이를 기준으로 다음과 같이 그룹화하여 AGEGROUP 변수를 생성한다고 가정해보자.</p>
<table>
<thead>
<tr class="header">
<th align="center">AGE</th>
<th align="center">AGEGROUP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">AGE <span class="math inline">\(\le\)</span> 60</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">61 <span class="math inline">\(\le\)</span> AGE <span class="math inline">\(\le\)</span> 70</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">71 <span class="math inline">\(\le\)</span> AGE <span class="math inline">\(\le\)</span> 80</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">AGE <span class="math inline">\(\ge\)</span> 80</td>
<td align="center">4</td>
</tr>
</tbody>
</table>
<p>여기서 나이가 60세 이하인 사람들은 AGEGROUP 값이 1로 할당된다. 이때 AGE 값이 결측이라면(특히 수치형 변수에서 결측값은 가장 작은 값으로 판단하기 때문에), 60세 이하에는 결측값도 포함되므로 결측값 처리는 따로 해주는 것이 좋다. AGEGROUP 변수 생성을 위한 프로그램은 다음과 같다.</p>
<pre><code>data bb.death_age;
set bb.death;
birthyear=substr(bth_yyyy,1,4)*1;
age=2020-birthyear;
if age le 60 then agegroup=1; 혹은 if age &lt;= 60 then agegroup=1
else if age le 70 then agegroup=2; 혹은 else if age &lt;= 70 then agegroup=2;
else if age le 80 then agegroup=3; 혹은 else if age &lt;= 80 then agegroup=3;
else agegroup=4;
run;

proc print data=bb.death_age (obs=10);
var rn_indi birthyear age agegroup;
run;</code></pre>
<p><img src="fig5/f8.png" /></p>
<p>또 다른 예로 문자형 카테고리 변수를 만드는 예제를 살펴보자. BB.T20 데이터셋에서 심결요양급여비용총액(ED_RC_TOT_AMT)을 기준으로 다음과 같은 COSTLEVEL 변수를 생성시킨다고 가정해보자.</p>
<table>
<thead>
<tr class="header">
<th align="center">ED_RC_TOT_AMT</th>
<th align="center">COSTLEVEL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ED_RC_TOT_AMT <span class="math inline">\(\le\)</span> 10000</td>
<td align="center">Low</td>
</tr>
<tr class="even">
<td align="center">10000 <span class="math inline">\(\lt\)</span> ED_RC_TOT_AMT <span class="math inline">\(\le\)</span> 20000</td>
<td align="center">Medium</td>
</tr>
<tr class="odd">
<td align="center">ED_RC_TOT_AMT <span class="math inline">\(\gt\)</span> 20000</td>
<td align="center">High</td>
</tr>
</tbody>
</table>
<p>COSTLEVEL 변수를 생성하여 BB.T20_COSTLEVEL 데이터셋을 생성하는 프로그램은 다음과 같다.</p>
<pre><code>data bb.t20_costlevel;
set bb.t20;
length costlevel $ 8.;
if ed_rc_tot_amt &lt;= 10000 then costlevel=&#39;Low&#39;;
else if ed_rc_tot_amt &lt;= 20000 then costlevel=&#39;Medium&#39;;
else costlevel=&#39;High&#39;;
run;

proc print data=bb.t20_costlevel (firstobs=775 obs=784);
var rn_indi ed_rc_tot_amt costlevel;
run;</code></pre>
<p><img src="fig5/f9.png" /></p>
<p>위의 예제와 마찬가지로 심결요양급여비용총액(ED_RC_TOT_AMT) 변수는 수치형 변수이기 때문에 결측값이 있는 경우 결측값을 가장 작은 값으로 간주한다. 따라서 COSTLEVEL 변수 생성 시 결측값이 존재한다면 결측값은 모두 COSTLEVEL=’LOW’인 케이스로 할당된다. 또한, 문자형 변수를 생성할 때 변수의 길이는 첫 번째 조건문에서 할당되는 값에 의해 결정된다. 예를 들어 COSTLEVEL 변수 생성 시 첫 번째 조건에서 COSTLEVEL의 값이 ‘Low’이기 때문에 COSTLEVEL 변수의 길이는 3으로 고정이 된다. 따라서 특정 개체의 COSTLEVEL의 값이 ‘Midium’ 이라면 3자리인 ‘Mid’로 표시가 된다. 이를 방지하기 위해 LENGTH 문을 통해 변수의 길이를 미리 결정하는 것이 가능하며 사용 방법은 다음과 같다.</p>
<pre><code>LENGTH 변수명 $ n.;</code></pre>
<p>여기서 ‘$’는 앞에 지정된 변수가 문자형 변수인 것을 의미하며 n은 자리수의 크기를 나타낸다. 위의 예제에서는 [LENGTH COSTLEVEL $ 8.;]과 같이 지정했으므로 COSTLEVEL은 문자형이며, 8자리 값을 가지는 것으로 인식된다.</p>
</div>
<div id="output문을-이용한-여러-데이터셋-생성하기" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Output문을 이용한 여러 데이터셋 생성하기</h2>
<p>특정 조건에 맞는 관찰값들을 취하여 두 개 이상의 새로운 데이터셋을 만드는 방법으로 IF ~ THEN OUTPUT 문이 있다. 앞서 KEEP, DROP, RENAME을 이용한 여러 데이터셋을 만드는 방법은 개체는 손대지 않고 특정변수를 남기거나 지우는 형태로 여러 데이터셋을 만들었다. 반면, IF ~ THEN OUTPUT 문은 변수는 그대로 두고 조건에 맞는 개체를 조절하여 데이터셋을 생성시킨다. 사용 방법은 다음과 같다.</p>
<pre><code>DATA 라이브러리.데이터셋1 라이브러리.데이터셋2 ... ;
SET 라이브러리.기존 데이터셋;
IF 조건문1 THEN OUTPUT 데이터셋1;
(ELSE) IF 조건문2 THEN OUTPUT 데이터셋2;
...
RUN;</code></pre>
<p>여기서 새로 생성시키고자 하는 데이터셋 명은 반드시 DATA 문에 모두 기입되어야 한다. 조건문을 나열할 때는 IF 문과 ELSE 문을 중첩해 사용해도 무방하다.</p>
<p>BB.T20 데이터셋에서 주상병(SICK_SYM1)을 기준으로 BB.T20_OUTPUT1, BB.T20_OUTPUT2, BB.T20_OUTPUT3 데이터셋을 동시에 생성시켜보자. 이때 조건은 1) BB.T20_OUTPUT1 데이터셋은 주상병 시작 코드가 ‘S’인 경우, 2) BB.T20_OUTPUT2 데이터셋은 주상병 시작 코드가 ‘Z’인 경우, 3) 주상병 시작 코드가 ‘S’ 와 ‘Z’를 제외한 모든 경우이다. 이를 위한 프로그램은 다음과 같다.</p>
<pre><code>data bb.t20_output1 bb.t20_output2 bb.t20_output3;
set bb.t20;
if sick_sym1 =: &#39;S&#39; then output bb.t20_output1;
else if sick_sym1 =: &#39;Z&#39; then output bb.t20_output2;
else output bb.t20_output3;
run;

proc print data=bb.t20_output1 (obs=10); var rn_indi sick_sym1; run;
proc print data=bb.t20_output2 (obs=10); var rn_indi sick_sym1; run;
proc print data=bb.t20_output3 (obs=10); var rn_indi sick_sym1; run;</code></pre>
<p>특정 문자로 시작하는 조건은 SUBSTR 함수를 이용해서 첫 글자만 뽑아내서 조건을 지정할 수도 있으며, 예제 프로그램과 같이 변수 =: ‘특정문자’와 같이 지정할 수 있다.</p>
<p><img src="fig5/f10.png" /></p>
<!----------------------------------------- End-------------------->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SASclaims.pdf", "SASclaims.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
