<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Medical Cost Data Analysis | Bio-Health Data Analysis</title>
  <meta name="description" content="This is lecture for the bio-health data analysis" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Medical Cost Data Analysis | Bio-Health Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is lecture for the bio-health data analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Medical Cost Data Analysis | Bio-Health Data Analysis" />
  
  <meta name="twitter:description" content="This is lecture for the bio-health data analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2022-08-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chapter2.html"/>
<link rel="next" href="Chapter4.html"/>
<script src="libs/header-attrs-2.15/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bio-Health Data Analysis</a></li>

<li class="divider"></li>
<li><a href="index.html#머리말" id="toc-머리말">머리말<span></span></a></li>
<li><a href="chapter1.html#chapter1" id="toc-chapter1"><span class="toc-section-number">1</span> Introduction to Claims Data<span></span></a>
<ul>
<li><a href="chapter1.html#국내-보건의료-빅데이터" id="toc-국내-보건의료-빅데이터"><span class="toc-section-number">1.1</span> 국내 보건의료 빅데이터<span></span></a></li>
<li><a href="chapter1.html#건강보험-청구자료" id="toc-건강보험-청구자료"><span class="toc-section-number">1.2</span> 건강보험 청구자료<span></span></a>
<ul>
<li><a href="chapter1.html#건강보험심사평가원" id="toc-건강보험심사평가원">건강보험심사평가원<span></span></a></li>
<li><a href="chapter1.html#건강보험공단" id="toc-건강보험공단">건강보험공단<span></span></a></li>
</ul></li>
<li><a href="chapter1.html#청구자료-구성-요소" id="toc-청구자료-구성-요소"><span class="toc-section-number">1.3</span> 청구자료 구성 요소<span></span></a></li>
<li><a href="chapter1.html#건강보험청구자료-활용" id="toc-건강보험청구자료-활용"><span class="toc-section-number">1.4</span> 건강보험청구자료 활용<span></span></a>
<ul>
<li><a href="chapter1.html#활용-예시---명세서-기반" id="toc-활용-예시---명세서-기반"><span class="toc-section-number">1.4.1</span> 활용 예시 - 명세서 기반<span></span></a></li>
<li><a href="chapter1.html#활용-예시---환자-기반" id="toc-활용-예시---환자-기반"><span class="toc-section-number">1.4.2</span> 활용 예시 - 환자 기반<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="Chapter2.html#Chapter2" id="toc-Chapter2"><span class="toc-section-number">2</span> Observational Study<span></span></a>
<ul>
<li><a href="Chapter2.html#case-control-study" id="toc-case-control-study"><span class="toc-section-number">2.1</span> Case-Control study<span></span></a>
<ul>
<li><a href="Chapter2.html#환자군-선정" id="toc-환자군-선정"><span class="toc-section-number">2.1.1</span> 환자군 선정<span></span></a></li>
<li><a href="Chapter2.html#대조군-선정" id="toc-대조군-선정"><span class="toc-section-number">2.1.2</span> 대조군 선정<span></span></a></li>
<li><a href="Chapter2.html#비교성-확보를-위한-짝짓기-수행" id="toc-비교성-확보를-위한-짝짓기-수행"><span class="toc-section-number">2.1.3</span> 비교성 확보를 위한 짝짓기 수행<span></span></a></li>
<li><a href="Chapter2.html#과거-정보-수집" id="toc-과거-정보-수집"><span class="toc-section-number">2.1.4</span> 과거 정보 수집<span></span></a></li>
<li><a href="Chapter2.html#기본-특징-분석" id="toc-기본-특징-분석"><span class="toc-section-number">2.1.5</span> 기본 특징 분석<span></span></a></li>
<li><a href="Chapter2.html#결과변수와-중재-노출간의-관련성-파악" id="toc-결과변수와-중재-노출간의-관련성-파악"><span class="toc-section-number">2.1.6</span> 결과변수와 중재 노출간의 관련성 파악<span></span></a></li>
<li><a href="Chapter2.html#환자-대조군-연구의-장점과-단점" id="toc-환자-대조군-연구의-장점과-단점"><span class="toc-section-number">2.1.7</span> 환자-대조군 연구의 장점과 단점<span></span></a></li>
</ul></li>
<li><a href="Chapter2.html#cohort-study" id="toc-cohort-study"><span class="toc-section-number">2.2</span> Cohort study<span></span></a>
<ul>
<li><a href="Chapter2.html#코호트-선정" id="toc-코호트-선정"><span class="toc-section-number">2.2.1</span> 코호트 선정<span></span></a></li>
<li><a href="Chapter2.html#중재-노출-정의" id="toc-중재-노출-정의"><span class="toc-section-number">2.2.2</span> 중재 노출 정의<span></span></a></li>
<li><a href="Chapter2.html#결과변수-정의" id="toc-결과변수-정의"><span class="toc-section-number">2.2.3</span> 결과변수 정의<span></span></a></li>
<li><a href="Chapter2.html#교란요인-정의" id="toc-교란요인-정의"><span class="toc-section-number">2.2.4</span> 교란요인 정의<span></span></a></li>
<li><a href="Chapter2.html#기본-특징-분석-1" id="toc-기본-특징-분석-1"><span class="toc-section-number">2.2.5</span> 기본 특징 분석<span></span></a></li>
<li><a href="Chapter2.html#인과성-평가" id="toc-인과성-평가"><span class="toc-section-number">2.2.6</span> 인과성 평가<span></span></a></li>
<li><a href="Chapter2.html#코호트-연구의-장점과-단점" id="toc-코호트-연구의-장점과-단점"><span class="toc-section-number">2.2.7</span> 코호트 연구의 장점과 단점<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="Chapter3.html#Chapter3" id="toc-Chapter3"><span class="toc-section-number">3</span> Medical Cost Data Analysis<span></span></a>
<ul>
<li><a href="Chapter3.html#health-care-cost" id="toc-health-care-cost"><span class="toc-section-number">3.1</span> health care cost<span></span></a></li>
<li><a href="Chapter3.html#regression-analysis-with-log-transformation" id="toc-regression-analysis-with-log-transformation"><span class="toc-section-number">3.2</span> Regression analysis with log transformation<span></span></a>
<ul>
<li><a href="Chapter3.html#general-linear-model" id="toc-general-linear-model"><span class="toc-section-number">3.2.1</span> General linear model<span></span></a></li>
<li><a href="Chapter3.html#log-cost-regression-model" id="toc-log-cost-regression-model"><span class="toc-section-number">3.2.2</span> Log cost regression model<span></span></a></li>
</ul></li>
<li><a href="Chapter3.html#gamma-generalized-linear-models" id="toc-gamma-generalized-linear-models"><span class="toc-section-number">3.3</span> Gamma generalized Linear Models<span></span></a>
<ul>
<li><a href="Chapter3.html#generalized-linear-models-glms" id="toc-generalized-linear-models-glms"><span class="toc-section-number">3.3.1</span> Generalized linear models (GLMs)<span></span></a></li>
<li><a href="Chapter3.html#gamma-generalized-linear-models-1" id="toc-gamma-generalized-linear-models-1"><span class="toc-section-number">3.3.2</span> Gamma generalized linear models<span></span></a></li>
</ul></li>
<li><a href="Chapter3.html#transformation-vs.-glms" id="toc-transformation-vs.-glms"><span class="toc-section-number">3.4</span> Transformation vs. GLMs<span></span></a></li>
<li><a href="Chapter3.html#appendix" id="toc-appendix"><span class="toc-section-number">3.5</span> Appendix<span></span></a>
<ul>
<li><a href="Chapter3.html#exponential-family" id="toc-exponential-family"><span class="toc-section-number">3.5.1</span> Exponential Family<span></span></a></li>
<li><a href="Chapter3.html#canonical-links" id="toc-canonical-links"><span class="toc-section-number">3.5.2</span> Canonical Links<span></span></a></li>
<li><a href="Chapter3.html#estimation-of-the-model-parameters" id="toc-estimation-of-the-model-parameters"><span class="toc-section-number">3.5.3</span> Estimation of the Model Parameters<span></span></a></li>
<li><a href="Chapter3.html#distribution-and-link-function" id="toc-distribution-and-link-function"><span class="toc-section-number">3.5.4</span> Distribution and Link Function<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="Chapter4.html#Chapter4" id="toc-Chapter4"><span class="toc-section-number">4</span> Binary and Categorical data Analysis<span></span></a>
<ul>
<li><a href="Chapter4.html#binary-outcomes" id="toc-binary-outcomes"><span class="toc-section-number">4.1</span> Binary Outcomes<span></span></a></li>
</ul></li>
<li><a href="Chapter5.html#Chapter5" id="toc-Chapter5"><span class="toc-section-number">5</span> Count Data Analysis<span></span></a>
<ul>
<li><a href="Chapter5.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">5.1</span> Poisson Regression<span></span></a></li>
<li><a href="Chapter5.html#example-danish-lung-cancer-counts" id="toc-example-danish-lung-cancer-counts"><span class="toc-section-number">5.2</span> Example: Danish Lung Cancer Counts<span></span></a></li>
<li><a href="Chapter5.html#what-about-accounting-for-population-size" id="toc-what-about-accounting-for-population-size"><span class="toc-section-number">5.3</span> What About Accounting for Population Size?<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#Chapter6" id="toc-Chapter6"><span class="toc-section-number">6</span> Survival Analysis<span></span></a>
<ul>
<li><a href="Chapter6.html#생존분석" id="toc-생존분석"><span class="toc-section-number">6.1</span> 생존분석<span></span></a></li>
<li><a href="Chapter6.html#비모수적-생존함수-추정" id="toc-비모수적-생존함수-추정"><span class="toc-section-number">6.2</span> 비모수적 생존함수 추정<span></span></a>
<ul>
<li><a href="Chapter6.html#생명표-방법" id="toc-생명표-방법"><span class="toc-section-number">6.2.1</span> 생명표 방법<span></span></a></li>
<li><a href="Chapter6.html#누적한계추정법" id="toc-누적한계추정법"><span class="toc-section-number">6.2.2</span> 누적한계추정법<span></span></a></li>
<li><a href="Chapter6.html#생존분포-비교" id="toc-생존분포-비교"><span class="toc-section-number">6.2.3</span> 생존분포 비교<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#모수적-생존함수-추정과-회귀모형" id="toc-모수적-생존함수-추정과-회귀모형"><span class="toc-section-number">6.3</span> 모수적 생존함수 추정과 회귀모형<span></span></a>
<ul>
<li><a href="Chapter6.html#지수분포" id="toc-지수분포"><span class="toc-section-number">6.3.1</span> 지수분포<span></span></a></li>
<li><a href="Chapter6.html#와이블분포" id="toc-와이블분포"><span class="toc-section-number">6.3.2</span> 와이블분포<span></span></a></li>
<li><a href="Chapter6.html#감마분포" id="toc-감마분포"><span class="toc-section-number">6.3.3</span> 감마분포<span></span></a></li>
<li><a href="Chapter6.html#로그정규분포" id="toc-로그정규분포"><span class="toc-section-number">6.3.4</span> 로그정규분포<span></span></a></li>
<li><a href="Chapter6.html#로그로지스틱분포" id="toc-로그로지스틱분포"><span class="toc-section-number">6.3.5</span> 로그로지스틱분포<span></span></a></li>
<li><a href="Chapter6.html#곰페르츠분포" id="toc-곰페르츠분포"><span class="toc-section-number">6.3.6</span> 곰페르츠분포<span></span></a></li>
<li><a href="Chapter6.html#회귀모형aft" id="toc-회귀모형aft"><span class="toc-section-number">6.3.7</span> 회귀모형(AFT)<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#cox-비례위험모형" id="toc-cox-비례위험모형"><span class="toc-section-number">6.4</span> Cox 비례위험모형<span></span></a>
<ul>
<li><a href="Chapter6.html#시간에-따라-변화하는-공변량이-있을-경우" id="toc-시간에-따라-변화하는-공변량이-있을-경우"><span class="toc-section-number">6.4.1</span> 시간에 따라 변화하는 공변량이 있을 경우<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#경쟁위험모형" id="toc-경쟁위험모형"><span class="toc-section-number">6.5</span> 경쟁위험모형<span></span></a>
<ul>
<li><a href="Chapter6.html#원인별-누적발생함수" id="toc-원인별-누적발생함수"><span class="toc-section-number">6.5.1</span> 원인별 누적발생함수<span></span></a></li>
<li><a href="Chapter6.html#원인별-위험함수" id="toc-원인별-위험함수"><span class="toc-section-number">6.5.2</span> 원인별 위험함수<span></span></a></li>
<li><a href="Chapter6.html#누적발생함수에-대한-회귀분석" id="toc-누적발생함수에-대한-회귀분석"><span class="toc-section-number">6.5.3</span> 누적발생함수에 대한 회귀분석<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#sas-실습" id="toc-sas-실습"><span class="toc-section-number">6.6</span> SAS 실습<span></span></a>
<ul>
<li><a href="Chapter6.html#생명표-방법-1" id="toc-생명표-방법-1"><span class="toc-section-number">6.6.1</span> 생명표 방법<span></span></a></li>
<li><a href="Chapter6.html#누적한계추정법-1" id="toc-누적한계추정법-1"><span class="toc-section-number">6.6.2</span> 누적한계추정법<span></span></a></li>
<li><a href="Chapter6.html#생존분포-비교-1" id="toc-생존분포-비교-1"><span class="toc-section-number">6.6.3</span> 생존분포 비교<span></span></a></li>
<li><a href="Chapter6.html#parametric-model" id="toc-parametric-model"><span class="toc-section-number">6.6.4</span> Parametric Model<span></span></a></li>
<li><a href="Chapter6.html#aft-model" id="toc-aft-model"><span class="toc-section-number">6.6.5</span> AFT model<span></span></a></li>
<li><a href="Chapter6.html#cox-비례위험모형-1" id="toc-cox-비례위험모형-1"><span class="toc-section-number">6.6.6</span> Cox 비례위험모형<span></span></a></li>
<li><a href="Chapter6.html#cox-비례위험모형---time-dependent-covariate" id="toc-cox-비례위험모형---time-dependent-covariate"><span class="toc-section-number">6.6.7</span> Cox 비례위험모형 - time dependent covariate<span></span></a></li>
<li><a href="Chapter6.html#competing-risks" id="toc-competing-risks"><span class="toc-section-number">6.6.8</span> Competing Risks<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="Chapter7.html#Chapter7" id="toc-Chapter7"><span class="toc-section-number">7</span> propensity score Methods<span></span></a>
<ul>
<li><a href="Chapter7.html#observational-study" id="toc-observational-study"><span class="toc-section-number">7.1</span> Observational Study?<span></span></a></li>
<li><a href="Chapter7.html#propensity-score" id="toc-propensity-score"><span class="toc-section-number">7.2</span> Propensity Score?<span></span></a></li>
<li><a href="Chapter7.html#propensity-score-methods" id="toc-propensity-score-methods"><span class="toc-section-number">7.3</span> Propensity Score Methods<span></span></a>
<ul>
<li><a href="Chapter7.html#propensity-score-matching" id="toc-propensity-score-matching"><span class="toc-section-number">7.3.1</span> Propensity Score Matching<span></span></a></li>
<li><a href="Chapter7.html#stratification-using-propensity-score" id="toc-stratification-using-propensity-score"><span class="toc-section-number">7.3.2</span> Stratification using Propensity Score<span></span></a></li>
<li><a href="Chapter7.html#inverse-probability-of-treatment-weighting" id="toc-inverse-probability-of-treatment-weighting"><span class="toc-section-number">7.3.3</span> Inverse Probability of Treatment Weighting<span></span></a></li>
<li><a href="Chapter7.html#propensity-score-adjustment-as-covariate" id="toc-propensity-score-adjustment-as-covariate"><span class="toc-section-number">7.3.4</span> Propensity Score Adjustment as Covariate<span></span></a></li>
<li><a href="Chapter7.html#property-of-propensity-score" id="toc-property-of-propensity-score"><span class="toc-section-number">7.3.5</span> Property of Propensity Score<span></span></a></li>
</ul></li>
<li><a href="Chapter7.html#practice---sas" id="toc-practice---sas"><span class="toc-section-number">7.4</span> Practice - SAS<span></span></a>
<ul>
<li><a href="Chapter7.html#greedy-nearest-neighbor-matching" id="toc-greedy-nearest-neighbor-matching"><span class="toc-section-number">7.4.1</span> Greedy Nearest Neighbor Matching<span></span></a></li>
<li><a href="Chapter7.html#propensity-score-stratification" id="toc-propensity-score-stratification"><span class="toc-section-number">7.4.2</span> Propensity Score Stratification<span></span></a></li>
<li><a href="Chapter7.html#inverse-probability-treatment-weighting" id="toc-inverse-probability-treatment-weighting"><span class="toc-section-number">7.4.3</span> Inverse Probability Treatment Weighting<span></span></a></li>
<li><a href="Chapter7.html#matching-with-existing-propensity-scores" id="toc-matching-with-existing-propensity-scores"><span class="toc-section-number">7.4.4</span> Matching with Existing propensity scores<span></span></a></li>
<li><a href="Chapter7.html#matching-with-existing-propensity-scores-1" id="toc-matching-with-existing-propensity-scores-1"><span class="toc-section-number">7.4.5</span> Matching with Existing propensity scores<span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bio-Health Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Chapter3" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Medical Cost Data Analysis<a href="Chapter3.html#Chapter3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="health-care-cost" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> health care cost<a href="Chapter3.html#health-care-cost" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Health care cost: medical cost, direct medical cost, etc.</li>
<li>There is no absolute concept of health care costs.
<ul>
<li>When describing health care costs,
<ul>
<li>various terms may be used such as charges, payments, expenditures …</li>
<li>It may vary depending on the insurer and the setting</li>
</ul></li>
<li>Depending on perspectives: patient, payer, provider</li>
</ul></li>
<li>The closest approximation to a health care cost
<ul>
<li>Total expenditures associated with the service, for a given patient in a given health care setting and with a given payer</li>
<li>The sum of the insurance payment, the out-of-pocket amount, and any expenses associated with the health plan</li>
</ul></li>
</ul>
<p><br></p>
<div id="health-care-cost-example" class="section level5 unnumbered hasAnchor">
<h5>Health care cost example<a href="Chapter3.html#health-care-cost-example" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="fig3/f1.png" /></p>
<p><br></p>
</div>
<div id="health-care-cost---meps-medical-expenditure-panel-survey" class="section level5 unnumbered hasAnchor">
<h5>Health care cost - MEPS (Medical Expenditure Panel Survey)<a href="Chapter3.html#health-care-cost---meps-medical-expenditure-panel-survey" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="fig3/f2.png" /></p>
<p><br></p>
</div>
<div id="health-care-cost---nhis-claims-data" class="section level5 unnumbered hasAnchor">
<h5>Health care cost - NHIS claims data<a href="Chapter3.html#health-care-cost---nhis-claims-data" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="fig3/f3.png" /></p>
<p><br></p>
<ul>
<li>Almost of health care cost do not follow normal distribution.
<ul>
<li>Not symmetric and bell shape<br />
</li>
<li>Right-skewed</li>
</ul></li>
</ul>
<p><img src="fig3/f4.png" /></p>
<p><br></p>
<ul>
<li>Skewed data
<ul>
<li>The mean is not always the best descriptive measure.</li>
<li>The median might be better than the mean.
<ul>
<li>Median is not sensitive to extreme values.</li>
<li>The log of the median is also the median of the log cost.</li>
</ul></li>
</ul></li>
<li>Given the heterogeneity of health care expenditures, the predictors and correlates of these expenditures are of great interest.
<ul>
<li>Extremely non-normal nature of cost outcomes means that standard linear regression analyses may not be appropriate for inference.</li>
</ul></li>
</ul>
<p><img src="fig3/f5.png" />
Felix, J., Andreozzi, V., Soares, M., Borrego, P., Gervasio, H., Moreira, A., . . . Portuguese Group for the Study of Bone, M. (2011). Hospital resource utilization and treatment cost of skeletal-related events in patients with metastatic breast or prostate cancer: estimation for the Portuguese National Health System. Value Health, 14(4), 499-505. <a href="doi:10.1016/j.jval.2010.11.014" class="uri">doi:10.1016/j.jval.2010.11.014</a></p>
<p><br></p>
<p><img src="fig3/f6.png" />
Leibson et al. (2020). Objective estimates of direct-medical costs among persons aged 3 to 38 years with and without research-defined autism spectrum disorder ascertained during childhood: A population-based birth-cohort study. Value Health, 23(5): 494-605.</p>
<p><br></p>
<p><img src="fig3/f7.png" />
Chaikledkaew et al. (2008). Factors affecting health-care costs and hospitalizations among diabetic patients in Thai public hospitals. International Society for Pharmacoeconomics and Outcomes Research (ISPOR), 1098-3015/08/S69 S69-S74.</p>
<p><br></p>
<p><img src="fig3/f8.png" />
Schneider, P. P., Ramaekers, B. L., Pouwels, X., Geurts, S., Ibragimova, K., de Boer, M., . . . Joore, M. (2021). Direct Medical Costs of Advanced Breast Cancer Treatment: A Real-World Study in the Southeast of The Netherlands. Value Health, 24(5), 668-675. <a href="doi:10.1016/j.jval.2020.12.007" class="uri">doi:10.1016/j.jval.2020.12.007</a></p>
<p><br></p>
</div>
</div>
<div id="regression-analysis-with-log-transformation" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Regression analysis with log transformation<a href="Chapter3.html#regression-analysis-with-log-transformation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="general-linear-model" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> General linear model<a href="Chapter3.html#general-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="the-general-linear-model" class="section level4 unnumbered hasAnchor">
<h4>The <strong>general linear model</strong><a href="Chapter3.html#the-general-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_{1i} + \ldots + \beta_p x_{pi} + \epsilon_i\]</span><br />
the <strong>response</strong> <span class="math inline">\(y_i\)</span>, <span class="math inline">\(i=1,\ldots ,n\)</span> is modelled by a linear function
of <strong>explanatory</strong> variables <span class="math inline">\(x_j\)</span>, <span class="math inline">\(j=1 , \ldots , p\)</span> plus an error
term.</p>
<p><img src="fig3/f9.png" /></p>
<p><br></p>
<ul>
<li><p>Here general refers to the dependence on potentially more than one
explanatory variable, v.s. the simple linear model:
<span class="math display">\[y_i = \beta_0 + \beta_1 x_i + \epsilon_i\]</span></p></li>
<li><p>The model is linear in the parameters, e.g. <span class="math display">\[\begin{aligned}
            y_i &amp;=&amp; \beta_0 + \beta_1 x_1 + \beta_2 x_1^2 + \epsilon_i \\
            y_i&amp;=&amp;\beta_0 + \beta_1 x_1x_2 + \beta_2 exp(x_2) +\epsilon_i
        \end{aligned}\]</span> but not e.g. <span class="math display">\[\begin{aligned}
            y_i &amp;=&amp; \beta_0 + \beta_1 x_1^{ \beta_2}+ \epsilon_i \\
            y_i&amp;=&amp;\beta_0 exp(\beta_1 )x_1 +\epsilon_i
        \end{aligned}\]</span></p></li>
<li><p>We assume that the errors <span class="math inline">\(\epsilon_i\)</span> are independent and
identically distributed such that <span class="math display">\[E[\epsilon_i]=0 \hskip5pt
        \text{and}
        \hskip5pt var[\epsilon_i]=\sigma^2\]</span></p></li>
<li><p>Typically we assume <span class="math display">\[\epsilon_i \sim N(0 , \sigma^2 )\]</span> as a basis
for inference, e.g. t-tests on paramters.</p></li>
</ul>
<p><img src="fig3/f10.png" /></p>
<p><br></p>
</div>
<div id="log-normal-distribution" class="section level4 unnumbered hasAnchor">
<h4>Log-normal distribution<a href="Chapter3.html#log-normal-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="fig3/f11.png" /></p>
<p><br></p>
</div>
</div>
<div id="log-cost-regression-model" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Log cost regression model<a href="Chapter3.html#log-cost-regression-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Classical approach for regression modeling of a right-skewed outcome on the positive real line
<ul>
<li>Standard linear regression with the log-transformed outcome, log(Y)</li>
</ul></li>
<li>Motivation with highly skewed data
<ul>
<li>Log transformation will make it normal.</li>
<li>Or at least normal enough that linear regression is valid.</li>
</ul></li>
<li>The log transformation is a compressive function
<ul>
<li>Applied to a set of positive numbers.</li>
<li>It shrinks those at the higher end of the range more than those at the lower end.</li>
</ul></li>
<li>The inverse of the natural logarithm, the exponential transformation is a magnifying function.
<ul>
<li>It stretches those at the higher end of the range more than those at the lower end.</li>
</ul></li>
<li>Standard linear regression with log of <span class="math inline">\(Y\)</span>
<span class="math display">\[
log(Y) \sim N(\mu, \sigma^2)
\]</span></li>
</ul>
<p>In the case where <span class="math inline">\(Y\)</span> is costs, <span class="math inline">\(log(Y)\)</span> is the log of costs, <span class="math inline">\(\mu\)</span> is the mean of log costs, and <span class="math inline">\(\sigma^2\)</span> is the variance of log costs.</p>
<ul>
<li>In the regression setting with covariates <span class="math inline">\(X_1, \ldots, X_k\)</span> the model is</li>
</ul>
<p><span class="math display">\[
log(Y|X_1,\ldots,X_k) \sim N(\beta_0+\beta_1X_1+\cdots+\beta_kX_k, \sigma^2)
\]</span></p>
<p>where <span class="math inline">\(\beta_0, \beta_1, \ldots, \beta_k\)</span> are the regression coefficients the represent an intercept and the effects of a change in the corresponding covariate on the mean of <span class="math inline">\(log(Y)\)</span>.</p>
<ul>
<li>Regression model</li>
</ul>
<p><span class="math display">\[
log(Y_i)=\beta_0+\beta_1X_{i1}+\cdots+\beta_kX_{ik}+\epsilon_i, \,\,\, \epsilon_i \sim N(0, \sigma^2)
\]</span></p>
<ul>
<li><p>Interpretation of <span class="math inline">\(\beta\)</span></p>
<ul>
<li>One-unit change in any of the covariates is associated with a constant change, <span class="math inline">\(\beta\)</span>, in the mean of the outcome, regardless of the actual value of the covariate.</li>
</ul></li>
<li><p>The <span class="math inline">\(\beta\)</span>s quantify the association between the covariates <span class="math inline">\(X\)</span> and the mean of <span class="math inline">\(log(Y)\)</span>.</p></li>
<li><p>However, health care costs are not easily understood in log costs.</p>
<ul>
<li>Ideally we would like estimates of the effects of covariates on the mean of <span class="math inline">\(Y\)</span>.
In short, when out model is for <span class="math inline">\(E[log(Y)]=\mu\)</span>, then what is <span class="math inline">\(E(Y)\)</span>?</li>
<li>It turns out that <span class="math inline">\(E(Y)\)</span> is not simply <span class="math inline">\(exp(\mu)\)</span>, the inverse transformation of <span class="math inline">\(\mu\)</span>.</li>
</ul></li>
<li><p>The mean of the lognormal random variable depends not only on the mean of the original random variable but also on its variance.</p></li>
<li><p>Formally, when <span class="math inline">\(E[log(Y)]=\mu\)</span> and <span class="math inline">\(Var[log(Y)]=\sigma^2\)</span>, then</p></li>
</ul>
<p><span class="math display">\[
E(Y)=exp(\mu+\frac{1}{2}\sigma^2)=exp(\mu)\times exp(\frac{1}{2}\sigma^2)
\]</span></p>
<ul>
<li>The mean of <span class="math inline">\(Y\)</span> is the exponentiated mean of <span class="math inline">\(log(Y)\)</span> multiplied by a term that depends on the variance.</li>
<li>The multiplicative term is always larger than 1, and it increases with the variance of the normally distributed <span class="math inline">\(log(Y)\)</span>.</li>
</ul>
<p><br></p>
<center>
<div id="under-estimation-problem" class="section level4 unnumbered hasAnchor">
<h4>Under Estimation problem!!!<a href="Chapter3.html#under-estimation-problem" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</center>
<p><br></p>
<ul>
<li>Example: Fitted linear regression of the log of medical expenditures</li>
</ul>
<p><img src="fig3/f12.png" /></p>
<p><span class="math display">\[
log(Y)=\beta_0 + \beta_1 \times Diabetes + \epsilon
\]</span>
* Fitted model</p>
<p><span class="math display">\[
log(expenditures)=7,386+1.230 \times Diabetes
\]</span></p>
<ul>
<li><p>Interpretation</p>
<ul>
<li>The mean of log expenditures increases by 1.230 (<span class="math inline">\(\beta_1\)</span>) when <span class="math inline">\(X\)</span> changes from 0 (no diabetes) to 1 (diabetes)</li>
<li>In practical, the <strong>average expenditures</strong> with a prior diabetes diagnosis are exp(1.230)=3.42 (<span class="math inline">\(exp(\beta_1)\)</span>) higher than the average medical expenditures without a prior diagnosis.</li>
</ul></li>
<li><p>To obtain the implications of this model for the average medical expenditures, we can use <span class="math inline">\(E(Y)\)</span> above.</p></li>
<li><p>When our model is <span class="math inline">\(log(Y|X) \sim N(\beta_0 +\beta_1X , \sigma^2)\)</span> then</p></li>
</ul>
<p><span class="math display">\[
E(Y|X)=exp(\beta_0+\beta_1X+\frac{1}{2}\sigma^2)=exp(\beta_0)\times exp(\beta_1X) \times exp(\frac{1}{2}\sigma^2)
\]</span></p>
<ul>
<li>The variance is same between with <span class="math inline">\((X=1)\)</span> and without <span class="math inline">\((X=0)\)</span> a prior diabetes diagnosis</li>
</ul>
<p><span class="math display">\[
\frac{E(Y|X=1)}{E(Y|X=0)}=exp(\beta_1)
\]</span></p>
<ul>
<li>The variance is not the same across values of <span class="math inline">\(X\)</span>: heteroskedastic</li>
</ul>
<p><span class="math display">\[
\frac{E(Y|X=1)}{E(Y|X=0)}=exp(\beta_1+\frac{1}{2}(\sigma_1^2-\sigma_0^2))
\]</span></p>
<ul>
<li><p>Although a very useful framework, there are some situations where
general linear models are not appropriate.</p>
<ul>
<li><p>the range of <span class="math inline">\(Y\)</span> is restricted (e.g. binary, count)</p></li>
<li><p>the variance of <span class="math inline">\(Y\)</span> depends on the mean</p></li>
<li><p>Non-normality with continuous variable</p></li>
</ul></li>
<li><p>Generalized linear models (GLMs) extend the range of application of
general linear models by accommodating response variables with
non-normal conditional distribution to address both of these issues.</p></li>
<li><p>Except for the error, the right-hand side of a generalized linear
model is essentially the same as for a general linear model.</p></li>
</ul>
</div>
</div>
</div>
<div id="gamma-generalized-linear-models" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Gamma generalized Linear Models<a href="Chapter3.html#gamma-generalized-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="generalized-linear-models-glms" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Generalized linear models (GLMs)<a href="Chapter3.html#generalized-linear-models-glms" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>A generalized linear model consists of three components:</li>
</ul>
<ol style="list-style-type: decimal">
<li>Random component : specifying the conditional distribution of the response variable, <span class="math inline">\(Y_i\)</span>, given the explanatory variables.</li>
</ol>
<ul>
<li>Traditionally, the random component is a member of an "exponential
family" - the normal (Gaussian), binomial, Poisson, gamma, or
inverse-Gaussian families of distributions - but generalized linear
models have been extended beyond the exponential families.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Systematic component : A linear function of the regressors, called
the linear predictor,
<span class="math display">\[\eta_i = \beta_0 + \beta_1 x_{1i} + \ldots + \beta_p x_{pi}\]</span> on
which the expected value <span class="math inline">\(\mu_i\)</span> of <span class="math inline">\(Y_i\)</span> depends.</li>
</ol>
<ul>
<li>The <span class="math inline">\(X\)</span>’s may include quantitative predictors, but they may also
include transformations of predictors, polynomial terms, contrasts
generated from factors, interaction regressors, etc.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Link function : an invertible link function which transforms the
expectation of the response to the linear predictor.</li>
</ol>
<ul>
<li><p>A link function that describes how the mean, <span class="math inline">\(E(Y_i )=\mu_i\)</span>,
depends on the linear predictor <span class="math display">\[g(\mu_i )=\eta_i\]</span></p></li>
<li><p>The inverse of the link function is sometimes called the mean
function : <span class="math inline">\(g^{-1}(\eta_i )=\mu_i\)</span>.</p></li>
<li><p>A variance function that describes how the variance, <span class="math inline">\(var(Y_i )\)</span>
depends on the mean <span class="math inline">\(var(Y_i )=\phi V(\mu_i)\)</span> where the dispersion
parameter <span class="math inline">\(\phi\)</span> is a constant.</p></li>
</ul>
<div id="the-generalized-linear-model" class="section level4 unnumbered hasAnchor">
<h4>The <strong>generalized linear model</strong><a href="Chapter3.html#the-generalized-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[g(\mu_i) = \beta_0 + \beta_1 x_{1i} + \ldots + \beta_p x_{pi}\]</span>
where <span class="math inline">\(g(\cdot)\)</span> is the link function, <span class="math inline">\(\mu_i\)</span> is the expectation of
random component <span class="math inline">\(Y_i\)</span> and explanatory variables <span class="math inline">\(x_j\)</span>,
<span class="math inline">\(j=1 , \ldots , p\)</span> .</p>
</div>
<div id="example-of-glms" class="section level4 unnumbered hasAnchor">
<h4>Example of GLMs<a href="Chapter3.html#example-of-glms" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Normal distribution with identity link function: Normal GLM</p>
<p><span class="math display">\[ E(Y_i | X)=\mu_i = \beta_0 + \beta_1 x_{1i} + \ldots + \beta_p x_{pi}\]</span></p></li>
<li><p>Binomial distribution with logit link function: Logistic regression model {-}</p>
<p><span class="math display">\[log(\frac{\mu_i}{1-\mu_i})= \beta_0 + \beta_1 x_{1i} + \ldots + \beta_p x_{pi}\]</span></p></li>
<li><p>Poisson distribution with log link function: Poisson GLMs</p>
<p><span class="math display">\[log(\mu_i)= \beta_0 + \beta_1 x_{1i} + \ldots + \beta_p x_{pi}\]</span></p></li>
<li><p>Gamma distribution with log link function: Gamma GLMs</p>
<p><span class="math display">\[log(\mu_i)= \beta_0 + \beta_1 x_{1i} + \ldots + \beta_p x_{pi}\]</span></p></li>
</ul>
<p><br></p>
</div>
</div>
<div id="gamma-generalized-linear-models-1" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Gamma generalized linear models<a href="Chapter3.html#gamma-generalized-linear-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>The log cost model has traditionally been a staple for estimating the mean of right-skewed costs.
<ul>
<li>Potential for heteroskedasticity and the resulting retransformation issues limit its practical application.</li>
</ul></li>
<li>One would model a cost outcome directly, in a way that avoids logging the cost.
<ul>
<li>The model should ideally allow for the variance to increase with the mean, as might be expected for health cost outcomes.</li>
<li>And the effects of covariates on the outcome should be readily interpretable.</li>
</ul></li>
<li>The gamma generalized linear model (GLM) with a log link satisfies all these requirements.
<ul>
<li>The gamma distribution is a flexible distribution on the positive real line.</li>
</ul></li>
<li>Gamma distribution with parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span></li>
</ul>
<p><img src="fig3/f13.png" /></p>
<ul>
<li>The “log link” means that the model relates the log of the mean to the linear predictors.</li>
</ul>
<p><span class="math display">\[
log[E(Y)]=\beta_0+\beta_1X_1+\cdots+\beta_kX_k
\]</span></p>
<ul>
<li>Or equivalently</li>
</ul>
<p><span class="math display">\[
E(Y)=exp(\beta_0+\beta_1X_1+\cdots+\beta_kX_k)=exp(\beta_0)\times exp(\beta_1X_1)\times \cdots \times exp(\beta_kX_k)
\]</span></p>
<ul>
<li>Interpretation: if <span class="math inline">\(X_j\)</span> is a binary covariate then</li>
</ul>
<p><span class="math display">\[
\frac{E(Y|X_j=1)}{E(Y|X_j=0)}=\exp(\beta_j)
\]</span></p>
<ul>
<li><p>This interpretation applies for any one-unit change in <span class="math inline">\(X_j\)</span> if it is a continuous covariate.</p></li>
<li><p>Example: Fitted gamma GLMs of the expenditures</p></li>
</ul>
<p><img src="fig3/f14.png" /></p>
<p><span class="math display">\[
log(\mu)=\beta_0+\beta_1 \times Age-18
\]</span></p>
<ul>
<li>Fitted model</li>
</ul>
<p><span class="math display">\[
log(mean \,\,\, expenditures)=7.954+0.021\times Age
\]</span></p>
<ul>
<li>Interpretation
<ul>
<li>The <strong>log mean of expenditures</strong> increases by 0.021 (<span class="math inline">\(\beta_1\)</span>) when <span class="math inline">\(X\)</span> changes from 0 (under age 18) to 1 (over age 18)</li>
<li>The <strong>average expenditures</strong> with a over 18 years old are exp(0.021)=1.02 (<span class="math inline">\(exp(\beta_1)\)</span>) higher than the average medical expenditures with under 18 years old.</li>
</ul></li>
<li>Comparison betwen gamma GLM and linear regression of the log of cost</li>
</ul>
<p><img src="fig3/f15.png" /></p>
</div>
</div>
<div id="transformation-vs.-glms" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Transformation vs. GLMs<a href="Chapter3.html#transformation-vs.-glms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>In some situations a response variable can be transformed to improve
linearity and homogeneity of variance so that a general linear model
can be applied.</p></li>
<li><p>This approach has some drawbacks</p>
<ul>
<li><p>Response variable has changed!</p></li>
<li><p>Transformation must simultaneously improve linearity and
homogeneity of variance</p></li>
<li><p>Transformation may not be defined on the boundaries of the
sample space</p></li>
</ul></li>
<li><p>For example, a common remedy for the variance increasing with the
mean is to apply the log transform. e.g.
<span class="math display">\[log(y_i)=\beta_0 +\beta_1 x_1 +\epsilon_i\]</span>
<span class="math display">\[\Rightarrow E(logY_i )=\beta_0 +\beta_1x_1\]</span></p></li>
<li><p>This is a linear model for the mean of <span class="math inline">\(logY\)</span> which may not always be
appropriate.</p></li>
<li><p>If <span class="math inline">\(Y\)</span> is income perhaps, we are really interested in the mean
income of population subgroups, in which case it would be better to
model <span class="math inline">\(E(Y)\)</span> using a GLMs: <span class="math display">\[logE(Y_i)=\beta_0 +\beta_1x_1\]</span> with
<span class="math inline">\(V(\mu )=\mu\)</span>. This also avoids difficulties with <span class="math inline">\(y=0\)</span>.</p></li>
</ul>
</div>
<div id="appendix" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Appendix<a href="Chapter3.html#appendix" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exponential-family" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Exponential Family<a href="Chapter3.html#exponential-family" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Most of the commonly used statistical distributions, e.g. Normal,
Binomial and Poisson, are members of the exponential family of
distributions whose densities can be written in the form
<span class="math display">\[f(y; \theta, \phi )=exp \left ( \frac{y\theta-b(\theta)}{\phi}+c(y,\phi)  \right)\]</span>
where <span class="math inline">\(\phi\)</span> is the dispersion parameter and <span class="math inline">\(\theta\)</span> is the
canonical parameter.</p></li>
<li><p>It can be shown that <span class="math display">\[\begin{aligned}
            E(Y) &amp;=&amp; b&#39;(\theta) = \mu \\
            var(Y)&amp;=&amp;\phi b&#39;&#39;(\theta)=\phi V(\mu)
        \end{aligned}\]</span></p></li>
</ul>
</div>
<div id="canonical-links" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Canonical Links<a href="Chapter3.html#canonical-links" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>For a GLMs where the response follows an exponential distribution we
have
<span class="math display">\[g(\mu_i )=g(b&#39;(\theta_i ))=\beta_0 +\beta_1 x_{1i} + \ldots + \beta_p x_{pi}\]</span></p></li>
<li><p>The canonical link is defined as <span class="math display">\[\begin{aligned}
            g&amp;=&amp;(b&#39;)^{-1} \\
            \Rightarrow g(\mu_i )&amp;=&amp;\theta_i = \beta_o + \beta_1 x_{1i}+ \ldots + \beta_p x_{pi}
        \end{aligned}\]</span></p></li>
<li><p>Canonical links lead to desirable statistical properties of the GLMs
hence tend to be used by default.</p></li>
<li><p>However there is no a priori reason why the systematic effects in
the model should be additive on the scale given by this link.</p></li>
</ul>
</div>
<div id="estimation-of-the-model-parameters" class="section level3 hasAnchor" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Estimation of the Model Parameters<a href="Chapter3.html#estimation-of-the-model-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>A single algorithm can be used to estimate the parameters of an
exponential family GLMs using maximum likelihood.</p></li>
<li><p>The log-likelihood for the sample <span class="math inline">\(y_1, \ldots , y_n\)</span> is
<span class="math display">\[l=\sum_{i=1}^n \frac{y_i\theta_i - b(\theta_i )}{\phi_i}+c(y_i , \phi_i )\]</span></p></li>
<li><p>The maximum likelihood estimates are obtained by solving the score
equations
<span class="math display">\[s(\beta_j )=\frac{\partial l}{\partial\beta_j} =\sum_{i=1}^n \frac{a_i(y_i -\mu_i)}{ V(\mu_i )}\times \frac{x_{ij}}{g&#39;(\mu_i )}=0\]</span>
Here <span class="math inline">\(\phi_i = \phi/a_i\)</span> where <span class="math inline">\(\phi\)</span> is a single dispersion
parameter and <span class="math inline">\(a_i\)</span> are known prior weights.</p></li>
<li><p>By the Fisher’s scoring method, the solution can be written as
<span class="math display">\[\mathbf{\beta}^{(r+1)} = (\mathbf{X}^T \mathbf{W}^{(r)} \mathbf{X})^{-1} \mathbf{X}^T \mathbf{W}^{(r)} \mathbf{z}^{(r)}\]</span></p>
<p>i.e. the score equations for a weighted least squares regression of
<span class="math inline">\(\mathbf{z}^{(r)}\)</span> on <span class="math inline">\(\mathbf{X}\)</span> with weights
<span class="math inline">\(\mathbf{W}^{(r)}=diag(w_i )\)</span>, where <span class="math display">\[\begin{aligned}
            z_i^{(r)} &amp;=&amp; \eta_i^{(r)} + (y_i - \mu_i^{(r)} )g&#39; (\mu_i^{(r)}) \\
            \text{and} \quad w_i^{(r)}&amp;=&amp;\frac{a_i}{V(\mu_i^{(r)})(g&#39;(\mu_i^{(r)}))^2}
        \end{aligned}\]</span></p></li>
<li><p>The estimates can be found using an Iteratively (Re-)Weighted Least
Squares (IRLS) algorithm</p>
<ol style="list-style-type: decimal">
<li><p>Start with initial estimates <span class="math inline">\(\mu_i^{(r)}\)</span></p></li>
<li><p>Calculate working responses <span class="math inline">\(z_i^{(r)}\)</span> and working weights
<span class="math inline">\(w_i^{(r)}\)</span></p></li>
<li><p>Calculate <span class="math inline">\(\mathbf{\beta}^{(r+1)}\)</span> by weighted least squares</p></li>
<li><p>Repeat 2 and 3 till convergence</p></li>
</ol></li>
<li><p>For models with the canonical link, this is simply the
Newton-Raphson method.</p></li>
</ul>
</div>
<div id="distribution-and-link-function" class="section level3 hasAnchor" number="3.5.4">
<h3><span class="header-section-number">3.5.4</span> Distribution and Link Function<a href="Chapter3.html#distribution-and-link-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="fig3/link.jpg" style="width:100.0%" /></p>
<p><br></p>
<p><br></p>
<!-- End -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chapter2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Chapter4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Bio-Health Data Analysis.pdf", "Bio-Health Data Analysis.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
