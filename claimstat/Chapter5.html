<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Count Data Analysis | Bio-Health Data Analysis</title>
  <meta name="description" content="This is lecture for the bio-health data analysis" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Count Data Analysis | Bio-Health Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is lecture for the bio-health data analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Count Data Analysis | Bio-Health Data Analysis" />
  
  <meta name="twitter:description" content="This is lecture for the bio-health data analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2022-08-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chapter4.html"/>
<link rel="next" href="Chapter6.html"/>
<script src="libs/header-attrs-2.15/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bio-Health Data Analysis</a></li>

<li class="divider"></li>
<li><a href="index.html#머리말" id="toc-머리말">머리말<span></span></a></li>
<li><a href="chapter1.html#chapter1" id="toc-chapter1"><span class="toc-section-number">1</span> Introduction to Claims Data<span></span></a>
<ul>
<li><a href="chapter1.html#국내-보건의료-빅데이터" id="toc-국내-보건의료-빅데이터"><span class="toc-section-number">1.1</span> 국내 보건의료 빅데이터<span></span></a></li>
<li><a href="chapter1.html#건강보험-청구자료" id="toc-건강보험-청구자료"><span class="toc-section-number">1.2</span> 건강보험 청구자료<span></span></a>
<ul>
<li><a href="chapter1.html#건강보험심사평가원" id="toc-건강보험심사평가원">건강보험심사평가원<span></span></a></li>
<li><a href="chapter1.html#건강보험공단" id="toc-건강보험공단">건강보험공단<span></span></a></li>
</ul></li>
<li><a href="chapter1.html#청구자료-구성-요소" id="toc-청구자료-구성-요소"><span class="toc-section-number">1.3</span> 청구자료 구성 요소<span></span></a></li>
<li><a href="chapter1.html#건강보험청구자료-활용" id="toc-건강보험청구자료-활용"><span class="toc-section-number">1.4</span> 건강보험청구자료 활용<span></span></a>
<ul>
<li><a href="chapter1.html#활용-예시---명세서-기반" id="toc-활용-예시---명세서-기반"><span class="toc-section-number">1.4.1</span> 활용 예시 - 명세서 기반<span></span></a></li>
<li><a href="chapter1.html#활용-예시---환자-기반" id="toc-활용-예시---환자-기반"><span class="toc-section-number">1.4.2</span> 활용 예시 - 환자 기반<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="Chapter2.html#Chapter2" id="toc-Chapter2"><span class="toc-section-number">2</span> Observational Study<span></span></a>
<ul>
<li><a href="Chapter2.html#case-control-study" id="toc-case-control-study"><span class="toc-section-number">2.1</span> Case-Control study<span></span></a>
<ul>
<li><a href="Chapter2.html#환자군-선정" id="toc-환자군-선정"><span class="toc-section-number">2.1.1</span> 환자군 선정<span></span></a></li>
<li><a href="Chapter2.html#대조군-선정" id="toc-대조군-선정"><span class="toc-section-number">2.1.2</span> 대조군 선정<span></span></a></li>
<li><a href="Chapter2.html#비교성-확보를-위한-짝짓기-수행" id="toc-비교성-확보를-위한-짝짓기-수행"><span class="toc-section-number">2.1.3</span> 비교성 확보를 위한 짝짓기 수행<span></span></a></li>
<li><a href="Chapter2.html#과거-정보-수집" id="toc-과거-정보-수집"><span class="toc-section-number">2.1.4</span> 과거 정보 수집<span></span></a></li>
<li><a href="Chapter2.html#기본-특징-분석" id="toc-기본-특징-분석"><span class="toc-section-number">2.1.5</span> 기본 특징 분석<span></span></a></li>
<li><a href="Chapter2.html#결과변수와-중재-노출간의-관련성-파악" id="toc-결과변수와-중재-노출간의-관련성-파악"><span class="toc-section-number">2.1.6</span> 결과변수와 중재 노출간의 관련성 파악<span></span></a></li>
<li><a href="Chapter2.html#환자-대조군-연구의-장점과-단점" id="toc-환자-대조군-연구의-장점과-단점"><span class="toc-section-number">2.1.7</span> 환자-대조군 연구의 장점과 단점<span></span></a></li>
</ul></li>
<li><a href="Chapter2.html#cohort-study" id="toc-cohort-study"><span class="toc-section-number">2.2</span> Cohort study<span></span></a>
<ul>
<li><a href="Chapter2.html#코호트-선정" id="toc-코호트-선정"><span class="toc-section-number">2.2.1</span> 코호트 선정<span></span></a></li>
<li><a href="Chapter2.html#중재-노출-정의" id="toc-중재-노출-정의"><span class="toc-section-number">2.2.2</span> 중재 노출 정의<span></span></a></li>
<li><a href="Chapter2.html#결과변수-정의" id="toc-결과변수-정의"><span class="toc-section-number">2.2.3</span> 결과변수 정의<span></span></a></li>
<li><a href="Chapter2.html#교란요인-정의" id="toc-교란요인-정의"><span class="toc-section-number">2.2.4</span> 교란요인 정의<span></span></a></li>
<li><a href="Chapter2.html#기본-특징-분석-1" id="toc-기본-특징-분석-1"><span class="toc-section-number">2.2.5</span> 기본 특징 분석<span></span></a></li>
<li><a href="Chapter2.html#인과성-평가" id="toc-인과성-평가"><span class="toc-section-number">2.2.6</span> 인과성 평가<span></span></a></li>
<li><a href="Chapter2.html#코호트-연구의-장점과-단점" id="toc-코호트-연구의-장점과-단점"><span class="toc-section-number">2.2.7</span> 코호트 연구의 장점과 단점<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="Chapter3.html#Chapter3" id="toc-Chapter3"><span class="toc-section-number">3</span> Medical Cost Data Analysis<span></span></a>
<ul>
<li><a href="Chapter3.html#health-care-cost" id="toc-health-care-cost"><span class="toc-section-number">3.1</span> health care cost<span></span></a></li>
<li><a href="Chapter3.html#regression-analysis-with-log-transformation" id="toc-regression-analysis-with-log-transformation"><span class="toc-section-number">3.2</span> Regression analysis with log transformation<span></span></a>
<ul>
<li><a href="Chapter3.html#general-linear-model" id="toc-general-linear-model"><span class="toc-section-number">3.2.1</span> General linear model<span></span></a></li>
<li><a href="Chapter3.html#log-cost-regression-model" id="toc-log-cost-regression-model"><span class="toc-section-number">3.2.2</span> Log cost regression model<span></span></a></li>
</ul></li>
<li><a href="Chapter3.html#gamma-generalized-linear-models" id="toc-gamma-generalized-linear-models"><span class="toc-section-number">3.3</span> Gamma generalized Linear Models<span></span></a>
<ul>
<li><a href="Chapter3.html#generalized-linear-models-glms" id="toc-generalized-linear-models-glms"><span class="toc-section-number">3.3.1</span> Generalized linear models (GLMs)<span></span></a></li>
<li><a href="Chapter3.html#gamma-generalized-linear-models-1" id="toc-gamma-generalized-linear-models-1"><span class="toc-section-number">3.3.2</span> Gamma generalized linear models<span></span></a></li>
</ul></li>
<li><a href="Chapter3.html#transformation-vs.-glms" id="toc-transformation-vs.-glms"><span class="toc-section-number">3.4</span> Transformation vs. GLMs<span></span></a></li>
<li><a href="Chapter3.html#appendix" id="toc-appendix"><span class="toc-section-number">3.5</span> Appendix<span></span></a>
<ul>
<li><a href="Chapter3.html#exponential-family" id="toc-exponential-family"><span class="toc-section-number">3.5.1</span> Exponential Family<span></span></a></li>
<li><a href="Chapter3.html#canonical-links" id="toc-canonical-links"><span class="toc-section-number">3.5.2</span> Canonical Links<span></span></a></li>
<li><a href="Chapter3.html#estimation-of-the-model-parameters" id="toc-estimation-of-the-model-parameters"><span class="toc-section-number">3.5.3</span> Estimation of the Model Parameters<span></span></a></li>
<li><a href="Chapter3.html#distribution-and-link-function" id="toc-distribution-and-link-function"><span class="toc-section-number">3.5.4</span> Distribution and Link Function<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="Chapter4.html#Chapter4" id="toc-Chapter4"><span class="toc-section-number">4</span> Binary and Categorical data Analysis<span></span></a>
<ul>
<li><a href="Chapter4.html#binary-outcomes" id="toc-binary-outcomes"><span class="toc-section-number">4.1</span> Binary Outcomes<span></span></a></li>
</ul></li>
<li><a href="Chapter5.html#Chapter5" id="toc-Chapter5"><span class="toc-section-number">5</span> Count Data Analysis<span></span></a>
<ul>
<li><a href="Chapter5.html#poisson-regression" id="toc-poisson-regression"><span class="toc-section-number">5.1</span> Poisson Regression<span></span></a></li>
<li><a href="Chapter5.html#example-danish-lung-cancer-counts" id="toc-example-danish-lung-cancer-counts"><span class="toc-section-number">5.2</span> Example: Danish Lung Cancer Counts<span></span></a></li>
<li><a href="Chapter5.html#what-about-accounting-for-population-size" id="toc-what-about-accounting-for-population-size"><span class="toc-section-number">5.3</span> What About Accounting for Population Size?<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#Chapter6" id="toc-Chapter6"><span class="toc-section-number">6</span> Survival Analysis<span></span></a>
<ul>
<li><a href="Chapter6.html#생존분석" id="toc-생존분석"><span class="toc-section-number">6.1</span> 생존분석<span></span></a></li>
<li><a href="Chapter6.html#비모수적-생존함수-추정" id="toc-비모수적-생존함수-추정"><span class="toc-section-number">6.2</span> 비모수적 생존함수 추정<span></span></a>
<ul>
<li><a href="Chapter6.html#생명표-방법" id="toc-생명표-방법"><span class="toc-section-number">6.2.1</span> 생명표 방법<span></span></a></li>
<li><a href="Chapter6.html#누적한계추정법" id="toc-누적한계추정법"><span class="toc-section-number">6.2.2</span> 누적한계추정법<span></span></a></li>
<li><a href="Chapter6.html#생존분포-비교" id="toc-생존분포-비교"><span class="toc-section-number">6.2.3</span> 생존분포 비교<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#모수적-생존함수-추정과-회귀모형" id="toc-모수적-생존함수-추정과-회귀모형"><span class="toc-section-number">6.3</span> 모수적 생존함수 추정과 회귀모형<span></span></a>
<ul>
<li><a href="Chapter6.html#지수분포" id="toc-지수분포"><span class="toc-section-number">6.3.1</span> 지수분포<span></span></a></li>
<li><a href="Chapter6.html#와이블분포" id="toc-와이블분포"><span class="toc-section-number">6.3.2</span> 와이블분포<span></span></a></li>
<li><a href="Chapter6.html#감마분포" id="toc-감마분포"><span class="toc-section-number">6.3.3</span> 감마분포<span></span></a></li>
<li><a href="Chapter6.html#로그정규분포" id="toc-로그정규분포"><span class="toc-section-number">6.3.4</span> 로그정규분포<span></span></a></li>
<li><a href="Chapter6.html#로그로지스틱분포" id="toc-로그로지스틱분포"><span class="toc-section-number">6.3.5</span> 로그로지스틱분포<span></span></a></li>
<li><a href="Chapter6.html#곰페르츠분포" id="toc-곰페르츠분포"><span class="toc-section-number">6.3.6</span> 곰페르츠분포<span></span></a></li>
<li><a href="Chapter6.html#회귀모형aft" id="toc-회귀모형aft"><span class="toc-section-number">6.3.7</span> 회귀모형(AFT)<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#cox-비례위험모형" id="toc-cox-비례위험모형"><span class="toc-section-number">6.4</span> Cox 비례위험모형<span></span></a>
<ul>
<li><a href="Chapter6.html#시간에-따라-변화하는-공변량이-있을-경우" id="toc-시간에-따라-변화하는-공변량이-있을-경우"><span class="toc-section-number">6.4.1</span> 시간에 따라 변화하는 공변량이 있을 경우<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#경쟁위험모형" id="toc-경쟁위험모형"><span class="toc-section-number">6.5</span> 경쟁위험모형<span></span></a>
<ul>
<li><a href="Chapter6.html#원인별-누적발생함수" id="toc-원인별-누적발생함수"><span class="toc-section-number">6.5.1</span> 원인별 누적발생함수<span></span></a></li>
<li><a href="Chapter6.html#원인별-위험함수" id="toc-원인별-위험함수"><span class="toc-section-number">6.5.2</span> 원인별 위험함수<span></span></a></li>
<li><a href="Chapter6.html#누적발생함수에-대한-회귀분석" id="toc-누적발생함수에-대한-회귀분석"><span class="toc-section-number">6.5.3</span> 누적발생함수에 대한 회귀분석<span></span></a></li>
</ul></li>
<li><a href="Chapter6.html#sas-실습" id="toc-sas-실습"><span class="toc-section-number">6.6</span> SAS 실습<span></span></a>
<ul>
<li><a href="Chapter6.html#생명표-방법-1" id="toc-생명표-방법-1"><span class="toc-section-number">6.6.1</span> 생명표 방법<span></span></a></li>
<li><a href="Chapter6.html#누적한계추정법-1" id="toc-누적한계추정법-1"><span class="toc-section-number">6.6.2</span> 누적한계추정법<span></span></a></li>
<li><a href="Chapter6.html#생존분포-비교-1" id="toc-생존분포-비교-1"><span class="toc-section-number">6.6.3</span> 생존분포 비교<span></span></a></li>
<li><a href="Chapter6.html#parametric-model" id="toc-parametric-model"><span class="toc-section-number">6.6.4</span> Parametric Model<span></span></a></li>
<li><a href="Chapter6.html#aft-model" id="toc-aft-model"><span class="toc-section-number">6.6.5</span> AFT model<span></span></a></li>
<li><a href="Chapter6.html#cox-비례위험모형-1" id="toc-cox-비례위험모형-1"><span class="toc-section-number">6.6.6</span> Cox 비례위험모형<span></span></a></li>
<li><a href="Chapter6.html#cox-비례위험모형---time-dependent-covariate" id="toc-cox-비례위험모형---time-dependent-covariate"><span class="toc-section-number">6.6.7</span> Cox 비례위험모형 - time dependent covariate<span></span></a></li>
<li><a href="Chapter6.html#competing-risks" id="toc-competing-risks"><span class="toc-section-number">6.6.8</span> Competing Risks<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="Chapter7.html#Chapter7" id="toc-Chapter7"><span class="toc-section-number">7</span> propensity score Methods<span></span></a>
<ul>
<li><a href="Chapter7.html#observational-study" id="toc-observational-study"><span class="toc-section-number">7.1</span> Observational Study?<span></span></a></li>
<li><a href="Chapter7.html#propensity-score" id="toc-propensity-score"><span class="toc-section-number">7.2</span> Propensity Score?<span></span></a></li>
<li><a href="Chapter7.html#propensity-score-methods" id="toc-propensity-score-methods"><span class="toc-section-number">7.3</span> Propensity Score Methods<span></span></a>
<ul>
<li><a href="Chapter7.html#propensity-score-matching" id="toc-propensity-score-matching"><span class="toc-section-number">7.3.1</span> Propensity Score Matching<span></span></a></li>
<li><a href="Chapter7.html#stratification-using-propensity-score" id="toc-stratification-using-propensity-score"><span class="toc-section-number">7.3.2</span> Stratification using Propensity Score<span></span></a></li>
<li><a href="Chapter7.html#inverse-probability-of-treatment-weighting" id="toc-inverse-probability-of-treatment-weighting"><span class="toc-section-number">7.3.3</span> Inverse Probability of Treatment Weighting<span></span></a></li>
<li><a href="Chapter7.html#propensity-score-adjustment-as-covariate" id="toc-propensity-score-adjustment-as-covariate"><span class="toc-section-number">7.3.4</span> Propensity Score Adjustment as Covariate<span></span></a></li>
<li><a href="Chapter7.html#property-of-propensity-score" id="toc-property-of-propensity-score"><span class="toc-section-number">7.3.5</span> Property of Propensity Score<span></span></a></li>
</ul></li>
<li><a href="Chapter7.html#practice---sas" id="toc-practice---sas"><span class="toc-section-number">7.4</span> Practice - SAS<span></span></a>
<ul>
<li><a href="Chapter7.html#greedy-nearest-neighbor-matching" id="toc-greedy-nearest-neighbor-matching"><span class="toc-section-number">7.4.1</span> Greedy Nearest Neighbor Matching<span></span></a></li>
<li><a href="Chapter7.html#propensity-score-stratification" id="toc-propensity-score-stratification"><span class="toc-section-number">7.4.2</span> Propensity Score Stratification<span></span></a></li>
<li><a href="Chapter7.html#inverse-probability-treatment-weighting" id="toc-inverse-probability-treatment-weighting"><span class="toc-section-number">7.4.3</span> Inverse Probability Treatment Weighting<span></span></a></li>
<li><a href="Chapter7.html#matching-with-existing-propensity-scores" id="toc-matching-with-existing-propensity-scores"><span class="toc-section-number">7.4.4</span> Matching with Existing propensity scores<span></span></a></li>
<li><a href="Chapter7.html#matching-with-existing-propensity-scores-1" id="toc-matching-with-existing-propensity-scores-1"><span class="toc-section-number">7.4.5</span> Matching with Existing propensity scores<span></span></a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bio-Health Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Chapter5" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Count Data Analysis<a href="Chapter5.html#Chapter5" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="poisson-regression" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Poisson Regression<a href="Chapter5.html#poisson-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Count data, in which there is no upper limit to the number of
counts, usually fall into two types</p>
<ul>
<li><p>Rates : counts per unit of time/area/distance, etc</p></li>
<li><p>Contingency tables : counts cross-classified by categorical
variables</p></li>
</ul></li>
<li><p>We concentrate on rates data can be modelled using Poisson GLMs with
a log link</p></li>
<li><p>Log-linear model for mean rate:
<span class="math display">\[\log(\lambda_i ) = \beta_0 + \beta_1 x_{1i} + \ldots +\beta_p x_{pi}\]</span>
where <span class="math inline">\(p\)</span> is the number of predictors (or covariates) in the model</p></li>
<li><p>Random component: <span class="math display">\[Y_i|\mathbf{X}_i \sim Poisson(\lambda_i )\]</span></p></li>
<li><p>Here, <span class="math inline">\(\lambda_i = E(Y_i|\mathbf{X}_i)=var(Y_i|\mathbf{X}_i)\)</span></p></li>
<li><p>Exponentiating gives us a model for the rate parameter, or expected
counts:
<span class="math display">\[\lambda_i  = e^{\beta_0 + \beta_1 x_{1i} + \ldots +\beta_p x_{pi}}\]</span></p></li>
<li><p>For Poisson random variables, expectation of <span class="math inline">\(Y_i\)</span> is <span class="math inline">\(\lambda_i\)</span>,
so the log-linear model provides a prediction for the expected value
of <span class="math inline">\(Y_i\)</span></p></li>
<li><p><span class="math inline">\(e^{\beta_j}\)</span>=Rate ratio for a <span class="math inline">\(1\)</span> unit increase in <span class="math inline">\(x_j\)</span>, i.e. rate
ratio for <span class="math inline">\(x_j +1\)</span> compared to <span class="math inline">\(x_j\)</span>, with other covariates held
constant.</p></li>
<li><p><span class="math inline">\(e^{\Delta\beta_j}\)</span>=Rate ratio for a <span class="math inline">\(\Delta\)</span> unit increase in
<span class="math inline">\(x_j\)</span>, i.e. rate ratio for <span class="math inline">\(x_j +\Delta\)</span> compared to <span class="math inline">\(x_j\)</span>, with
other covariates held constant.</p></li>
<li><p><span class="math inline">\(e^{\beta_0}\)</span>=Baseline rate value, i.e. rate for an observation with
all <span class="math inline">\(X\)</span>’s equal to zero.</p></li>
<li><p>The systematic portion of the model allows linear combinations of
the covariates:
<span class="math display">\[\beta_0 + \beta_1 x_{1i} + \ldots +\beta_p x_{pi}\]</span></p></li>
<li><p>Since we have no restrictions on the predictors <span class="math inline">\(X_1 , \ldots, X_p\)</span>,
the predicted values can take any values on the real line:
<span class="math inline">\((-\infty, +\infty)\)</span></p></li>
<li><p>But our outcome variable <span class="math inline">\(Y_i\)</span> consistes of counts, so the expected
value of <span class="math inline">\(Y_i\)</span> has the restriction:
<span class="math inline">\(\lambda_i \in \left[0, +\infty\right)\)</span></p></li>
<li><p>After taking a log transform, we get:
<span class="math inline">\(\log(\lambda_i) \in (-\infty, +\infty)\)</span> which is just what we
wanted.</p></li>
</ul>
</div>
<div id="example-danish-lung-cancer-counts" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Example: Danish Lung Cancer Counts<a href="Chapter5.html#example-danish-lung-cancer-counts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Cases of lung cancer were counted in four Danish cities between
<span class="math inline">\(1968\)</span> and <span class="math inline">\(1971\)</span> inclusive.</p></li>
<li><p>We have <span class="math inline">\(24\)</span> observations on each of <span class="math inline">\(4\)</span> variables:</p>
<ul>
<li><p>Cases: the number of lung cancer cases</p></li>
<li><p>Pop: the popilation of each age group in each city</p></li>
<li><p>Age: the categorical age group; one of 40-54, 55-59, 60-64,
65-69, 70-74 or $&gt;$74</p></li>
<li><p>city: the city; one of Fredericia, Horsens, Kolding, or Vejle</p></li>
</ul></li>
<li><p>Questions of interest: How does the expected number of lung cancer
counts vary by age?</p></li>
<li><p>Dataset</p>
<p><img src="glm/dataset.jpg" style="width:60.0%" /></p></li>
<li><p>Boxplots of observed counts versus age category</p>
<p><img src="glm/boxplot.jpg" style="width:60.0%" /></p></li>
<li><p>Model
<span class="math display">\[\log(\lambda_i )= \beta_0 +\beta_1 I(Age55-59_i)+\beta_2 I(Age60-64_i)
\]</span></p></li>
</ul>
<p><span class="math display">\[+\beta_3 I(Age65-69_i)+\beta_4 I(Age70-74_i)+\beta_5 I(Age&gt;74_i)\]</span></p>
<ul>
<li><p>We are fitting a model with indicators for each of the age
categories.</p></li>
<li><p>Baseline is the group aged <span class="math inline">\(40-54\)</span>.</p></li>
<li><p><span class="math inline">\(I(age55-59)\)</span> is an indicator of having age <span class="math inline">\(55-59\)</span>, it is equal to
<span class="math inline">\(1\)</span> for those of age <span class="math inline">\(55-59\)</span> and <span class="math inline">\(0\)</span> otherwise.</p></li>
<li><p><span class="math inline">\(I(age60-64)\)</span> is an indicator of having age <span class="math inline">\(60-64\)</span>, it is equal to
<span class="math inline">\(1\)</span> for those of age <span class="math inline">\(60-64\)</span> and <span class="math inline">\(0\)</span> otherwise.</p></li>
<li><p>etc...</p></li>
</ul>
<p><img src="glm/result1.jpg" style="width:90.0%" /></p>
<p><span class="math display">\[    \log(\lambda_i ) = 2.110 -0.031 I(Age55-59_i)+0.265 I(Age60-64_i)
\]</span>
<span class="math display">\[+0.310 I(Age65-69_i)+0.192 I(Age70-74_i)
                -0.063 I(Age&gt;74_i)
   \]</span></p>
<ul>
<li><p>We interpret <span class="math inline">\(\hat{\beta}_0=2.110\)</span> as the log expected count of
cancer cases among individuals aged <span class="math inline">\(40-54\)</span></p></li>
<li><p>We interpret <span class="math inline">\(\hat{\beta}_0+\hat{\beta}_1=2.079\)</span> as the log expected
count of cancer cases among individuals aged <span class="math inline">\(55-59\)</span></p></li>
<li><p>We interpret <span class="math inline">\(\hat{\beta}_1=-0.031\)</span> as the difference in log
expected count of cancer cases comparing the <span class="math inline">\(55-59\)</span> age group to
the <span class="math inline">\(40-54\)</span> age group. We can also interpret <span class="math inline">\(\hat{\beta}_1\)</span> as a
log relative rate</p></li>
</ul>
<p><span class="math display">\[
                \log(\lambda_i ) = 2.110 -0.031 I(Age55-59_i)+0.265 I(Age60-64_i)
                \]</span>
<span class="math display">\[                +0.310 I(Age65-69_i)+0.192 I(Age70-74_i)
                -0.063 I(Age&gt;74_i)
            \]</span></p>
<ul>
<li><p>We interpret <span class="math inline">\(exp(\hat{\beta}_0)=8.24\)</span> as the expected count of
cancer cases among individuals aged <span class="math inline">\(40-54\)</span></p></li>
<li><p>We interpret <span class="math inline">\(exp(\hat{\beta}_0+\hat{\beta}_1)=8.00\)</span> as the expected
count of cancer cases among individuals aged <span class="math inline">\(55-59\)</span></p></li>
<li><p>We interpret <span class="math inline">\(exp(\hat{\beta}_1)=0.97\)</span> as the ratio of expected
counts comparing the <span class="math inline">\(55-59\)</span> age group to the <span class="math inline">\(40-54\)</span> age group. We
can also interpret <span class="math inline">\(exp(\hat{\beta}_1)\)</span> as a relative rate</p></li>
<li><p>Let’s perform a likelihood ratio test to look at the global
hypothesis:
<span class="math display">\[H_0 : \beta_1 = \beta_2 = \beta_3 = \beta_4 =\beta_5 =0\]</span> versus
the alternative hypothesis:
<span class="math display">\[H_a : \text{at least one of the } \beta_i \text{&#39;s is not } 0, \text{for } i\in 1,\ldots,5\]</span></p></li>
<li><p>Test statistic:</p></li>
<li><p>TS = -2(logLik(intercept only model)-logLik(Age model))</p></li>
<li><p>= 4.95 <span class="math inline">\(\sim \chi_5^2\)</span></p></li>
<li><p>Critical value for the hypothesis at level <span class="math inline">\(\alpha=0.05\)</span>:
<span class="math inline">\(\chi_{5,0.05}^2 = 11.07\)</span>. Fail to reject the null hypothesis.</p></li>
</ul>
<div id="conclusions" class="section level4 unnumbered hasAnchor">
<h4>Conclusions:<a href="Chapter5.html#conclusions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>Based on the Poisson model of cancer case counts as a function of
Age, we noted a generally increasing number of cases with increasing
age.</p></li>
<li><p>The trend was not monotonically increasing with age.</p></li>
<li><p>Not a statistically significant result.</p></li>
</ul>
</div>
</div>
<div id="what-about-accounting-for-population-size" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> What About Accounting for Population Size?<a href="Chapter5.html#what-about-accounting-for-population-size" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>So far we modelled the observed counts of cancer cases as Poisson
counts.</p></li>
<li><p>The population size from each of these counts was drawn is also
known.</p></li>
<li><p>Can we improve our analysis?</p></li>
<li><p>Each city and age group has a different population size.</p></li>
<li><p>If we model expected counts without accounting for population size,
we may just be picking up effects of population distribution by age.</p></li>
<li><p>Accounting for population size can refine our analysis.</p></li>
<li><p>The distribution of population sizes appears bimodal.</p></li>
<li><p>The population sizes range from a minimum of <span class="math inline">\(509\)</span> to a miximum of
<span class="math inline">\(3,142\)</span> people.</p>
<p><img src="glm/dist.jpg" style="width:60.0%" /></p></li>
<li><p>So far, we have modeled expected counts for each population group,
within the <span class="math inline">\(4\)</span> year period of time: <span class="math display">\[Rate=Counts/4years\]</span></p></li>
<li><p>It may be more intersting to know the rate per person, per <span class="math inline">\(4\)</span> year
period of time:
<span class="math display">\[Rate=\frac{Counts/Population\ size}{4\ years} = \frac{Counts}{4\ person-years}\]</span></p></li>
<li><p>Even better, we can get the rate per person year as:
<span class="math display">\[Rate=\frac{Counts/4\ Population\ size}{4\ years} = \frac{Counts}{person-years}\]</span></p></li>
<li><p>Here, <span class="math inline">\(4\cdot Population\ size\)</span> is equal to the number of
person-years that we observed to obtain each count.</p></li>
<li><p>We can think of the person years at the denominator to be used to
caculate the cancer rate per person, per year.</p></li>
<li><p>If we prefer the cancer rate per <span class="math inline">\(100\)</span> person-years, we can just
multiply the rate per person-year by <span class="math inline">\(100\)</span>.</p></li>
<li><p>Suppose we are told that <span class="math inline">\(100,000\)</span> new cases of HIV were reported in
the world, during the past three years.</p></li>
<li><p>What is the incidence rate of HIV?</p></li>
<li><p>We can calculate incidence as:</p></li>
</ul>
<p><span class="math display">\[\frac{Number\ of\ new\ cases}{Number\ of\ people\ observed \cdot Amount\ of\ time\ observed}
\]</span></p>
<p><span class="math display">\[
               = \frac{100,000\ cases}{6,000,000,000\ people\ in\ the\ world \cdot 3\ years\ of\ observation}
               \]</span></p>
<p><span class="math display">\[
                = 5.55 \times 10^{-6} \ cases / person - year
            \]</span></p>
<p><span class="math display">\[
                = 5.55\ cases/ 1,000,000\ person - years
           \]</span></p>
<p>Based on this incidence rate, we could say
that each year, there are about <span class="math inline">\(5.55\)</span> new cases of HIV per
<span class="math inline">\(1,000,000\)</span> people per year.</p>
<ul>
<li><p>So far, we have written a model for the expected number of counts
over the <span class="math inline">\(4\)</span> year period of observation.</p></li>
<li><p>However, if we know that the total populations generating our counts
differ substantially, it does not make sense to write a log-linear
model to consider expected counts direct.</p></li>
<li><p>What we really wnat is to consider, the rate per person year
<span class="math display">\[r_i = \frac{\lambda_i } {Pop_i}=\frac{E(count_i )}{Pop_i}\]</span> and
model that by a log-linear model.</p></li>
<li><p>Based on this model, we can still say:
<span class="math display">\[Y_i \sim Poisson(\lambda_i )=Poisson(r_i \cdot Pop_i)\]</span></p></li>
<li><p>On a log scale, our model will be:
<span class="math display">\[\log(r_{i})=\log(\frac{\lambda_i}{Pop_i} )=\beta_0 +\beta_1
I(Age55-59_i)+\beta_2 I(Age60-64_i)
\]</span></p></li>
</ul>
<p><span class="math display">\[
                +\beta_3 I(Age65-69_i)+\beta_4 I(Age70-74_i)+\beta_5 I(Age&gt;74_i)
\]</span></p>
<ul>
<li>Exponentiating, we get:
<span class="math display">\[\frac{\lambda_i}{Pop_i} = exp\{ \beta_0 +\beta_1 I(Age55-59_i)+\beta_2 I(Age60-64_i)
\]</span></li>
</ul>
<p><span class="math display">\[+\beta_3 I(Age65-69_i)+\beta_4 I(Age70-74_i)+\beta_5 I(Age&gt;74_i) \}
      \]</span></p>
<ul>
<li><p>Divide the <span class="math inline">\(\lambda_i\)</span>s by the population size that yielded each
count to get rates "per <span class="math inline">\(4\)</span> person-years".</p></li>
<li><p>Now that we have a model of rates per <span class="math inline">\(4\)</span> person-years, we can
divide by <span class="math inline">\(4\)</span> to get rate per person-year.</p></li>
<li><p>We can then multiply by <span class="math inline">\(10,000\)</span> to get rates per <span class="math inline">\(10,000\)</span>
person-years (maybe easier to interpret than person-years).</p></li>
<li><p>Dividing by 4 and multiplying by <span class="math inline">\(10,000\)</span> is the same as multiplying
by <span class="math inline">\(2500\)</span>:</p></li>
<li><p>Exponentiating, we get:
<span class="math display">\[\frac{\lambda_i}{Pop_i/2500} = exp\{ \beta_0 +\beta_1 I(Age55-59_i)+\beta_2 I(Age60-64_i)
\]</span></p></li>
</ul>
<p><span class="math display">\[
                +\beta_3 I(Age65-69_i)+\beta_4 I(Age70-74_i)+\beta_5 I(Age&gt;74_i) \}
           \]</span></p>
<ul>
<li>Finally, we should take a log-transform to get back our log-linear
model:</li>
</ul>
<p><span class="math display">\[\log(\frac{\lambda_i}{Pop_i /2500} )
                =\beta_0 +\beta_1 I(Age55-59_i)+\beta_2 I(Age60-64_i)
\]</span></p>
<p><span class="math display">\[
                +\beta_3 I(Age65-69_i)+\beta_4 I(Age70-74_i)+\beta_5 I(Age&gt;74_i)
\]</span></p>
<ul>
<li>Further, we can move the population denominator to the other size of
the equation:</li>
</ul>
<p><span class="math display">\[\log(\lambda_i )
                = \log(Pop_i/2500) + \beta_0 +\beta_1 I(Age55-59_i)+\beta_2 I(Age60-64_i)
\]</span></p>
<p><span class="math display">\[
                +\beta_3 I(Age65-69_i)+\beta_4 I(Age70-74_i)+\beta_5 I(Age&gt;74_i)
\]</span></p>
<ul>
<li><p>Here, we call the amount <span class="math inline">\(\log(Pop_i/2500)\)</span> the <strong>offset</strong>.</p></li>
<li><p>using the offset is just a way of accounting for population sizes,
which could vary by age, region, etc.</p></li>
<li><p>The term "offset" is jargon for predictor terms whose <span class="math inline">\(\beta\)</span>
coefficient is forced to be <span class="math inline">\(+1\)</span>.</p></li>
<li><p>Using an offset gives us a convenient way to model rates per
person-years, instead of just modeling the raw counts.</p></li>
<li><p>If all the observations have the same exposure, the model does not
need an offset term and we can model <span class="math inline">\(\log(\lambda_i)\)</span> directly.</p>
<p><img src="glm/result2.jpg" style="width:90.0%" /></p></li>
<li><p>After including the offset in our model, we need to change our
regression coefficient interpretations a bit.</p></li>
<li><p>We should think of the outcome as <span class="math inline">\(\log(\lambda_i)-\text{offset}_i\)</span>.</p></li>
<li><p>In this case, <span class="math inline">\(\lambda_i\)</span> was the expected number of cases observed
in a particular age group and city, within a <span class="math inline">\(4\)</span> year period of
time.</p></li>
<li><p>Our offset was <span class="math inline">\(\log(Pop_i/2500)\)</span>.</p></li>
<li><p>So, we should think of the outcome as log rate per <span class="math inline">\(10,000\)</span> person
years.</p></li>
<li><p><span class="math inline">\(\beta_0\)</span> is the log rate of cancer cases per <span class="math inline">\(10,000\)</span> person years
in the baseline age group of <span class="math inline">\(40-54\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> is the log relative rate of cancer cases per <span class="math inline">\(10,000\)</span>
person years comparing the age group <span class="math inline">\(55-59\)</span> to the baseline age
group <span class="math inline">\(40-54\)</span>.</p></li>
<li><p><span class="math inline">\(\beta_2\)</span> is the log relative rate of cancer cases per <span class="math inline">\(10,000\)</span>
person years comparing the age group <span class="math inline">\(60-64\)</span> to the baseline age
group <span class="math inline">\(40-54\)</span>.</p></li>
<li><p>Before we put the offset in our model, none of our regression
coefficients were statistically significant.</p></li>
<li><p><span class="math inline">\(\Rightarrow\)</span> without the offset, there was no statistically
sifnificant difference in the expected counts per year at age group
compared to the baseline <span class="math inline">\(40-54\)</span> group.</p></li>
<li><p>After including the offset, we’re looking for differences in the
expected counts per person-year, across age groups.</p></li>
<li><p>Let’s perform a likelihood ratio test to look at the global
hypothesis:
<span class="math display">\[H_0 : \beta_1 = \beta_2 = \beta_3 = \beta_4 =\beta_5 =0\]</span> versus
the alternative hypothesis:
<span class="math display">\[H_a : \text{at least one of the } \beta_i \text{&#39;s is not } 0, \text{for } i\in 1,\ldots,5\]</span></p></li>
<li><p>Test statistic:</p></li>
<li><p>TS = -2(logLik(intercept only, with offset)-logLik(Age model with
offset)) = 101.6 <span class="math inline">\(\sim \chi_5^2\)</span></p></li>
<li><p>Critical value for the hypothesis at level <span class="math inline">\(\alpha=0.05\)</span>:
<span class="math inline">\(\chi_{5,0.05}^2 = 11.07\)</span>. reject the null hypothesis.</p></li>
<li><p>Model</p></li>
</ul>
<p><span class="math display">\[\log(\lambda_i )
                = \log(Pop_i/2500) + \beta_0 +\beta_1 I(Age55-59_i)+\beta_2 I(Age60-64_i)
                \]</span></p>
<p><span class="math display">\[
                +\beta_3 I(Age65-69_i)+\beta_4 I(Age70-74_i)+\beta_5 I(Age&gt;74_i)
\]</span></p>
<ul>
<li><p>Predicted log rate of cancer per <span class="math inline">\(10,000\)</span> person years among <span class="math inline">\(40-54\)</span>
year olds; <span class="math display">\[\hat{\beta}_0=1.96\]</span></p></li>
<li><p>Predicted rate of cancer per <span class="math inline">\(10,000\)</span> person years among <span class="math inline">\(40-54\)</span>
year olds; <span class="math display">\[exp(\hat{\beta}_0)=exp(1.96)=7.09\]</span></p></li>
<li><p>Based on this model, we predict <span class="math inline">\(7.09\)</span> new cases of lung cancer per
<span class="math inline">\(10,000\)</span> <span class="math inline">\(40-54\)</span> year olds in Denmark, per year.</p></li>
<li><p>Predicted log rate of cancer per <span class="math inline">\(10,000\)</span> person years among <span class="math inline">\(55-59\)</span>
year olds; <span class="math display">\[\hat{\beta}_0 + \hat{\beta}_1=3.04\]</span></p></li>
<li><p>Predicted rate of cancer per <span class="math inline">\(10,000\)</span> person years among <span class="math inline">\(55-59\)</span>
year olds;
<span class="math display">\[exp(\hat{\beta}_0 + \hat{\beta}_1)=exp(1.96+1.08)=20.9\]</span></p></li>
<li><p>Based on this model, we predict <span class="math inline">\(20.9\)</span> new cases of lung cancer per
<span class="math inline">\(10,000\)</span> <span class="math inline">\(55-59\)</span> year olds in Denmark, per year.</p></li>
<li><p>We predicted an incidence rate of <span class="math inline">\(7.09\)</span> cases per <span class="math inline">\(10,000\)</span> per year
among <span class="math inline">\(40-54\)</span> year olds, and a rate of <span class="math inline">\(20.9\)</span> new cases per <span class="math inline">\(10,000\)</span>
person years for <span class="math inline">\(55-59\)</span> years olds.</p></li>
<li><p><span class="math inline">\(\Rightarrow\)</span> The relative rate per <span class="math inline">\(10,000\)</span> person years comparing
<span class="math inline">\(55-59\)</span> years olds to <span class="math inline">\(40-54\)</span> years olds is
<span class="math inline">\(20.9/7.09 \approx 2.94\)</span>.</p></li>
<li><p>We could have gotten the same answer by taking
<span class="math inline">\(exp(\hat{\beta}_1)=exp(1.08)=2.94\)</span>.</p></li>
<li><p><span class="math inline">\(exp(\hat{\beta}_1)\)</span> is the relative rate cancer cases per <span class="math inline">\(10,000\)</span>
person years comparing <span class="math inline">\(55-59\)</span> years olds to <span class="math inline">\(40-54\)</span> years olds.</p></li>
<li><p><span class="math inline">\(\hat{\beta}_1\)</span> is the log relative rate.</p></li>
<li><p>There is an increasing trend in relative rates compared to the
baseline <span class="math inline">\(40-54\)</span> year old group as age increases.</p></li>
<li><p>The only exception for this trend is for the <span class="math inline">\(Age&gt;74\)</span> group.</p></li>
<li><p>The model fit matches what we know from biology: the risk of cancer
does increase with age, but trails of for the oldest individuals
perhaps because</p></li>
<li><p>Those surviving to age <span class="math inline">\(74\)</span> and beyond have genes which protect
against cancer.</p></li>
<li><p>Cell growth slows down at older ages, slowing the growth of
tumors.</p></li>
<li><p>The purpose of an offset is the change the denominator or units of a
rate.</p></li>
<li><p>Often, the model without an offset does not make much sense, and
likely fails our Poisson assumptions.</p></li>
<li><p>We should always try to use an offset if we suspect that the
underlying population sizes differ for each of the observed counts.</p></li>
<li><p>Typically the offset will take value <span class="math inline">\(\log(N)\)</span> where <span class="math inline">\(N\)</span> is the
sample size, or the number of person-years.</p></li>
<li><p>If the underlying population sizes are not available, we just have
to do our best - but be careful about applying the Poisson model.</p></li>
<li><p>Log-linear models can be a good way to approach count data.</p></li>
<li><p>If population sizes or denominators are available, it’s a good idea
to include an offset.</p></li>
<li><p>Log-linear models can also be useful in analyzing binary data from
cohort studies, but with care.</p></li>
</ul>
<p><br></p>
<p><br></p>
<!-------------------------------------->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chapter4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Chapter6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Bio-Health Data Analysis.pdf", "Bio-Health Data Analysis.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
