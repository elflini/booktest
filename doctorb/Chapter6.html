<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 연속형 변수의 선형관계 추정 | 닥터배의 술술 보건의학통계</title>
  <meta name="description" content="(그림으로 이해하는) 닥터배의 술술 보건의학통계" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 연속형 변수의 선형관계 추정 | 닥터배의 술술 보건의학통계" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="(그림으로 이해하는) 닥터배의 술술 보건의학통계" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 연속형 변수의 선형관계 추정 | 닥터배의 술술 보건의학통계" />
  
  <meta name="twitter:description" content="(그림으로 이해하는) 닥터배의 술술 보건의학통계" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2022-10-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Chapter5.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">닥터배의 술술 보건의학통계</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="Chapter1.html"><a href="Chapter1.html"><i class="fa fa-check"></i><b>1</b> 꼭 알아야 할 여덟가지</a>
<ul>
<li class="chapter" data-level="1.1" data-path="Chapter1.html"><a href="Chapter1.html#자료의-분류"><i class="fa fa-check"></i><b>1.1</b> 자료의 분류</a></li>
<li class="chapter" data-level="1.2" data-path="Chapter1.html"><a href="Chapter1.html#가설을-검정하는-방법"><i class="fa fa-check"></i><b>1.2</b> 가설을 검정하는 방법</a></li>
<li class="chapter" data-level="1.3" data-path="Chapter1.html"><a href="Chapter1.html#유의수준과-다중비교"><i class="fa fa-check"></i><b>1.3</b> 5% 유의수준과 다중비교</a></li>
<li class="chapter" data-level="1.4" data-path="Chapter1.html"><a href="Chapter1.html#자유도"><i class="fa fa-check"></i><b>1.4</b> 자유도</a></li>
<li class="chapter" data-level="1.5" data-path="Chapter1.html"><a href="Chapter1.html#분포와-검정통계량"><i class="fa fa-check"></i><b>1.5</b> 분포와 검정통계량</a></li>
<li class="chapter" data-level="1.6" data-path="Chapter1.html"><a href="Chapter1.html#중심극한정리"><i class="fa fa-check"></i><b>1.6</b> 중심극한정리</a></li>
<li class="chapter" data-level="1.7" data-path="Chapter1.html"><a href="Chapter1.html#모수적-방법과-비모수적-방법"><i class="fa fa-check"></i><b>1.7</b> 모수적 방법과 비모수적 방법</a></li>
<li class="chapter" data-level="1.8" data-path="Chapter1.html"><a href="Chapter1.html#자료의-탐색-및-정규성-검정"><i class="fa fa-check"></i><b>1.8</b> 자료의 탐색 및 정규성 검정</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Chapter2.html"><a href="Chapter2.html"><i class="fa fa-check"></i><b>2</b> 두 군의 크기 비교</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Chapter2.html"><a href="Chapter2.html#독립표본-t-검정"><i class="fa fa-check"></i><b>2.1</b> 독립표본 T 검정</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="Chapter2.html"><a href="Chapter2.html#정규성-검정-1"><i class="fa fa-check"></i><b>2.1.1</b> 정규성 검정</a></li>
<li class="chapter" data-level="2.1.2" data-path="Chapter2.html"><a href="Chapter2.html#등분산성-검정"><i class="fa fa-check"></i><b>2.1.2</b> 등분산성 검정</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="Chapter2.html"><a href="Chapter2.html#mann-whitney-test"><i class="fa fa-check"></i><b>2.2</b> Mann-Whitney test</a></li>
<li class="chapter" data-level="2.3" data-path="Chapter2.html"><a href="Chapter2.html#r-예제"><i class="fa fa-check"></i><b>2.3</b> R 예제</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="Chapter2.html"><a href="Chapter2.html#t-test"><i class="fa fa-check"></i><b>2.3.1</b> t-test</a></li>
<li class="chapter" data-level="2.3.2" data-path="Chapter2.html"><a href="Chapter2.html#wilcoxon-rank-sum-test"><i class="fa fa-check"></i><b>2.3.2</b> Wilcoxon rank sum test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Chapter3.html"><a href="Chapter3.html"><i class="fa fa-check"></i><b>3</b> 치료 전과 후의 크기 비교</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Chapter3.html"><a href="Chapter3.html#대응표본-t-검정"><i class="fa fa-check"></i><b>3.1</b> 대응표본 T 검정</a></li>
<li class="chapter" data-level="3.2" data-path="Chapter3.html"><a href="Chapter3.html#wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>3.2</b> Wilcoxon signed rank test</a></li>
<li class="chapter" data-level="3.3" data-path="Chapter3.html"><a href="Chapter3.html#r-예제-1"><i class="fa fa-check"></i><b>3.3</b> R 예제</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="Chapter3.html"><a href="Chapter3.html#paired-t-test"><i class="fa fa-check"></i><b>3.3.1</b> Paired t-test</a></li>
<li class="chapter" data-level="3.3.2" data-path="Chapter3.html"><a href="Chapter3.html#wilcoxon-signed-rank-test-1"><i class="fa fa-check"></i><b>3.3.2</b> Wilcoxon signed rank test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Chapter4.html"><a href="Chapter4.html"><i class="fa fa-check"></i><b>4</b> 세 군 이상의 크기 비교</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Chapter4.html"><a href="Chapter4.html#일원배치-분산분석-anova"><i class="fa fa-check"></i><b>4.1</b> 일원배치 분산분석 (ANOVA)</a></li>
<li class="chapter" data-level="4.2" data-path="Chapter4.html"><a href="Chapter4.html#kruskal-wallis-test"><i class="fa fa-check"></i><b>4.2</b> Kruskal-Wallis test</a></li>
<li class="chapter" data-level="4.3" data-path="Chapter4.html"><a href="Chapter4.html#r-예제-2"><i class="fa fa-check"></i><b>4.3</b> R 예제</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="Chapter4.html"><a href="Chapter4.html#anova"><i class="fa fa-check"></i><b>4.3.1</b> ANOVA</a></li>
<li class="chapter" data-level="4.3.2" data-path="Chapter4.html"><a href="Chapter4.html#kruskal-wallis-test-1"><i class="fa fa-check"></i><b>4.3.2</b> Kruskal-Wallis test</a></li>
<li class="chapter" data-level="4.3.3" data-path="Chapter4.html"><a href="Chapter4.html#jonckheere-terpstra-test"><i class="fa fa-check"></i><b>4.3.3</b> Jonckheere-Terpstra test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Chapter5.html"><a href="Chapter5.html"><i class="fa fa-check"></i><b>5</b> 비율을 비교하는 방법</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Chapter5.html"><a href="Chapter5.html#범주형-변수에-대한-접근"><i class="fa fa-check"></i><b>5.1</b> 범주형 변수에 대한 접근</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="Chapter5.html"><a href="Chapter5.html#두-범주형-자료의-연관성"><i class="fa fa-check"></i><b>5.1.1</b> 두 범주형 자료의 연관성</a></li>
<li class="chapter" data-level="5.1.2" data-path="Chapter5.html"><a href="Chapter5.html#교차분석"><i class="fa fa-check"></i><b>5.1.2</b> 교차분석</a></li>
<li class="chapter" data-level="5.1.3" data-path="Chapter5.html"><a href="Chapter5.html#fisher의-정확한-검정"><i class="fa fa-check"></i><b>5.1.3</b> Fisher의 정확한 검정</a></li>
<li class="chapter" data-level="5.1.4" data-path="Chapter5.html"><a href="Chapter5.html#선형-대-선형-결합linear-by-linear-association"><i class="fa fa-check"></i><b>5.1.4</b> 선형 대 선형 결합(linear by linear association)</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Chapter5.html"><a href="Chapter5.html#r-예제-3"><i class="fa fa-check"></i><b>5.2</b> R 예제</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="Chapter5.html"><a href="Chapter5.html#카이제곱-검정"><i class="fa fa-check"></i><b>5.2.1</b> 카이제곱 검정</a></li>
<li class="chapter" data-level="5.2.2" data-path="Chapter5.html"><a href="Chapter5.html#fisher의-정확-검정"><i class="fa fa-check"></i><b>5.2.2</b> Fisher의 정확 검정</a></li>
<li class="chapter" data-level="5.2.3" data-path="Chapter5.html"><a href="Chapter5.html#cochran-armitage-trend-test"><i class="fa fa-check"></i><b>5.2.3</b> Cochran Armitage trend test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Chapter6.html"><a href="Chapter6.html"><i class="fa fa-check"></i><b>6</b> 연속형 변수의 선형관계 추정</a>
<ul>
<li class="chapter" data-level="6.1" data-path="Chapter6.html"><a href="Chapter6.html#상관분석correlation-analysis"><i class="fa fa-check"></i><b>6.1</b> 상관분석(Correlation analysis)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="Chapter6.html"><a href="Chapter6.html#상관분석"><i class="fa fa-check"></i><b>6.1.1</b> 상관분석</a></li>
<li class="chapter" data-level="6.1.2" data-path="Chapter6.html"><a href="Chapter6.html#spearman의-순위상관분석비모수적-방법"><i class="fa fa-check"></i><b>6.1.2</b> Spearman의 순위상관분석(비모수적 방법)</a></li>
<li class="chapter" data-level="6.1.3" data-path="Chapter6.html"><a href="Chapter6.html#r-예제-4"><i class="fa fa-check"></i><b>6.1.3</b> R 예제</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="Chapter6.html"><a href="Chapter6.html#회귀분석regression-analysis"><i class="fa fa-check"></i><b>6.2</b> 회귀분석(Regression analysis)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="Chapter6.html"><a href="Chapter6.html#단순회귀분석simple-regression-analysis"><i class="fa fa-check"></i><b>6.2.1</b> 단순회귀분석(simple regression analysis)</a></li>
<li class="chapter" data-level="6.2.2" data-path="Chapter6.html"><a href="Chapter6.html#다중회귀분석"><i class="fa fa-check"></i><b>6.2.2</b> 다중회귀분석</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">닥터배의 술술 보건의학통계</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Chapter6" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> 연속형 변수의 선형관계 추정<a href="Chapter6.html#Chapter6" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ul>
<li><p>상관분석과 회귀분석의 의미</p>
<ol style="list-style-type: decimal">
<li><p>상관분석: 두 변수들 사이의 선형적 상관관계의 정도를 보는 것</p></li>
<li><p>회귀분석: 회귀식을 구하여 독립변수(<span class="math inline">\(x\)</span>)를 통해 종속변수 <span class="math inline">\(y\)</span>의 값을 예측하는 것</p></li>
</ol></li>
</ul>
<p><span class="math display">\[
y=\beta_0 + \beta_1 x_1 + \cdots + \beta_p x_p
\]</span></p>
<div id="상관분석correlation-analysis" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 상관분석(Correlation analysis)<a href="Chapter6.html#상관분석correlation-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="상관분석" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> 상관분석<a href="Chapter6.html#상관분석" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>수치형 변수들 간 선형적 연관성을 분석</li>
<li>상관관계를 인과성으로 결론짓지 않도록 주의!</li>
</ul>
<ol style="list-style-type: decimal">
<li>모수적 상관분석(pearson’s r)
<ul>
<li>두 연속형 자료 중 적어도 한 개는 정규성을 갖는다는 가정을 전제(표본크기가 30 이상이라면 중심극한정리에 의해 정규성 검정 없이도 모수적 상관분석 가능)</li>
</ul></li>
<li>비모수적 상관분석(Spearman’s rho(<span class="math inline">\(\rho\)</span>), Keandall’s tau(<span class="math inline">\(\tau\)</span>)-b)
<ul>
<li>표본크기가 작고 정규분포를 가정할 수 없는 연속형 자료인 경우, 순위 척도를 분석에 포함하는 경우</li>
</ul></li>
</ol>
<div id="pearson의-상관분석모수적-방법" class="section level5 unnumbered hasAnchor">
<h5>Pearson의 상관분석(모수적 방법)<a href="Chapter6.html#pearson의-상관분석모수적-방법" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ul>
<li>가설
<ul>
<li>귀무가설: 두 변수는 선형의 관계가 없다(<span class="math inline">\(r=0\)</span>)</li>
<li>대립가설: 두 변수는 선형의 관계가 있다(<span class="math inline">\(r \ne 0\)</span>)</li>
</ul></li>
<li>Pearson의 상관계수: -1 ~ 1 사이의 값
<ul>
<li><p><span class="math inline">\(r=1\)</span> or <span class="math inline">\(r=1\)</span>: 한 변수를 알 때 다른 변수의 값을 100% 정확히 알 수 있음을 의미(<span class="math inline">\(r\)</span>이 0에 가까울수록 두 변수의 관계는 선형적인 관계가 없다고 해석)</p></li>
<li><p>상관계수(<span class="math inline">\(r\)</span>) <span class="math inline">\(\ne\)</span> 직선의 기울기(<span class="math inline">\(r\)</span>은 오로지 상관의 정도만 의미)</p></li>
<li><p><span class="math inline">\(r=1\)</span> 이더라도 실제 기울기가 작으면 <span class="math inline">\(x\)</span> 변수가 <span class="math inline">\(y\)</span> 변수에 대해 큰 영향을 미친다고 보기는 어려움</p></li>
</ul></li>
</ul>
<p><img src="fig6/f1.png" /></p>
<p><br></p>
<ul>
<li>설명력 <span class="math inline">\(r^2\)</span>
<ul>
<li>두 변수 사이의 선형 관계의 정도를 설명</li>
</ul></li>
</ul>
<p><img src="fig6/f2.png" /></p>
<p><br></p>
<ul>
<li>편상관분석
<ul>
<li>관심을 갖는 두 변수 외 나머지 변수들이 모두 동일한 값으로 통제(adjusted)되었다고 가정하여, 두 변수 사이의 순수한 연관성의 정도를 평가</li>
<li>예시: 허리둘레와 혈압은 서로 64%정도 설명해 주지만, 나이에 의한 영향을 통제하였을 때 허리둘레와 혈압은 서로 25%를 설명하고 있다.</li>
</ul></li>
</ul>
<p><img src="fig6/f3.png" /></p>
<p><br></p>
<ul>
<li><p>허리둘레와 BMI의 상관분석 예시</p>
<ol style="list-style-type: decimal">
<li>그래프</li>
</ol></li>
</ul>
<p><img src="fig6/f4.png" /></p>
<ul>
<li><p>산점도를 통해 허리둘레의 BMI는 강한 양의 상관관계가 있을 것으로 보임</p>
<ol start="2" style="list-style-type: decimal">
<li>Pearson’s 상관계수</li>
</ol></li>
</ul>
<p><img src="fig6/f5.png" /></p>
<ul>
<li><p>허리둘레와 BMIㄴ의 상관계수 <span class="math inline">\(r=0.8\)</span>로 유의확률 <span class="math inline">\(p&lt;0.001\)</span>로 통계적으로 유의하게 연관을 보임</p>
<ol start="3" style="list-style-type: decimal">
<li>편상관계수</li>
</ol></li>
</ul>
<p><img src="fig6/f6.png" /></p>
<ul>
<li>몸무게가 일정하다고 할 때 허리둘레와 BMI의 편상관계수는 <span class="math inline">\(r=0.514\)</span>로 통계적으로 유의한 연관성이 있다고 말할 수 있음(<span class="math inline">\(p&lt;0.001\)</span>)</li>
</ul>
</div>
</div>
<div id="spearman의-순위상관분석비모수적-방법" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> Spearman의 순위상관분석(비모수적 방법)<a href="Chapter6.html#spearman의-순위상관분석비모수적-방법" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>표본수가 적고 정규성을 만족하지 않는 두 연속형 변수 혹은 순위척도 사이의 상관관계를 추정 및 검정
<ul>
<li>선형적 연관성 검정 X -&gt; “한 변수(X)가 증가할 때 다른 변수(Y)도 증가하는 경향이 있느냐”에 관한 상관성 검정</li>
</ul></li>
<li>짝지어진 두 변수(X,Y)를 각각 순위를 매긴 뒤 그 순위의 차를 통해 두 변수의 상관관계 검정
<ul>
<li>만약, 짝지어진 두 변수의 순서가 완전히 같다면 순위 차(d)는 모두 0이고 <span class="math inline">\(\rho=1\)</span></li>
</ul></li>
<li>가설의 형태
<ul>
<li>귀무가설: 두 변수는 독립이다.</li>
<li>대립 가설: 두 변수는 독립이 아니다(상관성이 있다)</li>
</ul></li>
</ul>
<p><img src="fig6/f7.png" /></p>
<p><br></p>
</div>
<div id="r-예제-4" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> R 예제<a href="Chapter6.html#r-예제-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="모수적-상관분석" class="section level4 unnumbered hasAnchor">
<h4>모수적 상관분석<a href="Chapter6.html#모수적-상관분석" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="패키지-설치-및-불러오기-1" class="section level4 hasAnchor" number="6.1.3.1">
<h4><span class="header-section-number">6.1.3.1</span> 패키지 설치 및 불러오기<a href="Chapter6.html#패키지-설치-및-불러오기-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="Chapter6.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;lattice&#39;)</span></span>
<span id="cb1-2"><a href="Chapter6.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span></code></pre></div>
</div>
<div id="파일불러오기-및-데이터-관찰" class="section level4 hasAnchor" number="6.1.3.2">
<h4><span class="header-section-number">6.1.3.2</span> 파일불러오기 및 데이터 관찰<a href="Chapter6.html#파일불러오기-및-데이터-관찰" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="Chapter6.html#cb2-1" aria-hidden="true" tabindex="-1"></a>healthdata<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&#39;data/6_correlation_and_regression.csv&#39;</span>, <span class="at">header=</span>T)</span>
<span id="cb2-2"><a href="Chapter6.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(healthdata)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    322 obs. of  6 variables:
##  $ age      : int  57 25 57 43 52 27 48 45 38 69 ...
##  $ height   : num  164 172 157 170 155 ...
##  $ weight   : num  62 54 59 87.8 50 76 53 72 65.8 56 ...
##  $ waistline: num  85 65 83 104 83 83 75 93 71 94 ...
##  $ BMI      : num  23.1 18.3 23.9 30.4 20.8 28.6 21.5 26.8 21.6 23.9 ...
##  $ SBP      : int  147 116 122 130 120 128 97 145 110 170 ...</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="Chapter6.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(healthdata)</span></code></pre></div>
</div>
<div id="산점도" class="section level4 hasAnchor" number="6.1.3.3">
<h4><span class="header-section-number">6.1.3.3</span> 산점도<a href="Chapter6.html#산점도" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="Chapter6.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb5-2"><a href="Chapter6.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(healthdata)</span></code></pre></div>
<p><img src="graph_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="상관분석-1" class="section level4 hasAnchor" number="6.1.3.4">
<h4><span class="header-section-number">6.1.3.4</span> 상관분석<a href="Chapter6.html#상관분석-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="Chapter6.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(healthdata, <span class="at">use=</span><span class="st">&quot;pairwise.complete.obs&quot;</span>) </span></code></pre></div>
<pre><code>##                   age      height      weight  waistline         BMI
## age        1.00000000 -0.47336360 -0.34049591 0.05003146 -0.05581894
## height    -0.47336360  1.00000000  0.58858828 0.16948372 -0.03486425
## weight    -0.34049591  0.58858828  1.00000000 0.75324679  0.78320296
## waistline  0.05003146  0.16948372  0.75324679 1.00000000  0.80066003
## BMI       -0.05581894 -0.03486425  0.78320296 0.80066003  1.00000000
## SBP        0.18612058 -0.16458514  0.06343363 0.20513749  0.21025032
##                   SBP
## age        0.18612058
## height    -0.16458514
## weight     0.06343363
## waistline  0.20513749
## BMI        0.21025032
## SBP        1.00000000</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="Chapter6.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(BMI,waistline)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  BMI and waistline
## t = 23.906, df = 320, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.7576655 0.8367351
## sample estimates:
##     cor 
## 0.80066</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="Chapter6.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(BMI,weight)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  BMI and weight
## t = 22.533, df = 320, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.7369932 0.8221252
## sample estimates:
##      cor 
## 0.783203</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="Chapter6.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(weight,waistline)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  weight and waistline
## t = 20.486, df = 320, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.7017200 0.7969347
## sample estimates:
##       cor 
## 0.7532468</code></pre>
</div>
<div id="체중영향을-통제한-허리둘레-bmi-편상관분석" class="section level4 hasAnchor" number="6.1.3.5">
<h4><span class="header-section-number">6.1.3.5</span> 체중영향을 통제한 허리둘레-BMI 편상관분석<a href="Chapter6.html#체중영향을-통제한-허리둘레-bmi-편상관분석" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="Chapter6.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;ppcor&#39;)</span></span>
<span id="cb14-2"><a href="Chapter6.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ppcor)</span></code></pre></div>
<pre><code>## 필요한 패키지를 로딩중입니다: MASS</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="Chapter6.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pcor.test</span>(waistline, BMI, weight)</span></code></pre></div>
<pre><code>##    estimate     p.value statistic   n gp  Method
## 1 0.5152468 3.64479e-23  10.73763 322  1 pearson</code></pre>
</div>
<div id="비모수적-상관분석" class="section level4 unnumbered hasAnchor">
<h4>비모수적 상관분석<a href="Chapter6.html#비모수적-상관분석" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="파일불러오기-및-데이터-관찰-1" class="section level4 hasAnchor" number="6.1.3.6">
<h4><span class="header-section-number">6.1.3.6</span> 파일불러오기 및 데이터 관찰<a href="Chapter6.html#파일불러오기-및-데이터-관찰-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="Chapter6.html#cb18-1" aria-hidden="true" tabindex="-1"></a>healthdata<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&#39;data/6_spearman.csv&#39;</span>, <span class="at">header=</span>T)</span>
<span id="cb18-2"><a href="Chapter6.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(healthdata)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    6 obs. of  2 variables:
##  $ Age: int  15 15 25 30 40 50
##  $ SBP: int  116 130 120 132 160 148</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="Chapter6.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(healthdata)</span></code></pre></div>
<pre><code>## The following object is masked from healthdata (pos = 5):
## 
##     SBP</code></pre>
</div>
<div id="상관분석-2" class="section level4 hasAnchor" number="6.1.3.7">
<h4><span class="header-section-number">6.1.3.7</span> 상관분석<a href="Chapter6.html#상관분석-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="Chapter6.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(healthdata, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>##          Age      SBP
## Age 1.000000 0.840668
## SBP 0.840668 1.000000</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="Chapter6.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(Age,SBP, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in cor.test.default(Age, SBP, method = &quot;spearman&quot;): Cannot compute exact
## p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  Age and SBP
## S = 5.5766, p-value = 0.03606
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##      rho 
## 0.840668</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="Chapter6.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(healthdata, <span class="at">use=</span><span class="st">&quot;complete.obs&quot;</span>, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>##           Age       SBP
## Age 1.0000000 0.6900656
## SBP 0.6900656 1.0000000</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="Chapter6.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(Age,SBP, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in cor.test.default(Age, SBP, method = &quot;kendall&quot;): Cannot compute exact
## p-value with ties</code></pre>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  Age and SBP
## z = 1.9127, p-value = 0.05578
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.6900656</code></pre>
<p><br></p>
</div>
</div>
</div>
<div id="회귀분석regression-analysis" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 회귀분석(Regression analysis)<a href="Chapter6.html#회귀분석regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>목적: 독립변수(X)와 종속변수(Y)가 선형의 관계에 있을 때, 선형회귀식을 추정 - 종속변수는 반드시 수치형 변수일 것</p></li>
<li><p>단순 회귀분석(simple regresison anlaysis): 단 하나의 독립변수</p></li>
</ul>
<p><span class="math display">\[
y=\beta_0 + \beta_1 x_1 +\epsilon
\]</span></p>
<p>여기서 <span class="math inline">\(\beta_0\)</span>: <span class="math inline">\(x=0\)</span>일때 <span class="math inline">\(y\)</span>의 평균, <span class="math inline">\(\beta_1\)</span>: <span class="math inline">\(x\)</span>의 값이 1단위 증가할 때 <span class="math inline">\(y\)</span>의 평균적인 증가량</p>
<ul>
<li>다중 회귀분석(multiple regression anlaysis): 여러 개의 독립변수</li>
</ul>
<p><span class="math display">\[
y=\beta_0 +\beta_1x_1 +\cdots +\beta_px_p
\]</span></p>
<ul>
<li>오차항 및 잔차의 의미
<ul>
<li>오차항(error): 모집단에서 실제값과 회귀선 사이의 차이</li>
<li>잔차(residual): 표본집단에서 관측값과 회귀선에 의한 예측값 사이의 차이</li>
<li>표본집단을 분석하는 회귀분석에서는 모집단의 오차항을 직접 관찰할 수 는 없으므로 잔차를 사용</li>
</ul></li>
</ul>
<p><img src="fig6/f8.png" /></p>
<p><br></p>
<ul>
<li><p>회귀모형에 대한 기본 가정</p>
<ol style="list-style-type: decimal">
<li>선형성: 독립변수(X)와 종속변수(Y)는 선형관계 - 산점도로 확인</li>
<li>오차항의 정규성: 모든 독립변수(X)의 값에서 종속변수(Y)는 정규분포를 이룸 - 정규 Q-Q 도표로 확인</li>
<li>오차항의 독립성: 개별 잔차들은 서로 독립 - 잔차산점도, Durbin-Watson 통계량으로 확인</li>
<li>오차항의 등분산: 모든 독립변수(X)의 값에서 종속변수(Y)는 등분산 - 잔차산점도로 확인</li>
</ol></li>
</ul>
<p><br></p>
<ul>
<li>선형성</li>
</ul>
<p><img src="fig6/f9.png" /></p>
<p><br></p>
<ul>
<li>오차항의 정규성</li>
</ul>
<p><img src="fig6/f10.png" /></p>
<p><br></p>
<ul>
<li>오차항의 독립성/등분산성</li>
</ul>
<p><img src="fig6/f11.png" /></p>
<p><br></p>
<ul>
<li>독립: 잔차들이 불규칙한 분포를 보임</li>
<li>등분산: 모든 독립변수(X)에 대해 잔차의 분산이 같음</li>
</ul>
<div id="단순회귀분석simple-regression-analysis" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> 단순회귀분석(simple regression analysis)<a href="Chapter6.html#단순회귀분석simple-regression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>단순회귀분석의 시행 - 분석 시행에 앞서 산점도로 선형관계를 먼저 확인</li>
</ul>
<ol style="list-style-type: decimal">
<li>Step 1: 회귀식(<span class="math inline">\(y=\alpha+\beta X\)</span>) 추정</li>
</ol>
<ul>
<li>최소제곱법: (잔차)<span class="math inline">\(^2\)</span>의 합이 최소가 되는 회귀식을 추정. (즉, <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>)</li>
</ul>
<p><img src="fig6/f12.png" /></p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li>Step 2: 결정계수 <span class="math inline">\(R^2\)</span>(회귀방정식의 설명력 평가)</li>
</ol>
<ul>
<li>종속변수(y)의 값을 <span class="math inline">\(y=\alpha+\beta X\)</span>의 회귀식으로 추정</li>
<li>실제 y값의 총변동: 1) 회귀식으로 설명 가능한 변동, 2) 그 외 설명되지 않는 변동(잔차에 의한 값)</li>
<li>결정계수(<span class="math inline">\(R^2\)</span>)가 클수록 회귀직선이 잘 추정되었다고 판단 가능</li>
</ul>
<p><img src="fig6/f13.png" /></p>
<p><br></p>
<ol start="3" style="list-style-type: decimal">
<li>Step 3: 회귀식(<span class="math inline">\(y=\alpha+\beta X\)</span>)의 통계적 유의성(적합도) 검정</li>
</ol>
<ul>
<li><p>분산분석표(F검정)를 이용하여 검정</p></li>
<li><p>가설</p>
<ul>
<li>귀무가설: 회귀모형(<span class="math inline">\(y=\alpha+\beta X\)</span>)으로 설명할 수 없다.</li>
<li>대립가설: 회귀모형(<span class="math inline">\(y=\alpha+\beta X\)</span>)으로 설명할 수 있다.</li>
</ul></li>
</ul>
<p><img src="fig6/f14.png" /></p>
<p><br></p>
<p><img src="fig6/f15.png" /></p>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li>Step 4: 회귀계수(<span class="math inline">\(\beta\)</span>)의 통계적 유의성 검정</li>
</ol>
<ul>
<li><span class="math inline">\(t\)</span> 분포를 이용하여 검정</li>
<li>단순회귀분석: 회귀식의 검정과 회귀계수의 검정이 실제로 같은 과정을 볼 수 있음</li>
<li>다중회귀분석: 회귀식의 유의성을 검정한 다음 개별 독립변수들의 회귀계수를 각각 검정</li>
</ul>
<p><img src="fig6/f16.png" /></p>
<p><br></p>
<ol start="5" style="list-style-type: decimal">
<li>Step 5: 회귀분석의 기본 가정 검정(오차항의 정규성, 독립성, 등분산성)</li>
</ol>
<p><img src="fig6/f17.png" /></p>
<div id="r-예제-5" class="section level4 hasAnchor" number="6.2.1.1">
<h4><span class="header-section-number">6.2.1.1</span> R 예제<a href="Chapter6.html#r-예제-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="단순회귀분석bmiwaistline" class="section level5 hasAnchor" number="6.2.1.1.1">
<h5><span class="header-section-number">6.2.1.1.1</span> 단순회귀분석(BMI~waistline)<a href="Chapter6.html#단순회귀분석bmiwaistline" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="Chapter6.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#파일불러오기 및 데이터 관찰 6_correlation_and_regression</span></span>
<span id="cb32-2"><a href="Chapter6.html#cb32-2" aria-hidden="true" tabindex="-1"></a>healthdata<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;data/6_correlation_and_regression.csv&quot;</span>)</span>
<span id="cb32-3"><a href="Chapter6.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(healthdata)</span></code></pre></div>
<pre><code>## The following object is masked from healthdata (pos = 3):
## 
##     SBP</code></pre>
<pre><code>## The following objects are masked from healthdata (pos = 6):
## 
##     age, BMI, height, SBP, waistline, weight</code></pre>
</div>
<div id="산점도선형관계-확인" class="section level5 hasAnchor" number="6.2.1.1.2">
<h5><span class="header-section-number">6.2.1.1.2</span> 산점도(선형관계 확인)<a href="Chapter6.html#산점도선형관계-확인" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="Chapter6.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(healthdata)</span></code></pre></div>
<p><img src="graph_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="회귀분석시행bmi-waistline" class="section level5 hasAnchor" number="6.2.1.1.3">
<h5><span class="header-section-number">6.2.1.1.3</span> 회귀분석시행(BMI~ waistline)<a href="Chapter6.html#회귀분석시행bmi-waistline" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="Chapter6.html#cb36-1" aria-hidden="true" tabindex="-1"></a>myresult<span class="ot">=</span><span class="fu">lm</span>(BMI<span class="sc">~</span>waistline)</span>
<span id="cb36-2"><a href="Chapter6.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(myresult)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = BMI ~ waistline)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -7.5197 -1.3087 -0.0444  1.2532 12.0683 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -3.97611    1.25481  -3.169  0.00168 ** 
## waistline    0.33135    0.01386  23.906  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.186 on 320 degrees of freedom
## Multiple R-squared:  0.6411, Adjusted R-squared:  0.6399 
## F-statistic: 571.5 on 1 and 320 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="Chapter6.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(myresult)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: BMI
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## waistline   1 2731.7 2731.67  571.51 &lt; 2.2e-16 ***
## Residuals 320 1529.5    4.78                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="Chapter6.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb40-2"><a href="Chapter6.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myresult)</span></code></pre></div>
<p><img src="graph_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p><br></p>
</div>
</div>
</div>
<div id="다중회귀분석" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> 다중회귀분석<a href="Chapter6.html#다중회귀분석" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>하나의 독립변수로 종속변수를 예측하기 어려우며 교란변수에 대한 고려 없이 종속변수와 독립변수를 1:1로 짝지어서 여러 개의 단순회귀식을 구하는 것은 의미가 없음</p></li>
<li><p>여러 독립변수 사이의 영향을 모두 함께 고려하여 종속변수를 설명하는 최적의 회귀모형을 하나의 식으로 추정하는 것을 다중회귀분석(multiple regression analysis) 혹은 중회귀분석이라 함</p></li>
<li><p>다중회귀분석의 목적</p></li>
</ul>
<p><img src="fig6/f18.png" /></p>
<p><br></p>
<ul>
<li>다중회귀분석의 형태</li>
</ul>
<p><span class="math display">\[
y_i =\beta_0 +\beta_1 x_{1i}+\beta_2 x_{2i} +\cdots +\beta_p x_{pi} + \epsilon_i, \,\,\, \epsilon_i \sim N(0, \sigma^2), \,\,\, i=1,\ldots ,n
\]</span></p>
<p><span class="math inline">\(\beta_0\)</span>: 절편(intercept), <span class="math inline">\(\beta_j, \,\,\, j=1,\ldots, p\)</span>: 설명변수에 대한 회귀 계수</p>
<ul>
<li>다중회귀분석의 가정
<ul>
<li>다중회귀분석은 기본적으로 단순회귀분석과 동일한 가정을 바탕으로 함</li>
</ul></li>
</ul>
<p><img src="fig6/f19.png" /></p>
<p><br></p>
<ul>
<li>다중회귀분석도 단순회귀분석과 동일한 절차에 의해 시행된다.</li>
</ul>
<p><img src="fig6/f20.png" /></p>
<p><br></p>
<ol style="list-style-type: decimal">
<li>Step 1: 회귀식의 추정</li>
</ol>
<ul>
<li>최소제곱법을 통해 잔차의 제곱 합을 최소화하는 회귀식을 설정함</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>Step 2: 수정된 결정계수 <span class="math inline">\(R^2_{adj}\)</span></li>
</ol>
<ul>
<li>일반적으로 <span class="math inline">\(R^2\)</span>이 클수록 회귀식은 높은 설명력을 가지지만, <span class="math inline">\(R^2\)</span>을 약간 증가시키기 위해 모든 독립변수를 추가시키는 것이 꼭 옳은 것은 아님</li>
<li>수정된 결정계수 <span class="math inline">\(R^2_{adj}\)</span>은 이런 점을 고려하여 <span class="math inline">\(R^2\)</span>을 표본의 크기와 독립변수의 수로써 조정한 것으로 <span class="math inline">\(R^2\)</span>보다 작은 값을 가짐</li>
<li>새로 포함되는 독립변수에 의한 추가적인 설명력이 경미한 경우에는 <span class="math inline">\(R^2\)</span>은 다소 증가하더라도 <span class="math inline">\(R^2_{adj}\)</span>은 오히려 감소할 수 있음</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Step 3: 회귀식의 유의성 검정</li>
</ol>
<p><img src="fig6/f21.png" /></p>
<p><br></p>
<ul>
<li>회귀식의 유의성은 단순회귀분석에서와 마찬가지로 F 검정을 이용하여 분산분석표로 표현됨</li>
</ul>
<p><img src="fig6/f22.png" /></p>
<p><br></p>
<ol start="4" style="list-style-type: decimal">
<li>Step 4: 회귀계수의 유의성 검정</li>
</ol>
<p><img src="fig6/f23.png" /></p>
<p><br></p>
<ul>
<li>전체 회귀식의 유의성이 검정되면 <span class="math inline">\(t\)</span> 분포를 통해 개별 독립변수의 회귀계수가 유의한지 검정하며 <span class="math inline">\(p&lt;0.05\)</span>일 때, 해당 독립변수가 종속변수에 유의한 영향을 미친다고 판단함</li>
</ul>
<div id="표준화-회귀계수standardized-beta-coefficient" class="section level4 unnumbered hasAnchor">
<h4>표준화 회귀계수(Standardized beta coefficient)<a href="Chapter6.html#표준화-회귀계수standardized-beta-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>회귀계수는 독립변수들의 단위에 크게 영향을 받기 때문에 회귀계수의 크기로 독립변수의 영향력을 직접 비교해서는 암됨</li>
<li>표준화 회귀계수는 독립변수들의 값들을 평균 0, 표준편차 1로 표준화해 계산해준 값으로 표준화 계수의 절대값을 비교한다면 가장 영향력이 큰 독립변수를 찾을 수 있음</li>
</ul>
</div>
<div id="회귀모형에-포함될-독립변수를-선택하는-방법" class="section level4 hasAnchor" number="6.2.2.1">
<h4><span class="header-section-number">6.2.2.1</span> 회귀모형에 포함될 독립변수를 선택하는 방법<a href="Chapter6.html#회귀모형에-포함될-독립변수를-선택하는-방법" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>입력</li>
</ol>
<ul>
<li>선택된 모든 변수를 모형에 입력하는 방법으로 독립변수들의 영향을 전체적으로 파악할 수 있음</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>전진선택법(forward selection)</li>
</ol>
<ul>
<li>회귀계수의 유의확률이 가장 낮은 변수를 먼저 모형에 넣고, 남은 변수들 가운데 모형에 추가하였을 때, 유의확률이 가장 낮은 변수를 순서대로 하나씩 더해나가는 방법</li>
<li>한번 선택된 변수는 절대로 제거되지 않는다는 단점이 있음</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>후진선택법(backward elimination)</li>
</ol>
<ul>
<li>모든 변수를 회귀모형에 넣은 상태에서 출발하여 유의확률이 높은 변수부터 순서대로 하나씩 제거하여 유의한 변수들만 남을때까지 제거를 계속하는 방법</li>
<li>한번 제외된 변수는 다시 선택되지 못한다는 단점이 있음</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>단계선택법(stepwise selection)</li>
</ol>
<ul>
<li>전진선택법과 후진선택법의 방법을 섞어 놓은 방법</li>
<li>독립변수가 하나도 포함되지 않은 모형으로부터 출발하여 모형에 변수가 추가되었을 때 회귀계수의 유의확률이 가장 낮은 변수부터 순서대로 모형에 진입함</li>
<li>새로운 변수가 진입될 때마다 모형 내 모든 독립변수들의 유의확률을 재평가하여 유의성이 떨어지는 변수가 있으면 제거하고 다시 모형 밖의 변수들 가운데 더 포함시킬 변수가 있는지 검토함</li>
</ul>
<p><img src="fig6/f24.png" /></p>
<p><br></p>
</div>
<div id="다중공선성" class="section level4 hasAnchor" number="6.2.2.2">
<h4><span class="header-section-number">6.2.2.2</span> 다중공선성<a href="Chapter6.html#다중공선성" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>다중공선성(multicollinearity): 독립변수들 간에 완전한 또는 거의 완전한 선형의 종속관계가 존재하는 것을 의미함</li>
<li>다중공선성이 있는 경우, 회귀계수 추정량의 분산이 매우 커지게 되어 회귀계수의 유의확률도 큰 폭으로 증가하게 되므로 임상적으로 의미가 더 크고, 종속변수와 관련성이 더 높은 변수를 하나만 선택하여 모형에 투입해야 함</li>
</ul>
<div id="공차한계와-분산팽창요인" class="section level5 unnumbered hasAnchor">
<h5>공차한계와 분산팽창요인<a href="Chapter6.html#공차한계와-분산팽창요인" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<ul>
<li>다중공선성이 있는 경우 각 변수들의 공차한계(tolerance)와 분산팽창요인(VIF)을 통해 파악할 수 있음</li>
</ul>
<p><img src="fig6/f25.png" /></p>
<ul>
<li><span class="math inline">\(R_k^2\)</span>은 회귀식의 독립변수 중 <span class="math inline">\(x_k\)</span>를 종ㅅ고변수로 하고, 나머지 변수들을 독립변수로 회귀분석을 수행했을 때의 결정계수를 의미하여 <span class="math inline">\(R_k^2\)</span>이 크다는 것은 다른 변수들에 의해 <span class="math inline">\(x_k\)</span>가 거의 설명되고 있음을 의미함</li>
</ul>
</div>
</div>
<div id="r-예제-6" class="section level4 hasAnchor" number="6.2.2.3">
<h4><span class="header-section-number">6.2.2.3</span> R 예제<a href="Chapter6.html#r-예제-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="자료입력-및-관찰" class="section level5 hasAnchor" number="6.2.2.3.1">
<h5><span class="header-section-number">6.2.2.3.1</span> 자료입력 및 관찰<a href="Chapter6.html#자료입력-및-관찰" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="Chapter6.html#cb41-1" aria-hidden="true" tabindex="-1"></a>healthdata <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/6_correlation_and_regression.csv&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb41-2"><a href="Chapter6.html#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="Chapter6.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(healthdata)</span></code></pre></div>
<pre><code>## The following objects are masked from healthdata (pos = 3):
## 
##     age, BMI, height, SBP, waistline, weight</code></pre>
<pre><code>## The following object is masked from healthdata (pos = 4):
## 
##     SBP</code></pre>
<pre><code>## The following objects are masked from healthdata (pos = 7):
## 
##     age, BMI, height, SBP, waistline, weight</code></pre>
</div>
<div id="모든-변수를-입력하여-다중회귀분석-시행" class="section level5 hasAnchor" number="6.2.2.3.2">
<h5><span class="header-section-number">6.2.2.3.2</span> 모든 변수를 입력하여 다중회귀분석 시행<a href="Chapter6.html#모든-변수를-입력하여-다중회귀분석-시행" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="Chapter6.html#cb45-1" aria-hidden="true" tabindex="-1"></a>model_all<span class="ot">=</span><span class="fu">lm</span>(SBP<span class="sc">~</span>., <span class="at">data=</span>healthdata)</span></code></pre></div>
</div>
<div id="정규성-검정-5" class="section level5 unnumbered hasAnchor">
<h5>정규성 검정<a href="Chapter6.html#정규성-검정-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="Chapter6.html#cb46-1" aria-hidden="true" tabindex="-1"></a>nor_all <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_all)</span>
<span id="cb46-2"><a href="Chapter6.html#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(nor_all)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  nor_all
## W = 0.9768, p-value = 4.582e-05</code></pre>
</div>
<div id="오차항의-독립성-등분산성-확인" class="section level5 unnumbered hasAnchor">
<h5>오차항의 독립성, 등분산성 확인<a href="Chapter6.html#오차항의-독립성-등분산성-확인" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="Chapter6.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb48-2"><a href="Chapter6.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_all)</span></code></pre></div>
<p><img src="graph_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="다중회귀분석의-결과-확인" class="section level5 unnumbered hasAnchor">
<h5>다중회귀분석의 결과 확인<a href="Chapter6.html#다중회귀분석의-결과-확인" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="Chapter6.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_all)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SBP ~ ., data = healthdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -43.449 -11.628  -1.081   9.635  64.919 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) -19.3598   141.9737  -0.136   0.8916  
## age           0.1899     0.1051   1.808   0.0716 .
## height        0.5913     0.8621   0.686   0.4933  
## weight       -1.0241     1.0141  -1.010   0.3133  
## waistline     0.3231     0.2206   1.465   0.1440  
## BMI           3.2248     2.7177   1.187   0.2363  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.06 on 316 degrees of freedom
## Multiple R-squared:  0.09673,    Adjusted R-squared:  0.08243 
## F-statistic: 6.768 on 5 and 316 DF,  p-value: 5.187e-06</code></pre>
</div>
<div id="후진선택법으로-다중회귀분석-시행" class="section level5 hasAnchor" number="6.2.2.3.3">
<h5><span class="header-section-number">6.2.2.3.3</span> 후진선택법으로 다중회귀분석 시행<a href="Chapter6.html#후진선택법으로-다중회귀분석-시행" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="Chapter6.html#cb51-1" aria-hidden="true" tabindex="-1"></a>model_backward<span class="ot">=</span><span class="fu">step</span>(<span class="fu">lm</span>(SBP<span class="sc">~</span>., <span class="at">data=</span>healthdata), healthdata, <span class="at">direction=</span><span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=1869.63
## SBP ~ age + height + weight + waistline + BMI
## 
##             Df Sum of Sq    RSS    AIC
## - height     1    153.53 103267 1868.1
## - weight     1    332.81 103446 1868.7
## - BMI        1    459.45 103573 1869.1
## &lt;none&gt;                   103113 1869.6
## - waistline  1    700.11 103813 1869.8
## - age        1   1066.16 104179 1870.9
## 
## Step:  AIC=1868.11
## SBP ~ age + weight + waistline + BMI
## 
##             Df Sum of Sq    RSS    AIC
## &lt;none&gt;                   103267 1868.1
## - waistline  1    673.29 103940 1868.2
## - age        1   1063.68 104330 1869.4
## - weight     1   1253.53 104520 1870.0
## - BMI        1   2310.05 105577 1873.2</code></pre>
</div>
<div id="정규성-검정-6" class="section level5 unnumbered hasAnchor">
<h5>정규성 검정<a href="Chapter6.html#정규성-검정-6" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="Chapter6.html#cb53-1" aria-hidden="true" tabindex="-1"></a>nor_backward <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_backward)</span>
<span id="cb53-2"><a href="Chapter6.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(nor_backward)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  nor_backward
## W = 0.97723, p-value = 5.509e-05</code></pre>
</div>
<div id="오차항의-독립성-등분산성-확인-1" class="section level5 unnumbered hasAnchor">
<h5>오차항의 독립성, 등분산성 확인<a href="Chapter6.html#오차항의-독립성-등분산성-확인-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="Chapter6.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb55-2"><a href="Chapter6.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_backward)</span></code></pre></div>
<p><img src="graph_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
<div id="다중회귀분석의-결과-확인-1" class="section level5 unnumbered hasAnchor">
<h5>다중회귀분석의 결과 확인<a href="Chapter6.html#다중회귀분석의-결과-확인-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="Chapter6.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_backward)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SBP ~ age + weight + waistline + BMI, data = healthdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -43.368 -11.600  -1.212   9.972  65.881 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  77.7238    11.1234   6.987 1.66e-11 ***
## age           0.1897     0.1050   1.807  0.07171 .  
## weight       -0.3387     0.1727  -1.962  0.05068 .  
## waistline     0.3166     0.2202   1.438  0.15152    
## BMI           1.3957     0.5241   2.663  0.00814 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.05 on 317 degrees of freedom
## Multiple R-squared:  0.09538,    Adjusted R-squared:  0.08397 
## F-statistic: 8.356 on 4 and 317 DF,  p-value: 2.028e-06</code></pre>
</div>
<div id="단계선택법으로-다중회귀분석-시행" class="section level5 hasAnchor" number="6.2.2.3.4">
<h5><span class="header-section-number">6.2.2.3.4</span> 단계선택법으로 다중회귀분석 시행<a href="Chapter6.html#단계선택법으로-다중회귀분석-시행" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="Chapter6.html#cb58-1" aria-hidden="true" tabindex="-1"></a>model_step<span class="ot">=</span><span class="fu">step</span>(<span class="fu">lm</span>(SBP<span class="sc">~</span>., <span class="at">data=</span>healthdata), healthdata, <span class="at">direction=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=1869.63
## SBP ~ age + height + weight + waistline + BMI
## 
##             Df Sum of Sq    RSS    AIC
## - height     1    153.53 103267 1868.1
## - weight     1    332.81 103446 1868.7
## - BMI        1    459.45 103573 1869.1
## &lt;none&gt;                   103113 1869.6
## - waistline  1    700.11 103813 1869.8
## - age        1   1066.16 104179 1870.9
## 
## Step:  AIC=1868.11
## SBP ~ age + weight + waistline + BMI
## 
##             Df Sum of Sq    RSS    AIC
## &lt;none&gt;                   103267 1868.1
## - waistline  1    673.29 103940 1868.2
## - age        1   1063.68 104330 1869.4
## - weight     1   1253.53 104520 1870.0
## - BMI        1   2310.05 105577 1873.2</code></pre>
</div>
<div id="정규성-검정-7" class="section level5 unnumbered hasAnchor">
<h5>정규성 검정<a href="Chapter6.html#정규성-검정-7" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="Chapter6.html#cb60-1" aria-hidden="true" tabindex="-1"></a>nor_step <span class="ot">&lt;-</span> <span class="fu">residuals</span>(model_backward)</span>
<span id="cb60-2"><a href="Chapter6.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(nor_step)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  nor_step
## W = 0.97723, p-value = 5.509e-05</code></pre>
</div>
<div id="오차항의-독립성-등분산성-확인-2" class="section level5 unnumbered hasAnchor">
<h5>오차항의 독립성, 등분산성 확인<a href="Chapter6.html#오차항의-독립성-등분산성-확인-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="Chapter6.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb62-2"><a href="Chapter6.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model_step)</span></code></pre></div>
<p><img src="graph_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="다중회귀분석의-결과-확인-2" class="section level5 unnumbered hasAnchor">
<h5>다중회귀분석의 결과 확인<a href="Chapter6.html#다중회귀분석의-결과-확인-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="Chapter6.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_step)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = SBP ~ age + weight + waistline + BMI, data = healthdata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -43.368 -11.600  -1.212   9.972  65.881 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  77.7238    11.1234   6.987 1.66e-11 ***
## age           0.1897     0.1050   1.807  0.07171 .  
## weight       -0.3387     0.1727  -1.962  0.05068 .  
## waistline     0.3166     0.2202   1.438  0.15152    
## BMI           1.3957     0.5241   2.663  0.00814 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 18.05 on 317 degrees of freedom
## Multiple R-squared:  0.09538,    Adjusted R-squared:  0.08397 
## F-statistic: 8.356 on 4 and 317 DF,  p-value: 2.028e-06</code></pre>
</div>
<div id="제거된-변수들의-기여도를-평가" class="section level5 unnumbered hasAnchor">
<h5>제거된 변수들의 기여도를 평가<a href="Chapter6.html#제거된-변수들의-기여도를-평가" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="Chapter6.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_all,model_step)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: SBP ~ age + height + weight + waistline + BMI
## Model 2: SBP ~ age + weight + waistline + BMI
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    316 103113                           
## 2    317 103267 -1   -153.53 0.4705 0.4933</code></pre>
</div>
<div id="최종회귀모형의-선택" class="section level5 unnumbered hasAnchor">
<h5>최종회귀모형의 선택<a href="Chapter6.html#최종회귀모형의-선택" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="Chapter6.html#cb67-1" aria-hidden="true" tabindex="-1"></a>model_final<span class="ot">=</span><span class="fu">lm</span>(SBP<span class="sc">~</span>age<span class="sc">+</span>height<span class="sc">+</span>waistline, <span class="at">data=</span>healthdata)</span></code></pre></div>
</div>
<div id="다중공선성-확인" class="section level5 unnumbered hasAnchor">
<h5>다중공선성 확인<a href="Chapter6.html#다중공선성-확인" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="Chapter6.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&#39;car&#39;)</span></span>
<span id="cb68-2"><a href="Chapter6.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code></pre></div>
<pre><code>## 필요한 패키지를 로딩중입니다: carData</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="Chapter6.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(model_final)</span></code></pre></div>
<pre><code>##       age    height waistline 
##  1.318465  1.354060  1.053288</code></pre>
<p><br></p>
<p><br></p>
<!------------ End -------------------->

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Chapter5.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["graph.pdf", "graph.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
