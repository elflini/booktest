<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Statistics and Health Data | Statistics for Health Data Science</title>
  <meta name="description" content="Lecture notes for Statistics for Health Data Science" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Statistics and Health Data | Statistics for Health Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Lecture notes for Statistics for Health Data Science" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Statistics and Health Data | Statistics for Health Data Science" />
  
  <meta name="twitter:description" content="Lecture notes for Statistics for Health Data Science" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2021-11-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="chapter2.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics for Health Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Statistics and Health Data</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#statistics-and-organic-statistics"><i class="fa fa-check"></i><b>1.2</b> Statistics and Organic Statistics</a></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#statistical-methods-and-models"><i class="fa fa-check"></i><b>1.3</b> Statistical Methods and Models</a></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#health-care-data"><i class="fa fa-check"></i><b>1.4</b> Health Care Data</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chapter1.html"><a href="chapter1.html#medical-claims"><i class="fa fa-check"></i><b>1.4.1</b> Medical Claims</a></li>
<li class="chapter" data-level="1.4.2" data-path="chapter1.html"><a href="chapter1.html#medical-records"><i class="fa fa-check"></i><b>1.4.2</b> Medical Records</a></li>
<li class="chapter" data-level="1.4.3" data-path="chapter1.html"><a href="chapter1.html#health-surveys"><i class="fa fa-check"></i><b>1.4.3</b> Health Surveys</a></li>
<li class="chapter" data-level="1.4.4" data-path="chapter1.html"><a href="chapter1.html#disease-registries"><i class="fa fa-check"></i><b>1.4.4</b> Disease Registries</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="chapter1.html"><a href="chapter1.html#outline-of-the-text"><i class="fa fa-check"></i><b>1.5</b> Outline of the Text</a></li>
<li class="chapter" data-level="1.6" data-path="chapter1.html"><a href="chapter1.html#software-and-data"><i class="fa fa-check"></i><b>1.6</b> Software and Data</a></li>
<li class="chapter" data-level="1.7" data-path="chapter1.html"><a href="chapter1.html#loading-meps-data"><i class="fa fa-check"></i><b>1.7</b> Loading MEPS data</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="chapter1.html"><a href="chapter1.html#data-loading"><i class="fa fa-check"></i><b>1.7.1</b> Data Loading</a></li>
<li class="chapter" data-level="1.7.2" data-path="chapter1.html"><a href="chapter1.html#visualize-histogram-of-total-expenditures"><i class="fa fa-check"></i><b>1.7.2</b> Visualize histogram of total expenditures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> Key Statistical Concepts</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#samples-and-populations"><i class="fa fa-check"></i><b>2.1</b> Samples and Populations</a></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#statistics-basics"><i class="fa fa-check"></i><b>2.2</b> Statistics Basics</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter2.html"><a href="chapter2.html#random-variables"><i class="fa fa-check"></i><b>2.2.1</b> Random Variables</a></li>
<li class="chapter" data-level="2.2.2" data-path="chapter2.html"><a href="chapter2.html#dependent-and-independent-variables"><i class="fa fa-check"></i><b>2.2.2</b> Dependent and Independent Variables</a></li>
<li class="chapter" data-level="2.2.3" data-path="chapter2.html"><a href="chapter2.html#statistical-distributions-and-their-summaries"><i class="fa fa-check"></i><b>2.2.3</b> Statistical Distributions and Their Summaries</a></li>
<li class="chapter" data-level="2.2.4" data-path="chapter2.html"><a href="chapter2.html#parameters-and-models"><i class="fa fa-check"></i><b>2.2.4</b> Parameters and Models</a></li>
<li class="chapter" data-level="2.2.5" data-path="chapter2.html"><a href="chapter2.html#estimation-and-inference"><i class="fa fa-check"></i><b>2.2.5</b> Estimation and Inference</a></li>
<li class="chapter" data-level="2.2.6" data-path="chapter2.html"><a href="chapter2.html#variation-and-standard-error"><i class="fa fa-check"></i><b>2.2.6</b> Variation and Standard Error</a></li>
<li class="chapter" data-level="2.2.7" data-path="chapter2.html"><a href="chapter2.html#conditional-and-marginal-means"><i class="fa fa-check"></i><b>2.2.7</b> Conditional and Marginal Means</a></li>
<li class="chapter" data-level="2.2.8" data-path="chapter2.html"><a href="chapter2.html#joint-and-mixture-distributions"><i class="fa fa-check"></i><b>2.2.8</b> Joint and Mixture Distributions</a></li>
<li class="chapter" data-level="2.2.9" data-path="chapter2.html"><a href="chapter2.html#pmf-plot"><i class="fa fa-check"></i><b>2.2.9</b> pmf plot</a></li>
<li class="chapter" data-level="2.2.10" data-path="chapter2.html"><a href="chapter2.html#comparison-with-simulated-value"><i class="fa fa-check"></i><b>2.2.10</b> comparison with simulated value</a></li>
<li class="chapter" data-level="2.2.11" data-path="chapter2.html"><a href="chapter2.html#the-poisson-and-negative-binomial-distributions-for-counts"><i class="fa fa-check"></i><b>2.2.11</b> The Poisson and Negative Binomial Distributions for Counts</a></li>
<li class="chapter" data-level="2.2.12" data-path="chapter2.html"><a href="chapter2.html#pmf-plot-1"><i class="fa fa-check"></i><b>2.2.12</b> pmf plot</a></li>
<li class="chapter" data-level="2.2.13" data-path="chapter2.html"><a href="chapter2.html#comparison-with-simulated-value-1"><i class="fa fa-check"></i><b>2.2.13</b> comparison with simulated value</a></li>
<li class="chapter" data-level="2.2.14" data-path="chapter2.html"><a href="chapter2.html#pdf-plot"><i class="fa fa-check"></i><b>2.2.14</b> pdf plot</a></li>
<li class="chapter" data-level="2.2.15" data-path="chapter2.html"><a href="chapter2.html#comparison-with-simulated-value-2"><i class="fa fa-check"></i><b>2.2.15</b> comparison with simulated value</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Regression Analysis</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="chapter3.html"><a href="chapter3.html#regression-to-estimate-the-effect-of-an-intervention"><i class="fa fa-check"></i><b>3.0.1</b> Regression to Estimate the Effect of an Intervention</a></li>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#linear-regression-estimation-and-interpretation"><i class="fa fa-check"></i><b>3.1</b> Linear Regression Estimation and Interpretation</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#model-selection-and-hypothesis-testing"><i class="fa fa-check"></i><b>3.2</b> Model Selection and Hypothesis Testing</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#checking-assumptions-about-the-random-part"><i class="fa fa-check"></i><b>3.3</b> Checking Assumptions About the Random Part</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter3.html"><a href="chapter3.html#추가자료_quantile-regression"><i class="fa fa-check"></i><b>3.3.1</b> 추가자료_Quantile regression</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter3.html"><a href="chapter3.html#추가자료_loess-lowess"><i class="fa fa-check"></i><b>3.3.2</b> 추가자료_Loess Lowess</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Health Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter1" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Statistics and Health Data</h1>
<!-- --------- Chapter 1 Statistics and health Data ------------------>
<p><strong>Why health data?</strong></p>
<ul>
<li><p>Costs of health care expenditures</p>
<p><code>-</code> US: over $3 trillion</p>
<p><code>-</code> Korea: about 154 trillion won</p></li>
<li><p>Adoption of Electronic Health Records (EHR) has increased <span class="math inline">\(9\times\)</span> in US since 2008.</p></li>
</ul>
<p><img src="fig/e1.1.png" /></p>
<ul>
<li>Large datasets</li>
</ul>
<p><img src="fig/e1.2.png" /></p>
<ul>
<li>Diversity of digital health data</li>
</ul>
<p><img src="fig/e1.3.png" /></p>
<ul>
<li>Standardization</li>
</ul>
<p><img src="fig/e1.4.png" /></p>
<ul>
<li>Standardization</li>
</ul>
<p><img src="fig/e1.5.png" /></p>
<p><strong>Types of Data</strong></p>
<ul>
<li><p>Demographics</p>
<p><code>-</code> Age, sex, socio-economic status, insurance type, language, religion, living situation, family structure, location, work, …</p></li>
<li><p>Vital signs</p>
<p><code>-</code> Weight, height, pulse, respriation rate, body temperature, …</p></li>
<li><p>Medications</p>
<p><code>-</code> Prescriptions, over-the-counter drugs, illegal drugs, alcohol, …</p>
<p><code>-</code> Medication reconciliation</p></li>
<li><p>Laboratory</p>
<p><code>-</code> Components of blood, urine, stool, saliva, spinal fluid (CSF), ascitic fluid, joint fluid, bone marrow, lung, …</p></li>
<li><p>Pathology</p>
<p><code>-</code>Qualitative and quantitative examination of any body tissue, e.g., biopsy samples, surgical ’scraps"</p>
<p><code>-</code> Cell-level measurements, e.g., cell-surface antigens</p></li>
<li><p>Microbiology - organisms grown, typically from cultures</p>
<p><code>-</code> Testing sensitivity to various antibiotics, at various dilutions Input/Output (fluids)</p></li>
<li><p>Notes</p>
<p><code>-</code> Discharge summary, Attending and/or Resident, Nurse</p>
<p><code>-</code> Speciallist : Radiology, Pathology, ECG, Nutrition, Respiratory, Social work, …</p>
<p><code>-</code> Consultant, Referring physician, Emergency Department</p></li>
<li><p>Billing</p>
<p><code>-</code> Diagnoses (ICD-9 or 10)</p>
<p><code>-</code> Procedures (CPT and ICD)</p>
<p><code>-</code> Diagnosis Related Groups (DRG)</p></li>
<li><p>Administrative</p>
<p><code>-</code> Service</p>
<p><code>-</code> Transfers</p></li>
<li><p>Imaging</p>
<p><code>-</code> X-ray, Ultrasound, CT, MRI, PET, Retinal, Endoscopy, Photographs</p></li>
</ul>
<blockquote>
<p>The evolution of health care data resources is creating vast new opportunities for population health research.</p>
</blockquote>
<ul>
<li><p>Key themes</p>
<p><code>-</code> Health data resources and their features</p>
<p><code>-</code> Research question and its role in analysis</p>
<p><code>-</code> Mindset of organic statistics.</p></li>
</ul>
<div id="introduction" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Introduction</h2>
<p>“In treatment, there can be too much of a good thing.” - The Wall Street Journal (August 4, 2014)</p>
<ul>
<li><p>Citation of Two studies</p>
<p><code>-</code> Large patient databases had been used to link blood pressure and blood sugar levels with health outcomes.</p></li>
<li><p>Blood pressure study</p>
<p><code>-</code> Medical records of nearly 400,000 Kaiser Permanente patients who were taking prescription drugs for hypertension.</p>
<p><code>-</code> Showed lower blood pressures had higher risk of death or end-stage renal disease than those with intermediate levels.</p></li>
<li><p>Blood sugar study</p>
<p><code>-</code> Medical claims from over 33 million beneficiaries</p>
<p><code>-</code> Showed that hospital admission rates for hypoglycemia had increased over time, ultimately exceeding admission rates for hyperglycemia.</p></li>
<li><p>Question?</p>
<p><code>-</code> The control of diabetes is the methods to improve the hyperglycemia?</p></li>
</ul>
<p><strong>Statistical analyses of large databases</strong></p>
<p><code>-</code> Raise questions</p>
<p><code>-</code> Provide answers that can eventually improve health systems</p>
<ul>
<li><p>Statistics for the study of</p>
<p><code>-</code> Health care delivery</p>
<p><code>-</code> Utilization</p>
<p><code>-</code> Outcome</p></li>
<li><p>Classical statistical methods and methods to include algorithmic approaches designed for predictive purposes and big data.</p></li>
</ul>
</div>
<div id="statistics-and-organic-statistics" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Statistics and Organic Statistics</h2>
<p>There are many ways to define statistics.</p>
<ul>
<li><p>Fundamentally, statistics is how we make sense of the world through data.</p>
<p><code>-</code> Via the process of statistical analysis.</p></li>
<li><p>Statistical analysis translates questions into mathematical formulations or models</p>
<p><code>-</code> Uses the data to learn sensible models.</p>
<p><code>-</code> Ultimately, applies the models to address the original questions.</p></li>
</ul>
<p>Statistics is therefore a pipeline that links question and data to answer and impact.</p>
<ul>
<li><p>Statistics = model fitting?</p>
<p><code>-</code> Turns statistics into a collection of recipes.</p>
<p><code>-</code> Turns statistical analysis into an exercise in picking the right recipe for the data at hand.</p>
<p><code>-</code> Wide availability of modern software packages</p></li>
<li><p>Objective:</p>
<p><code>-</code> Learn the statistical methods and models with health data.</p>
<p><code>-</code> More conceptual frame than mathematics.</p></li>
</ul>
</div>
<div id="statistical-methods-and-models" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Statistical Methods and Models</h2>
<ul>
<li><p>Mostly about hypothesis-driven Statistical methods and also, some algorithmic approaches.</p>
<p><code>-</code> Under current evolution in the health outcomes research, The important thing is to be familiar with both the traditional statistical paradigm and modern predictive ideas and methods.</p></li>
<li><p>The goal is to identify biological signal and to be able to separate it from the noise.</p>
<p><code>-</code> Done by statistical inference, formally implemented via statistical hypothesis testing.</p></li>
</ul>
<p>In the case of health care outcomes, traditional statistical models must account for the typically non-normal nature of the outcome variables.</p>
<p><img src="fig/fig1.1.png" /></p>
<ul>
<li><p>(left-hand panel) Histogram of total medical expenditures in the Medical Expenditure Panel Survey (MEPS) in 2017 and those of After logarithmic transformation (right-hand panel)</p>
<p><code>-</code> Extremely right-skewed with a long tail.</p>
<p><code>-</code> Lots of zeros, reflecting participants who did not record any medical care costs for that year.</p>
<p><code>-</code> Appropriate Methods : linear regression, generalized linear regression models, overdispersed data models, transformation and retransformation approaches for skewed data, and two-part regression models and so on.</p></li>
</ul>
<p>The predictive analytics paradigm does not generally aim to learn about the data-generating mechanism.</p>
<ul>
<li><p>Rather, it learns about patterns in the data that enable predicting the outcome of interest with an accuracy.</p>
<p><code>-</code> These patterns may not even be describable mathematically.</p>
<p><code>-</code> And also, predictive algorithm may be similarly opaque.</p></li>
<li><p>Algorithmic methods are relatively novel in the health services and outcomes literature;</p>
<p><code>-</code> But, much less structured and generally makes fewer assumptions than traditional statistical approaches</p>
<p><code>-</code> May not provide direction for specific interventions to improve outcomes.</p>
<p><code>-</code> Perform well to predict outcome but, not easy to interpret the associations between any of the predictors and the outcome.</p></li>
<li><p>Which approach is to be preferred?</p>
<p><code>—</code> Depends on the objective of the analysis and how the results are to be used in practice.</p></li>
</ul>
</div>
<div id="health-care-data" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Health Care Data</h2>
<ul>
<li><p>Types of health care data available for research into the drivers of health care utilization and outcomes</p></li>
<li><p>Administrative data</p>
<p><code>-</code> Collected as a matter of course for the financial and administrative aspects of health care delivery.</p>
<p><code>-</code> Medical claims and electronic medical records</p>
<p><code>-</code> Valuable but, generally not collected for research purposes</p>
<p><code>-</code> Many challenges arise when using them to address research questions.</p></li>
<li><p>Non-administrative data</p>
<p><code>-</code> Registries and surveys</p>
<p><code>-</code> Gathered for surveillance or research purposes</p>
<p><code>-</code> Yet, have many limitations stemming from the manner in which they are collected.</p></li>
</ul>
<p>As a health data analyst, it is important to match a given research question to the data resource that is most likely to provide a valid answer.</p>
<ul>
<li>Summary information of each data type</li>
</ul>
<p><img src="fig/table1.1.png" /></p>
<ul>
<li><p>Different data types may be linked to provide a more comprehensive record.</p></li>
<li><p>Example: estimating the prevalence of hypertension in a specified population.</p>
<p><code>-</code> From population surveys that specifically ask participants whether they have been previously diagnosed with the condition.</p>
<p><code>-</code> From medical claims that bill for encounters or medications is associated with a hypertension diagnosis code.</p>
<p><code>-</code> From electronic medical records, which provide measurements of patients’ health status including (frequently) blood pressure.</p></li>
</ul>
<p><strong>Each of these sources is subject to its own caveats and limitations.</strong></p>
<p><code>-</code> It is important to understand which individuals are represented in each data source and adjust or interpret the analysis in light of over-, non-, or under-represented groups.</p>
<p><code>-</code> And it is critical to understand the data-generating process in each setting.</p>
<div id="medical-claims" class="section level3" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Medical Claims</h3>
<ul>
<li><p>Medical claims code the billable interactions between insured patients and the health care delivery system.</p></li>
<li><p>The purpose of a claim : to generate payment from the payer for the services provided.</p>
<p><code>-</code> Includes the information needed to justify the claim and quantify its expense.</p>
<p><code>-</code> Diagnosis and procedure codes, prescribed medications, and medical care costs.</p>
<p><code>-</code> Diagnoses - International Classification of Diseases (ICD) 9 or 10</p>
<p><code>-</code> Procedure code : services rendered to patients.</p></li>
<li><p>There are several coding systems for procedures.</p>
<p><code>-</code> The ICD-10 system includes codes for inpatient procedures.</p>
<p><code>-</code> The Current Procedure Terminology (CPT) codes and the Healthcare Common Procedure Coding System (HCPCS), which builds on the CPT codes, describe procedures conducted as part of outpatient or ambulatory care.</p>
<p><code>-</code> Many CPT and HCPCS codes overlap, but HCPCS codes also capture non-physician services, such as ambulance rides, durable medical equipment use, and prescription drug use.</p></li>
<li><p>How is a medical claim produced?</p>
<p><code>-</code> Trained claims coders extract the relevant information from the medical record and clinical documentation.</p>
<p><code>-</code> And Then, this information is translated into insurance claims and bills for patients.</p>
<p><code>-</code> Due to the Complexity, the same service may be billed differently depending on the payer.</p></li>
<li><p>Example: New York Times article</p>
<p><code>-</code> Two friends who got drive-through coronavirus tests at the same emergency center in Austin.</p>
<p><code>-</code> Received very different bills depending on whether they paid cash (199) or billed their test to their health insurance company (6408).</p></li>
<li><p>Although medical claims are generated for billing purposes and not for research</p>
<p><code>-</code> Contain a wealth of information that pertains to important research questions about delivery of care, disparities in care, and the effectiveness and quality of care.</p>
<p><code>-</code> Hence, claims databases are increasingly being used for research purposes.</p></li>
</ul>
<p><img src="fig/fig1.claim.jpg" /></p>
<p><img src="fig/fig1.ex.png" /></p>
<ul>
<li><p>Limitations of claims data</p>
<p><code>-</code> Only insured patients can be studied using claims databases, and only covered services are represented.</p>
<p><code>-</code> Thus, claims data are not broadly population representative, and they are by nature incomplete.</p>
<p><code>-</code> Example: information on non-prescription drugs is lacking.</p>
<p><code>-</code> Further, claims can only be recorded if patients are enrolled in a health care plan.</p>
<p><code>-</code> Missing if coverage lapses or if they switch to a different payer.</p></li>
<li><p>Claims data must therefore be studied in the context of health plan enrollment, which may change over time.</p></li>
<li><p>While claims data are frequently used to analyze health care utilization, key predictors such as socio-demographic and socio-economic factors are generally not available at the individual level; this may limit predictive and causal studies.</p></li>
<li><p>Claims data are also frequently used to learn about patterns of care for a specific condition, but because of the wide variability in how claims are coded, such analyses invariably under ascertain individuals with that condition.</p></li>
<li><p>In general, the sensitivity and specificity of medical claims can be limited, particularly when the target population is somewhat nuanced, e.g., identifying cancer cases with a specific disease stage or distinguishing Type I and Type II diabetes.</p></li>
<li><p>A major limitation of medical claims is that they do not include health status measurements or diagnostic test results.</p>
<p><code>-</code> The blood sugar study focused on hospital admissions for hyper- and hypoglycemia; by identifying these conditions on the basis of the discharge diagnosis, it could be conducted using medical claims.</p>
<p><code>-</code> However, if a measurement of blood sugar level had been required to confirm the diagnosis, the study would have needed access to the patients’ medical records.</p></li>
<li><p>It can be difficult to get access to medical claims data without a formal proposal, funds, and (in some cases) a demonstrably effective data security protocol.</p></li>
</ul>
</div>
<div id="medical-records" class="section level3" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Medical Records</h3>
<ul>
<li><p>Medical records contain comprehensive electronic clinical data obtained at the point of care.</p></li>
<li><p>Example of electronic health record</p></li>
</ul>
<p><img src="fig/fig1.ehr.png" /></p>
<p><img src="fig/fig1.emr.png" /></p>
<ul>
<li><p>Track health conditions, interventions, and outcomes at the individual patient level for the purpose of diagnosis and treatment.</p>
<p><code>-</code> Same structured diagnosis and procedure information as in medical claims.</p></li>
<li><p>All patients who received care regardless of insurance status and incorporate much richer information on the health status of the patients and their care.</p></li>
<li><p>Unstructured data, such as physician notes, imaging reports, vital status measurements, and diagnostic test results.</p></li>
<li><p>Medical records offer tremendous potential for understanding processes of care, researching effectiveness of interventions, and predicting health outcomes in real-world settings.</p></li>
<li><p>However, like claims, medical records are not generated for research purposes, and their limitations must be understood.</p></li>
<li><p>Limitation medical records data</p>
<p><code>-</code> Quality: completeness, correctness, concordance (with other sources), plausibility, and currency (or timeliness).</p>
<p><code>-</code> Problem of phenotyping—identifying a diagnosis, procedure, or outcome from a medical record.</p></li>
<li><p>From an analytic perspective, a medical record is a real-time surveillance instrument that does not follow a statistical design or plan.</p>
<p><code>-</code> Whether information is recorded or not may be linked with the underlying condition of the patient.</p></li>
<li><p>Sicker patients generally have more diagnostic tests or more frequent vital status assessments than healthier patients.</p>
<p><code>-</code> These realities may lead to informative missing data patterns, which may bias estimates of associations between predictors and outcomes.</p></li>
<li><p>While the potential for medical record data to advance health research is clear, raw medical record data are generally proprietary to their health system and are not routinely accessible to outside researchers.</p></li>
<li><p>These data include highly sensitive information about individuals who are protected by the Health</p></li>
<li><p>Insurance Portability and Accountability Act; therefore, the majority of medical record data are available for research only on a limited, tightly controlled basis.</p>
<p><code>-</code> However, data from medical records are exported and curated to many other agencies.</p></li>
<li><p>There are public resources</p>
<p><code>-</code> Comprehensive Hospital Abstract Reporting System</p>
<p><code>-</code> National Inpatient Sample</p>
<p><code>-</code> Substance Abuse and Mental HealthServices Administration facility data</p>
<p><code>-</code> commercial data collections</p></li>
</ul>
</div>
<div id="health-surveys" class="section level3" number="1.4.3">
<h3><span class="header-section-number">1.4.3</span> Health Surveys</h3>
<ul>
<li><p>Health surveys record</p>
<p><code>-</code> Patients responses</p>
<p><code>-</code> Socio-demographics, health behaviors and conditions, and access to care and utilization patterns.</p></li>
</ul>
<p><img src="fig/fig1.survey.png" /></p>
<ul>
<li>Three large national publicly available health surveys</li>
</ul>
<p><strong>The National Health Interview Survey (NHIS)</strong>: Nation’s largest in-person household health survey.</p>
<p><code>-</code> Since 1957, the NHIS has been conducted annually by the Census Bureau on behalf of the National Center for Health Statistics (NCHS).</p>
<p><code>-</code> Cross sectional and collects information on a different sample every year.</p>
<p><code>-</code> Wide variety of topics (medical conditions, health insurance, doctor visits, and health behaviors).</p>
<p><code>-</code> Results from the NHIS have been used to monitor trends in the burden of chronic conditions and health care access and to track progress toward national health objectives.</p>
<p><img src="fig/fig1.nhis1.jpg" /></p>
<p><img src="fig/fig1.nhis2.jpg" /></p>
<p><img src="fig/fig1.nhis3.jpg" /></p>
<p><strong>The National Health and Nutrition Examination Survey (NHANES)</strong></p>
<p><code>-</code> Also conducted by the NCHS</p>
<p><code>-</code> One step further than the NHIS in that it not only interviews participants but also includes a full physical examination and blood test.</p>
<p><code>-</code> Important health indicators, such as blood pressure, body mass index, and hemoglobin A1c.</p>
<p><code>-</code> NHANES data have been crucial in providing the data to create growth charts for children, monitor the prevalence of obesity and overweight, and estimate the frequency of undiagnosed diabetes in the US.</p>
<p><img src="fig/fig1.nhanes1.jpg" /></p>
<p><img src="fig/fig1.nhanes2.jpg" /></p>
<p><img src="fig/fig1.nhanes3.jpg" /></p>
<p><strong>The Medical Expenditure Panel Survey (MEPS)</strong></p>
<p><code>-</code> Conducted by the Agency for Healthcare Research and Quality collects extensive information on health care utilization and expenditures for a subsample of NHIS households.</p>
<p><code>-</code> Socio-demographic, health history, and health behavior variables from NHIS, health insurance information, inpatient, outpatient, prescription drug utilization, expenditures sourced from medical providers and health records.</p>
<p><code>-</code> Rolling panel survey that enrolls participants annually and interviews them five times over a period of 2 years.</p>
<p><code>-</code> Longitudinal data</p>
<p><code>-</code> Useful in tracking health care expenditures, identifying the most costly medical conditions, and monitoring the use of and costs of different types of care in the population.</p>
<ul>
<li><p>All of the aforementioned surveys are designed with complex sampling and weighting schemes to reduce the costs of survey administration and produce results that are population representative.</p>
<p><code>-</code> Rather than simple random sampling, survey designs include stratification to control the proportion sampled within population subgroups and clustering to control survey costs.</p>
<p><code>-</code> Each observation in a survey is associated with a weight that reflects the number of individuals in the target population represented by that observation.</p>
<p><code>-</code> Survey documentation provides sampling scheme and weight estimation details and can be important in informing data analyses.</p>
<p><code>-</code> Important to understand these details and to track any changes in survey design over time.</p></li>
<li><p>Many of the examples in this book use MEPS data.</p>
<p><code>-</code> Rich environment for exploring topical health services questions while demonstrating specialized methods and techniques relevant for observational health care databases.</p></li>
<li><p>Surveys are of enormous value because they directly query respondents for information that may be difficult or impossible to obtain from administrative data,</p>
<p><code>-</code> Socio-demographic characteristics</p>
<p><code>-</code> Health behaviors</p>
<p><code>-</code> Individual perceptions and preferences.</p></li>
<li><p>At the same time, surveys are subject to a host of potential biases.</p>
<p><code>-</code> non-response bias</p>
<p><code>-</code> Recall bias</p>
<p><code>-</code> Social desirability bias</p></li>
<li><p>All of these can skew survey responses and/or lead to non-representative survey samples.</p></li>
<li><p>Mitigation of these biases requires extensive development and calibration of survey instruments and careful consideration of the mode of survey implementation.</p></li>
</ul>
</div>
<div id="disease-registries" class="section level3" number="1.4.4">
<h3><span class="header-section-number">1.4.4</span> Disease Registries</h3>
<ul>
<li><p>A registry is a corpus of non-administrative data collected for population surveillance of a specific condition or group of conditions.</p></li>
<li><p>Registries in the US</p>
<p><code>-</code> Cancer</p>
<p><code>-</code> End-stage renal disease</p>
<p><code>-</code> Alzheimer’s disease</p>
<p><code>-</code> Down syndrome</p></li>
<li><p>Registries have a clearly specified objective, a set of variables designed to address the objective, and an infrastructure to collect the desired data items.</p></li>
<li><p>Difference from population surveys</p>
<p><code>-</code> Not random samples</p>
<p><code>-</code> Surveillance, Epidemiology, and End Results (SEER) registry of the National Cancer Institute, are a complete census in certain regions.</p></li>
<li><p>The SEER registry is an example of an established population disease registry.</p>
<p><code>-</code> SEER collects information on all diagnosed cancer cases within a specific set of catchment areas (subregistries) in the US.</p>
<p><code>-</code> Objective: to track the burden of cancer incidence and mortality in the population.</p></li>
<li><p>Once new cases have been identified, a set of patient- and disease-specific factors is abstracted by hospital-based cancer registrars.</p>
<p><code>-</code> Individual-level demographics</p>
<p><code>-</code> Some socio-economic data at the census-tract level</p>
<p><code>-</code> Disease characteristics</p>
<p><code>-</code> First course of cancer-directed therapy</p></li>
<li><p>Following diagnosis, information about survival and cause of death is obtained via linkage to vital status records from the NCHS.</p></li>
<li><p>The SEER registry is an indispensable tool for researchers and others interested in understanding how the profile of cancer is changing over time.</p></li>
<li><p>Two potential limitations</p>
<p><code>-</code> Data quality</p>
<p><code>-</code> Representativeness</p></li>
</ul>
<p><img src="fig/fig1.reg1.png" /></p>
<p><img src="fig/fig1.reg2.png" /></p>
</div>
</div>
<div id="outline-of-the-text" class="section level2" number="1.5">
<h2><span class="header-section-number">1.5</span> Outline of the Text</h2>
<ul>
<li><p>Chap. 2: Basic statistical background and hypothesis testing.</p></li>
<li><p>Chap. 3: Review standard linear regression modeling, quantile, and non-parametric regression.</p></li>
<li><p>Chap. 4: Methods for binary or categorical data.</p></li>
<li><p>Chap. 5: Methods for count data.</p></li>
<li><p>Chap. 6: Analysis of skewed cost data, including two-part models.</p></li>
<li><p>Chap. 7: Concept of resampling and bootstrapping.</p></li>
<li><p>Chap. 8: Causality, causal inference, and strengths and limitations of different designs for observational studies of health care outcomes.</p></li>
<li><p>Chap. 9: Designs used for health surveys.</p></li>
<li><p>Chap. 10: Some of the applied examples and some statistical learning algorithms.</p></li>
</ul>
</div>
<div id="software-and-data" class="section level2" number="1.6">
<h2><span class="header-section-number">1.6</span> Software and Data</h2>
<ul>
<li><p>R code to download data and to carry out the examples in this book is available at the GitHub page, <a href="https://roman-gulati.github.io/statistics-for-health-data-science/" class="uri">https://roman-gulati.github.io/statistics-for-health-data-science/</a>.</p></li>
<li><p>Our example analyses relied heavily not only on the R language and base packages but also on several R packages designed to facilitate reading, manipulating, visualizing, summarizing, and modeling data.</p></li>
</ul>
</div>
<div id="loading-meps-data" class="section level2" number="1.7">
<h2><span class="header-section-number">1.7</span> Loading MEPS data</h2>
<p>Several methods are available for importing MEPS public use files (PUFs) into R. The easiest method is to use the read_MEPS function from the MEPS package, which was created to facilitate loading and manipulation of MEPS PUFs. Alternatively, R users can use the read.xport function from the foreign package to import SAS transport (.ssp) files from data years 1996-2017, or the read_fwf function from the readr package to import ASCII (.dat) files from data years 2018 and later.</p>
<p>Using the MEPS Package (all data years)
The MEPS R Package was created to facilitate loading and manipulation of MEPS PUFs. It can be installed using the following commands:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter1.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-2"><a href="chapter1.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="chapter1.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;e-mitchell/meps_r_pkg/MEPS&quot;</span>)</span>
<span id="cb1-4"><a href="chapter1.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MEPS)</span></code></pre></div>
<p>The read_MEPS function can then be used to import MEPS data into R, either directly from the MEPS website, or from a local directory. This function automatically detects the best file format (.ssp or .dat) to import based on the specified data year.</p>
<p>In the following example, the 2017 (h197b) and 2018 (h206b) Dental visits files are automatically downloaded from the MEPS website and imported into R. Either the file name or the year and MEPS data type can be specified:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="chapter1.html#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifying year and MEPS data type</span></span>
<span id="cb2-2"><a href="chapter1.html#cb2-2" aria-hidden="true" tabindex="-1"></a>dn2017 <span class="ot">&lt;-</span> <span class="fu">read_MEPS</span>(<span class="at">year =</span> <span class="dv">2017</span>, <span class="at">type =</span> <span class="st">&quot;DV&quot;</span>)</span>
<span id="cb2-3"><a href="chapter1.html#cb2-3" aria-hidden="true" tabindex="-1"></a>dn2018 <span class="ot">&lt;-</span> <span class="fu">read_MEPS</span>(<span class="at">year =</span> <span class="dv">2018</span>, <span class="at">type =</span> <span class="st">&quot;DV&quot;</span>)</span>
<span id="cb2-4"><a href="chapter1.html#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="chapter1.html#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifying MEPS file name</span></span>
<span id="cb2-6"><a href="chapter1.html#cb2-6" aria-hidden="true" tabindex="-1"></a>dn2017 <span class="ot">&lt;-</span> <span class="fu">read_MEPS</span>(<span class="at">file =</span> <span class="st">&quot;h197b&quot;</span>)</span>
<span id="cb2-7"><a href="chapter1.html#cb2-7" aria-hidden="true" tabindex="-1"></a>dn2018 <span class="ot">&lt;-</span> <span class="fu">read_MEPS</span>(<span class="at">file =</span> <span class="st">&quot;h206b&quot;</span>)</span></code></pre></div>
<ul>
<li><p>More details for MEPS: <a href="https://github.com/HHS-AHRQ/MEPS">MEPS: https://github.com/HHS-AHRQ/MEPS</a></p></li>
<li><p>Example</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter1.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MEPS)</span></code></pre></div>
<pre><code>## Loading required package: dplyr</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre><code>## Loading required package: foreign</code></pre>
<pre><code>## Loading required package: stringr</code></pre>
<pre><code>## Loading required package: tidyr</code></pre>
<pre><code>## Loading required package: readr</code></pre>
<pre><code>## Loading required package: httr</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter1.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
<pre><code>## v ggplot2 3.3.3     v purrr   0.3.4
## v tibble  3.1.2     v forcats 0.5.1</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div id="data-loading" class="section level3" number="1.7.1">
<h3><span class="header-section-number">1.7.1</span> Data Loading</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="chapter1.html#cb17-1" aria-hidden="true" tabindex="-1"></a>dset <span class="ot">&lt;-</span> <span class="fu">read_MEPS</span>(<span class="at">file=</span><span class="st">&quot;h201&quot;</span>)</span></code></pre></div>
</div>
<div id="visualize-histogram-of-total-expenditures" class="section level3" number="1.7.2">
<h3><span class="header-section-number">1.7.2</span> Visualize histogram of total expenditures</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter1.html#cb18-1" aria-hidden="true" tabindex="-1"></a>totexp_panel <span class="ot">&lt;-</span> <span class="cf">function</span>(data, varname){</span>
<span id="cb18-2"><a href="chapter1.html#cb18-2" aria-hidden="true" tabindex="-1"></a>    dset <span class="ot">&lt;-</span> data</span>
<span id="cb18-3"><a href="chapter1.html#cb18-3" aria-hidden="true" tabindex="-1"></a>    dset <span class="ot">&lt;-</span> dset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">SCALEDTOTEXP17=</span>TOTEXP17<span class="sc">/</span><span class="dv">10000</span>,</span>
<span id="cb18-4"><a href="chapter1.html#cb18-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">LOGTOTEXP17=</span><span class="fu">log</span>(TOTEXP17<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb18-5"><a href="chapter1.html#cb18-5" aria-hidden="true" tabindex="-1"></a>    dset <span class="ot">&lt;-</span> dset <span class="sc">%&gt;%</span> <span class="fu">select</span>(SCALEDTOTEXP17, LOGTOTEXP17)</span>
<span id="cb18-6"><a href="chapter1.html#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(varname <span class="sc">==</span> <span class="st">&#39;SCALEDTOTEXP17&#39;</span>){</span>
<span id="cb18-7"><a href="chapter1.html#cb18-7" aria-hidden="true" tabindex="-1"></a>        xmax <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb18-8"><a href="chapter1.html#cb18-8" aria-hidden="true" tabindex="-1"></a>        xstep <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb18-9"><a href="chapter1.html#cb18-9" aria-hidden="true" tabindex="-1"></a>        ymax <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb18-10"><a href="chapter1.html#cb18-10" aria-hidden="true" tabindex="-1"></a>        ystep <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb18-11"><a href="chapter1.html#cb18-11" aria-hidden="true" tabindex="-1"></a>        xlabel <span class="ot">&lt;-</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">Total expenditure ($10,000)&#39;</span></span>
<span id="cb18-12"><a href="chapter1.html#cb18-12" aria-hidden="true" tabindex="-1"></a>        bpoints <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>, xmax, <span class="at">length=</span><span class="dv">15</span>), <span class="fu">max</span>(dset[[<span class="st">&#39;SCALEDTOTEXP17&#39;</span>]]))</span>
<span id="cb18-13"><a href="chapter1.html#cb18-13" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb18-14"><a href="chapter1.html#cb18-14" aria-hidden="true" tabindex="-1"></a>        xmax <span class="ot">&lt;-</span> <span class="dv">16</span></span>
<span id="cb18-15"><a href="chapter1.html#cb18-15" aria-hidden="true" tabindex="-1"></a>        xstep <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb18-16"><a href="chapter1.html#cb18-16" aria-hidden="true" tabindex="-1"></a>        ymax <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb18-17"><a href="chapter1.html#cb18-17" aria-hidden="true" tabindex="-1"></a>        ystep <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb18-18"><a href="chapter1.html#cb18-18" aria-hidden="true" tabindex="-1"></a>        xlabel <span class="ot">&lt;-</span> <span class="st">&#39;</span><span class="sc">\n</span><span class="st">Log(Total expenditure+$1)&#39;</span></span>
<span id="cb18-19"><a href="chapter1.html#cb18-19" aria-hidden="true" tabindex="-1"></a>        bpoints <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb18-20"><a href="chapter1.html#cb18-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb18-21"><a href="chapter1.html#cb18-21" aria-hidden="true" tabindex="-1"></a>    hdat <span class="ot">&lt;-</span> <span class="fu">hist</span>(dset[[varname]], <span class="at">breaks=</span>bpoints, <span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-22"><a href="chapter1.html#cb18-22" aria-hidden="true" tabindex="-1"></a>    hset <span class="ot">&lt;-</span> <span class="fu">with</span>(hdat, <span class="fu">data.frame</span>(mids, counts))</span>
<span id="cb18-23"><a href="chapter1.html#cb18-23" aria-hidden="true" tabindex="-1"></a>    hset <span class="ot">&lt;-</span> hset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">scaledcounts=</span>counts<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb18-24"><a href="chapter1.html#cb18-24" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hset)</span>
<span id="cb18-25"><a href="chapter1.html#cb18-25" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x=</span>mids, <span class="at">y=</span>scaledcounts), <span class="at">stat=</span><span class="st">&#39;identity&#39;</span>)</span>
<span id="cb18-26"><a href="chapter1.html#cb18-26" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">name=</span>xlabel,</span>
<span id="cb18-27"><a href="chapter1.html#cb18-27" aria-hidden="true" tabindex="-1"></a>                                <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, xmax, <span class="at">by=</span>xstep),</span>
<span id="cb18-28"><a href="chapter1.html#cb18-28" aria-hidden="true" tabindex="-1"></a>                                <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, xmax))</span>
<span id="cb18-29"><a href="chapter1.html#cb18-29" aria-hidden="true" tabindex="-1"></a>    gg <span class="ot">&lt;-</span> gg<span class="sc">+</span><span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">&#39;Participants (1,000)</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb18-30"><a href="chapter1.html#cb18-30" aria-hidden="true" tabindex="-1"></a>                                <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>, ymax, <span class="at">by=</span>ystep),</span>
<span id="cb18-31"><a href="chapter1.html#cb18-31" aria-hidden="true" tabindex="-1"></a>                                <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, ymax))</span>
<span id="cb18-32"><a href="chapter1.html#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(gg)</span>
<span id="cb18-33"><a href="chapter1.html#cb18-33" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter1.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">totexp_panel</span>(dset, <span class="st">&#39;SCALEDTOTEXP17&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (position_stack).</code></pre>
<p><img src="hdsbook_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter1.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">totexp_panel</span>(dset, <span class="st">&#39;LOGTOTEXP17&#39;</span>)</span></code></pre></div>
<p><img src="hdsbook_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<!-------------------- End --------------->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["hdsbook.pdf", "hdsbook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
