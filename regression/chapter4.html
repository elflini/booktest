<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 다중선형회귀분석 | Regression Analysis</title>
  <meta name="description" content="Chapter 4 다중선형회귀분석 | Regression Analysis" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 다중선형회귀분석 | Regression Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 4 다중선형회귀분석 | Regression Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 다중선형회귀분석 | Regression Analysis" />
  
  <meta name="twitter:description" content="Chapter 4 다중선형회귀분석 | Regression Analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2024-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter3.html"/>
<link rel="next" href="chapter5.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Regression Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>목 차</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> 서론</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#기술-통계descriptive-statistics"><i class="fa fa-check"></i><b>1.1</b> 기술 통계(Descriptive Statistics)</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#회귀-분석regression-analysis"><i class="fa fa-check"></i><b>1.2</b> 회귀 분석(regression analysis)</a></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#회귀분석-예제"><i class="fa fa-check"></i><b>1.3</b> 회귀분석 예제</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> 기초 행렬 이론</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#정의"><i class="fa fa-check"></i><b>2.1</b> 정의</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#행렬과-벡터"><i class="fa fa-check"></i><b>2.1.1</b> 행렬과 벡터</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#특정-형태의-행렬"><i class="fa fa-check"></i><b>2.1.2</b> 특정 형태의 행렬</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#행렬의-연산"><i class="fa fa-check"></i><b>2.2</b> 행렬의 연산</a></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#분할행렬"><i class="fa fa-check"></i><b>2.3</b> 분할행렬</a></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#행렬의-계수"><i class="fa fa-check"></i><b>2.4</b> 행렬의 계수</a></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#행렬식"><i class="fa fa-check"></i><b>2.5</b> 행렬식</a></li>
<li class="chapter" data-level="2.6" data-path="chapter2.html"><a href="chapter2.html#역행렬"><i class="fa fa-check"></i><b>2.6</b> 역행렬</a></li>
<li class="chapter" data-level="2.7" data-path="chapter2.html"><a href="chapter2.html#양정치행렬과-반양정치행렬"><i class="fa fa-check"></i><b>2.7</b> 양정치행렬과 반양정치행렬</a></li>
<li class="chapter" data-level="2.8" data-path="chapter2.html"><a href="chapter2.html#트레이스"><i class="fa fa-check"></i><b>2.8</b> 트레이스</a></li>
<li class="chapter" data-level="2.9" data-path="chapter2.html"><a href="chapter2.html#직교벡터와-직교행렬"><i class="fa fa-check"></i><b>2.9</b> 직교벡터와 직교행렬</a></li>
<li class="chapter" data-level="2.10" data-path="chapter2.html"><a href="chapter2.html#고유값과-고유벡터"><i class="fa fa-check"></i><b>2.10</b> 고유값과 고유벡터</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="chapter2.html"><a href="chapter2.html#고유값과-고유벡터-정의"><i class="fa fa-check"></i><b>2.10.1</b> 고유값과 고유벡터 정의</a></li>
<li class="chapter" data-level="2.10.2" data-path="chapter2.html"><a href="chapter2.html#고유값의-성질"><i class="fa fa-check"></i><b>2.10.2</b> 고유값의 성질</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="chapter2.html"><a href="chapter2.html#스펙트럼분해"><i class="fa fa-check"></i><b>2.11</b> 스펙트럼분해</a></li>
<li class="chapter" data-level="2.12" data-path="chapter2.html"><a href="chapter2.html#멱등행렬"><i class="fa fa-check"></i><b>2.12</b> 멱등행렬</a></li>
<li class="chapter" data-level="2.13" data-path="chapter2.html"><a href="chapter2.html#벡터와-행렬의-미분"><i class="fa fa-check"></i><b>2.13</b> 벡터와 행렬의 미분</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> 단순선형회귀분석</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#산점도"><i class="fa fa-check"></i><b>3.1</b> 산점도</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#상관분석"><i class="fa fa-check"></i><b>3.2</b> 상관분석</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter3.html"><a href="chapter3.html#표본상관계수"><i class="fa fa-check"></i><b>3.2.1</b> 표본상관계수</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter3.html"><a href="chapter3.html#상관분석-1"><i class="fa fa-check"></i><b>3.2.2</b> 상관분석</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter3.html"><a href="chapter3.html#표본상관계수-해석시-유의점"><i class="fa fa-check"></i><b>3.2.3</b> 표본상관계수 해석시 유의점</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#단순선형회귀모형"><i class="fa fa-check"></i><b>3.3</b> 단순선형회귀모형</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#모수-추정"><i class="fa fa-check"></i><b>3.4</b> 모수 추정</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter3.html"><a href="chapter3.html#최소제곱법을-이용한-모수-추정"><i class="fa fa-check"></i><b>3.4.1</b> 최소제곱법을 이용한 모수 추정</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter3.html"><a href="chapter3.html#가능도함수를-이용한-모수-추정"><i class="fa fa-check"></i><b>3.4.2</b> 가능도함수를 이용한 모수 추정</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter3.html"><a href="chapter3.html#추정량의-성질"><i class="fa fa-check"></i><b>3.4.3</b> 추정량의 성질</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#모형에-대한-적합도-검정"><i class="fa fa-check"></i><b>3.5</b> 모형에 대한 적합도 검정</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="chapter3.html"><a href="chapter3.html#결정계수"><i class="fa fa-check"></i><b>3.5.1</b> 결정계수</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapter3.html"><a href="chapter3.html#회귀식에-대한-검정"><i class="fa fa-check"></i><b>3.5.2</b> 회귀식에 대한 검정</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapter3.html"><a href="chapter3.html#회귀계수에-대한-검정"><i class="fa fa-check"></i><b>3.5.3</b> 회귀계수에 대한 검정</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapter3.html"><a href="chapter3.html#회귀계수에-대한-신뢰구간"><i class="fa fa-check"></i><b>3.5.4</b> 회귀계수에 대한 신뢰구간</a></li>
<li class="chapter" data-level="3.5.5" data-path="chapter3.html"><a href="chapter3.html#예측값에-대한-신뢰구간"><i class="fa fa-check"></i><b>3.5.5</b> 예측값에 대한 신뢰구간</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#잔차-분석"><i class="fa fa-check"></i><b>3.6</b> 잔차 분석</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="chapter3.html"><a href="chapter3.html#회귀함수의-선형성"><i class="fa fa-check"></i><b>3.6.1</b> 회귀함수의 선형성</a></li>
<li class="chapter" data-level="3.6.2" data-path="chapter3.html"><a href="chapter3.html#오차항의-등분산성과-독립성"><i class="fa fa-check"></i><b>3.6.2</b> 오차항의 등분산성과 독립성</a></li>
<li class="chapter" data-level="3.6.3" data-path="chapter3.html"><a href="chapter3.html#오차항의-정규성"><i class="fa fa-check"></i><b>3.6.3</b> 오차항의 정규성</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="chapter3.html"><a href="chapter3.html#example-7"><i class="fa fa-check"></i><b>3.7</b> Example</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="chapter3.html"><a href="chapter3.html#example-1-1"><i class="fa fa-check"></i><b>3.7.1</b> Example 1</a></li>
<li class="chapter" data-level="3.7.2" data-path="chapter3.html"><a href="chapter3.html#example-2-1"><i class="fa fa-check"></i><b>3.7.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="chapter3.html"><a href="chapter3.html#부분-회귀"><i class="fa fa-check"></i><b>3.8</b> 부분 회귀</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="chapter3.html"><a href="chapter3.html#example-8"><i class="fa fa-check"></i><b>3.8.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> 다중선형회귀분석</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#다중선형회귀모형---설명변수가-두-개인-경우"><i class="fa fa-check"></i><b>4.1</b> 다중선형회귀모형 - 설명변수가 두 개인 경우</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#다중선형회귀모형---설명변수가-여러-개인-경우"><i class="fa fa-check"></i><b>4.2</b> 다중선형회귀모형 - 설명변수가 여러 개인 경우</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#모수-추정-1"><i class="fa fa-check"></i><b>4.3</b> 모수 추정</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chapter4.html"><a href="chapter4.html#최소제곱법을-이용한-모수추정"><i class="fa fa-check"></i><b>4.3.1</b> 최소제곱법을 이용한 모수추정</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter4.html"><a href="chapter4.html#가능도함수를-이용한-모수-추정-1"><i class="fa fa-check"></i><b>4.3.2</b> 가능도함수를 이용한 모수 추정</a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter4.html"><a href="chapter4.html#추정량의-성질-1"><i class="fa fa-check"></i><b>4.3.3</b> 추정량의 성질</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#회귀모형-추정"><i class="fa fa-check"></i><b>4.4</b> 회귀모형 추정</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="chapter4.html"><a href="chapter4.html#회귀계수에-대한-검정-1"><i class="fa fa-check"></i><b>4.4.1</b> 회귀계수에 대한 검정</a></li>
<li class="chapter" data-level="4.4.2" data-path="chapter4.html"><a href="chapter4.html#회귀계수에-대한-신뢰구간-1"><i class="fa fa-check"></i><b>4.4.2</b> 회귀계수에 대한 신뢰구간</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#모형에-대한-적합도-검정-1"><i class="fa fa-check"></i><b>4.5</b> 모형에 대한 적합도 검정</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="chapter4.html"><a href="chapter4.html#결정계수-1"><i class="fa fa-check"></i><b>4.5.1</b> 결정계수</a></li>
<li class="chapter" data-level="4.5.2" data-path="chapter4.html"><a href="chapter4.html#회귀계수벡터에-대한-검정"><i class="fa fa-check"></i><b>4.5.2</b> 회귀계수벡터에 대한 검정</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#신뢰구간과-예측구간"><i class="fa fa-check"></i><b>4.6</b> 신뢰구간과 예측구간</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chapter4.html"><a href="chapter4.html#반응평균과-반응평균에-대한-신뢰구간"><i class="fa fa-check"></i><b>4.6.1</b> 반응평균과 반응평균에 대한 신뢰구간</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#잔차분석"><i class="fa fa-check"></i><b>4.7</b> 잔차분석</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="chapter4.html"><a href="chapter4.html#회귀함수의-선형성-1"><i class="fa fa-check"></i><b>4.7.1</b> 회귀함수의 선형성</a></li>
<li class="chapter" data-level="4.7.2" data-path="chapter4.html"><a href="chapter4.html#오차항의-등분산성과-독립성-1"><i class="fa fa-check"></i><b>4.7.2</b> 오차항의 등분산성과 독립성</a></li>
<li class="chapter" data-level="4.7.3" data-path="chapter4.html"><a href="chapter4.html#오차항의-정규성-1"><i class="fa fa-check"></i><b>4.7.3</b> 오차항의 정규성</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="chapter4.html"><a href="chapter4.html#r을-이용한-다중회귀분석"><i class="fa fa-check"></i><b>4.8</b> R을 이용한 다중회귀분석</a></li>
<li class="chapter" data-level="4.9" data-path="chapter4.html"><a href="chapter4.html#다항회귀모형"><i class="fa fa-check"></i><b>4.9</b> 다항회귀모형</a></li>
<li class="chapter" data-level="4.10" data-path="chapter4.html"><a href="chapter4.html#표준화-회귀모형"><i class="fa fa-check"></i><b>4.10</b> 표준화 회귀모형</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> 회귀진단 및 보정</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#모자행렬과-지렛대"><i class="fa fa-check"></i><b>5.1</b> 모자행렬과 지렛대</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#스튜던트화-잔차"><i class="fa fa-check"></i><b>5.2</b> 스튜던트화 잔차</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#영향점"><i class="fa fa-check"></i><b>5.3</b> 영향점</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter5.html"><a href="chapter5.html#쿡의-거리"><i class="fa fa-check"></i><b>5.3.1</b> 쿡의 거리</a></li>
<li class="chapter" data-level="5.3.2" data-path="chapter5.html"><a href="chapter5.html#dffits"><i class="fa fa-check"></i><b>5.3.2</b> DFFITS</a></li>
<li class="chapter" data-level="5.3.3" data-path="chapter5.html"><a href="chapter5.html#추가변수-그림"><i class="fa fa-check"></i><b>5.3.3</b> 추가변수 그림</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#이상점"><i class="fa fa-check"></i><b>5.4</b> 이상점</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#example-13"><i class="fa fa-check"></i><b>5.5</b> Example</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#회귀진단-후-보정-방법"><i class="fa fa-check"></i><b>5.6</b> 회귀진단 후 보정 방법</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chapter5.html"><a href="chapter5.html#잔차그림"><i class="fa fa-check"></i><b>5.6.1</b> 잔차그림</a></li>
<li class="chapter" data-level="5.6.2" data-path="chapter5.html"><a href="chapter5.html#정규성을-만족하지-않는-경우"><i class="fa fa-check"></i><b>5.6.2</b> 정규성을 만족하지 않는 경우</a></li>
<li class="chapter" data-level="5.6.3" data-path="chapter5.html"><a href="chapter5.html#등분산이-아닌-경우"><i class="fa fa-check"></i><b>5.6.3</b> 등분산이 아닌 경우</a></li>
<li class="chapter" data-level="5.6.4" data-path="chapter5.html"><a href="chapter5.html#선형이-아닌-경우"><i class="fa fa-check"></i><b>5.6.4</b> 선형이 아닌 경우</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> 모형비교와 변수선택법</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#다중공선성"><i class="fa fa-check"></i><b>6.1</b> 다중공선성</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter6.html"><a href="chapter6.html#다중공선성-문제"><i class="fa fa-check"></i><b>6.1.1</b> 다중공선성 문제</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter6.html"><a href="chapter6.html#분산팽창계수"><i class="fa fa-check"></i><b>6.1.2</b> 분산팽창계수</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter6.html"><a href="chapter6.html#다중공선성이-존재하는-경우"><i class="fa fa-check"></i><b>6.1.3</b> 다중공선성이 존재하는 경우</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#모형-비교와-f-검정"><i class="fa fa-check"></i><b>6.2</b> 모형 비교와 F-검정</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#변수선택"><i class="fa fa-check"></i><b>6.3</b> 변수선택</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chapter6.html"><a href="chapter6.html#단계별-변수선택법"><i class="fa fa-check"></i><b>6.3.1</b> 단계별 변수선택법</a></li>
<li class="chapter" data-level="6.3.2" data-path="chapter6.html"><a href="chapter6.html#가능한-경우들-중-선택"><i class="fa fa-check"></i><b>6.3.2</b> 가능한 경우들 중 선택</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#r-활용-모형-비교-및-변수선택"><i class="fa fa-check"></i><b>6.4</b> R 활용 모형 비교 및 변수선택</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> 다중회귀분석 예제</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#데이터-탐색"><i class="fa fa-check"></i><b>7.1</b> 데이터 탐색</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#다중선형회귀분석"><i class="fa fa-check"></i><b>7.2</b> 다중선형회귀분석</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#단계별-회귀에-의한-변수-선택"><i class="fa fa-check"></i><b>7.3</b> 단계별 회귀에 의한 변수 선택</a></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#다중공선성-1"><i class="fa fa-check"></i><b>7.4</b> 다중공선성</a></li>
<li class="chapter" data-level="7.5" data-path="chapter7.html"><a href="chapter7.html#지렛대점과-이상점"><i class="fa fa-check"></i><b>7.5</b> 지렛대점과 이상점</a></li>
<li class="chapter" data-level="7.6" data-path="chapter7.html"><a href="chapter7.html#잔차분석-1"><i class="fa fa-check"></i><b>7.6</b> 잔차분석</a></li>
<li class="chapter" data-level="7.7" data-path="chapter7.html"><a href="chapter7.html#모형-제안-및-예측"><i class="fa fa-check"></i><b>7.7</b> 모형 제안 및 예측</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> 일반화 가중회귀모형</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#일반화-회귀모형"><i class="fa fa-check"></i><b>8.1</b> 일반화 회귀모형</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#최소제곱법을-이용한-모수추정-1"><i class="fa fa-check"></i><b>8.2</b> 최소제곱법을 이용한 모수추정</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#r-활용-가중회귀분석"><i class="fa fa-check"></i><b>8.3</b> R 활용 가중회귀분석</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> 가변수 회귀모형</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#이분-가변수-경우"><i class="fa fa-check"></i><b>9.1</b> 이분 가변수 경우</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#두-개-회귀직선의-비교"><i class="fa fa-check"></i><b>9.2</b> 두 개 회귀직선의 비교</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-평행성-검정---각-모형의-경우"><i class="fa fa-check"></i><b>9.2.1</b> 회귀직선의 평행성 검정 - 각 모형의 경우</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-평행성-검정---가변수의-경우"><i class="fa fa-check"></i><b>9.2.2</b> 회귀직선의 평행성 검정 - 가변수의 경우</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-일치성-검정---각-모형의-경우"><i class="fa fa-check"></i><b>9.2.3</b> 회귀직선의 일치성 검정 - 각 모형의 경우</a></li>
<li class="chapter" data-level="9.2.4" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-일치성-검정---가변수의-적용"><i class="fa fa-check"></i><b>9.2.4</b> 회귀직선의 일치성 검정 - 가변수의 적용</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapter9.html"><a href="chapter9.html#다항-가변수-경우"><i class="fa fa-check"></i><b>9.3</b> 다항 가변수 경우</a></li>
<li class="chapter" data-level="9.4" data-path="chapter9.html"><a href="chapter9.html#r-활용-가변수회귀분석"><i class="fa fa-check"></i><b>9.4</b> R 활용 가변수회귀분석</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter9.html"><a href="chapter9.html#구름-데이터"><i class="fa fa-check"></i><b>9.4.1</b> 구름 데이터</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapter9.html"><a href="chapter9.html#iq-데이터"><i class="fa fa-check"></i><b>9.4.2</b> IQ 데이터</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter10.html"><a href="chapter10.html"><i class="fa fa-check"></i><b>10</b> 능형회귀추정량과 LASSO 추정량</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter10.html"><a href="chapter10.html#능형회귀모형"><i class="fa fa-check"></i><b>10.1</b> 능형회귀모형</a></li>
<li class="chapter" data-level="10.2" data-path="chapter10.html"><a href="chapter10.html#능형모수추정"><i class="fa fa-check"></i><b>10.2</b> 능형모수추정</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="chapter10.html"><a href="chapter10.html#능형추정량의-성질"><i class="fa fa-check"></i><b>10.2.1</b> 능형추정량의 성질</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapter10.html"><a href="chapter10.html#능형모수추정-1"><i class="fa fa-check"></i><b>10.2.2</b> 능형모수추정</a></li>
<li class="chapter" data-level="10.2.3" data-path="chapter10.html"><a href="chapter10.html#능형트레이스"><i class="fa fa-check"></i><b>10.2.3</b> 능형트레이스</a></li>
<li class="chapter" data-level="10.2.4" data-path="chapter10.html"><a href="chapter10.html#example-15"><i class="fa fa-check"></i><b>10.2.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="chapter10.html"><a href="chapter10.html#lasso-회귀모형"><i class="fa fa-check"></i><b>10.3</b> LASSO 회귀모형</a></li>
<li class="chapter" data-level="10.4" data-path="chapter10.html"><a href="chapter10.html#r-활용-능형회귀-및-lasso-회귀분석"><i class="fa fa-check"></i><b>10.4</b> R 활용 능형회귀 및 LASSO 회귀분석</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Regression Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter4" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> 다중선형회귀분석<a href="chapter4.html#chapter4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ul>
<li><p>일반적으로 자연현상, 사회현상은 여러 개의 설명변수로 반응변수와의 관계를 파악하여 현상을 설명해야 하는 경우가 대부분</p></li>
<li><p>설명변수가 2개 이상인 경우의 회귀모형을 다중회귀모형(multiple regression model)이라고 함</p></li>
<li><p>다중회귀모형은 다차원에 대한 표현을 해야 하므로 벡터와 행렬로 표현하게 됨</p></li>
<li><p>또한 다중회귀모형에서는 설명변수가 여러 개이므로 단순회귀모형에서와는 달리 설명변수들 간의 관계도 고려되어야 함</p></li>
</ul>
<div id="다중선형회귀모형---설명변수가-두-개인-경우" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> 다중선형회귀모형 - 설명변수가 두 개인 경우<a href="chapter4.html#다중선형회귀모형---설명변수가-두-개인-경우" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>관측벡터 <span class="math inline">\((X_{11},X_{12},y_1), (X_{21},X_{22},y_2), \cdots, (X_{n1},X_{n2},y_n)\)</span>에 대해 다중선형회귀모형을 생각해 보자.</p></li>
<li><p><span class="math inline">\(X_1, X_2\)</span>는 고정된(fixed) 설명변수이고 <span class="math inline">\(Y\)</span>는 일변량 반응변수인 경우, 설명변수들과 반응변수 간의 선형회귀모형은</p></li>
</ul>
<p><span class="math display">\[
Y=\beta_0+\beta_1X_{1}+\beta_2X_{2}+\epsilon
\]</span></p>
<ul>
<li><p>여기서 회귀모수로 <span class="math inline">\(\beta_0\)</span>는 절편, <span class="math inline">\(\beta_1\)</span>은 <span class="math inline">\(X_1\)</span>과 관련된 회귀계수, <span class="math inline">\(\beta_2\)</span>은 <span class="math inline">\(X_2\)</span>와 관련된 회귀계수, 오차항 <span class="math inline">\(\epsilon \stackrel{iid}{\sim} N(0,\sigma^2)\)</span>을 가정</p></li>
<li><p><span class="math inline">\(n\)</span>개 관측점에 대해 표현하면</p></li>
</ul>
<p><span class="math display">\[
Y_i=\beta_0+\beta_1X_{1i}+\beta_2X_{2i}+\epsilon_i, \,\,\, i=1,2,\cdots, n
\]</span></p>
<p>      여기서 <span class="math inline">\(Cov(\epsilon_i,\epsilon_j)=0, \,\,\, i\ne j\)</span></p>
<ul>
<li>선형회귀모형을 벡터와 행렬로 표현하면</li>
</ul>
<p><span class="math display">\[
\mathbf{Y}=\mathbf{X}\beta +\epsilon
\]</span></p>
<ul>
<li>여기서</li>
</ul>
<p><span class="math display">\[
\mathbf{Y}=\begin{pmatrix} Y_1\\Y_2\\\vdots\\Y_n \end{pmatrix}, \,\,\,
x_i=\begin{pmatrix} 1\\X_{i1}\\X_{i2} \end{pmatrix}, \,\,\,
\mathbf{X}=\begin{pmatrix}x_1&#39;\\\vdots\\x_n&#39; \end{pmatrix}=\begin{pmatrix}1 &amp; X_{11}&amp;X_{12}\\
\vdots &amp;\vdots &amp;\vdots \\ 1&amp;X_{n1}&amp;X_{n2} \end{pmatrix}, \,\,\,
\beta=\begin{pmatrix}\beta_0\\ \beta_1\\ \beta_2 \end{pmatrix}, \,\,\,
\epsilon=\begin{pmatrix} \epsilon_1\\ \epsilon_2 \\ \vdots \\ \epsilon_n \end{pmatrix}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\mathbf{Y}\)</span>와 <span class="math inline">\(\epsilon\)</span>은 <span class="math inline">\(n\times 1\)</span> 벡터, <span class="math inline">\(x_i\)</span>와 <span class="math inline">\(\beta\)</span>는 <span class="math inline">\(3 \times 1\)</span> 벡터이고 <span class="math inline">\(\mathbf{X}\)</span>는 <span class="math inline">\(n\times 3\)</span> 행렬</p></li>
<li><p>회귀계수 추정량을 구하기 위해 오차제곱합을 최소화</p></li>
</ul>
<p><span class="math display">\[
S=\sum_{i=1}^n\epsilon_i^2 =\sum_{i=1}^n (Y_i-\beta_0-\beta_1X_{i1}-\beta_2X_{i2})^2
\]</span></p>
<ul>
<li>각 모수에 대해 편미분하여 <span class="math inline">\(0\)</span>으로 놓으면</li>
</ul>
<p><span class="math display">\[
\begin{align}
\frac{\partial S}{\partial\beta_0}&amp;=2\sum_{i=1}^n(Y_i-\beta_0-\beta_1X_{i1}-\beta_2X_{i2})(-1)=0 \\
\frac{\partial S}{\partial\beta_1}&amp;=2\sum_{i=1}^n(Y_i-\beta_0-\beta_1X_{i1}-\beta_2X_{i2})(-X_{i1})=0 \\
\frac{\partial S}{\partial\beta_2}&amp;=2\sum_{i=1}^n(Y_i-\beta_0-\beta_1X_{i1}-\beta_2X_{i2})(-X_{i2})=0
\end{align}
\]</span></p>
<ul>
<li>정규방정식</li>
</ul>
<p><span class="math display">\[
\begin{align}
n\beta_0+\beta_1\sum_{i=1}^nX_{i1}+\beta_2\sum_{i=1}^nX_{i2}&amp;=\sum_{i=1}^nY_i \\
\beta_0\sum_{i=1}^nX_{i1}+\beta_1\sum_{i=1}^nX_{i1}^2+\beta_2\sum_{i=1}^nX_{i1}X_{i2}&amp;=\sum_{i=1}^n X_{i1}Y_i\\
\beta_0\sum_{i=1}^nX_{i2}+\beta_1\sum_{i=1}^nX_{i1}X_{i2}+\beta_2\sum_{i=1}^nX_{i2}^2&amp;=\sum_{i=1}^n X_{i2}Y_i
\end{align}
\]</span></p>
<ul>
<li>설명변수 개수가 증가함에 따라 동시에 풀어야 할 연립방정식 개수도 증가하기때문에 행렬을 이용하여 간결하고 이해하기 쉽게 표현</li>
</ul>
<p><br></p>
</div>
<div id="다중선형회귀모형---설명변수가-여러-개인-경우" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> 다중선형회귀모형 - 설명변수가 여러 개인 경우<a href="chapter4.html#다중선형회귀모형---설명변수가-여러-개인-경우" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p><span class="math inline">\(p\)</span>개 설명변수와 한 개의 반응변수를 포함한 관측벡터터 <span class="math inline">\((X_{11},X_{12},\cdots, X_{1p},y_1), (X_{21},X_{22},\cdots, X_{2p},y_2), \cdots, (X_{n1},X_{n2},\cdots, X_{np},y_n)\)</span>에 대해 다중선형회귀모형을 생각해 보자.</p></li>
<li><p><span class="math inline">\(X_1, X_2,\cdots, X_p\)</span>는 <span class="math inline">\(p\)</span>개의 고정된(fixed) 설명변수이고 <span class="math inline">\(Y\)</span>는 일변량 반응변수인 경우, 설명변수들과 반응변수 간의 선형회귀모형은</p></li>
</ul>
<p><span class="math display">\[
Y=\beta_0+\beta_1X_{1}+\cdots +\beta_pX_{p}+\epsilon
\]</span></p>
<p>      여기서 회귀모수로 <span class="math inline">\(\beta_0\)</span>는 절편, <span class="math inline">\(\beta_j\)</span>, <span class="math inline">\(j=1,2,\cdots, p\)</span>는 회귀계수, 오차항 <span class="math inline">\(\epsilon \stackrel{iid}{\sim} N(0,\sigma^2)\)</span>을 가정</p>
<ul>
<li><span class="math inline">\(n\)</span>개 관측점에 대해 표현하면</li>
</ul>
<p><span class="math display">\[
Y_i=\beta_0+\beta_1X_{1i}+\cdots+\beta_pX_{pi}+\epsilon_i, \,\,\, i=1,2,\cdots, n
\]</span></p>
<ul>
<li>일반적으로 오차항 <span class="math inline">\(\epsilon_i\)</span>에 대한 가정으로부터</li>
</ul>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(E(\epsilon_i)=0, \,\,\, i=1,2,,\cdots, n\)</span></p></li>
<li><p><span class="math inline">\(Var(\epsilon_i)=\sigma^2, \,\,\, i=1,2,,\cdots, n\)</span></p></li>
<li><p><span class="math inline">\(Cov(\epsilon_i, \epsilon_j)=0, \,\,\, i\ne j\)</span></p></li>
</ol>
<ul>
<li><p>즉, 오차항은 서로 독립이며 평균 <span class="math inline">\(0\)</span>, 분산 <span class="math inline">\(\sigma^2\)</span>인 정규분포 <span class="math inline">\(N(0,\sigma^2)\)</span>을 따른다고 가정함</p></li>
<li><p>오차항 <span class="math inline">\(\epsilon\)</span>이 정규분포를 따르면 <span class="math inline">\(Y\)</span>도 정규분포를 따르게 됨</p></li>
<li><p>따라서, 주어진 <span class="math inline">\(X\)</span>에 대해서 <span class="math inline">\(Y\)</span>의 기대값과 분산은 다음과 같음</p></li>
</ul>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(E(Y_i)=\beta_0+\beta_1X_{1i}+\cdots+\beta_pX_{pi}, \,\,\, i=1,2,,\cdots, n\)</span></p></li>
<li><p><span class="math inline">\(Var(Y_i)=\sigma^2, \,\,\, i=1,2,,\cdots, n\)</span></p></li>
<li><p><span class="math inline">\(Cov(Y_i, Y_j)=0, \,\,\, i\ne j\)</span></p></li>
</ol>
<ul>
<li>모형을 행렬과 벡터로 표현하면</li>
</ul>
<p><span class="math display">\[
\begin{pmatrix} Y_1\\Y_2\\\vdots\\Y_n \end{pmatrix}=\begin{pmatrix}1 &amp; X_{11}&amp;X_{12}&amp;\cdots&amp;X_{1p}\\
1 &amp;X_{21}&amp;X_{22}&amp;\cdots &amp;X_{2p}\\
&amp;\vdots &amp; &amp;\vdots &amp;\\ 1&amp;X_{n1}&amp;X_{n2}&amp;\cdots&amp;X_{np} \end{pmatrix} \begin{pmatrix}\beta_0\\ \beta_1\\ \vdots \\ \beta_p \end{pmatrix}+\begin{pmatrix} \epsilon_1\\ \epsilon_2 \\ \vdots \\ \epsilon_n \end{pmatrix}
\]</span></p>
<ul>
<li>또한</li>
</ul>
<p><span class="math display">\[
\mathbf{Y}=\mathbf{X}\beta+\epsilon
\]</span></p>
<p>      여기서 <span class="math inline">\(\mathbf{Y}\)</span>와 <span class="math inline">\(\epsilon\)</span>은 <span class="math inline">\(n\times 1\)</span> 벡터, <span class="math inline">\(\mathbf{X}\)</span>는 <span class="math inline">\(n\times (p+1)\)</span> 행렬이고 <span class="math inline">\(\beta\)</span>는 <span class="math inline">\((p+1) \times 1\)</span> 벡터임</p>
<ul>
<li>회귀분석과정으로 반응관측값 <span class="math inline">\(\mathbf{Y}\)</span>를 설명변수 <span class="math inline">\(X_1\)</span>과 <span class="math inline">\(X_2\)</span>가 만드는 공간으로 투영시켜 반응추정값을 구하는 기하학적 표현</li>
</ul>
<center>
<img src="fig4/f1.png" style="width:80.0%" />
</center>
<ul>
<li>선형최소제곱법을 이용한 회귀직선 적합</li>
</ul>
<center>
<img src="fig4/f2.png" style="width:80.0%" />
</center>
<p><br></p>
</div>
<div id="모수-추정-1" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> 모수 추정<a href="chapter4.html#모수-추정-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="최소제곱법을-이용한-모수추정" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> 최소제곱법을 이용한 모수추정<a href="chapter4.html#최소제곱법을-이용한-모수추정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>오차제곱합을 최소화하는 최소제곱법을 이용하여 회귀계수 추정량을 구하는 방법은 표본자료로부터 회귀계수를 추정하는 방법 중 가장 널리 이용되는 방법</p></li>
<li><p>회귀계수 <span class="math inline">\(\beta\)</span>의 추정값 <span class="math inline">\(\hat{\beta}\)</span>을 구하기 위한 오차제곱합</p></li>
</ul>
<p><span class="math display">\[ \begin{align}
S(\beta)&amp;=\sum_{i=1}^n\epsilon_i^2\\
&amp;=\sum_{i=1}^n(Y_i-\beta_0-\beta_1X_{i1}-\cdots - \beta_pX_{ip})^2\\
&amp;=(\mathbf{Y}-\mathbf{X}\beta)&#39;(\mathbf{Y}-\mathbf{X}\beta)
\end{align}
\]</span></p>
<ul>
<li>다중선형회귀모형에서 <span class="math inline">\(\mathbf{X}\)</span>가 완전계수(full rank) <span class="math inline">\(p+1\le n\)</span>일 때, 회귀계수 <span class="math inline">\(\beta\)</span>의 최소제곱추정량(least squares estimator)은</li>
</ul>
<p><span class="math display">\[
\hat{\beta}=\mathbf{(X&#39;X)^{-1}X&#39;Y}
\]</span></p>
<ul>
<li>Proof</li>
</ul>
<p><span class="math display">\[
S(\beta)=\mathbf(Y&#39;Y - Y&#39;X\beta - \beta&#39;X&#39;Y+\beta&#39;X&#39;X\beta)
\]</span></p>
<p><span class="math display">\[
\frac{\partial S}{\partial \beta}= -2\mathbf{X&#39;Y}+2\mathbf{X&#39;X\beta}=0
\]</span></p>
<ul>
<li>Proof hint:</li>
</ul>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(x, y\)</span>가 <span class="math inline">\(n\)</span>차원 벡터일 때</li>
</ol>
<p><span class="math display">\[
\frac{\partial}{\partial x}(x&#39;y)=\frac{\partial}{\partial x}(y&#39;x)=y
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><span class="math inline">\(x\)</span>가 <span class="math inline">\(n\)</span>차원 벡터이고 <span class="math inline">\(\mathbf{A}\)</span>가 <span class="math inline">\(n\times n\)</span> 행렬일 때때</li>
</ol>
<p><span class="math display">\[
\frac{\partial}{\partial x}(x&#39; \mathbf{A})=\mathbf{A}, \,\,\, \frac{\partial}{\partial x}(\mathbf{A}x)=\mathbf{A&#39;}
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><span class="math inline">\(n\)</span>차원 벡터 <span class="math inline">\(x\)</span>의 이차형식에 대한 미분은</li>
</ol>
<p><span class="math display">\[
\frac{\partial}{\partial x}(x&#39; \mathbf{A}x)=\mathbf{A}x + \mathbf{A&#39;}x = 2\mathbf{A}x, \,\,\, \mathbf{A}: symmetric
\]</span></p>
<ul>
<li><span class="math inline">\(\mathbf{H=X(X&#39;X)^{-1}X&#39;}\)</span> (hat matrix)라고 하면</li>
</ul>
<p><span class="math display">\[ \begin{align}
&amp;\mathbf{\hat{Y}=X\hat{\beta}=HY}\\
&amp;e=\mathbf{Y-\hat{Y}=[I-X(X&#39;X)^{-1}X&#39;]Y=(I-H)Y}
\end{align}
\]</span></p>
<ul>
<li><p><span class="math inline">\(\mathbf{X&#39;}e=0\)</span>과 <span class="math inline">\(\mathbf{Y&#39;}e=0\)</span>를 만족함</p></li>
<li><p>잔차제곱합</p></li>
</ul>
<p><span class="math display">\[ \begin{align}
S(\beta)&amp;=\sum_{i=1}^n(Y_i-\hat{\beta}_0-\hat{\beta}_1X_{i1}-\cdots - \hat{\beta}_pX_{ip})^2\\
&amp;=e&#39;e\\
&amp;=\mathbf{Y&#39;[I-X(X&#39;X)^{-1}X&#39;]Y}\\
&amp;=\mathbf{Y&#39;Y-Y&#39;X\hat{\beta}}
\end{align}
\]</span></p>
<ul>
<li>단순회귀모형에 대해 다변량 추정량을 이용해 회귀계수벡터를 구해보자. 단순선형회귀모형 <span class="math inline">\(\mathbf{Y=X\beta+\epsilon}\)</span></li>
</ul>
<p><span class="math display">\[
\begin{pmatrix} Y_1\\Y_2\\\vdots\\Y_n \end{pmatrix}=\begin{pmatrix}1 &amp; X_{11}\\
1 &amp;X_{21}\\
\vdots &amp;\vdots\\
1&amp; X_{n1}\end{pmatrix} \begin{pmatrix}\beta_0\\ \beta_1 \end{pmatrix}+\begin{pmatrix} \epsilon_1\\ \epsilon_2 \\ \vdots \\ \epsilon_n \end{pmatrix}
\]</span></p>
<p>      여기서 <span class="math inline">\(\mathbf{Y}\)</span>와 <span class="math inline">\(\epsilon\)</span>은 <span class="math inline">\(n\times 1\)</span> 벡터, <span class="math inline">\(\mathbf{X}\)</span>는 <span class="math inline">\(n\times 2\)</span> 행렬이고 <span class="math inline">\(\beta\)</span>는 <span class="math inline">\(2 \times 1\)</span> 벡터임</p>
<p><span class="math display">\[
\mathbf{(X&#39;X)}=\begin{pmatrix}
n&amp;\sum_{i=1}^nX_i\\
\sum_{i=1}^nX_i &amp; \sum_{i=1}^nX_i^2
\end{pmatrix}, \,\,\,
\mathbf{X&#39;Y}=\begin{pmatrix}
\sum_{i=1}^nY_i\\
\sum_{i=1}^nX_iY_i
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[ \begin{align}
\mathbf(X&#39;X)^{-1}&amp;=\frac{1}{n\sum_{i=1}^nX_i^2-(\sum_{i=1}^nX_i)^2}\begin{pmatrix}\sum_{i=1}^nX_i^2 &amp; -\sum_{i=1}^nX_i\\
-\sum_{i=1}^nX_i &amp; n
\end{pmatrix}\\
&amp;=\frac{1}{\sum_{i=1}^n(X_i-\bar{X})^2}\begin{pmatrix}\frac{1}{n}\sum_{i=1}^nX_i^2 &amp; -\bar{X}\\
-\bar{X} &amp; 1
\end{pmatrix}
\end{align}
\]</span></p>
<ul>
<li>따라서</li>
</ul>
<p><span class="math display">\[\begin{align}
\hat{\beta}=
\begin{pmatrix}
\hat{\beta}_0 \\
\hat{\beta}_1
\end{pmatrix}=\mathbf{(X&#39;X)^{-1}X&#39;Y}&amp;=\frac{1}{\sum_{i=1}^n(X_i-\bar{X})^2}\begin{pmatrix}\frac{1}{n}\sum_{i=1}^nX_i^2 &amp; -\bar{X}\\
-\bar{X} &amp; 1
\end{pmatrix}\begin{pmatrix} \sum_{i=1}^nY_i\\ \sum_{i=1}^nX_iY_i \end{pmatrix}\\
&amp;= \begin{pmatrix} \bar{Y}-\hat{\beta}_1\bar{X}\\
\frac{\sum_{i=1}^nX_iY_i-n\bar{X}\bar{Y}}{\sum_{i=1}^n(X_i-\bar{X})^2}\end{pmatrix}
\end{align}
\]</span></p>
</div>
<div id="가능도함수를-이용한-모수-추정-1" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> 가능도함수를 이용한 모수 추정<a href="chapter4.html#가능도함수를-이용한-모수-추정-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>오차항이 정규분포를 따른다는 가정하에 관측값에 대한 가능도함수를 벡터와 행렬을 이용하여 표현하면</li>
</ul>
<p><span class="math display">\[
P(\mathbf{Y}|\beta, \sigma^2, \mathbf{X})=(2\pi\sigma^2)^{-n/2}exp(-\frac{\mathbf{(Y-X\beta)&#39;(Y-X\beta)}}{2\sigma^2})
\]</span></p>
<ul>
<li>가능도함수를 log 변환을 하면 모수 <span class="math inline">\(\beta\)</span>에 영향을 받는 부분은 <span class="math inline">\(-\mathbf{(Y-X\beta)&#39;(Y-X\beta)}\)</span> 부분만 남게 됨
<ul>
<li>최대가능도 추정량은 가능도 함수를 최대화 하는 모수 값을 찾기 때문에 결국 -부호를 제거하면 <span class="math inline">\(\mathbf{(Y-X\beta)&#39;(Y-X\beta)}\)</span>를 최소화 하는 모수 추정량을 찾는 문제가 같아짐</li>
<li>따라서 최대가능도 추정량은 최소제곱 추정량과 같음</li>
</ul></li>
</ul>
<p><span class="math display">\[
\hat{\beta}=\mathbf{(X&#39;X)^{-1}X&#39;Y}
\]</span></p>
<ul>
<li>로그 가능도함수를 <span class="math inline">\(\sigma^2\)</span>에 대해 미분하여 얻은 최대가능도 추정량은</li>
</ul>
<p><span class="math display">\[
\begin{align}
\hat{\sigma}_{ML}^2=\frac{\mathbf{(Y-X\hat{\beta})&#39;(Y-X\hat{\beta})}}{n}
\end{align}
\]</span></p>
</div>
<div id="추정량의-성질-1" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> 추정량의 성질<a href="chapter4.html#추정량의-성질-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>회귀계수의 최소제곱 추정량은 불편성과 최소분산성을 만족하는 우수한 추정량</li>
</ul>
<div id="가우스-마코프-정리" class="section level4 unnumbered hasAnchor">
<h4>가우스-마코프 정리<a href="chapter4.html#가우스-마코프-정리" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>다중선형회귀모형의 오차벡터에 대해 <span class="math inline">\(E(\epsilon)=0\)</span>이고 오차항이 서로 독립이고 등분산인 경우 회귀계수에 대한 최적선형불편추정량(best linear unbiased estimator: BLUE)은 최소제곱추정량임</li>
</ul>
</div>
<div id="증명-1" class="section level4 unnumbered hasAnchor">
<h4>증명<a href="chapter4.html#증명-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>모수들의 선형조합 <span class="math inline">\(\psi=c&#39;\beta\)</span>는 다음과 같은 선형조합이 존재할 경우에만 추정가능함(estimable):</li>
</ul>
<p><span class="math display">\[
E(a&#39;y)=c&#39;\beta \,\,\, \forall\beta
\]</span></p>
<ul>
<li><p>만약 <span class="math inline">\(\mathbf{X}\)</span>가 완전 행렬계수(full rank)라면 모든 선형조합은 추정가능함</p></li>
<li><p>가우스-마코프 정리는 불편성을 지닌 선형조합들 중 최소제곱 추정량이 최소분산(minimum variance)을 가지고 유일하다고(unique) 설명함</p></li>
<li><p><span class="math inline">\(a&#39;y\)</span>는 <span class="math inline">\(c&#39;\beta\)</span>의 불편추정량이라고 가정하면 모든 <span class="math inline">\(\beta\)</span>에 대해 <span class="math inline">\(E(a&#39;y)=c&#39;\beta\)</span> 이므로</p></li>
</ul>
<p><span class="math display">\[
a&#39;\mathbf{X}\beta=c&#39;\beta
\]</span></p>
<p>      가 되므로 <span class="math inline">\(a&#39;\mathbf{X}=c&#39;\)</span>.</p>
<ul>
<li>벡터 <span class="math inline">\(c\)</span>는 <span class="math inline">\(\mathbf{X&#39;}\)</span>의 공간에 있어야함. 즉, <span class="math inline">\(\mathbf{X&#39;X}\)</span>의 공간에 있어야 하므로 <span class="math inline">\(c=\mathbf{X&#39;X}\lambda\)</span>를 만족하는 <span class="math inline">\(\lambda\)</span>가 존재해야 함. 따라서</li>
</ul>
<p><span class="math display">\[
c&#39;\hat{\beta}=\lambda&#39;\mathbf{X&#39;X}\hat{\beta}=\lambda&#39;\mathbf{X}&#39;y
\]</span></p>
<ul>
<li>추정량 <span class="math inline">\(a&#39;y\)</span>의 분산을 구해 보면</li>
</ul>
<p><span class="math display">\[
\begin{align}
Var(a&#39;y)&amp;=Var(a&#39;y-c&#39;\hat{\beta}+c&#39;\hat{\beta})\\
&amp;=Var(a&#39;y-\lambda&#39;\mathbf{X}&#39;y+c&#39;\hat{\beta})\\
&amp;=Var(a&#39;y-\lambda&#39;\mathbf{X}&#39;y)+Var(c&#39;\hat{\beta})+2cov(a&#39;y-\lambda&#39;\mathbf{X}&#39;y,\lambda&#39;\mathbf{X}&#39;y)
\end{align}
\]</span></p>
<ul>
<li>여기서</li>
</ul>
<p><span class="math display">\[
\begin{align}
cov(a&#39;y-\lambda&#39;\mathbf{X}&#39;y,\lambda&#39;\mathbf{X}&#39;y)&amp;=(a&#39;-\lambda&#39;\mathbf{X}&#39;)\sigma^2\mathbf{IX}\lambda\\
&amp;=(a&#39;\mathbf{X}-\lambda&#39;\mathbf{X&#39;X})\sigma^2\mathbf{I}\lambda\\
&amp;=(c&#39;-c&#39;)\sigma^2\mathbf{I}\lambda\\
&amp;=0
\end{align}
\]</span></p>
<ul>
<li>따라서</li>
</ul>
<p><span class="math display">\[
Var(a&#39;y)=Var(a&#39;y-\lambda&#39;\mathbf{X}&#39;y)+Var(c&#39;\hat{\beta})\ge Var(c&#39;\hat{\beta})
\]</span></p>
<ul>
<li><p>즉, <span class="math inline">\(c&#39;\hat{\beta}\)</span>는 최소분산을 가짐</p></li>
<li><p><span class="math inline">\(c&#39;\hat{\beta}\)</span>의 유일성</p>
<ul>
<li>위 분산 텀에서 <span class="math inline">\(Var(c&#39;\hat{\beta})\)</span>와 같아지려면</li>
</ul></li>
</ul>
<p><span class="math display">\[
Var(a&#39;y-\lambda&#39;\mathbf{X}&#39;y)=0
\]</span></p>
<p>      이어야 하므로 <span class="math inline">\((a&#39;-\lambda&#39;\mathbf{X})=0\)</span>이 되고 <span class="math inline">\(a&#39;y=\lambda&#39;\mathbf{X}&#39;y=c&#39;\hat{\beta}\)</span>가 됨</p>
<ul>
<li>따라서 등호는 <span class="math inline">\(a&#39;y=c&#39;\hat{\beta}\)</span>인 경우에만 성립하므로 등호가 성립되는 경우의 유일한 추정량이 됨</li>
</ul>
</div>
<div id="회귀계수-최소제곱추정량-hatbetamathbfxx-1xy-특성" class="section level4 unnumbered hasAnchor">
<h4>회귀계수 최소제곱추정량 <span class="math inline">\(\hat{\beta}=\mathbf{(X&#39;X)^{-1}X&#39;Y}\)</span> 특성<a href="chapter4.html#회귀계수-최소제곱추정량-hatbetamathbfxx-1xy-특성" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>회귀계수의 불편성</li>
</ul>
<p><span class="math display">\[
E(\hat{\beta})=E[\mathbf{(X&#39;X)^{-1}X&#39;Y}]=\mathbf{(X&#39;X)^{-1}X&#39;}E(\mathbf{Y})=\mathbf{(X&#39;X)^{-1}X&#39;X\beta}=\beta
\]</span></p>
<ul>
<li>회귀계수의 공분산 행렬</li>
</ul>
<p><span class="math display">\[
cov(\hat{\beta})=cov(\mathbf{(X&#39;X)^{-1}X&#39;Y})=\mathbf{(X&#39;X)^{-1}X&#39;}cov(\mathbf{Y})\mathbf{X(X&#39;X)^{-1}}= \sigma^2(\mathbf{X&#39;X})^{-1}
\]</span></p>
<ul>
<li>잔차벡터 <span class="math inline">\(e=\{e_1,\cdots, e_n\}&#39;\)</span>에 대해</li>
</ul>
<p><span class="math display">\[
E(e)=0, \,\,\, Cov(e)=\sigma^2(\mathbf{I-H})
\]</span></p>
<ul>
<li>분산추정량</li>
</ul>
<p><span class="math display">\[
S^2=\frac{e&#39;e}{n-(p+1)}=\frac{\mathbf{Y&#39;[I-X(X&#39;X)^{-1}X&#39;]Y}}{n-p-1}=\frac{\mathbf{Y&#39;[I-H]Y}}{n-p-1}
\]</span></p>
<ul>
<li><span class="math inline">\(E(S^2)=\sigma^2\)</span>을 만족하므로 <span class="math inline">\(S^2\)</span>은 <span class="math inline">\(\sigma^2\)</span>의 불편추정량</li>
</ul>
<p><br></p>
</div>
</div>
</div>
<div id="회귀모형-추정" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> 회귀모형 추정<a href="chapter4.html#회귀모형-추정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="회귀계수에-대한-검정-1" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> 회귀계수에 대한 검정<a href="chapter4.html#회귀계수에-대한-검정-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>회귀모형에 대한 유의성은 각 회귀계수에 대한 유의성 문제와 관련이 있음</p></li>
<li><p>가설</p></li>
</ul>
<p><span class="math display">\[
H_{0j}:\beta_j=0 \,\,\, vs. H_{1j}:\beta_j\ne 0, \,\,\, j=1,2,\cdots,p
\]</span></p>
<ul>
<li>검정통계량</li>
</ul>
<p><span class="math display">\[
t_j=\frac{\hat{\beta}_j}{\hat{Var}(\hat{\beta})}=\frac{\hat{\beta}_j}{s\sqrt{q_{jj}}} \sim t_{n-p-1}
\]</span></p>
<ul>
<li><p>여기서 <span class="math inline">\(q_{jj}\)</span>는 <span class="math inline">\((\mathbf{X&#39;X)^{-1}}\)</span>의 <span class="math inline">\(j\)</span>번째 대각선상 <span class="math inline">\(j=1,2,\ldots, p\)</span>에 놓은 값임</p></li>
<li><p>유의수준 <span class="math inline">\(\alpha\)</span> 검정</p></li>
</ul>
<p><span class="math display">\[
|t_j|\ge t_{n-p-1}(\alpha/2) \,\,\, \text{then reject} \,\,\, H_0
\]</span></p>
<ul>
<li><span class="math inline">\(H_0\)</span>를 기각하는 경우 <span class="math inline">\(\beta_j=0\)</span>이라고 할 수 없으므로 추정된 회귀계수가 회귀모형에 기여함을 알 수 있음</li>
</ul>
</div>
<div id="회귀계수에-대한-신뢰구간-1" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> 회귀계수에 대한 신뢰구간<a href="chapter4.html#회귀계수에-대한-신뢰구간-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>각 회귀계수에 대한 신뢰구간은 <span class="math inline">\(t\)</span>-분포를 이용하여 구함</p></li>
<li><p><span class="math inline">\(\beta_j\)</span>에 대한 <span class="math inline">\(100(1-\alpha)\%\)</span> 신뢰구간은</p></li>
</ul>
<p><span class="math display">\[
\hat{\beta}\pm t_{n-p-1}(\alpha/2)\sqrt{\hat{Var}(\hat{\beta}_j)}
\]</span></p>
<div id="hatbeta의-분포" class="section level4 unnumbered hasAnchor">
<h4><span class="math inline">\(\hat{\beta}\)</span>의 분포<a href="chapter4.html#hatbeta의-분포" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><span class="math inline">\(\mathbf{Y=X\beta+\epsilon}\)</span>, <span class="math inline">\(rank(\mathbf{X})=p+1\)</span>이고, <span class="math inline">\(\epsilon\sim N_n(0, \sigma^2I)\)</span>일 때 회귀계수벡터 <span class="math inline">\(\beta\)</span>의 최대우도추정량과 최소제곱추정량은 일치함</li>
</ul>
<p><span class="math display">\[
\hat{\beta}=\mathbf{(X&#39;X)^{-1}X&#39;Y}\sim N_{p+1}(\beta,\sigma^2(\mathbf{X&#39;X})^{-1})
\]</span></p>
<ul>
<li>잔차에 대해서는 <span class="math inline">\(e=\mathbf{Y-X\beta}\)</span>일 때,</li>
</ul>
<p><span class="math display">\[
n\hat{\sigma}^2=e&#39;e \sim \sigma^2 \chi_{n-p-1}^2
\]</span></p>
</div>
<div id="동시신뢰영역" class="section level4 unnumbered hasAnchor">
<h4>동시신뢰영역<a href="chapter4.html#동시신뢰영역" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><span class="math inline">\(\mathbf{Y=X\beta+\epsilon}\)</span>, <span class="math inline">\(rank(\mathbf{X})=p+1\)</span>이고, <span class="math inline">\(\epsilon\sim N_n(0, \sigma^2I)\)</span>일 때 회귀계수벡터 <span class="math inline">\(\beta\)</span>에 대한 <span class="math inline">\(100(1-\alpha)\%\)</span> 신뢰영역은</li>
</ul>
<p><span class="math display">\[
(\beta-\hat{\beta})&#39;\mathbf{X&#39;X}(\beta-\hat{\beta})\le (p+1)S^2 F_{p+1,n-p-1}(\alpha)
\]</span></p>
<ul>
<li><span class="math inline">\(\beta_j\)</span>에 대한 <span class="math inline">\(100(1-\alpha)\%\)</span> 동시신뢰구간은</li>
</ul>
<p><span class="math display">\[
\hat{\beta}_j\pm \sqrt{\hat{Var}(\hat{\beta}_j)}\times \sqrt{(p+1)F_{p+1,n-p-1}(\alpha)}, \,\,\, j=0, 1, \cdots , p
\]</span></p>
<ul>
<li>여기서 <span class="math inline">\(S^2\)</span>은 MSE이고 <span class="math inline">\(\hat{Var}(\hat{\beta}_j)\)</span>는 <span class="math inline">\(S^2(\mathbf{X&#39;X})^{-1}\)</span>의 대각선상에서 <span class="math inline">\(j\)</span>번째 원소</li>
</ul>
<p><br></p>
</div>
</div>
</div>
<div id="모형에-대한-적합도-검정-1" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> 모형에 대한 적합도 검정<a href="chapter4.html#모형에-대한-적합도-검정-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>회귀모형을 적합한 후에는 그 모형에 대한 적합성 또는 타당성에 대한 평가를 해야하고 만약 회귀모형에 대한 적합도가 충분하지 않다면 설명력이 높은 적절한 회귀모형을 찾아야 함</li>
</ul>
<div id="결정계수-1" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> 결정계수<a href="chapter4.html#결정계수-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>회귀모형을 적합한 후 전체변동을 회귀모형에 의한 변동과 오차에 의한 변동으로 나누었을 대 회귀모형에 의해 설명되는 부분이 클수록 모형의 적합도가 증가하게 됨</p></li>
<li><p>제곱합 분해</p></li>
</ul>
<p><span class="math display">\[
\begin{align}
\mathbf{(Y-\bar{Y})&#39;(Y-\bar{Y})}&amp;=\mathbf{[(\hat{Y}-\bar{Y})+(Y-\hat{Y})]}&#39;\mathbf{[(\hat{Y}-\bar{Y})+(Y-\hat{Y})]}\\
&amp;=\mathbf{(\hat{Y}-\bar{Y})&#39;(\hat{Y}-\bar{Y})+(Y-\hat{Y})&#39;(Y-\hat{Y})}\\
&amp;=\sum_{i=1}^n(\hat{Y}_i-\bar{Y})^2+\sum_{i=1}^ne_i^2\\
TSS&amp;=SSR+SSE
\end{align}
\]</span></p>
<ul>
<li><p>전체 변동 <span class="math inline">\(SST\)</span>는 회귀제곱합 <span class="math inline">\(SSR\)</span>과 잔차제곱합 <span class="math inline">\(SSE\)</span>로 분해</p></li>
<li><p>결정계수</p></li>
</ul>
<p><span class="math display">\[
R^2=\frac{\sum_{i=1}^n(\hat{Y}_j-\bar{Y})^2}{\sum_{i=1}^n(Y_j-\bar{Y})^2}=1-\frac{\sum_{i=1}^ne_i^2}{\sum_{i=1}^n(Y_j-\bar{Y})^2}
\]</span></p>
<ul>
<li><p>결정계수는 전체 변동 중 적합된 회귀식에 의해 설명되는 비율을 나타냄</p></li>
<li><p>결정계수 <span class="math inline">\(R^2\)</span>는 설명변수 개수가 증가할수록 무조건 증가함</p></li>
<li><p>수정된 결정계수(adjusted <span class="math inline">\(R^2\)</span>)</p></li>
</ul>
<p><span class="math display">\[
R_{adj}^2=1-(1-R^2)(\frac{n-1}{n-p-1})=1-\frac{SSE/(n-p-1)}{TSS/(n-1)}
\]</span></p>
<ul>
<li><p>총변동을 회귀모형에 의한 변동과 오차 요인에 의한 변동으로 분해하여 분산분석을 통해 모형의 유의성에 대해 검정이 가능함</p></li>
<li><p>가설</p>
<ul>
<li><span class="math inline">\(H_0:\mathbf{Y}=\beta_0\mathbf{1}+\epsilon\)</span></li>
<li><span class="math inline">\(H_1:\mathbf{Y=X\beta+\epsilon}\)</span></li>
<li>여기서 <span class="math inline">\(\mathbf{1}=(1,\cdots, 1)&#39;\)</span>로 <span class="math inline">\(n\times 1\)</span> 벡터</li>
</ul></li>
<li><p>검정통계량</p></li>
</ul>
<p><span class="math display">\[
F_{model}=\frac{(TSS-SSE)/p}{SSE/(n-p-1)}\sim F_{p,n-p-1}
\]</span></p>
<ul>
<li>유의수준 <span class="math inline">\(\alpha\)</span> 검정</li>
</ul>
<p><span class="math display">\[
F_{model}\ge F_{p,n-p-1}(\alpha) \,\,\, \text{then reject} \,\,\, H_0
\]</span></p>
<ul>
<li>귀무가설하에서는 설명변수가 반응변수와 관련 없이 상수함수로 주어지는 경우로 이러한 상황에서는 두 변수 간의 관련식을 구할 필요가 없음
<ul>
<li>귀무가설을 기각하지 못하면 추정된 회귀모형이 유의하지 않게 됨</li>
</ul></li>
<li>다중회귀모형 분산분석표</li>
</ul>
<table style="width:100%;">
<colgroup>
<col width="16%" />
<col width="16%" />
<col width="16%" />
<col width="16%" />
<col width="16%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">요인(source)</th>
<th align="center">자유도(df)</th>
<th align="center">제곱합(SS)</th>
<th align="center">평균제곱합(MS)</th>
<th align="center"><span class="math inline">\(F\)</span>-통계량</th>
<th align="center">기각값</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">모형(model)</td>
<td align="center"><span class="math inline">\(p\)</span></td>
<td align="center"><span class="math inline">\(SSR\)</span></td>
<td align="center"><span class="math inline">\(MSR=SSR/p\)</span></td>
<td align="center"><span class="math inline">\(F_{model}=\frac{MSR}{MSE}\)</span></td>
<td align="center"><span class="math inline">\(F_{p,n-p-1}\)</span></td>
</tr>
<tr class="even">
<td align="center">오차(error)</td>
<td align="center"><span class="math inline">\(n-p-1\)</span></td>
<td align="center"><span class="math inline">\(SSE\)</span></td>
<td align="center"><span class="math inline">\(MSE=SSE/(n-p-1)\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">총합(total)</td>
<td align="center"><span class="math inline">\(n-1\)</span></td>
<td align="center"><span class="math inline">\(TSS\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody>
</table>
</div>
<div id="회귀계수벡터에-대한-검정" class="section level3 hasAnchor" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> 회귀계수벡터에 대한 검정<a href="chapter4.html#회귀계수벡터에-대한-검정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>다중회귀모형에서 반응변수와 설명변수벡터 간의 관계를 나타내는 부분이 회귀계수벡터이며, 이 회귀계수벡터에 대한 유의성이 모형의 유의성을 결정함</p></li>
<li><p>회귀계수벡터 <span class="math inline">\(\beta\)</span>는 다음과 같이 표현 가능</p></li>
</ul>
<p><span class="math display">\[
\beta=\begin{pmatrix}
\beta_0\\
\beta_{\mathbf{X}}
\end{pmatrix}
\]</span></p>
<ul>
<li><p>여기서 <span class="math inline">\(\beta_0\)</span>는 절편을 나타내므로 설명변수와의 관계는 <span class="math inline">\(\beta_{\mathbf{X}}\)</span>에서 나타나며 <span class="math inline">\(\beta_{\mathbf{X}}\)</span>에 대한 유의성 검정이 모형의 유의성 검정과 같게 됨</p></li>
<li><p>위 가설을 회귀계수벡터에 대해 표현하면</p>
<ul>
<li><span class="math inline">\(H_0: \beta_{\mathbf{X}}=0\)</span></li>
<li><span class="math inline">\(H_1: \beta_{\mathbf{X}}\ne 0\)</span></li>
</ul></li>
<li><p>검정통계량</p></li>
</ul>
<p><span class="math display">\[
F=\frac{SSR/p}{SSE/(n-p-1)}\sim F_{p,n-p-1}
\]</span></p>
<ul>
<li>유의수준 <span class="math inline">\(\alpha\)</span> 검정</li>
</ul>
<p><span class="math display">\[
F\ge F_{p,n-p-1}(\alpha) \,\,\, \text{then reject} \,\,\, H_0
\]</span></p>
<p><br></p>
</div>
</div>
<div id="신뢰구간과-예측구간" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> 신뢰구간과 예측구간<a href="chapter4.html#신뢰구간과-예측구간" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>반응변수는 변동이 있는 확률변수이기 대문에 정확한 예측값으로 점추정(point estimation)하기는 쉽지 않음</p></li>
<li><p>보완으로 회귀모형을 기반으로 반응변수를 포함한 예측구간 및 신뢰구간을 계산하여 구간추정(interval estimation)을 할 수 있음</p></li>
</ul>
<div id="반응평균과-반응평균에-대한-신뢰구간" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> 반응평균과 반응평균에 대한 신뢰구간<a href="chapter4.html#반응평균과-반응평균에-대한-신뢰구간" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>회귀모형을 적합한 구간 내에 있는 설명변수에서의 반응변수의 예측 문제</p></li>
<li><p>설명변수 <span class="math inline">\(\mathbf{x}*=(X_1*, X_2*, \cdots, X_p*)&#39;\)</span>에서의 종속변수 <span class="math inline">\(Y*=\beta_0+\beta_1X_1*+\beta_2X_2*+\cdots + \beta_pX_p*\)</span>의 반응평균을 구하면</p></li>
</ul>
<p><span class="math display">\[
y*=E(Y*)=\beta_0+\beta_1X_1*+\beta_2X_2*+\cdots + \beta_pX_p*=\mathbf{x}*&#39;\beta
\]</span></p>
<ul>
<li><p>여기서 <span class="math inline">\(\mathbf{x}*=(1,X_1*,X_2*,\cdots ,X_p*)&#39;\)</span></p></li>
<li><p><span class="math inline">\(y*\)</span>의 적합값(fitted value)</p></li>
</ul>
<p><span class="math display">\[
\hat{y}*=\mathbf{x}*&#39;\hat{\beta}
\]</span></p>
<ul>
<li><span class="math inline">\(Y*\)</span>의 불편추정량은 <span class="math inline">\(\hat{y}*\)</span>이고, 분산은</li>
</ul>
<p><span class="math display">\[
Var(\hat{y}*)=\sigma^2\mathbf{x}*&#39;(\mathbf{X&#39;X})^{-1}\mathbf{x}*
\]</span></p>
<ul>
<li>따라서 반응평균에 대한 추정값은</li>
</ul>
<p><span class="math display">\[
\hat{y}*=\mathbf{x}*&#39;\hat{\beta}\sim N(y*,\sigma^2\mathbf{x}*&#39;(\mathbf{X&#39;X})^{-1}\mathbf{x}*)
\]</span></p>
<ul>
<li><span class="math inline">\(\mathbf{x}*&#39;\)</span>에서 반응평균에 대한 추정값 <span class="math inline">\(\hat{y}*\)</span>에 대한 <span class="math inline">\(100(1-\alpha)\%\)</span> 신뢰구간</li>
</ul>
<p><span class="math display">\[
\hat{y}*\pm t_{n-p-1}(\alpha/2)\hat{se}[\hat{y}*]
\]</span></p>
<ul>
<li><span class="math inline">\(\hat{se}[\hat{y}*]\)</span>는 추정값 <span class="math inline">\(\hat{y}*\)</span>의 추정된 표준오차</li>
</ul>
<p><span class="math display">\[
\hat{se}[\hat{y}*]=S\sqrt{\mathbf{x}*&#39;(\mathbf{X&#39;X})^{-1}\mathbf{x}*}
\]</span></p>
<ul>
<li>여기서 <span class="math inline">\(S=\sqrt{MSE_{model}}\)</span>이고 <span class="math inline">\(MSE_{model}\)</span>은 적합한 모형에 대한 평균제곱오차</li>
</ul>
<p><br></p>
</div>
</div>
<div id="잔차분석" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> 잔차분석<a href="chapter4.html#잔차분석" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>잔차는 관측값과 추정값의 차이로 정의되며 회귀모형에 의하여 설명되지 않는 변동의 크기를 나타내는 오차에 대한 추정값</p></li>
<li><p>따라서 오차에 대한 가정의 성립여부는 잔차를 거토해 봄으로써 알 수 있음</p></li>
<li><p>다중선형회귀모형에서 오차항에 대한 가정</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>등분산성</li>
<li>독립성</li>
<li>평균 0인 정규성</li>
</ol>
<div id="회귀함수의-선형성-1" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> 회귀함수의 선형성<a href="chapter4.html#회귀함수의-선형성-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>선형회귀함수가 적합한지 적합하지 않은지에 대한 문제는 자료의 산점도를 그려보거나 선형회귀모형을 적합한 후의 잔차를 각 설명변수 또는 반응변수에 대해 그려봄으로써 추측할 수 있음</p></li>
<li><p>회귀직선의 모형이 타당하고 오차의 등분산성이 성립된다면 설명변수에 대한 잔차 산점도 또는 반응변수에 대한 잔차 산점도에서 잔차는 0을 중심으로 랜덤하게 나타나게 됨</p></li>
<li><p>예를 들어, 산점도에서 이차 곡선이나 삼차 곡선의 형태가 나타난다면 가정된 선형회귀함수는 적절하지 못하다고 볼 수 있음</p></li>
</ul>
</div>
<div id="오차항의-등분산성과-독립성-1" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> 오차항의 등분산성과 독립성<a href="chapter4.html#오차항의-등분산성과-독립성-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>잔차는 회귀직선의 모형이 타당하고 오차의 등분산성이 성립된다면 <span class="math inline">\(Y\)</span>에 대한 잔차산점도 또는 <span class="math inline">\(\hat{Y}\)</span>에 대한 잔차산점도에서 0을 중심으로 완전히 랜덤하게 나타나며 <span class="math inline">\(x\)</span>축 변수에 따라 어떤 경향도 나타나지 않아야 함</p></li>
<li><p>오차항의 독립성은 단순선형회귀모형에서와 마찬가지로 더빈-왓슨 검정을 통해 살펴볼 수 있음</p></li>
</ul>
</div>
<div id="오차항의-정규성-1" class="section level3 hasAnchor" number="4.7.3">
<h3><span class="header-section-number">4.7.3</span> 오차항의 정규성<a href="chapter4.html#오차항의-정규성-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>오차항의 확률분포가 정규분포에서 많이 벗어나는 경우는 정규성을 가정한 가설 검정 등의 추론을 할 수 없음</p></li>
<li><p>오차항의 정규성을 검토하는 방법으로 잔차들에 대해 정규 <span class="math inline">\(Q-Q\)</span> 그림을 그려 보고, 이들이 <span class="math inline">\(45\)</span>도 직선을 따라 분포하면 정규성을 따른다고 볼 수 있음</p></li>
<li><p>정규성을 만족한다는 귀무가설에 대해 <span class="math inline">\(Shapiro-Wilks\)</span> 검정통계량으로 정규성에 대한 검정을 할 수 있음</p></li>
</ul>
<p><br></p>
</div>
</div>
<div id="r을-이용한-다중회귀분석" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> R을 이용한 다중회귀분석<a href="chapter4.html#r을-이용한-다중회귀분석" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>R에서 lm() 함수를 이용하여 회귀분석 후 생성된 객체에 대해 사용할 수 있는 함수</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">함수 이름</th>
<th align="center">함수 설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">print()</td>
<td align="center">출력</td>
</tr>
<tr class="even">
<td align="center">summary()</td>
<td align="center">회귀분석후 기본적인 결과</td>
</tr>
<tr class="odd">
<td align="center">coef(), coefficients()</td>
<td align="center">추정된 회귀계수값</td>
</tr>
<tr class="even">
<td align="center">resid(), residuals()</td>
<td align="center">잔차</td>
</tr>
<tr class="odd">
<td align="center">fitted()</td>
<td align="center">반응변수 추정값</td>
</tr>
<tr class="even">
<td align="center">anova()</td>
<td align="center">요인에 대한 분산분석결과</td>
</tr>
<tr class="odd">
<td align="center">predict()</td>
<td align="center">새로운 데이터에 대한 추정</td>
</tr>
<tr class="even">
<td align="center">plot()</td>
<td align="center">회귀진단 그림</td>
</tr>
<tr class="odd">
<td align="center">confint()</td>
<td align="center">회귀계수에 대한 신뢰구간</td>
</tr>
<tr class="even">
<td align="center">deviance()</td>
<td align="center">잔차제곱합</td>
</tr>
<tr class="odd">
<td align="center">vcov()</td>
<td align="center">추정된 분산-공분산행렬</td>
</tr>
<tr class="even">
<td align="center">logLik()</td>
<td align="center">정규성 가정하에서 로그-가능도값</td>
</tr>
<tr class="odd">
<td align="center">AIC()</td>
<td align="center">정보기준값, AIC</td>
</tr>
<tr class="even">
<td align="center">step()</td>
<td align="center">AIC 기준으로 모형 선택과정</td>
</tr>
</tbody>
</table>
<div id="example-9" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="chapter4.html#example-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>R에 내장되어 있는 환경 데이터 airquality는 New York 도시의 153일 동안 오존, 일조량, 기온과 풍속을 기록한 데이터</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter4.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(airquality)</span></code></pre></div>
<pre><code>##   Ozone Solar.R Wind Temp Month Day
## 1    41     190  7.4   67     5   1
## 2    36     118  8.0   72     5   2
## 3    12     149 12.6   74     5   3
## 4    18     313 11.5   62     5   4
## 5    NA      NA 14.3   56     5   5
## 6    28      NA 14.9   66     5   6</code></pre>
<ul>
<li>산점도</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter4.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(airquality[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">panel=</span>panel.smooth)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch4_1-1.png" width="672" /></p>
<ul>
<li><p>pairs() 함수는 산점도 행렬을 보여주며, panel=panel.smooth 옵션을 사용하여 평활(smooth)시킨 함수를 추정하여 선으로 표현</p></li>
<li><p>Ozone에 대한 다중회귀모형</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="chapter4.html#cb4-1" aria-hidden="true" tabindex="-1"></a>lm.a <span class="ot">&lt;-</span> <span class="fu">lm</span>(Ozone <span class="sc">~</span> Solar.R <span class="sc">+</span> Wind <span class="sc">+</span> Temp, <span class="at">data=</span>airquality)</span>
<span id="cb4-2"><a href="chapter4.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.a)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Ozone ~ Solar.R + Wind + Temp, data = airquality)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -40.485 -14.219  -3.551  10.097  95.619 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -64.34208   23.05472  -2.791  0.00623 ** 
## Solar.R       0.05982    0.02319   2.580  0.01124 *  
## Wind         -3.33359    0.65441  -5.094 1.52e-06 ***
## Temp          1.65209    0.25353   6.516 2.42e-09 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 21.18 on 107 degrees of freedom
##   (결측으로 인하여 42개의 관측치가 삭제되었습니다.)
## Multiple R-squared:  0.6059, Adjusted R-squared:  0.5948 
## F-statistic: 54.83 on 3 and 107 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>추정된 회귀계수를 이용하여 Ozone에 대한 추정된 회귀식</li>
</ul>
<p><span class="math display">\[
Ozone=-63.34+0.059Solar.R-3.333Wind+1.652Temp
\]</span></p>
<ul>
<li><p>모형에 대한 결정계수는 <span class="math inline">\(61\%\)</span>이고, 회귀계수 검정결과 모든 회귀계수는 유의함</p></li>
<li><p>log(Ozone)에 대한 다중회귀모형</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="chapter4.html#cb6-1" aria-hidden="true" tabindex="-1"></a>lm.b <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Ozone) <span class="sc">~</span> Solar.R <span class="sc">+</span> Wind <span class="sc">+</span> Temp, <span class="at">data=</span>airquality)</span>
<span id="cb6-2"><a href="chapter4.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.b)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(Ozone) ~ Solar.R + Wind + Temp, data = airquality)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.06193 -0.29970 -0.00231  0.30756  1.23578 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.2621323  0.5535669  -0.474 0.636798    
## Solar.R      0.0025152  0.0005567   4.518 1.62e-05 ***
## Wind        -0.0615625  0.0157130  -3.918 0.000158 ***
## Temp         0.0491711  0.0060875   8.077 1.07e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5086 on 107 degrees of freedom
##   (결측으로 인하여 42개의 관측치가 삭제되었습니다.)
## Multiple R-squared:  0.6644, Adjusted R-squared:  0.655 
## F-statistic: 70.62 on 3 and 107 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li><p>log(Ozone) 모형에 대한 결정계수는 <span class="math inline">\(66\%\)</span>로, log 변환을 취한 경우가 약간 높음</p></li>
<li><p>유의수준 <span class="math inline">\(5\%\)</span>에서 회귀계수 검정결과 각 회귀계수는 유의함</p></li>
<li><p>잔차 그림</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="chapter4.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb8-2"><a href="chapter4.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.a, <span class="at">which=</span><span class="dv">1</span>)</span>
<span id="cb8-3"><a href="chapter4.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm.b, <span class="at">which=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch4_2-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapter4.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb9-2"><a href="chapter4.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(lm.a), <span class="fu">residuals</span>(lm.a), <span class="at">xlab=</span><span class="st">&quot;fitted&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;residual&quot;</span>)</span>
<span id="cb9-3"><a href="chapter4.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb9-4"><a href="chapter4.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(lm.b), <span class="fu">residuals</span>(lm.b), <span class="at">xlab=</span><span class="st">&quot;fitted&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;residual&quot;</span>)</span>
<span id="cb9-5"><a href="chapter4.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch4_3-1.png" width="672" /></p>
<ul>
<li><p>Ozone과 log(Ozone)에 대한 잔차 그림을 살펴보면 Ozone 모형은 오차에 대한 가정을 벗어나 보임</p></li>
<li><p>정규성 검정</p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapter4.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lm.a))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(lm.a)
## W = 0.91709, p-value = 3.618e-06</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapter4.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lm.b))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(lm.b)
## W = 0.97749, p-value = 0.05726</code></pre>
<ul>
<li><p>잔차에 대한 Shapiro-Wilks 정규성 검정 결과 유의수준 <span class="math inline">\(5\%\)</span>에서 Ozone 모형은 귀무가설을 기각하여 정규성을 만족하지 못함</p></li>
<li><p>독립성 검정</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter4.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb14-2"><a href="chapter4.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(Ozone <span class="sc">~</span> Solar.R <span class="sc">+</span> Wind <span class="sc">+</span> Temp, <span class="at">data=</span><span class="fu">na.omit</span>(airquality))</span></code></pre></div>
<pre><code>## 
##  Durbin-Watson test
## 
## data:  Ozone ~ Solar.R + Wind + Temp
## DW = 1.9355, p-value = 0.3347
## alternative hypothesis: true autocorrelation is greater than 0</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter4.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(<span class="fu">log</span>(Ozone) <span class="sc">~</span> Solar.R <span class="sc">+</span> Wind <span class="sc">+</span> Temp, <span class="at">data=</span><span class="fu">na.omit</span>(airquality))</span></code></pre></div>
<pre><code>## 
##  Durbin-Watson test
## 
## data:  log(Ozone) ~ Solar.R + Wind + Temp
## DW = 1.8068, p-value = 0.1334
## alternative hypothesis: true autocorrelation is greater than 0</code></pre>
<ul>
<li><p>두 모형 모두 독립성을 만족하는 것으로 나타남</p></li>
<li><p>동시 신뢰영역</p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter4.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)</span>
<span id="cb18-2"><a href="chapter4.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb18-3"><a href="chapter4.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ellipse</span>(lm.b,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb18-4"><a href="chapter4.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">coef</span>(lm.b)[<span class="dv">2</span>], <span class="fu">coef</span>(lm.b)[<span class="dv">3</span>], <span class="at">pch=</span><span class="dv">18</span>)</span>
<span id="cb18-5"><a href="chapter4.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">confint</span>(lm.b)[<span class="dv">2</span>,], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb18-6"><a href="chapter4.html#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">confint</span>(lm.b)[<span class="dv">3</span>,], <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb18-7"><a href="chapter4.html#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ellipse</span>(lm.b,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb18-8"><a href="chapter4.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">coef</span>(lm.b)[<span class="dv">2</span>], <span class="fu">coef</span>(lm.b)[<span class="dv">4</span>], <span class="at">pch=</span><span class="dv">18</span>)</span>
<span id="cb18-9"><a href="chapter4.html#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ellipse</span>(lm.b,<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span>
<span id="cb18-10"><a href="chapter4.html#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">coef</span>(lm.b)[<span class="dv">3</span>], <span class="fu">coef</span>(lm.b)[<span class="dv">4</span>], <span class="at">pch=</span><span class="dv">18</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch4_4-1.png" width="672" /></p>
<p><br></p>
</div>
</div>
<div id="다항회귀모형" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> 다항회귀모형<a href="chapter4.html#다항회귀모형" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>설명변수와 반응변수 사이의 곡선 관계는 다항식(polynomial)을 이용해 표현할 수 있음</p></li>
<li><p>수학적으로 <span class="math inline">\(k\)</span>차 다항식은</p></li>
</ul>
<p><span class="math display">\[
y=c_0+c_1x+c_2x^2+\cdots+c_kx^k
\]</span></p>
<ul>
<li>통계적 모형은</li>
</ul>
<p><span class="math display">\[
Y=\beta_0+\beta_1x+\beta_2x^2+\cdots+\beta_kx^k+\epsilon
\]</span></p>
<div id="example-10" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="chapter4.html#example-10" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>8마리의 실험쥐에 대해 <span class="math inline">\(A\)</span>약의 용량을 달리하여 투여한지 2주 후 몸무게 증가량을 측정하였다.</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">투여량</th>
<th align="center">1</th>
<th align="center">2</th>
<th align="center">3</th>
<th align="center">4</th>
<th align="center">5</th>
<th align="center">6</th>
<th align="center">7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">몸무게 증가량</td>
<td align="center">1.0</td>
<td align="center">1.2</td>
<td align="center">1.8</td>
<td align="center">2.0</td>
<td align="center">3.8</td>
<td align="center">4.3</td>
<td align="center">6.5</td>
</tr>
</tbody>
</table>
<ul>
<li>이와 같은 데이터에 대해 이차항이 포함된 다항회귀모형을 적합해보자</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter4.html#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>)</span>
<span id="cb19-2"><a href="chapter4.html#cb19-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.2</span>,<span class="fl">1.8</span>,<span class="fl">2.0</span>,<span class="fl">3.8</span>,<span class="fl">4.3</span>,<span class="fl">6.5</span>,<span class="fl">9.0</span>)</span>
<span id="cb19-3"><a href="chapter4.html#cb19-3" aria-hidden="true" tabindex="-1"></a>mouse.lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb19-4"><a href="chapter4.html#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mouse.lm)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Residuals:
##        1        2        3        4        5        6        7        8 
## -0.14167  0.05119  0.28214 -0.24881  0.45833 -0.49643 -0.11310  0.20833 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  1.49643    0.51333   2.915  0.03320 * 
## x           -0.53571    0.26172  -2.047  0.09602 . 
## I(x^2)       0.18095    0.02839   6.374  0.00141 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3679 on 5 degrees of freedom
## Multiple R-squared:  0.988,  Adjusted R-squared:  0.9832 
## F-statistic: 205.6 on 2 and 5 DF,  p-value: 1.582e-05</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter4.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb21-2"><a href="chapter4.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,mouse.lm<span class="sc">$</span>fitted.values)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch4_5-1.png" width="672" /></p>
<ul>
<li>다항회귀분석 결과, 추정회귀식</li>
</ul>
<p><span class="math display">\[
\hat{Y}=1.496-0.536X+0.181X^2
\]</span></p>
<ul>
<li><p><span class="math inline">\(R^2=0.983\)</span>으로 추정된 회귀직선의 설명력이 매우 높음</p></li>
<li><p>일차 회귀계수의 유의성 검정으로</p></li>
</ul>
<p><span class="math display">\[
H_0:\beta_1=0 \,\,\, vs. \,\,\, H_1:\beta_1\ne 0
\]</span></p>
<ul>
<li><p><span class="math inline">\(t\)</span> 통계량은 -2.047으로 <span class="math inline">\(p-value=0.096&lt;0.10\)</span>으로 유의수준 <span class="math inline">\(10\%\)</span>에서 <span class="math inline">\(H_0\)</span>를 기각함(유의수준 <span class="math inline">\(5\%\)</span>에서는 기각하지 못함)</p></li>
<li><p>이차 회귀계수의 유의성 검정으로</p></li>
</ul>
<p><span class="math display">\[
H_0:\beta_2=0 \,\,\, vs. \,\,\, H_1:\beta_2\ne 0
\]</span></p>
<ul>
<li><span class="math inline">\(t\)</span> 통계량은 6.374이며 <span class="math inline">\(p-value=0.00141&lt;0.10\)</span>으로 유의수준 <span class="math inline">\(10\%\)</span>에서 <span class="math inline">\(H_0\)</span>를 기각함(유의수준 <span class="math inline">\(5\%\)</span>에서도 기각함)</li>
</ul>
</div>
<div id="example-11" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="chapter4.html#example-11" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>보스턴의 lower status에 따라 주택 가치에 대한 자료이다.</p></li>
<li><p>이와 같은 데이터에 대해 선형회귀모형과 다항회귀모형을 비교해 보자</p></li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter4.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-2"><a href="chapter4.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;Boston&quot;</span>, <span class="at">package =</span> <span class="st">&quot;MASS&quot;</span>)</span>
<span id="cb22-3"><a href="chapter4.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Boston)</span></code></pre></div>
<pre><code>##      crim zn indus chas   nox    rm  age    dis rad tax ptratio  black lstat
## 1 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3 396.90  4.98
## 2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8 396.90  9.14
## 3 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8 392.83  4.03
## 4 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7 394.63  2.94
## 5 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7 396.90  5.33
## 6 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7 394.12  5.21
##   medv
## 1 24.0
## 2 21.6
## 3 34.7
## 4 33.4
## 5 36.2
## 6 28.7</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter4.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(medv<span class="sc">~</span>lstat, Boston)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch4_6-1.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapter4.html#cb25-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="fu">poly</span>(lstat, <span class="dv">1</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> Boston)</span>
<span id="cb25-2"><a href="chapter4.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ poly(lstat, 1, raw = TRUE), data = Boston)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -15.168  -3.990  -1.318   2.034  24.500 
## 
## Coefficients:
##                            Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                34.55384    0.56263   61.41   &lt;2e-16 ***
## poly(lstat, 1, raw = TRUE) -0.95005    0.03873  -24.53   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.216 on 504 degrees of freedom
## Multiple R-squared:  0.5441, Adjusted R-squared:  0.5432 
## F-statistic: 601.6 on 1 and 504 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chapter4.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Boston, <span class="fu">aes</span>(lstat, medv) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-2"><a href="chapter4.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">1</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch4_7-1.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chapter4.html#cb28-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="fu">poly</span>(lstat, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> Boston)</span>
<span id="cb28-2"><a href="chapter4.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ poly(lstat, 3, raw = TRUE), data = Boston)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.5441  -3.7122  -0.5145   2.4846  26.4153 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                 48.6496253  1.4347240  33.909  &lt; 2e-16 ***
## poly(lstat, 3, raw = TRUE)1 -3.8655928  0.3287861 -11.757  &lt; 2e-16 ***
## poly(lstat, 3, raw = TRUE)2  0.1487385  0.0212987   6.983 9.18e-12 ***
## poly(lstat, 3, raw = TRUE)3 -0.0020039  0.0003997  -5.013 7.43e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.396 on 502 degrees of freedom
## Multiple R-squared:  0.6578, Adjusted R-squared:  0.6558 
## F-statistic: 321.7 on 3 and 502 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapter4.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Boston, <span class="fu">aes</span>(lstat, medv) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-2"><a href="chapter4.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch4_8-1.png" width="672" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter4.html#cb31-1" aria-hidden="true" tabindex="-1"></a>model5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="fu">poly</span>(lstat, <span class="dv">5</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> Boston)</span>
<span id="cb31-2"><a href="chapter4.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model5)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ poly(lstat, 5, raw = TRUE), data = Boston)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.5433  -3.1039  -0.7052   2.0844  27.1153 
## 
## Coefficients:
##                               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  6.770e+01  3.604e+00  18.783  &lt; 2e-16 ***
## poly(lstat, 5, raw = TRUE)1 -1.199e+01  1.526e+00  -7.859 2.39e-14 ***
## poly(lstat, 5, raw = TRUE)2  1.273e+00  2.232e-01   5.703 2.01e-08 ***
## poly(lstat, 5, raw = TRUE)3 -6.827e-02  1.438e-02  -4.747 2.70e-06 ***
## poly(lstat, 5, raw = TRUE)4  1.726e-03  4.167e-04   4.143 4.03e-05 ***
## poly(lstat, 5, raw = TRUE)5 -1.632e-05  4.420e-06  -3.692 0.000247 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 5.215 on 500 degrees of freedom
## Multiple R-squared:  0.6817, Adjusted R-squared:  0.6785 
## F-statistic: 214.2 on 5 and 500 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter4.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Boston, <span class="fu">aes</span>(lstat, medv) ) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-2"><a href="chapter4.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_smooth</span>(<span class="at">method =</span> lm, <span class="at">formula =</span> y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">5</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch4_9-1.png" width="672" /></p>
<p><br></p>
</div>
</div>
<div id="표준화-회귀모형" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> 표준화 회귀모형<a href="chapter4.html#표준화-회귀모형" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>회귀계수벡터를 구하기 위해 <span class="math inline">\(\mathbf{(X&#39;X)^{-1}}\)</span> 행렬을 이용하는 데 행렬 계산시 반올림오차 등에 민감함</p></li>
<li><p><span class="math inline">\(\mathbf{(X&#39;X)}\)</span>의 결정식이 0에 가까울 경우는 <span class="math inline">\(\mathbf{X}\)</span>변수들의 상관성이 높은 경우임</p></li>
<li><p>또한 <span class="math inline">\(\mathbf{(X&#39;X)}\)</span>의 값이 단위에 큰 차이가 날 경우는 각 <span class="math inline">\(\mathbf{X}\)</span>변수를 표준화한 후 안정된 <span class="math inline">\(\mathbf{(X&#39;X)}\)</span>를 얻을 수 있음</p></li>
<li><p>이러한 과정을 이용한 회귀모형을 표준화 회귀모형이라 함</p></li>
<li><p>변수에 대한 상관성 변환(correlation transformation)은 각 변수가 동일한 단위를 갖게 할 수 있어 회귀계수를 비교할 경우 장점이 있음</p></li>
<li><p>다음의 다중선형 회귀모형을 고려하자</p></li>
</ul>
<p><span class="math display">\[
Y=\beta_0+\beta_1X_1+\beta_2X_2+\cdots +\beta_pX_p+\epsilon
\]</span></p>
<ul>
<li><p>변수 표준화(standardization)는 평균으로 중심화(centering)하고 표준편차로 스케일링(scaling)하여 비례 축소함</p></li>
<li><p>변수 표준화</p></li>
</ul>
<p><span class="math display">\[
Y_i*=\frac{Y_i-\bar{Y}}{S_Y}, \,\,\, X_{ij}*=\frac{X_{ij}-\bar{X}_j}{S_{X_j}}
\]</span></p>
<ul>
<li><span class="math inline">\(n\)</span>개 관측점에 대해 표현하며, 표준화 회귀모형(standardized regression model)은</li>
</ul>
<p><span class="math display">\[
Y_i*=\beta_1*X_{i1}*+\beta_2*X_{i2}*+\cdots +\beta_p
*X_{ip}*+\epsilon_i, \,\,\, i=1,2, \ldots, n
\]</span></p>
<ul>
<li><p>여기서 절편항은 표준화 결과 0이 되어 모형에서 사라짐</p></li>
<li><p>표준화 회귀모형에서의 회귀계수 <span class="math inline">\(\beta*\)</span>와 원래 모형에서의 회귀계수 <span class="math inline">\(\beta\)</span>의 관계는 크기조정 요소(scaling factor)간의 비로 나타남</p></li>
</ul>
<p><span class="math display">\[
\beta_j=\frac{S_Y}{S_{X_j}}\beta_j*
\]</span></p>
<div id="example-12" class="section level4 unnumbered hasAnchor">
<h4>Example<a href="chapter4.html#example-12" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>랜덤 발샐 데이터에 대해 회귀모형을 적합하고, 표준화 회귀계수도 살펴보자.</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapter4.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb34-2"><a href="chapter4.html#cb34-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb34-3"><a href="chapter4.html#cb34-3" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb34-4"><a href="chapter4.html#cb34-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb34-5"><a href="chapter4.html#cb34-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">*</span>x1<span class="sc">+</span>x2<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb34-6"><a href="chapter4.html#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="chapter4.html#cb34-7" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span>
<span id="cb34-8"><a href="chapter4.html#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.6232 -0.6626  0.0234  0.4180  1.7137 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.78573    0.37533  -2.093   0.0458 *  
## x1           4.99930    0.01784 280.239  &lt; 2e-16 ***
## x2           1.27435    0.10364  12.296 1.42e-12 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8867 on 27 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9996 
## F-statistic: 3.96e+04 on 2 and 27 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chapter4.html#cb36-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">scale</span>(y) <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="fu">scale</span>(x1)<span class="sc">+</span><span class="fu">scale</span>(x2))</span>
<span id="cb36-2"><a href="chapter4.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = scale(y) ~ -1 + scale(x1) + scale(x2))
## 
## Residuals:
##       Min        1Q    Median        3Q       Max 
## -0.035020 -0.014296  0.000505  0.009019  0.036973 
## 
## Coefficients:
##           Estimate Std. Error t value Pr(&gt;|t|)    
## scale(x1) 0.996747   0.003493  285.38  &lt; 2e-16 ***
## scale(x2) 0.043733   0.003493   12.52 5.43e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.01879 on 28 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9996 
## F-statistic: 4.107e+04 on 2 and 28 DF,  p-value: &lt; 2.2e-16</code></pre>
<!-- End -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Regression Analysis.pdf", "Regression Analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
