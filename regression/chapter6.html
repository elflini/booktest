<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 모형비교와 변수선택법 | Regression Analysis</title>
  <meta name="description" content="Chapter 6 모형비교와 변수선택법 | Regression Analysis" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 모형비교와 변수선택법 | Regression Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 6 모형비교와 변수선택법 | Regression Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 모형비교와 변수선택법 | Regression Analysis" />
  
  <meta name="twitter:description" content="Chapter 6 모형비교와 변수선택법 | Regression Analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2024-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter5.html"/>
<link rel="next" href="chapter7.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Regression Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>목 차</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> 서론</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#기술-통계descriptive-statistics"><i class="fa fa-check"></i><b>1.1</b> 기술 통계(Descriptive Statistics)</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#회귀-분석regression-analysis"><i class="fa fa-check"></i><b>1.2</b> 회귀 분석(regression analysis)</a></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#회귀분석-예제"><i class="fa fa-check"></i><b>1.3</b> 회귀분석 예제</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> 기초 행렬 이론</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#정의"><i class="fa fa-check"></i><b>2.1</b> 정의</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#행렬과-벡터"><i class="fa fa-check"></i><b>2.1.1</b> 행렬과 벡터</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#특정-형태의-행렬"><i class="fa fa-check"></i><b>2.1.2</b> 특정 형태의 행렬</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#행렬의-연산"><i class="fa fa-check"></i><b>2.2</b> 행렬의 연산</a></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#분할행렬"><i class="fa fa-check"></i><b>2.3</b> 분할행렬</a></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#행렬의-계수"><i class="fa fa-check"></i><b>2.4</b> 행렬의 계수</a></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#행렬식"><i class="fa fa-check"></i><b>2.5</b> 행렬식</a></li>
<li class="chapter" data-level="2.6" data-path="chapter2.html"><a href="chapter2.html#역행렬"><i class="fa fa-check"></i><b>2.6</b> 역행렬</a></li>
<li class="chapter" data-level="2.7" data-path="chapter2.html"><a href="chapter2.html#양정치행렬과-반양정치행렬"><i class="fa fa-check"></i><b>2.7</b> 양정치행렬과 반양정치행렬</a></li>
<li class="chapter" data-level="2.8" data-path="chapter2.html"><a href="chapter2.html#트레이스"><i class="fa fa-check"></i><b>2.8</b> 트레이스</a></li>
<li class="chapter" data-level="2.9" data-path="chapter2.html"><a href="chapter2.html#직교벡터와-직교행렬"><i class="fa fa-check"></i><b>2.9</b> 직교벡터와 직교행렬</a></li>
<li class="chapter" data-level="2.10" data-path="chapter2.html"><a href="chapter2.html#고유값과-고유벡터"><i class="fa fa-check"></i><b>2.10</b> 고유값과 고유벡터</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="chapter2.html"><a href="chapter2.html#고유값과-고유벡터-정의"><i class="fa fa-check"></i><b>2.10.1</b> 고유값과 고유벡터 정의</a></li>
<li class="chapter" data-level="2.10.2" data-path="chapter2.html"><a href="chapter2.html#고유값의-성질"><i class="fa fa-check"></i><b>2.10.2</b> 고유값의 성질</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="chapter2.html"><a href="chapter2.html#스펙트럼분해"><i class="fa fa-check"></i><b>2.11</b> 스펙트럼분해</a></li>
<li class="chapter" data-level="2.12" data-path="chapter2.html"><a href="chapter2.html#멱등행렬"><i class="fa fa-check"></i><b>2.12</b> 멱등행렬</a></li>
<li class="chapter" data-level="2.13" data-path="chapter2.html"><a href="chapter2.html#벡터와-행렬의-미분"><i class="fa fa-check"></i><b>2.13</b> 벡터와 행렬의 미분</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> 단순선형회귀분석</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#산점도"><i class="fa fa-check"></i><b>3.1</b> 산점도</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#상관분석"><i class="fa fa-check"></i><b>3.2</b> 상관분석</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter3.html"><a href="chapter3.html#표본상관계수"><i class="fa fa-check"></i><b>3.2.1</b> 표본상관계수</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter3.html"><a href="chapter3.html#상관분석-1"><i class="fa fa-check"></i><b>3.2.2</b> 상관분석</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter3.html"><a href="chapter3.html#표본상관계수-해석시-유의점"><i class="fa fa-check"></i><b>3.2.3</b> 표본상관계수 해석시 유의점</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#단순선형회귀모형"><i class="fa fa-check"></i><b>3.3</b> 단순선형회귀모형</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#모수-추정"><i class="fa fa-check"></i><b>3.4</b> 모수 추정</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter3.html"><a href="chapter3.html#최소제곱법을-이용한-모수-추정"><i class="fa fa-check"></i><b>3.4.1</b> 최소제곱법을 이용한 모수 추정</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter3.html"><a href="chapter3.html#가능도함수를-이용한-모수-추정"><i class="fa fa-check"></i><b>3.4.2</b> 가능도함수를 이용한 모수 추정</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter3.html"><a href="chapter3.html#추정량의-성질"><i class="fa fa-check"></i><b>3.4.3</b> 추정량의 성질</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#모형에-대한-적합도-검정"><i class="fa fa-check"></i><b>3.5</b> 모형에 대한 적합도 검정</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="chapter3.html"><a href="chapter3.html#결정계수"><i class="fa fa-check"></i><b>3.5.1</b> 결정계수</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapter3.html"><a href="chapter3.html#회귀식에-대한-검정"><i class="fa fa-check"></i><b>3.5.2</b> 회귀식에 대한 검정</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapter3.html"><a href="chapter3.html#회귀계수에-대한-검정"><i class="fa fa-check"></i><b>3.5.3</b> 회귀계수에 대한 검정</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapter3.html"><a href="chapter3.html#회귀계수에-대한-신뢰구간"><i class="fa fa-check"></i><b>3.5.4</b> 회귀계수에 대한 신뢰구간</a></li>
<li class="chapter" data-level="3.5.5" data-path="chapter3.html"><a href="chapter3.html#예측값에-대한-신뢰구간"><i class="fa fa-check"></i><b>3.5.5</b> 예측값에 대한 신뢰구간</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#잔차-분석"><i class="fa fa-check"></i><b>3.6</b> 잔차 분석</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="chapter3.html"><a href="chapter3.html#회귀함수의-선형성"><i class="fa fa-check"></i><b>3.6.1</b> 회귀함수의 선형성</a></li>
<li class="chapter" data-level="3.6.2" data-path="chapter3.html"><a href="chapter3.html#오차항의-등분산성과-독립성"><i class="fa fa-check"></i><b>3.6.2</b> 오차항의 등분산성과 독립성</a></li>
<li class="chapter" data-level="3.6.3" data-path="chapter3.html"><a href="chapter3.html#오차항의-정규성"><i class="fa fa-check"></i><b>3.6.3</b> 오차항의 정규성</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="chapter3.html"><a href="chapter3.html#example-7"><i class="fa fa-check"></i><b>3.7</b> Example</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="chapter3.html"><a href="chapter3.html#example-1-1"><i class="fa fa-check"></i><b>3.7.1</b> Example 1</a></li>
<li class="chapter" data-level="3.7.2" data-path="chapter3.html"><a href="chapter3.html#example-2-1"><i class="fa fa-check"></i><b>3.7.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="chapter3.html"><a href="chapter3.html#부분-회귀"><i class="fa fa-check"></i><b>3.8</b> 부분 회귀</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="chapter3.html"><a href="chapter3.html#example-8"><i class="fa fa-check"></i><b>3.8.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> 다중선형회귀분석</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#다중선형회귀모형---설명변수가-두-개인-경우"><i class="fa fa-check"></i><b>4.1</b> 다중선형회귀모형 - 설명변수가 두 개인 경우</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#다중선형회귀모형---설명변수가-여러-개인-경우"><i class="fa fa-check"></i><b>4.2</b> 다중선형회귀모형 - 설명변수가 여러 개인 경우</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#모수-추정-1"><i class="fa fa-check"></i><b>4.3</b> 모수 추정</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chapter4.html"><a href="chapter4.html#최소제곱법을-이용한-모수추정"><i class="fa fa-check"></i><b>4.3.1</b> 최소제곱법을 이용한 모수추정</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter4.html"><a href="chapter4.html#가능도함수를-이용한-모수-추정-1"><i class="fa fa-check"></i><b>4.3.2</b> 가능도함수를 이용한 모수 추정</a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter4.html"><a href="chapter4.html#추정량의-성질-1"><i class="fa fa-check"></i><b>4.3.3</b> 추정량의 성질</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#회귀모형-추정"><i class="fa fa-check"></i><b>4.4</b> 회귀모형 추정</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="chapter4.html"><a href="chapter4.html#회귀계수에-대한-검정-1"><i class="fa fa-check"></i><b>4.4.1</b> 회귀계수에 대한 검정</a></li>
<li class="chapter" data-level="4.4.2" data-path="chapter4.html"><a href="chapter4.html#회귀계수에-대한-신뢰구간-1"><i class="fa fa-check"></i><b>4.4.2</b> 회귀계수에 대한 신뢰구간</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#모형에-대한-적합도-검정-1"><i class="fa fa-check"></i><b>4.5</b> 모형에 대한 적합도 검정</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="chapter4.html"><a href="chapter4.html#결정계수-1"><i class="fa fa-check"></i><b>4.5.1</b> 결정계수</a></li>
<li class="chapter" data-level="4.5.2" data-path="chapter4.html"><a href="chapter4.html#회귀계수벡터에-대한-검정"><i class="fa fa-check"></i><b>4.5.2</b> 회귀계수벡터에 대한 검정</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#신뢰구간과-예측구간"><i class="fa fa-check"></i><b>4.6</b> 신뢰구간과 예측구간</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chapter4.html"><a href="chapter4.html#반응평균과-반응평균에-대한-신뢰구간"><i class="fa fa-check"></i><b>4.6.1</b> 반응평균과 반응평균에 대한 신뢰구간</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#잔차분석"><i class="fa fa-check"></i><b>4.7</b> 잔차분석</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="chapter4.html"><a href="chapter4.html#회귀함수의-선형성-1"><i class="fa fa-check"></i><b>4.7.1</b> 회귀함수의 선형성</a></li>
<li class="chapter" data-level="4.7.2" data-path="chapter4.html"><a href="chapter4.html#오차항의-등분산성과-독립성-1"><i class="fa fa-check"></i><b>4.7.2</b> 오차항의 등분산성과 독립성</a></li>
<li class="chapter" data-level="4.7.3" data-path="chapter4.html"><a href="chapter4.html#오차항의-정규성-1"><i class="fa fa-check"></i><b>4.7.3</b> 오차항의 정규성</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="chapter4.html"><a href="chapter4.html#r을-이용한-다중회귀분석"><i class="fa fa-check"></i><b>4.8</b> R을 이용한 다중회귀분석</a></li>
<li class="chapter" data-level="4.9" data-path="chapter4.html"><a href="chapter4.html#다항회귀모형"><i class="fa fa-check"></i><b>4.9</b> 다항회귀모형</a></li>
<li class="chapter" data-level="4.10" data-path="chapter4.html"><a href="chapter4.html#표준화-회귀모형"><i class="fa fa-check"></i><b>4.10</b> 표준화 회귀모형</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> 회귀진단 및 보정</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#모자행렬과-지렛대"><i class="fa fa-check"></i><b>5.1</b> 모자행렬과 지렛대</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#스튜던트화-잔차"><i class="fa fa-check"></i><b>5.2</b> 스튜던트화 잔차</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#영향점"><i class="fa fa-check"></i><b>5.3</b> 영향점</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter5.html"><a href="chapter5.html#쿡의-거리"><i class="fa fa-check"></i><b>5.3.1</b> 쿡의 거리</a></li>
<li class="chapter" data-level="5.3.2" data-path="chapter5.html"><a href="chapter5.html#dffits"><i class="fa fa-check"></i><b>5.3.2</b> DFFITS</a></li>
<li class="chapter" data-level="5.3.3" data-path="chapter5.html"><a href="chapter5.html#추가변수-그림"><i class="fa fa-check"></i><b>5.3.3</b> 추가변수 그림</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#이상점"><i class="fa fa-check"></i><b>5.4</b> 이상점</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#example-13"><i class="fa fa-check"></i><b>5.5</b> Example</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#회귀진단-후-보정-방법"><i class="fa fa-check"></i><b>5.6</b> 회귀진단 후 보정 방법</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chapter5.html"><a href="chapter5.html#잔차그림"><i class="fa fa-check"></i><b>5.6.1</b> 잔차그림</a></li>
<li class="chapter" data-level="5.6.2" data-path="chapter5.html"><a href="chapter5.html#정규성을-만족하지-않는-경우"><i class="fa fa-check"></i><b>5.6.2</b> 정규성을 만족하지 않는 경우</a></li>
<li class="chapter" data-level="5.6.3" data-path="chapter5.html"><a href="chapter5.html#등분산이-아닌-경우"><i class="fa fa-check"></i><b>5.6.3</b> 등분산이 아닌 경우</a></li>
<li class="chapter" data-level="5.6.4" data-path="chapter5.html"><a href="chapter5.html#선형이-아닌-경우"><i class="fa fa-check"></i><b>5.6.4</b> 선형이 아닌 경우</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> 모형비교와 변수선택법</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#다중공선성"><i class="fa fa-check"></i><b>6.1</b> 다중공선성</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter6.html"><a href="chapter6.html#다중공선성-문제"><i class="fa fa-check"></i><b>6.1.1</b> 다중공선성 문제</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter6.html"><a href="chapter6.html#분산팽창계수"><i class="fa fa-check"></i><b>6.1.2</b> 분산팽창계수</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter6.html"><a href="chapter6.html#다중공선성이-존재하는-경우"><i class="fa fa-check"></i><b>6.1.3</b> 다중공선성이 존재하는 경우</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#모형-비교와-f-검정"><i class="fa fa-check"></i><b>6.2</b> 모형 비교와 F-검정</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#변수선택"><i class="fa fa-check"></i><b>6.3</b> 변수선택</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chapter6.html"><a href="chapter6.html#단계별-변수선택법"><i class="fa fa-check"></i><b>6.3.1</b> 단계별 변수선택법</a></li>
<li class="chapter" data-level="6.3.2" data-path="chapter6.html"><a href="chapter6.html#가능한-경우들-중-선택"><i class="fa fa-check"></i><b>6.3.2</b> 가능한 경우들 중 선택</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#r-활용-모형-비교-및-변수선택"><i class="fa fa-check"></i><b>6.4</b> R 활용 모형 비교 및 변수선택</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> 다중회귀분석 예제</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#데이터-탐색"><i class="fa fa-check"></i><b>7.1</b> 데이터 탐색</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#다중선형회귀분석"><i class="fa fa-check"></i><b>7.2</b> 다중선형회귀분석</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#단계별-회귀에-의한-변수-선택"><i class="fa fa-check"></i><b>7.3</b> 단계별 회귀에 의한 변수 선택</a></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#다중공선성-1"><i class="fa fa-check"></i><b>7.4</b> 다중공선성</a></li>
<li class="chapter" data-level="7.5" data-path="chapter7.html"><a href="chapter7.html#지렛대점과-이상점"><i class="fa fa-check"></i><b>7.5</b> 지렛대점과 이상점</a></li>
<li class="chapter" data-level="7.6" data-path="chapter7.html"><a href="chapter7.html#잔차분석-1"><i class="fa fa-check"></i><b>7.6</b> 잔차분석</a></li>
<li class="chapter" data-level="7.7" data-path="chapter7.html"><a href="chapter7.html#모형-제안-및-예측"><i class="fa fa-check"></i><b>7.7</b> 모형 제안 및 예측</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> 일반화 가중회귀모형</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#일반화-회귀모형"><i class="fa fa-check"></i><b>8.1</b> 일반화 회귀모형</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#최소제곱법을-이용한-모수추정-1"><i class="fa fa-check"></i><b>8.2</b> 최소제곱법을 이용한 모수추정</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#r-활용-가중회귀분석"><i class="fa fa-check"></i><b>8.3</b> R 활용 가중회귀분석</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> 가변수 회귀모형</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#이분-가변수-경우"><i class="fa fa-check"></i><b>9.1</b> 이분 가변수 경우</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#두-개-회귀직선의-비교"><i class="fa fa-check"></i><b>9.2</b> 두 개 회귀직선의 비교</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-평행성-검정---각-모형의-경우"><i class="fa fa-check"></i><b>9.2.1</b> 회귀직선의 평행성 검정 - 각 모형의 경우</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-평행성-검정---가변수의-경우"><i class="fa fa-check"></i><b>9.2.2</b> 회귀직선의 평행성 검정 - 가변수의 경우</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-일치성-검정---각-모형의-경우"><i class="fa fa-check"></i><b>9.2.3</b> 회귀직선의 일치성 검정 - 각 모형의 경우</a></li>
<li class="chapter" data-level="9.2.4" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-일치성-검정---가변수의-적용"><i class="fa fa-check"></i><b>9.2.4</b> 회귀직선의 일치성 검정 - 가변수의 적용</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapter9.html"><a href="chapter9.html#다항-가변수-경우"><i class="fa fa-check"></i><b>9.3</b> 다항 가변수 경우</a></li>
<li class="chapter" data-level="9.4" data-path="chapter9.html"><a href="chapter9.html#r-활용-가변수회귀분석"><i class="fa fa-check"></i><b>9.4</b> R 활용 가변수회귀분석</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter9.html"><a href="chapter9.html#구름-데이터"><i class="fa fa-check"></i><b>9.4.1</b> 구름 데이터</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapter9.html"><a href="chapter9.html#iq-데이터"><i class="fa fa-check"></i><b>9.4.2</b> IQ 데이터</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter10.html"><a href="chapter10.html"><i class="fa fa-check"></i><b>10</b> 능형회귀추정량과 LASSO 추정량</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter10.html"><a href="chapter10.html#능형회귀모형"><i class="fa fa-check"></i><b>10.1</b> 능형회귀모형</a></li>
<li class="chapter" data-level="10.2" data-path="chapter10.html"><a href="chapter10.html#능형모수추정"><i class="fa fa-check"></i><b>10.2</b> 능형모수추정</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="chapter10.html"><a href="chapter10.html#능형추정량의-성질"><i class="fa fa-check"></i><b>10.2.1</b> 능형추정량의 성질</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapter10.html"><a href="chapter10.html#능형모수추정-1"><i class="fa fa-check"></i><b>10.2.2</b> 능형모수추정</a></li>
<li class="chapter" data-level="10.2.3" data-path="chapter10.html"><a href="chapter10.html#능형트레이스"><i class="fa fa-check"></i><b>10.2.3</b> 능형트레이스</a></li>
<li class="chapter" data-level="10.2.4" data-path="chapter10.html"><a href="chapter10.html#example-15"><i class="fa fa-check"></i><b>10.2.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="chapter10.html"><a href="chapter10.html#lasso-회귀모형"><i class="fa fa-check"></i><b>10.3</b> LASSO 회귀모형</a></li>
<li class="chapter" data-level="10.4" data-path="chapter10.html"><a href="chapter10.html#r-활용-능형회귀-및-lasso-회귀분석"><i class="fa fa-check"></i><b>10.4</b> R 활용 능형회귀 및 LASSO 회귀분석</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Regression Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter6" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> 모형비교와 변수선택법<a href="chapter6.html#chapter6" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ul>
<li><p>이 장에서는 설명변수들의 부분집합 중 반응변수와의 관계를 가장 잘 설명하는 부분집합을 선택하는 변수선택(variable selection)에 대해 설명함</p></li>
<li><p>불필요한 설명변수가 제거되면 간단하면서도 설명력이 높은 모형을 선택할 수 있음</p></li>
<li><p>설명변수들을 선별하는 단계에서 설명변수들 간의 관계에 대해 점검해 볼 필요가 있으므로 먼저 다중공선성 문제를 다룸</p></li>
</ul>
<div id="다중공선성" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 다중공선성<a href="chapter6.html#다중공선성" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>설명변수 간에 연관성이 많으면 반응변수의 변화가 주요 설명변수보다 이 설명변수와 관련이 많은 다른 설명변수에 의존하게 되어 회귀모형 추정에 있어 문제가 발생함</p></li>
<li><p>그러므로 설명변수들의 다중공선성(multicollinearity) 등 설명변수들 간의 관계를 명확히 이해하는 것은 다중회귀분석에 있어 꼭 필요한 과정임</p></li>
</ul>
<div id="다중공선성-문제" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> 다중공선성 문제<a href="chapter6.html#다중공선성-문제" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>두 설명변수에 대해 상수항 <span class="math inline">\(c_0, c_1, c_2\)</span>가 존재해 다음의 선형식이 성립하면 두 변수 간 완전한 공선성이 존재함(collinear)</li>
</ul>
<p><span class="math display">\[
c_1X_1 + c_2X_2 = c_0
\]</span></p>
<ul>
<li><p>공선성이 있는 경우 회귀모형에서 두 변수를 모두 포함한다면 추정에 문제가 발생하게 되어 공선성 문제를 야기함</p></li>
<li><p>이상점이 공선성을 유도하는 경우</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter6.html#cb1-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd=</span><span class="fl">0.1</span>)</span>
<span id="cb1-2"><a href="chapter6.html#cb1-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd=</span><span class="fl">0.1</span>)</span>
<span id="cb1-3"><a href="chapter6.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, x2, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb1-4"><a href="chapter6.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fl">2.5</span>,<span class="fl">2.5</span>, <span class="at">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch6_1-1.png" width="672" /></p>
<ul>
<li><p>이상점이 공선성을 유도하는 경우로 이상점 때문에 두 변수간의 관련성이 높아짐</p></li>
<li><p>이상점이 공선성을 숨기는 경우</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="chapter6.html#cb2-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd=</span><span class="fl">0.1</span>)</span>
<span id="cb2-2"><a href="chapter6.html#cb2-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="dv">1-2</span><span class="sc">*</span>x1<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd=</span><span class="fl">0.1</span>)</span>
<span id="cb2-3"><a href="chapter6.html#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, x2, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb2-4"><a href="chapter6.html#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fl">2.5</span>,<span class="fl">2.5</span>, <span class="at">pch=</span><span class="dv">19</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch6_2-1.png" width="672" /></p>
<ul>
<li><p>이상점을 제거하면 두 변수 간의 관련성이 높아짐</p></li>
<li><p>설명변수가 서로 독립이고 모형 설계시 고려되지 않은 다른 설명변수와 독립이라면 상관없지만 현실에서 설명변수가 완벽하게 독립인 경우는 거의 없음</p></li>
<li><p>설명변수 중 한 개가 다른 설명변수들의 선형조합으로 표현된다면 <span class="math inline">\(\mathbf{X&#39;X}\)</span>가 특이한(singular) 상황이 되며 다중공선성을 가지게 됨</p></li>
<li><p>이러한 경우 <span class="math inline">\((\mathbf{X&#39;X})^{-1}\)</span>를 구할 수 없어 회귀계수벡터 <span class="math inline">\(\beta\)</span>에 대한 최소제곱추정량을 구하는 데 문제가 발생함</p></li>
<li><p>예) 아래와 같이 설명변수가 2개인 다중회귀모형</p></li>
</ul>
<p><span class="math display">\[
Y=\beta_0 + \beta_1X_1 + \beta_2X_2 +\epsilon
\]</span></p>
<ul>
<li><span class="math inline">\(r_{12}\)</span>를 <span class="math inline">\(X_1\)</span>과 <span class="math inline">\(X_2\)</span>의 상관계수라 할 때,</li>
</ul>
<p><span class="math display">\[
Var(\hat{\beta}_j)=\sigma^2(\frac{1}{1-r_{12}^2})(\frac{1}{S_{X_jX_j}})
\]</span></p>
<ul>
<li><p><span class="math inline">\(Var(\hat{\beta}_1)\)</span>과 <span class="math inline">\(Var(\hat{\beta}_2)\)</span>은 <span class="math inline">\(r_{12}^2=0\)</span>일 때 최소값을 가지며 <span class="math inline">\(r_{12}^2\approx 1\)</span>이면 <span class="math inline">\(\hat{\beta}_1\)</span>과 <span class="math inline">\(\hat{\beta}_2\)</span>의 분산은 크게 팽창되어(inflated) 회귀계수 추정값은 매우 불안정한 값이 됨</p></li>
<li><p>다중 공선성이 존재하는 경우 반응변수의 민감도는 설명변수의 위치에 따라 크게 좌우될 수 있으며 관측된 데이터에서 멀어지는 경우 예측값을 불안정하게 만드는 원인이 될 수 있음</p></li>
</ul>
<div id="다중공선성이-판단되는-경우" class="section level4 unnumbered hasAnchor">
<h4>다중공선성이 판단되는 경우<a href="chapter6.html#다중공선성이-판단되는-경우" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><p>설명변수들 간의 상관행렬에서 절대값이 큰 상관계수를 갖는 경우</p></li>
<li><p><span class="math inline">\(j\)</span>번째 설명변수를 반응변수 위치에 놓고 나머지 설명변수들로 회귀모형을 적합했을 때 결정계수 <span class="math inline">\(R_j^2\)</span>이 1에 가까운 경우</p></li>
<li><p><span class="math inline">\(\mathbf{X&#39;X}\)</span>의 고유값을 구한 후 크기 순서대로 늘어놓아 가장 큰 고유값을 <span class="math inline">\(\lambda_1\)</span>이라 놓으면 <span class="math inline">\(\lambda_1&gt;\lambda_2&gt;\cdots&gt;\lambda_{p+1}\)</span>을 만족하며 가장 작은 고유값 <span class="math inline">\(\lambda_{p+1}\)</span>에 대해 조건수(condition number)는 다음과 같음</p></li>
</ol>
<p><span class="math display">\[
\kappa = \sqrt{\frac{\lambda_1}{\lambda_{p+1}}}
\]</span></p>
<ul>
<li>만일 <span class="math inline">\(\kappa\ge 30\)</span>이면 다중공선성이 있다고 판단함</li>
</ul>
</div>
</div>
<div id="분산팽창계수" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> 분산팽창계수<a href="chapter6.html#분산팽창계수" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>설명변수를 <span class="math inline">\(p\)</span>개 포함한 일반적인 다중회귀모형</li>
</ul>
<p><span class="math display">\[
Y=\beta_0 + \beta_1X_1 +\cdots +\beta_pX_p + \epsilon
\]</span></p>
<ul>
<li>회귀계수추정량의 분산</li>
</ul>
<p><span class="math display">\[
Var(\hat{\beta}_j)=\sigma^2(\frac{1}{1-R_{j}^2})(\frac{1}{S_{X_jX_j}}), \,\,\, j=1,\ldots, p
\]</span></p>
<ul>
<li><p>여기서 <span class="math inline">\(R_j^2\)</span>은 <span class="math inline">\(j\)</span>번째 설명변수를 반응변수 위치에 놓고 나머지 설명변수들로 회귀모형을 적합했을 때의 결정계수</p></li>
<li><p>만약 <span class="math inline">\(j\)</span>번째 설명변수가 나머지 변수들의 어떤 부분집합에 거의 선형종속이면 <span class="math inline">\(R_j^2\)</span>은 1에 가깝게 되고 <span class="math inline">\(\frac{1}{1-R_j^2}\)</span>은 커지가 됨</p></li>
</ul>
<div id="분산팽창계수variance-inflation-factor" class="section level4 unnumbered hasAnchor">
<h4>분산팽창계수(variance inflation factor)<a href="chapter6.html#분산팽창계수variance-inflation-factor" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
VIF_j = \frac{1}{1-R_j^2}
\]</span></p>
<ul>
<li><p>일반적으로 다중공선성의 존재를 조사하는 방법으로 분산팽창계수가 널리 쓰임</p></li>
<li><p>한 개 또는 그 이상의 <span class="math inline">\(VIF\)</span> 값이 크면 다중공선성 문제가 있음을 나타냄</p></li>
<li><p><span class="math inline">\(R_j^2\ge 0.6\)</span>이상인 경우 즉, 분산팽장계수 <span class="math inline">\(VIF_j\ge 2.5\)</span> 이상이면 다중공선성을 의심해 볼 수 있음</p></li>
<li><p>일반적으로 <span class="math inline">\(VIF_j \ge 10\)</span>이면 다중공선성 문제가 있다고 함</p></li>
<li><p>R에서는 car package의 vif() 함수를 이용하여 분산팽창계수를 구할 수 있음</p></li>
</ul>
</div>
</div>
<div id="다중공선성이-존재하는-경우" class="section level3 hasAnchor" number="6.1.3">
<h3><span class="header-section-number">6.1.3</span> 다중공선성이 존재하는 경우<a href="chapter6.html#다중공선성이-존재하는-경우" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>다중공선성은 추정식과 예측값을 불안정하게 함</p></li>
<li><p>설명변수들 간의 상관관계로 인해 회귀계수에 대한 검정이 유의하지 않을 수 있으며 이러한 경우 추정식이 유의하지 않게 되며 따라서 예측값에 대해 신뢰할 수 없게 됨</p></li>
<li><p>또한 설명변수의 위치에 따라 예측값이 크게 좌우될 수 있으며 관측된 데이터에서 멀어지는 경우 예측값을 불안정하게 만드는 원인이 될 수 있음</p></li>
</ul>
<div id="다중공선성을-감안하는-방법" class="section level4 unnumbered hasAnchor">
<h4>다중공선성을 감안하는 방법<a href="chapter6.html#다중공선성을-감안하는-방법" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><p>상관성이 큰 설명변수를 제거한 후 분석</p></li>
<li><p>모든 설명변수를 포함시키고자 한다면 능형회귀(ridge regression) 등의 대안 모형을 모색</p></li>
</ol>
<p><br></p>
</div>
</div>
</div>
<div id="모형-비교와-f-검정" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 모형 비교와 F-검정<a href="chapter6.html#모형-비교와-f-검정" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>설명변수 간 다중공선성이 존재하는 경우 설명변수를 제거하여 모형을 개선하고 다중공선성을 줄일 수 있음</p></li>
<li><p>설명변수를 2개를 모두 포함한 완전모형</p></li>
</ul>
<p><span class="math display">\[
Y=\beta_0+\beta_1X_1+\beta_2X_2+\epsilon
\]</span></p>
<ul>
<li>부분집합 모형으로 <span class="math inline">\(X_2\)</span>를 제거하여 설명변수가 1개인 경우의 축소모형</li>
</ul>
<p><span class="math display">\[
Y=\beta_0+\beta_1X_1+\epsilon
\]</span></p>
<ul>
<li>편의상 <span class="math inline">\(S_{X_1X_1}=S_{X_2X_2}=1\)</span>로 가정하면, 완전모형에서 <span class="math inline">\(\beta_1\)</span>에 대한 추정에서 모형이 사실일 경우</li>
</ul>
<p><span class="math display">\[
E(\hat{\beta}_1)=\beta_1, \,\,\, Var(\hat{\beta}_1)=\frac{\sigma^2}{1-r_{12}^2}
\]</span></p>
<ul>
<li>축소모형이 사실이라면</li>
</ul>
<p><span class="math display">\[
E(\hat{\beta}_1)=\beta_1+r_{12}\beta_2, \,\,\, Var(\hat{\beta}_1)=\sigma^2
\]</span></p>
<ul>
<li>완전모형과 축소모형의 분산을 비교해 보면</li>
</ul>
<p><span class="math display">\[
Var(\hat{\beta}_1)_{full}=\frac{\sigma^2}{1-r_{12}^2}\ge\sigma^2=Var(\hat{\beta}_1)_{reduce}
\]</span></p>
<ul>
<li><p>축소모형에서의 회귀계수 추정량의 분산이 완전모형보다 작음을 알 수 있으므로 공선성이 존재할 경우에는 축소모형을 선택하는 것이 좋음</p></li>
<li><p><span class="math inline">\(p\)</span>개의 설명변수가 있는 다중회귀모형에서 모형비교</p></li>
</ul>
<p><span class="math display">\[
\mathbf{Y=X\beta+\epsilon}
\]</span></p>
<ul>
<li><span class="math inline">\(\mathbf{X}\)</span>를 <span class="math inline">\(\mathbf{X}_1\)</span>과 <span class="math inline">\(\mathbf{X}_2\)</span>로 분할하고 마찬가지로 해당되는 회귀계수벡터 <span class="math inline">\(\beta\)</span>를 <span class="math inline">\(\beta_1\)</span>과 <span class="math inline">\(\beta_2\)</span>로 분할하면</li>
</ul>
<p><span class="math display">\[
\mathbf{Y=X_1\beta_1+X_2\beta_2+\epsilon}
\]</span></p>
<ul>
<li>여기서 일부의 설명변수 <span class="math inline">\(\mathbf{X}_2\)</span>를 제거한 축소모형</li>
</ul>
<p><span class="math display">\[
\mathbf{Y=X_1\beta_1+\epsilon}
\]</span></p>
<ul>
<li><p>축소된 회귀모형은 완전모형에서 <span class="math inline">\(\beta_2=0\)</span>일 경우 동일한 모형이 됨</p></li>
<li><p>축소된 모형에서의 <span class="math inline">\(\beta_1\)</span>에 대한 추정량</p></li>
</ul>
<p><span class="math display">\[
\hat{\beta}_1=\mathbf{(X_1&#39;X_1)^{-1}X_1&#39;Y}
\]</span></p>
<ul>
<li><p>두 모형 비교를 위한 통계적 가설</p>
<ul>
<li><span class="math inline">\(H_0: \mathbf{Y=X_1\beta_1+\epsilon}\)</span></li>
<li><span class="math inline">\(H_1: \mathbf{Y=X_1\beta_1+X_2\beta_2+\epsilon}\)</span></li>
</ul></li>
<li><p><span class="math inline">\(H_0\)</span>하에서의 잔차제곱합 <span class="math inline">\(RSS_{H_0}\)</span>는 자유도 <span class="math inline">\(df_{H_0}\)</span>를 가지며, <span class="math inline">\(H_1\)</span>하에서의 잔차제곱합 <span class="math inline">\(RSS_{H_1}\)</span>는 자유도 <span class="math inline">\(df_{H_1}\)</span>를 가짐</p></li>
<li><p>대립가설하에서 모수의 개수가 더 많으므로 <span class="math inline">\(df_{H_0}&gt;df_{H_1}\)</span>이 됨</p></li>
<li><p>검정통계량</p></li>
</ul>
<p><span class="math display">\[
F=\frac{(RSS_{H_0}-RSS_{H_1})/(df_{H_0}-df_{H_1})}{RSS_{H_1}/df_{H_1}} \sim F_{df_{H_0}-df_{H_1},df_{H_1}}
\]</span></p>
<ul>
<li>유의수준 <span class="math inline">\(\alpha\)</span> 검정</li>
</ul>
<p><span class="math display">\[
F\ge F_{df_{H_0}-df_{H_1},df_{H_1}} \,\,\, then \,\,\, reject \,\,\, H_0
\]</span></p>
<p><br></p>
</div>
<div id="변수선택" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> 변수선택<a href="chapter6.html#변수선택" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>회귀모형에서 설명변수를 제거하여 다중공선성을 줄여 모형을 개선할 수 있음</p></li>
<li><p>특히 다중공선성을 발생시키는 설명변수를 제거하면 모수추정에 대한 정확도를 높일 수 있음</p></li>
<li><p>또 다른 측면에서 모수절약의 원칙을 적용하여 최소의 설명변수들로 반응변수와 관련성을 최대한 설명할 수 있는 모형을 만들기 위해 설명변수들을 선택하여 모형을 만들 수 있으며, 이를 변수선택(variable selection)이라 함</p></li>
</ul>
<div id="단계별-변수선택법" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> 단계별 변수선택법<a href="chapter6.html#단계별-변수선택법" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>유의한 설명변수를 삽입하거나 유의하지 않으니 설명변수들을 제거함으로써 유의한 설명변수만으로 회귀모형을 설정하는 방법으로 단계별 변수선택 접근이 많이 쓰이고 있음</p></li>
<li><p>단계별 변수선택은 전진 선택(forward selection), 후진 제거(backward elimination)과 단계별 선택(stepwise selection) 과정을 반복하며 최적의 설명변수들의 부분집합을 찾는 방법</p></li>
</ul>
<div id="단계별-선택법" class="section level4 unnumbered hasAnchor">
<h4>단계별 선택법<a href="chapter6.html#단계별-선택법" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li><p>설명변수들 중 반응변수와 상관관계가 가장 크고 설명력이 유의한 설명변수를 먼저 선택</p></li>
<li><p>이미 선택된 설명변수를 제외한 나머지 설명변수를 하나씩 삽입하여 유의한 설명변수 선택</p></li>
<li><p>새로 선택된 설명변수가 먼저 선택되었다고 가정하고, 이미 삽입되어 있던 설명변수의 유의성에 대한 <span class="math inline">\(F\)</span>-검정을 수행</p></li>
</ol>
<ul>
<li>이때 유의하지 않은 설명변수는 제외</li>
</ul>
<ol start="4" style="list-style-type: decimal">
<li>이와 같은 과정을 반복하면서 추가된 모형이 전 단계의 모형보다 유의하지 않으면 선택과정을 멈추고 최종모형으로 결정</li>
</ol>
<ul>
<li><p>단계별 변수선택방법으로 결정된 모형은 모형선택을 위한 다른 기준으로 점검해볼 때 최적모형이 아닐 수 있음</p></li>
<li><p>단계별 변수선택방법에서 설명변수들의 순서가 정해지는 방법은 데이터 기반 통계량에 의한 방법이며, 실질적인 관계를 가지는 변수가 제외될 수도 있음</p></li>
<li><p>R에서는 library(MASS)의 stepAIC()함수나 step() 함수를 이용해 단계별 변수선택을 할 수 있음</p></li>
</ul>
</div>
</div>
<div id="가능한-경우들-중-선택" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> 가능한 경우들 중 선택<a href="chapter6.html#가능한-경우들-중-선택" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>최적모형을 선택하기 위한 모형의 선택기준으로 다음의 측도들을 이용하여 적절한 모형을 선택할 수 있음</p></li>
<li><p>완전모형에 대한 결정계수 <span class="math inline">\(R^2\)</span>은 0과 1 사이의 값을 가지며, 1에 가까운 값을 가질수록 모형의 설명력이 높음</p></li>
<li><p>결정계수는 모형에 중요하지 않은 독립변수가 추가되는 경우에도 증가함</p></li>
<li><p>이러한 문제를 해결하기 위한 통계량으로 수정된 결정계수 <span class="math inline">\(R_{adj}^2\)</span>가 있음</p></li>
<li><p><span class="math inline">\(p\)</span>개 모수가 있을 경우</p></li>
</ul>
<p><span class="math display">\[
R_{adj}^2=1-(1-R_p^2)(\frac{n-1}{n-p})
\]</span></p>
<ul>
<li><p>여기서 <span class="math inline">\(R_p^2\)</span>은 절편을 포함하여 <span class="math inline">\(p\)</span>개의 설명변수를 이용한 회귀식을 구한 후의 결정계수</p></li>
<li><p><span class="math inline">\(C_k\)</span> 통계량은 <span class="math inline">\(k\)</span>개의 설명변수가 있을 경우, 즉 <span class="math inline">\((k+1)\)</span>개 회귀계수가 있을 경우, 각 회귀모형 부분집합에서 <span class="math inline">\(n\)</span>개 적합값 <span class="math inline">\(\hat{Y}_i\)</span>의 총평균제곱오차에 기반한 측도</p></li>
</ul>
<p><span class="math display">\[
C_k=\frac{SSE_k}{MSE_{full}}+2k-n=\frac{SSE_k-SSE_{p+1}}{MSE_{full}}+k-(p+1-k)=(p+1-k)(F_k-1)+k
\]</span></p>
<ul>
<li><p>여기서 <span class="math inline">\(MSE_{full}\)</span>은 완전모형의 평균오차제곱, <span class="math inline">\(SSE_k\)</span>는 절편을 포함하여 <span class="math inline">\(k\)</span>개의 설명변수를 포함하는 부분집합모형의 오차제곱합, <span class="math inline">\(F_k\)</span>는 부분집합에 포함되지 않은 설명변수들의 회귀계수가 0이라는 귀무가설에 대한 <span class="math inline">\(F\)</span>-검정통계량</p></li>
<li><p><span class="math inline">\(C_k\)</span> 기대값</p></li>
</ul>
<p><span class="math display">\[
E(C_k)=k
\]</span></p>
<ul>
<li><p><span class="math inline">\(p\)</span>개 설명변수들 중 <span class="math inline">\(a\)</span>개를 선택하고 <span class="math inline">\((k=a+1)\)</span> 나머지 <span class="math inline">\(q\)</span>개의 설명변수에 대해 <span class="math inline">\(\beta_q=0\)</span>가 성립한다면 <span class="math inline">\(C_k\)</span>는 <span class="math inline">\(k\)</span>에 가까운 값을 가지게 됨</p></li>
<li><p>이러한 경우 <span class="math inline">\(F_k\)</span> 값이 1에 가까워지는 경우이기도 함</p></li>
<li><p>따라서 변수선택법으로 <span class="math inline">\(C_k\)</span>값이 <span class="math inline">\(k\)</span>에 가까운 <span class="math inline">\(k\)</span>를 찾는 것이며 일반적으로 모든 가능한 회귀모형에서 <span class="math inline">\(C_k\)</span>를 계산하여 찾을 수 있음</p></li>
<li><p>R에서는 leaps() 함수에서 method=“cp” 옵션을 이용해 <span class="math inline">\(C_k\)</span>값을 구할 수 있음</p></li>
</ul>
<p><br></p>
</div>
</div>
<div id="r-활용-모형-비교-및-변수선택" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> R 활용 모형 비교 및 변수선택<a href="chapter6.html#r-활용-모형-비교-및-변수선택" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>longley 데이터를 이용해 분석 데이터셋 생성</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter6.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(longley)</span>
<span id="cb3-2"><a href="chapter6.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(longley)</span></code></pre></div>
<pre><code>##      GNP.deflator     GNP Unemployed Armed.Forces Population Year Employed
## 1947         83.0 234.289      235.6        159.0    107.608 1947   60.323
## 1948         88.5 259.426      232.5        145.6    108.632 1948   61.122
## 1949         88.2 258.054      368.2        161.6    109.773 1949   60.171
## 1950         89.5 284.599      335.1        165.0    110.929 1950   61.187
## 1951         96.2 328.975      209.9        309.9    112.075 1951   63.221
## 1952         98.1 346.999      193.2        359.4    113.270 1952   63.639</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="chapter6.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(longley)</span>
<span id="cb5-2"><a href="chapter6.html#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="chapter6.html#cb5-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> longley<span class="sc">$</span>GNP</span>
<span id="cb5-4"><a href="chapter6.html#cb5-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> longley<span class="sc">$</span>Unemployed</span>
<span id="cb5-5"><a href="chapter6.html#cb5-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> longley<span class="sc">$</span>Population</span>
<span id="cb5-6"><a href="chapter6.html#cb5-6" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> longley<span class="sc">$</span>Armed.Forces</span>
<span id="cb5-7"><a href="chapter6.html#cb5-7" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(y, x1, x2, x3)</span>
<span id="cb5-8"><a href="chapter6.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mydata)</span></code></pre></div>
<pre><code>##         y    x1      x2    x3
## 1 234.289 235.6 107.608 159.0
## 2 259.426 232.5 108.632 145.6
## 3 258.054 368.2 109.773 161.6
## 4 284.599 335.1 110.929 165.0
## 5 328.975 209.9 112.075 309.9
## 6 346.999 193.2 113.270 359.4</code></pre>
<ul>
<li>모형 fitting</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="chapter6.html#cb7-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data=</span>mydata)</span>
<span id="cb7-2"><a href="chapter6.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2 + x3, data = mydata)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -14.525  -6.989   1.574   5.657  13.434 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -1.352e+03  5.160e+01 -26.195 5.86e-12 ***
## x1          -1.142e-01  4.109e-02  -2.780   0.0167 *  
## x2           1.498e+01  5.834e-01  25.677 7.42e-12 ***
## x3           6.480e-02  4.308e-02   1.504   0.1584    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.384 on 12 degrees of freedom
## Multiple R-squared:  0.9943, Adjusted R-squared:  0.9929 
## F-statistic: 698.8 on 3 and 12 DF,  p-value: 9.943e-14</code></pre>
<ul>
<li>축소모형과 모형비교</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapter6.html#cb9-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data=</span>mydata)</span>
<span id="cb9-2"><a href="chapter6.html#cb9-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2, <span class="at">data=</span>mydata)</span>
<span id="cb9-3"><a href="chapter6.html#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit1, fit2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: y ~ x1 + x2 + x3
## Model 2: y ~ x1 + x2
##   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)
## 1     12  843.41                           
## 2     13 1002.44 -1   -159.03 2.2626 0.1584</code></pre>
<ul>
<li>단계별 회귀</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="chapter6.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb11-2"><a href="chapter6.html#cb11-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3, <span class="at">data=</span>mydata)</span>
<span id="cb11-3"><a href="chapter6.html#cb11-3" aria-hidden="true" tabindex="-1"></a>step <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(fit, <span class="at">direction=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=71.44
## y ~ x1 + x2 + x3
## 
##        Df Sum of Sq   RSS     AIC
## &lt;none&gt;                843  71.438
## - x3    1       159  1002  72.202
## - x1    1       543  1387  77.392
## - x2    1     46338 47181 133.827</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter6.html#cb13-1" aria-hidden="true" tabindex="-1"></a>step<span class="sc">$</span>anova <span class="co"># display results</span></span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## y ~ x1 + x2 + x3
## 
## Final Model:
## y ~ x1 + x2 + x3
## 
## 
##   Step Df Deviance Resid. Df Resid. Dev      AIC
## 1                         12   843.4129 71.43789</code></pre>
<!-- End -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter5.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter7.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Regression Analysis.pdf", "Regression Analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
