<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 다중회귀분석 예제 | Regression Analysis</title>
  <meta name="description" content="Chapter 7 다중회귀분석 예제 | Regression Analysis" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 다중회귀분석 예제 | Regression Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Chapter 7 다중회귀분석 예제 | Regression Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 다중회귀분석 예제 | Regression Analysis" />
  
  <meta name="twitter:description" content="Chapter 7 다중회귀분석 예제 | Regression Analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2024-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter6.html"/>
<link rel="next" href="chapter8.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Regression Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>목 차</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> 서론</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#기술-통계descriptive-statistics"><i class="fa fa-check"></i><b>1.1</b> 기술 통계(Descriptive Statistics)</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#회귀-분석regression-analysis"><i class="fa fa-check"></i><b>1.2</b> 회귀 분석(regression analysis)</a></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#회귀분석-예제"><i class="fa fa-check"></i><b>1.3</b> 회귀분석 예제</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> 기초 행렬 이론</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#정의"><i class="fa fa-check"></i><b>2.1</b> 정의</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#행렬과-벡터"><i class="fa fa-check"></i><b>2.1.1</b> 행렬과 벡터</a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#특정-형태의-행렬"><i class="fa fa-check"></i><b>2.1.2</b> 특정 형태의 행렬</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#행렬의-연산"><i class="fa fa-check"></i><b>2.2</b> 행렬의 연산</a></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#분할행렬"><i class="fa fa-check"></i><b>2.3</b> 분할행렬</a></li>
<li class="chapter" data-level="2.4" data-path="chapter2.html"><a href="chapter2.html#행렬의-계수"><i class="fa fa-check"></i><b>2.4</b> 행렬의 계수</a></li>
<li class="chapter" data-level="2.5" data-path="chapter2.html"><a href="chapter2.html#행렬식"><i class="fa fa-check"></i><b>2.5</b> 행렬식</a></li>
<li class="chapter" data-level="2.6" data-path="chapter2.html"><a href="chapter2.html#역행렬"><i class="fa fa-check"></i><b>2.6</b> 역행렬</a></li>
<li class="chapter" data-level="2.7" data-path="chapter2.html"><a href="chapter2.html#양정치행렬과-반양정치행렬"><i class="fa fa-check"></i><b>2.7</b> 양정치행렬과 반양정치행렬</a></li>
<li class="chapter" data-level="2.8" data-path="chapter2.html"><a href="chapter2.html#트레이스"><i class="fa fa-check"></i><b>2.8</b> 트레이스</a></li>
<li class="chapter" data-level="2.9" data-path="chapter2.html"><a href="chapter2.html#직교벡터와-직교행렬"><i class="fa fa-check"></i><b>2.9</b> 직교벡터와 직교행렬</a></li>
<li class="chapter" data-level="2.10" data-path="chapter2.html"><a href="chapter2.html#고유값과-고유벡터"><i class="fa fa-check"></i><b>2.10</b> 고유값과 고유벡터</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="chapter2.html"><a href="chapter2.html#고유값과-고유벡터-정의"><i class="fa fa-check"></i><b>2.10.1</b> 고유값과 고유벡터 정의</a></li>
<li class="chapter" data-level="2.10.2" data-path="chapter2.html"><a href="chapter2.html#고유값의-성질"><i class="fa fa-check"></i><b>2.10.2</b> 고유값의 성질</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="chapter2.html"><a href="chapter2.html#스펙트럼분해"><i class="fa fa-check"></i><b>2.11</b> 스펙트럼분해</a></li>
<li class="chapter" data-level="2.12" data-path="chapter2.html"><a href="chapter2.html#멱등행렬"><i class="fa fa-check"></i><b>2.12</b> 멱등행렬</a></li>
<li class="chapter" data-level="2.13" data-path="chapter2.html"><a href="chapter2.html#벡터와-행렬의-미분"><i class="fa fa-check"></i><b>2.13</b> 벡터와 행렬의 미분</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> 단순선형회귀분석</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#산점도"><i class="fa fa-check"></i><b>3.1</b> 산점도</a></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#상관분석"><i class="fa fa-check"></i><b>3.2</b> 상관분석</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="chapter3.html"><a href="chapter3.html#표본상관계수"><i class="fa fa-check"></i><b>3.2.1</b> 표본상관계수</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter3.html"><a href="chapter3.html#상관분석-1"><i class="fa fa-check"></i><b>3.2.2</b> 상관분석</a></li>
<li class="chapter" data-level="3.2.3" data-path="chapter3.html"><a href="chapter3.html#표본상관계수-해석시-유의점"><i class="fa fa-check"></i><b>3.2.3</b> 표본상관계수 해석시 유의점</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#단순선형회귀모형"><i class="fa fa-check"></i><b>3.3</b> 단순선형회귀모형</a></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#모수-추정"><i class="fa fa-check"></i><b>3.4</b> 모수 추정</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="chapter3.html"><a href="chapter3.html#최소제곱법을-이용한-모수-추정"><i class="fa fa-check"></i><b>3.4.1</b> 최소제곱법을 이용한 모수 추정</a></li>
<li class="chapter" data-level="3.4.2" data-path="chapter3.html"><a href="chapter3.html#가능도함수를-이용한-모수-추정"><i class="fa fa-check"></i><b>3.4.2</b> 가능도함수를 이용한 모수 추정</a></li>
<li class="chapter" data-level="3.4.3" data-path="chapter3.html"><a href="chapter3.html#추정량의-성질"><i class="fa fa-check"></i><b>3.4.3</b> 추정량의 성질</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="chapter3.html"><a href="chapter3.html#모형에-대한-적합도-검정"><i class="fa fa-check"></i><b>3.5</b> 모형에 대한 적합도 검정</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="chapter3.html"><a href="chapter3.html#결정계수"><i class="fa fa-check"></i><b>3.5.1</b> 결정계수</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapter3.html"><a href="chapter3.html#회귀식에-대한-검정"><i class="fa fa-check"></i><b>3.5.2</b> 회귀식에 대한 검정</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapter3.html"><a href="chapter3.html#회귀계수에-대한-검정"><i class="fa fa-check"></i><b>3.5.3</b> 회귀계수에 대한 검정</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapter3.html"><a href="chapter3.html#회귀계수에-대한-신뢰구간"><i class="fa fa-check"></i><b>3.5.4</b> 회귀계수에 대한 신뢰구간</a></li>
<li class="chapter" data-level="3.5.5" data-path="chapter3.html"><a href="chapter3.html#예측값에-대한-신뢰구간"><i class="fa fa-check"></i><b>3.5.5</b> 예측값에 대한 신뢰구간</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapter3.html"><a href="chapter3.html#잔차-분석"><i class="fa fa-check"></i><b>3.6</b> 잔차 분석</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="chapter3.html"><a href="chapter3.html#회귀함수의-선형성"><i class="fa fa-check"></i><b>3.6.1</b> 회귀함수의 선형성</a></li>
<li class="chapter" data-level="3.6.2" data-path="chapter3.html"><a href="chapter3.html#오차항의-등분산성과-독립성"><i class="fa fa-check"></i><b>3.6.2</b> 오차항의 등분산성과 독립성</a></li>
<li class="chapter" data-level="3.6.3" data-path="chapter3.html"><a href="chapter3.html#오차항의-정규성"><i class="fa fa-check"></i><b>3.6.3</b> 오차항의 정규성</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="chapter3.html"><a href="chapter3.html#example-7"><i class="fa fa-check"></i><b>3.7</b> Example</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="chapter3.html"><a href="chapter3.html#example-1-1"><i class="fa fa-check"></i><b>3.7.1</b> Example 1</a></li>
<li class="chapter" data-level="3.7.2" data-path="chapter3.html"><a href="chapter3.html#example-2-1"><i class="fa fa-check"></i><b>3.7.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="chapter3.html"><a href="chapter3.html#부분-회귀"><i class="fa fa-check"></i><b>3.8</b> 부분 회귀</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="chapter3.html"><a href="chapter3.html#example-8"><i class="fa fa-check"></i><b>3.8.1</b> Example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> 다중선형회귀분석</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#다중선형회귀모형---설명변수가-두-개인-경우"><i class="fa fa-check"></i><b>4.1</b> 다중선형회귀모형 - 설명변수가 두 개인 경우</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#다중선형회귀모형---설명변수가-여러-개인-경우"><i class="fa fa-check"></i><b>4.2</b> 다중선형회귀모형 - 설명변수가 여러 개인 경우</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#모수-추정-1"><i class="fa fa-check"></i><b>4.3</b> 모수 추정</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="chapter4.html"><a href="chapter4.html#최소제곱법을-이용한-모수추정"><i class="fa fa-check"></i><b>4.3.1</b> 최소제곱법을 이용한 모수추정</a></li>
<li class="chapter" data-level="4.3.2" data-path="chapter4.html"><a href="chapter4.html#가능도함수를-이용한-모수-추정-1"><i class="fa fa-check"></i><b>4.3.2</b> 가능도함수를 이용한 모수 추정</a></li>
<li class="chapter" data-level="4.3.3" data-path="chapter4.html"><a href="chapter4.html#추정량의-성질-1"><i class="fa fa-check"></i><b>4.3.3</b> 추정량의 성질</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#회귀모형-추정"><i class="fa fa-check"></i><b>4.4</b> 회귀모형 추정</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="chapter4.html"><a href="chapter4.html#회귀계수에-대한-검정-1"><i class="fa fa-check"></i><b>4.4.1</b> 회귀계수에 대한 검정</a></li>
<li class="chapter" data-level="4.4.2" data-path="chapter4.html"><a href="chapter4.html#회귀계수에-대한-신뢰구간-1"><i class="fa fa-check"></i><b>4.4.2</b> 회귀계수에 대한 신뢰구간</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#모형에-대한-적합도-검정-1"><i class="fa fa-check"></i><b>4.5</b> 모형에 대한 적합도 검정</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="chapter4.html"><a href="chapter4.html#결정계수-1"><i class="fa fa-check"></i><b>4.5.1</b> 결정계수</a></li>
<li class="chapter" data-level="4.5.2" data-path="chapter4.html"><a href="chapter4.html#회귀계수벡터에-대한-검정"><i class="fa fa-check"></i><b>4.5.2</b> 회귀계수벡터에 대한 검정</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#신뢰구간과-예측구간"><i class="fa fa-check"></i><b>4.6</b> 신뢰구간과 예측구간</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="chapter4.html"><a href="chapter4.html#반응평균과-반응평균에-대한-신뢰구간"><i class="fa fa-check"></i><b>4.6.1</b> 반응평균과 반응평균에 대한 신뢰구간</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#잔차분석"><i class="fa fa-check"></i><b>4.7</b> 잔차분석</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="chapter4.html"><a href="chapter4.html#회귀함수의-선형성-1"><i class="fa fa-check"></i><b>4.7.1</b> 회귀함수의 선형성</a></li>
<li class="chapter" data-level="4.7.2" data-path="chapter4.html"><a href="chapter4.html#오차항의-등분산성과-독립성-1"><i class="fa fa-check"></i><b>4.7.2</b> 오차항의 등분산성과 독립성</a></li>
<li class="chapter" data-level="4.7.3" data-path="chapter4.html"><a href="chapter4.html#오차항의-정규성-1"><i class="fa fa-check"></i><b>4.7.3</b> 오차항의 정규성</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="chapter4.html"><a href="chapter4.html#r을-이용한-다중회귀분석"><i class="fa fa-check"></i><b>4.8</b> R을 이용한 다중회귀분석</a></li>
<li class="chapter" data-level="4.9" data-path="chapter4.html"><a href="chapter4.html#다항회귀모형"><i class="fa fa-check"></i><b>4.9</b> 다항회귀모형</a></li>
<li class="chapter" data-level="4.10" data-path="chapter4.html"><a href="chapter4.html#표준화-회귀모형"><i class="fa fa-check"></i><b>4.10</b> 표준화 회귀모형</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> 회귀진단 및 보정</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#모자행렬과-지렛대"><i class="fa fa-check"></i><b>5.1</b> 모자행렬과 지렛대</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#스튜던트화-잔차"><i class="fa fa-check"></i><b>5.2</b> 스튜던트화 잔차</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#영향점"><i class="fa fa-check"></i><b>5.3</b> 영향점</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="chapter5.html"><a href="chapter5.html#쿡의-거리"><i class="fa fa-check"></i><b>5.3.1</b> 쿡의 거리</a></li>
<li class="chapter" data-level="5.3.2" data-path="chapter5.html"><a href="chapter5.html#dffits"><i class="fa fa-check"></i><b>5.3.2</b> DFFITS</a></li>
<li class="chapter" data-level="5.3.3" data-path="chapter5.html"><a href="chapter5.html#추가변수-그림"><i class="fa fa-check"></i><b>5.3.3</b> 추가변수 그림</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#이상점"><i class="fa fa-check"></i><b>5.4</b> 이상점</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#example-13"><i class="fa fa-check"></i><b>5.5</b> Example</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#회귀진단-후-보정-방법"><i class="fa fa-check"></i><b>5.6</b> 회귀진단 후 보정 방법</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="chapter5.html"><a href="chapter5.html#잔차그림"><i class="fa fa-check"></i><b>5.6.1</b> 잔차그림</a></li>
<li class="chapter" data-level="5.6.2" data-path="chapter5.html"><a href="chapter5.html#정규성을-만족하지-않는-경우"><i class="fa fa-check"></i><b>5.6.2</b> 정규성을 만족하지 않는 경우</a></li>
<li class="chapter" data-level="5.6.3" data-path="chapter5.html"><a href="chapter5.html#등분산이-아닌-경우"><i class="fa fa-check"></i><b>5.6.3</b> 등분산이 아닌 경우</a></li>
<li class="chapter" data-level="5.6.4" data-path="chapter5.html"><a href="chapter5.html#선형이-아닌-경우"><i class="fa fa-check"></i><b>5.6.4</b> 선형이 아닌 경우</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> 모형비교와 변수선택법</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#다중공선성"><i class="fa fa-check"></i><b>6.1</b> 다중공선성</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter6.html"><a href="chapter6.html#다중공선성-문제"><i class="fa fa-check"></i><b>6.1.1</b> 다중공선성 문제</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter6.html"><a href="chapter6.html#분산팽창계수"><i class="fa fa-check"></i><b>6.1.2</b> 분산팽창계수</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter6.html"><a href="chapter6.html#다중공선성이-존재하는-경우"><i class="fa fa-check"></i><b>6.1.3</b> 다중공선성이 존재하는 경우</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#모형-비교와-f-검정"><i class="fa fa-check"></i><b>6.2</b> 모형 비교와 F-검정</a></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#변수선택"><i class="fa fa-check"></i><b>6.3</b> 변수선택</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chapter6.html"><a href="chapter6.html#단계별-변수선택법"><i class="fa fa-check"></i><b>6.3.1</b> 단계별 변수선택법</a></li>
<li class="chapter" data-level="6.3.2" data-path="chapter6.html"><a href="chapter6.html#가능한-경우들-중-선택"><i class="fa fa-check"></i><b>6.3.2</b> 가능한 경우들 중 선택</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chapter6.html"><a href="chapter6.html#r-활용-모형-비교-및-변수선택"><i class="fa fa-check"></i><b>6.4</b> R 활용 모형 비교 및 변수선택</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter7.html"><a href="chapter7.html"><i class="fa fa-check"></i><b>7</b> 다중회귀분석 예제</a>
<ul>
<li class="chapter" data-level="7.1" data-path="chapter7.html"><a href="chapter7.html#데이터-탐색"><i class="fa fa-check"></i><b>7.1</b> 데이터 탐색</a></li>
<li class="chapter" data-level="7.2" data-path="chapter7.html"><a href="chapter7.html#다중선형회귀분석"><i class="fa fa-check"></i><b>7.2</b> 다중선형회귀분석</a></li>
<li class="chapter" data-level="7.3" data-path="chapter7.html"><a href="chapter7.html#단계별-회귀에-의한-변수-선택"><i class="fa fa-check"></i><b>7.3</b> 단계별 회귀에 의한 변수 선택</a></li>
<li class="chapter" data-level="7.4" data-path="chapter7.html"><a href="chapter7.html#다중공선성-1"><i class="fa fa-check"></i><b>7.4</b> 다중공선성</a></li>
<li class="chapter" data-level="7.5" data-path="chapter7.html"><a href="chapter7.html#지렛대점과-이상점"><i class="fa fa-check"></i><b>7.5</b> 지렛대점과 이상점</a></li>
<li class="chapter" data-level="7.6" data-path="chapter7.html"><a href="chapter7.html#잔차분석-1"><i class="fa fa-check"></i><b>7.6</b> 잔차분석</a></li>
<li class="chapter" data-level="7.7" data-path="chapter7.html"><a href="chapter7.html#모형-제안-및-예측"><i class="fa fa-check"></i><b>7.7</b> 모형 제안 및 예측</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter8.html"><a href="chapter8.html"><i class="fa fa-check"></i><b>8</b> 일반화 가중회귀모형</a>
<ul>
<li class="chapter" data-level="8.1" data-path="chapter8.html"><a href="chapter8.html#일반화-회귀모형"><i class="fa fa-check"></i><b>8.1</b> 일반화 회귀모형</a></li>
<li class="chapter" data-level="8.2" data-path="chapter8.html"><a href="chapter8.html#최소제곱법을-이용한-모수추정-1"><i class="fa fa-check"></i><b>8.2</b> 최소제곱법을 이용한 모수추정</a></li>
<li class="chapter" data-level="8.3" data-path="chapter8.html"><a href="chapter8.html#r-활용-가중회귀분석"><i class="fa fa-check"></i><b>8.3</b> R 활용 가중회귀분석</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter9.html"><a href="chapter9.html"><i class="fa fa-check"></i><b>9</b> 가변수 회귀모형</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chapter9.html"><a href="chapter9.html#이분-가변수-경우"><i class="fa fa-check"></i><b>9.1</b> 이분 가변수 경우</a></li>
<li class="chapter" data-level="9.2" data-path="chapter9.html"><a href="chapter9.html#두-개-회귀직선의-비교"><i class="fa fa-check"></i><b>9.2</b> 두 개 회귀직선의 비교</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-평행성-검정---각-모형의-경우"><i class="fa fa-check"></i><b>9.2.1</b> 회귀직선의 평행성 검정 - 각 모형의 경우</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-평행성-검정---가변수의-경우"><i class="fa fa-check"></i><b>9.2.2</b> 회귀직선의 평행성 검정 - 가변수의 경우</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-일치성-검정---각-모형의-경우"><i class="fa fa-check"></i><b>9.2.3</b> 회귀직선의 일치성 검정 - 각 모형의 경우</a></li>
<li class="chapter" data-level="9.2.4" data-path="chapter9.html"><a href="chapter9.html#회귀직선의-일치성-검정---가변수의-적용"><i class="fa fa-check"></i><b>9.2.4</b> 회귀직선의 일치성 검정 - 가변수의 적용</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapter9.html"><a href="chapter9.html#다항-가변수-경우"><i class="fa fa-check"></i><b>9.3</b> 다항 가변수 경우</a></li>
<li class="chapter" data-level="9.4" data-path="chapter9.html"><a href="chapter9.html#r-활용-가변수회귀분석"><i class="fa fa-check"></i><b>9.4</b> R 활용 가변수회귀분석</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="chapter9.html"><a href="chapter9.html#구름-데이터"><i class="fa fa-check"></i><b>9.4.1</b> 구름 데이터</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapter9.html"><a href="chapter9.html#iq-데이터"><i class="fa fa-check"></i><b>9.4.2</b> IQ 데이터</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter10.html"><a href="chapter10.html"><i class="fa fa-check"></i><b>10</b> 능형회귀추정량과 LASSO 추정량</a>
<ul>
<li class="chapter" data-level="10.1" data-path="chapter10.html"><a href="chapter10.html#능형회귀모형"><i class="fa fa-check"></i><b>10.1</b> 능형회귀모형</a></li>
<li class="chapter" data-level="10.2" data-path="chapter10.html"><a href="chapter10.html#능형모수추정"><i class="fa fa-check"></i><b>10.2</b> 능형모수추정</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="chapter10.html"><a href="chapter10.html#능형추정량의-성질"><i class="fa fa-check"></i><b>10.2.1</b> 능형추정량의 성질</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapter10.html"><a href="chapter10.html#능형모수추정-1"><i class="fa fa-check"></i><b>10.2.2</b> 능형모수추정</a></li>
<li class="chapter" data-level="10.2.3" data-path="chapter10.html"><a href="chapter10.html#능형트레이스"><i class="fa fa-check"></i><b>10.2.3</b> 능형트레이스</a></li>
<li class="chapter" data-level="10.2.4" data-path="chapter10.html"><a href="chapter10.html#example-15"><i class="fa fa-check"></i><b>10.2.4</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="chapter10.html"><a href="chapter10.html#lasso-회귀모형"><i class="fa fa-check"></i><b>10.3</b> LASSO 회귀모형</a></li>
<li class="chapter" data-level="10.4" data-path="chapter10.html"><a href="chapter10.html#r-활용-능형회귀-및-lasso-회귀분석"><i class="fa fa-check"></i><b>10.4</b> R 활용 능형회귀 및 LASSO 회귀분석</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Regression Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter7" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> 다중회귀분석 예제<a href="chapter7.html#chapter7" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="데이터-탐색" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> 데이터 탐색<a href="chapter7.html#데이터-탐색" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>데이터</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter7.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(multi)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    40 obs. of  7 variables:
##  $ Y : int  443 290 676 536 481 296 453 617 514 400 ...
##  $ X1: int  49 27 115 92 67 31 105 114 98 15 ...
##  $ X2: int  79 70 92 62 42 54 60 85 72 59 ...
##  $ X3: int  76 31 130 92 94 34 47 84 71 99 ...
##  $ X4: int  8 6 0 5 16 14 5 17 12 15 ...
##  $ X5: int  15 6 9 8 3 11 10 20 -1 11 ...
##  $ X6: int  205 129 339 247 202 119 212 285 242 174 ...</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter7.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(multi)</span></code></pre></div>
<pre><code>##     Y  X1 X2  X3 X4 X5  X6
## 1 443  49 79  76  8 15 205
## 2 290  27 70  31  6  6 129
## 3 676 115 92 130  0  9 339
## 4 536  92 62  92  5  8 247
## 5 481  67 42  94 16  3 202
## 6 296  31 54  34 14 11 119</code></pre>
<ul>
<li>산점도 행렬</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="chapter7.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(multi)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_1-1.png" width="672" /></p>
<ul>
<li>산점도 행렬을 살펴보면, 반응변수 <span class="math inline">\(Y\)</span>와 설명변수 <span class="math inline">\(X\)</span> 간에 선형적 관계가 있음을 알 수 있다. 특히 <span class="math inline">\(X6\)</span>은 강한 선형성을 보이며 <span class="math inline">\(X1, X2, X3\)</span>도 어느정도 선형성이 있음을 알 수 있음</li>
</ul>
<p><br></p>
</div>
<div id="다중선형회귀분석" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> 다중선형회귀분석<a href="chapter7.html#다중선형회귀분석" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>6개의 설명변수 <span class="math inline">\(X\)</span>와 반응변수 <span class="math inline">\(Y\)</span>와의 다중선형회귀모형</li>
</ul>
<p><span class="math display">\[
Y_i=\beta_0+\beta_1X_{1i}+\beta_2X_{2i}+\beta_3X_{3i}+\beta_4X_{4i}+\beta_5X_{5i}+\beta_6X_{6i}+\epsilon_i, \,\,\, i=1,2,\cdots, 40
\]</span></p>
<ul>
<li>모형을 행렬로 다시 표현하면</li>
</ul>
<p><span class="math display">\[
\mathbf{Y}=\mathbf{X}\beta+\epsilon
\]</span></p>
<ul>
<li>여기서</li>
</ul>
<p><span class="math display">\[
\begin{pmatrix} Y_1\\Y_2\\\vdots\\Y_{40} \end{pmatrix}=\begin{pmatrix}1 &amp; X_{1,1}&amp;X_{1,2}&amp;\cdots&amp;X_{1,6}\\
1 &amp;X_{2,1}&amp;X_{2,2}&amp;\cdots &amp;X_{2,6}\\
&amp;\vdots &amp; &amp;\vdots &amp;\\ 1&amp;X_{40,1}&amp;X_{40,2}&amp;\cdots&amp;X_{40,6} \end{pmatrix} \begin{pmatrix}\beta_0\\ \beta_1\\ \vdots \\ \beta_6 \end{pmatrix}+\begin{pmatrix} \epsilon_1\\ \epsilon_2 \\ \vdots \\ \epsilon_{40} \end{pmatrix}
\]</span></p>
<p>      여기서 <span class="math inline">\(\mathbf{Y}\)</span>는 반응변수벡터, <span class="math inline">\(\mathbf{X}\)</span>는 <span class="math inline">\(40\times 7\)</span> 설계행렬(design matrix), <span class="math inline">\(\beta\)</span>는 회귀계수벡터이고 <span class="math inline">\(\epsilon\)</span>은 오차벡터</p>
<ul>
<li>완전모형에 대한 최소제곱 추정</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="chapter7.html#cb6-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5<span class="sc">+</span>X6, <span class="at">data=</span>multi)</span>
<span id="cb6-2"><a href="chapter7.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X1 + X2 + X3 + X4 + X5 + X6, data = multi)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -54.267 -15.427   2.524  13.633  71.438 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)  35.1772    22.0755   1.593  0.12058   
## X1            2.8547     5.3372   0.535  0.59632   
## X2            3.2753     5.3330   0.614  0.54332   
## X3            3.1863     5.2887   0.602  0.55098   
## X4            3.1878     0.9918   3.214  0.00292 **
## X5           -0.6677     0.8934  -0.747  0.46014   
## X6           -1.1658     5.3217  -0.219  0.82794   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 28.5 on 33 degrees of freedom
## Multiple R-squared:  0.9559, Adjusted R-squared:  0.9479 
## F-statistic: 119.3 on 6 and 33 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>따라서 추정된 회귀식은</li>
</ul>
<p><span class="math display">\[
\hat{Y}=35.18+2.85X1+3.28X2+3.19X3+3.19X4-0.67X5-1.17X6
\]</span></p>
<ul>
<li><p>여기서 수정된 <span class="math inline">\(R^2\)</span>은 0.9479로 매우 높은 편이다. <span class="math inline">\(R^2\)</span>는 전체 변동 중 적합된 회귀식에 의해 설명되는 비율을 나타내므로 설명량이 매우 높다고 할 수 있음</p></li>
<li><p>회귀계수의 신뢰구간</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="chapter7.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit)</span></code></pre></div>
<pre><code>##                  2.5 %    97.5 %
## (Intercept)  -9.735797 80.090161
## X1           -8.003869 13.713291
## X2           -7.574837 14.125465
## X3           -7.573708 13.946270
## X4            1.169946  5.205616
## X5           -2.485251  1.149908
## X6          -11.992923  9.661246</code></pre>
<ul>
<li>적합값(fitted value)과 신뢰구간</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapter7.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, <span class="at">newdata=</span>multi[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="sc">-</span><span class="dv">1</span>], <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<pre><code>##         fit      lwr      upr
## 1  452.4554 433.3659 471.5449
## 2  305.0285 279.0820 330.9751
## 3  677.7860 643.3030 712.2690
## 4  516.6533 499.0103 534.2963
## 5  477.0185 447.7383 506.2987
## 6  307.4235 283.9517 330.8953
## 7  443.3003 413.2674 473.3332
## 8  615.2384 581.3873 649.0894
## 9  533.7755 511.6633 555.8877
## 10 424.2996 393.8434 454.7557
## 11 460.0212 439.2757 480.7668
## 12 135.0956 104.7676 165.4236
## 13 468.7317 445.1542 492.3093
## 14 489.0569 460.9848 517.1290
## 15 303.8659 268.0056 339.7262
## 16 546.6217 520.9281 572.3154
## 17 560.7264 538.1571 583.2956
## 18 614.9388 593.1832 636.6944
## 19 582.0898 562.0308 602.1488
## 20 441.8124 424.8033 458.8214</code></pre>
<ul>
<li>예측값(predicted value)과 신뢰구간</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapter7.html#cb12-1" aria-hidden="true" tabindex="-1"></a>new.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-2"><a href="chapter7.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="at">X1=</span><span class="fu">sample</span>(multi<span class="sc">$</span>X1,<span class="dv">20</span>),<span class="at">X2=</span><span class="fu">sample</span>(multi<span class="sc">$</span>X2,<span class="dv">20</span>),<span class="at">X3=</span><span class="fu">sample</span>(multi<span class="sc">$</span>X3,<span class="dv">20</span>),</span>
<span id="cb12-3"><a href="chapter7.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="at">X4=</span><span class="fu">sample</span>(multi<span class="sc">$</span>X4,<span class="dv">20</span>),<span class="at">X5=</span><span class="fu">sample</span>(multi<span class="sc">$</span>X5,<span class="dv">20</span>),<span class="at">X6=</span><span class="fu">sample</span>(multi<span class="sc">$</span>X6,<span class="dv">20</span>))</span>
<span id="cb12-4"><a href="chapter7.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(fit, <span class="at">newdata=</span>new.data, <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<pre><code>##         fit         lwr       upr
## 1  365.8525   161.74049  569.9646
## 2  487.5305   108.73591  866.3250
## 3  448.6729   -23.87866  921.2244
## 4  305.8030 -1026.92300 1638.5290
## 5  408.7551   330.40669  487.1035
## 6  335.8354  -620.11664 1291.7875
## 7  506.4663   228.65976  784.2728
## 8  559.8000   248.89707  870.7030
## 9  258.6692  -443.29556  960.6340
## 10 209.1758  -799.80566 1218.1572
## 11 385.6498  -246.26359 1017.5633
## 12 507.6996  -134.27669 1149.6758
## 13 502.2797  -226.26866 1230.8281
## 14 572.1360    14.93905 1129.3328
## 15 346.5968   -51.21006  744.4037
## 16 421.3392  -102.98081  945.6593
## 17 427.5129    34.07989  820.9459
## 18 299.5971  -458.20244 1057.3966
## 19 379.9453  -305.48510 1065.3758
## 20 598.2428   207.49219  988.9935</code></pre>
<p><br></p>
</div>
<div id="단계별-회귀에-의한-변수-선택" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> 단계별 회귀에 의한 변수 선택<a href="chapter7.html#단계별-회귀에-의한-변수-선택" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>회귀모형에서 종속변수를 설명하기 위한 독립변수들 중에서 어떤 독립변수를 포함시키는 것이 최적의 모형이 되는지를 판단하는 것은 매우 중요한 문제임</p></li>
<li><p>단계별 변수선택법에서는 유의한 설명변수를 삽입하거나 유의하지 않은 설명 변수들을 제거함으로써 유의한 설명변수만으로 회귀 모형을 설정할 수 있음</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter7.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb14-2"><a href="chapter7.html#cb14-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5<span class="sc">+</span>X6, <span class="at">data=</span>multi)</span>
<span id="cb14-3"><a href="chapter7.html#cb14-3" aria-hidden="true" tabindex="-1"></a>step <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(fit, <span class="at">direction=</span><span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=274.31
## Y ~ X1 + X2 + X3 + X4 + X5 + X6
## 
##        Df Sum of Sq   RSS    AIC
## - X6    1      39.0 26852 272.37
## - X1    1     232.5 27045 272.66
## - X3    1     294.9 27108 272.75
## - X2    1     306.5 27119 272.76
## - X5    1     453.8 27267 272.98
## &lt;none&gt;              26813 274.31
## - X4    1    8393.8 35207 283.20
## 
## Step:  AIC=272.37
## Y ~ X1 + X2 + X3 + X4 + X5
## 
##        Df Sum of Sq    RSS    AIC
## - X5    1       441  27293 271.02
## &lt;none&gt;               26852 272.37
## + X6    1        39  26813 274.31
## - X4    1      8626  35478 281.51
## - X1    1     57280  84132 316.05
## - X3    1     71412  98264 322.26
## - X2    1    104243 131095 333.79
## 
## Step:  AIC=271.02
## Y ~ X1 + X2 + X3 + X4
## 
##        Df Sum of Sq    RSS    AIC
## &lt;none&gt;               27293 271.02
## + X5    1       441  26852 272.37
## + X6    1        26  27267 272.98
## - X4    1      8727  36020 280.12
## - X1    1     58811  86104 314.98
## - X3    1     71034  98327 320.29
## - X2    1    104172 131465 331.90</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter7.html#cb16-1" aria-hidden="true" tabindex="-1"></a>step<span class="sc">$</span>anova <span class="co"># display results</span></span></code></pre></div>
<pre><code>## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## Y ~ X1 + X2 + X3 + X4 + X5 + X6
## 
## Final Model:
## Y ~ X1 + X2 + X3 + X4
## 
## 
##   Step Df  Deviance Resid. Df Resid. Dev      AIC
## 1                          33   26812.94 274.3104
## 2 - X6  1  38.99477        34   26851.94 272.3686
## 3 - X5  1 441.25106        35   27293.19 271.0205</code></pre>
<ul>
<li>단계별 변수선택법을 이용하여 최종적으로 적합된 모형에 대한 요약 결과를 살펴보면 종속변수 <span class="math inline">\(Y\)</span>에 영향을 주는 변수는 <span class="math inline">\(X1, X2, X3, X4\)</span>가 선택됨</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter7.html#cb18-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4, <span class="at">data=</span>multi)</span>
<span id="cb18-2"><a href="chapter7.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X1 + X2 + X3 + X4, data = multi)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -55.05 -17.03   2.83  17.08  72.40 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  28.3469    18.9141   1.499  0.14291    
## X1            1.7006     0.1958   8.684 2.97e-10 ***
## X2            2.0907     0.1809  11.558 1.68e-13 ***
## X3            2.0209     0.2117   9.544 2.83e-11 ***
## X4            3.2295     0.9654   3.345  0.00197 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 27.92 on 35 degrees of freedom
## Multiple R-squared:  0.9551, Adjusted R-squared:   0.95 
## F-statistic: 186.3 on 4 and 35 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>따라서 축소된 회귀모형은</li>
</ul>
<p><span class="math display">\[
\hat{Y}=28.35+1.70X1+2.09X2+2.02X3+3.23X4
\]</span></p>
<ul>
<li>이때 수정된 <span class="math inline">\(R^2\)</span>은 0.95로 축소된 <span class="math inline">\(X\)</span>로 <span class="math inline">\(Y\)</span>의 <span class="math inline">\(95\%\)</span>를 회귀직선으로 설명함을 알 수 있음</li>
</ul>
<p><br></p>
</div>
<div id="다중공선성-1" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> 다중공선성<a href="chapter7.html#다중공선성-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>다중공선성을 확인하기 위해 분산팽창계수 VIF를 고려함</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapter7.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb20-2"><a href="chapter7.html#cb20-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4, <span class="at">data=</span>multi)</span>
<span id="cb20-3"><a href="chapter7.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(fit2)</span></code></pre></div>
<pre><code>##       X1       X2       X3       X4 
## 1.489950 1.322866 1.276587 1.022997</code></pre>
<ul>
<li>VIF가 모두 10이하 이므로 다중공선성 문제는 고려하지 않아도 됨</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter7.html#cb22-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4<span class="sc">+</span>X5<span class="sc">+</span>X6, <span class="at">data=</span>multi)</span>
<span id="cb22-2"><a href="chapter7.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(fit)</span></code></pre></div>
<pre><code>##          X1          X2          X3          X4          X5          X6 
## 1062.167136 1103.595644  764.394462    1.036287    1.023312 5310.504807</code></pre>
<ul>
<li><p>완전 모형에서는 <span class="math inline">\(X1, X2, X3, X6\)</span>의 VIF 값이 매우 높게 나타나 다중공선성 문제를 심각히 고려하여 모형을 조정할 필요가 있음</p></li>
<li><p>회귀계수간 상관성</p></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter7.html#cb24-1" aria-hidden="true" tabindex="-1"></a>corr <span class="ot">&lt;-</span> <span class="fu">summary</span>(fit, <span class="at">correlation=</span>T)<span class="sc">$</span>correlation</span>
<span id="cb24-2"><a href="chapter7.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">col</span>(corr), <span class="fu">row</span>(corr), <span class="at">cex=</span><span class="dv">10</span><span class="sc">*</span><span class="fu">abs</span>(corr), </span>
<span id="cb24-3"><a href="chapter7.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">ncol</span>(corr)<span class="sc">+</span><span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">ncol</span>(corr)<span class="sc">+</span><span class="dv">1</span>))</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_12-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="지렛대점과-이상점" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> 지렛대점과 이상점<a href="chapter7.html#지렛대점과-이상점" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>회귀분석 문제의 데이터에서 종종 특이하거나 극단적인 관측값을 볼 수 있음</p></li>
<li><p>영향력을 진단하는 방법인 지렛대점, 모자행렬, 잔차들을 이용하여 이상점을 찾아보고자 함</p></li>
<li><p>쿡의 거리는 모든 개체를 이용한 예측값 <span class="math inline">\(\hat{Y}_i\)</span>와 <span class="math inline">\(i\)</span>번째 관측값을 제외하고 구한 예측값 <span class="math inline">\(\hat{Y}_{(i)}\)</span>과의 차이에 근거한 통계량으로, 이 값이 클수록 <span class="math inline">\(i\)</span>번째 관측값은 이상점 혹은 영향점일 가능성이 높음</p></li>
<li><p>기준값 1 이상이면 이상점으로 판단될 수 있으며, 영향점의 기준은 <span class="math inline">\(D&gt;4/n\)</span> 또는 <span class="math inline">\(D&gt;4/(n-p-1)\)</span>을 이용</p></li>
<li><p>Cook’s D plot: identify <span class="math inline">\(D\)</span> values <span class="math inline">\(&gt;4/(n-p-1)=0.1212\)</span></p></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapter7.html#cb25-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>((<span class="fu">nrow</span>(multi)<span class="sc">-</span><span class="fu">length</span>(fit2<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb25-2"><a href="chapter7.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2, <span class="at">which=</span><span class="dv">4</span>, <span class="at">cook.levels=</span>cutoff)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_21-1.png" width="672" /></p>
<ul>
<li>Cook’s D 값</li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapter7.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cooks.distance</span>(fit2)</span></code></pre></div>
<pre><code>##            1            2            3            4            5            6 
## 0.0040425103 0.0116141630 0.0015259657 0.0109580685 0.0035882257 0.0054170163 
##            7            8            9           10           11           12 
## 0.0071203481 0.0030085420 0.0037724075 0.0845608578 0.0029561177 0.0464073376 
##           13           14           15           16           17           18 
## 0.0512331630 0.0061171243 0.0058952052 0.0177805853 0.0975388310 0.0003397407 
##           19           20           21           22           23           24 
## 0.0089275397 0.0120393349 0.0032175818 0.0009346946 0.0104706759 0.0261316480 
##           25           26           27           28           29           30 
## 0.0247340417 0.0059275798 0.0080658277 0.0188522811 0.0004751104 0.0016070184 
##           31           32           33           34           35           36 
## 0.0094665269 0.0012165739 0.0605882937 0.2425048789 0.0072849928 0.0077147168 
##           37           38           39           40 
## 0.0075519438 0.3041838521 0.0136368104 0.0542270594</code></pre>
<ul>
<li>쿡의 D값을 살펴보면 개체 34번, 38번이 기준값보다 높게 나타나 영향점으로 판단 됨</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chapter7.html#cb28-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>((<span class="fu">nrow</span>(multi)<span class="sc">-</span><span class="fu">length</span>(fit2<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb28-2"><a href="chapter7.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2, <span class="at">which=</span><span class="dv">5</span>, <span class="at">cook.levels=</span>cutoff)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_22-1.png" width="672" /></p>
<ul>
<li>DFFITS는 쿡의 거리 측도를 변형한 형태로 기준값은 <span class="math inline">\(2\sqrt{(p+1)/(n-p-1)}=0.81\)</span></li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapter7.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dffits</span>(fit2)</span></code></pre></div>
<pre><code>##           1           2           3           4           5           6 
## -0.14061665 -0.23837081 -0.08611240  0.23249772  0.13225515 -0.16268470 
##           7           8           9          10          11          12 
##  0.18635486 -0.12103362 -0.13587027 -0.65174652  0.12047791  0.47946774 
##          13          14          15          16          17          18 
## -0.51006523 -0.17347354  0.16951088 -0.29623024  0.72688515  0.04062836 
##          19          20          21          22          23          24 
##  0.20983789  0.24749875  0.12529044  0.06740046 -0.22670678 -0.37135284 
##          25          26          27          28          29          30 
##  0.35630621  0.16997599 -0.20107645  0.30444729  0.04804765 -0.08845918 
##          31          32          33          34          35          36 
##  0.21597930  0.07694221  0.55685302 -1.16947699  0.18930180 -0.19488673 
##          37          38          39          40 
## -0.19260558  1.38391019 -0.26201959 -0.53554690</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapter7.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">dffits</span>(fit2), <span class="at">type=</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb31-2"><a href="chapter7.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.81</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_23-1.png" width="672" /></p>
<ul>
<li><p>38번째 개체가 영향점 혹인 이상점일 가능성이 높음</p></li>
<li><p>모자행렬의 대각원소 <span class="math inline">\(h_{ii}\)</span>는 어떠한 관측의 값이 특이한지 아닌지를 알아내는 데 유용한 측도임</p></li>
<li><p>지렛대점에 대한 <span class="math inline">\(h_{ii}\)</span>는 일반적으로 평균 지렛대값 <span class="math inline">\(\bar{h}\)</span>보다 두 배 이상이면 크다고 간주함</p></li>
<li><p>관측값 <span class="math inline">\(Y_i\)</span>가 일반적으로 지렛대점에 상응되어 나타나면 좋은 지렛대점이라 하며, 관측값들에 비해 떨어져 있으며 이상점과 대응되어 나타나면 나쁜 지렛대점이라고 함</p></li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="chapter7.html#cb32-1" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span>((<span class="fu">nrow</span>(multi)<span class="sc">-</span><span class="fu">length</span>(fit2<span class="sc">$</span>coefficients)<span class="sc">-</span><span class="dv">2</span>))</span>
<span id="cb32-2"><a href="chapter7.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2, <span class="at">which=</span><span class="dv">6</span>, <span class="at">cook.levels=</span>cutoff)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_24-1.png" width="672" /></p>
<ul>
<li><p>아래 영향력 그림은 모자행렬에 대한 스튜던트화 잔차의 영향점 그림으로 지렛대값에 대한 스튜던트화 잔차와 더불어 쿡의 거리를 원의 크기로 표현한 그림</p></li>
<li><p>원의 크기를 보면 34번째, 38번째 관측에 대한 쿡의 거리값이 가장 크게 나타남</p></li>
<li><p>수직 참조선은 <span class="math inline">\(\hat{h}\)</span>의 평균값이며 수평 참조선은 -2, 0, 2의 값을 나타냄</p></li>
<li><p>Influence plot</p></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapter7.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(fit2)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_3-1.png" width="672" /></p>
<pre><code>##       StudRes       Hat       CookD
## 3  -0.1269232 0.3152134 0.001525966
## 10 -1.0784317 0.2675253 0.084560858
## 34 -2.3406250 0.1997716 0.242504879
## 38  3.1738803 0.1597507 0.304183852</code></pre>
<ul>
<li>이상점 검정</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="chapter7.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influencePlot</span>(fit2)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_32-1.png" width="672" /></p>
<pre><code>##       StudRes       Hat       CookD
## 3  -0.1269232 0.3152134 0.001525966
## 10 -1.0784317 0.2675253 0.084560858
## 34 -2.3406250 0.1997716 0.242504879
## 38  3.1738803 0.1597507 0.304183852</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="chapter7.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outlierTest</span>(fit2)</span></code></pre></div>
<pre><code>## No Studentized residuals with Bonferroni p &lt; 0.05
## Largest |rstudent|:
##    rstudent unadjusted p-value Bonferroni p
## 38  3.17388          0.0031874       0.1275</code></pre>
<ul>
<li>영향력 판단과 이상점 검정을 통해 38번째 관측값을 자세히 살펴볼 필요가 있음</li>
</ul>
<p><br></p>
</div>
<div id="잔차분석-1" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> 잔차분석<a href="chapter7.html#잔차분석-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>다중선형회귀모형에서 오차항에 대한 등분산성, 독립성, 정규성 가정에 대한 검토가 필요함</p></li>
<li><p>적합값 vs. 잔차 그림</p></li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="chapter7.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2, <span class="at">which=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_4-1.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="chapter7.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2, <span class="at">which=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_4-2.png" width="672" /></p>
<ul>
<li><p>잔차 그림에서는 기본적으로 잔차에 대한 등분산성을 살펴볼 수 있음</p></li>
<li><p>그림을 살펴보면 0을 중심으로 랜덤하게 분포되어 보이기는 하지만 관측값 38번, 34번에 의해 수평대의 형태를 약간 벗어난 것으로 보임. 그러나 전반적으로 잔차가 수평대 이내에 놓여 있고 양이나 음의 값이 계통적(systematic)인 경향을 보이지 않고 랜덤하게 나타나고 있으므로 선형성을 대체로 만족한다고 할 수 있음.</p></li>
<li><p>편잔차그림을 이용해 다중회귀의 선형성에 대한 검토를 할 수 있음</p></li>
<li><p>편잔차그림에서 직선을 살펴보면 선형성을 만족하는 경우의 점선에 가까운 편이므로 모형에 적합된 변수들이 선형성을 크게 벗어나지 않는다고 여겨져 선형모형의 타당성을 뒷받침 함</p></li>
<li><p>편잔차그림</p></li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="chapter7.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">crPlots</span>(fit2)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_42-1.png" width="672" /></p>
<ul>
<li><p>정규성 가정에 대한 검토는 잔차에 대한 Q-Q plot, 스튜던트화 잔차에 대한 t-분포 Q-Q plot, 잔차에 대한 Shapiro-Wilks 검정 등을 통해 수행함</p></li>
<li><p>정규성 검정</p></li>
</ul>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="chapter7.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2, <span class="at">which=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_5-1.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="chapter7.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(fit2)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_5-2.png" width="672" /></p>
<pre><code>## [1] 34 38</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="chapter7.html#cb45-1" aria-hidden="true" tabindex="-1"></a>residual <span class="ot">&lt;-</span> <span class="fu">resid</span>(fit2)</span>
<span id="cb45-2"><a href="chapter7.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(residual)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residual
## W = 0.98271, p-value = 0.7883</code></pre>
<ul>
<li><p>Shapiro-Wilks 검정을 통해 살펴보면, 정규성 가정을 만족하는 것으로 나타남</p></li>
<li><p>등분산성 검정(non-constant error variance test)</p></li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="chapter7.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spreadLevelPlot</span>(fit2)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_6-1.png" width="672" /></p>
<pre><code>## 
## Suggested power transformation:  0.9365597</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="chapter7.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncvTest</span>(fit2)</span></code></pre></div>
<pre><code>## Non-constant Variance Score Test 
## Variance formula: ~ fitted.values 
## Chisquare = 3.507139, Df = 1, p = 0.061105</code></pre>
<ul>
<li><p>등분산성 검정에서도 특별한 이슈가 발생하지 않는 것으로 나타남</p></li>
<li><p>독립성 검정</p></li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="chapter7.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(fit2)</span></code></pre></div>
<pre><code>##  lag Autocorrelation D-W Statistic p-value
##    1       -0.212897      2.344761    0.26
##  Alternative hypothesis: rho != 0</code></pre>
<ul>
<li>더빈-왓슨 검정을 통해 독립성을 살펴보면 문제가 없는 것으로 나타남</li>
</ul>
<p><br></p>
</div>
<div id="모형-제안-및-예측" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> 모형 제안 및 예측<a href="chapter7.html#모형-제안-및-예측" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>이상점에 대한 이슈가 있긴 했지만 모든 개체를 모함한 최종 모형은 <span class="math inline">\(X1, X2, X3, X4\)</span>를 이용한 다중회귀 모형으로 선정</li>
</ul>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="chapter7.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(graphics)</span>
<span id="cb53-2"><a href="chapter7.html#cb53-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X1<span class="sc">+</span>X2<span class="sc">+</span>X3<span class="sc">+</span>X4, <span class="at">data=</span>multi)</span>
<span id="cb53-3"><a href="chapter7.html#cb53-3" aria-hidden="true" tabindex="-1"></a>pred.pre <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2, <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb53-4"><a href="chapter7.html#cb53-4" aria-hidden="true" tabindex="-1"></a>pred.con <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit2, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb53-5"><a href="chapter7.html#cb53-5" aria-hidden="true" tabindex="-1"></a>pred.dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(pred.con,pred.pre[,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb53-6"><a href="chapter7.html#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="chapter7.html#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">matplot</span>(pred.dat,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="Regression-Analysis_files/figure-html/ch7_7-1.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="chapter7.html#cb54-1" aria-hidden="true" tabindex="-1"></a>pred.con</span></code></pre></div>
<pre><code>##         fit      lwr      upr
## 1  456.2634 440.5912 471.9357
## 2  302.6355 278.0991 327.1718
## 3  678.9751 647.1467 710.8035
## 4  516.4949 499.2540 533.7359
## 5  471.7316 451.7075 491.7557
## 6  307.8860 288.5233 327.2487
## 7  443.4834 418.2930 468.6739
## 8  624.5821 602.7663 646.3980
## 9  527.7742 513.0539 542.4945
## 10 425.7142 396.3921 455.0363
## 11 456.1641 445.1628 467.1655
## 12 137.0722 108.5153 165.6291
## 13 471.8829 450.3707 493.3951
## 14 497.9870 483.5876 512.3863
## 15 307.2503 282.2352 332.2655
## 16 549.2984 528.2205 570.3764
## 17 560.1461 540.6051 579.6871
## 18 614.3461 593.1858 635.5065
## 19 580.4312 564.6617 596.2006
## 20 445.4612 434.6263 456.2961
## 21 268.5420 251.1490 285.9350
## 22 442.2220 418.5646 465.8794
## 23 465.8172 445.7779 485.8564
## 24 380.5561 368.5576 392.5545
## 25 421.9171 407.8311 436.0032
## 26 621.2499 596.1895 646.3103
## 27 511.5791 500.8531 522.3050
## 28 600.5784 576.3755 624.7813
## 29 601.9935 580.1422 623.8448
## 30 395.8933 379.4312 412.3554
## 31 332.1211 315.4544 348.7877
## 32 359.1801 342.6206 375.7396
## 33 458.5225 436.9198 480.1253
## 34 703.0536 677.7152 728.3920
## 35 431.1899 415.5214 446.8583
## 36 358.3910 342.7687 374.0133
## 37 308.7102 291.9164 325.5040
## 38 615.6009 592.9423 638.2596
## 39 438.1830 425.2050 451.1609
## 40 506.1192 489.4322 522.8062</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="chapter7.html#cb56-1" aria-hidden="true" tabindex="-1"></a>pred.pre</span></code></pre></div>
<pre><code>##         fit       lwr      upr
## 1  456.2634 397.44624 515.0806
## 2  302.6355 240.86272 364.4082
## 3  678.9751 613.96059 743.9896
## 4  516.4949 457.24046 575.7494
## 5  471.7316 411.60836 531.8549
## 6  307.8860 247.97973 367.7922
## 7  443.4834 381.44797 505.5189
## 8  624.5821 563.83865 685.3256
## 9  527.7742 469.20351 586.3450
## 10 425.7142 361.88924 489.5392
## 11 456.1641 398.41580 513.9125
## 12 137.0722  73.59513 200.5493
## 13 471.8829 411.24782 532.5180
## 14 497.9870 439.49608 556.4778
## 15 307.2503 245.28585 369.2148
## 16 549.2984 488.81604 609.7808
## 17 560.1461 500.18199 620.1102
## 18 614.3461 553.83494 674.8573
## 19 580.4312 521.58803 639.2744
## 20 445.4612 387.74435 503.1781
## 21 268.5420 209.24314 327.8409
## 22 442.2220 380.79306 503.6509
## 23 465.8172 405.68886 525.9455
## 24 380.5561 322.60949 438.5026
## 25 421.9171 363.50259 480.3317
## 26 621.2499 559.26708 683.2327
## 27 511.5791 453.88254 569.2756
## 28 600.5784 538.93730 662.2194
## 29 601.9935 541.23727 662.7497
## 30 395.8933 336.86073 454.9258
## 31 332.1211 273.03113 391.2110
## 32 359.1801 300.12028 418.2399
## 33 458.5225 397.85524 519.1898
## 34 703.0536 640.95787 765.1493
## 35 431.1899 372.37367 490.0060
## 36 358.3910 299.58711 417.1949
## 37 308.7102 249.58427 367.8361
## 38 615.6009 554.54969 676.6522
## 39 438.1830 380.02568 496.3402
## 40 506.1192 447.02351 565.2148</code></pre>
<!-- End -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter8.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Regression Analysis.pdf", "Regression Analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
