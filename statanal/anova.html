<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 분산분석 | Statistical Analysis</title>
  <meta name="description" content="This is a Statistical Analysis" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 분산분석 | Statistical Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a Statistical Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 분산분석 | Statistical Analysis" />
  
  <meta name="twitter:description" content="This is a Statistical Analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2022-02-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ttest.html"/>
<link rel="next" href="nonpara.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>1</b> 평균차이 검정</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ttest.html"><a href="ttest.html#일표본-t-검정"><i class="fa fa-check"></i><b>1.1</b> 일표본 <span class="math inline">\(t\)</span>-검정</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="ttest.html"><a href="ttest.html#with-r"><i class="fa fa-check"></i><b>1.1.1</b> With R</a></li>
<li class="chapter" data-level="1.1.2" data-path="ttest.html"><a href="ttest.html#with-sas"><i class="fa fa-check"></i><b>1.1.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ttest.html"><a href="ttest.html#독립표본-t-검정"><i class="fa fa-check"></i><b>1.2</b> 독립표본 <span class="math inline">\(t\)</span>-검정</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ttest.html"><a href="ttest.html#두-모분산-비의-검정"><i class="fa fa-check"></i><b>1.2.1</b> 두 모분산 비의 검정</a></li>
<li class="chapter" data-level="1.2.2" data-path="ttest.html"><a href="ttest.html#with-r-1"><i class="fa fa-check"></i><b>1.2.2</b> With R</a></li>
<li class="chapter" data-level="1.2.3" data-path="ttest.html"><a href="ttest.html#with-sas-1"><i class="fa fa-check"></i><b>1.2.3</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ttest.html"><a href="ttest.html#대응표본-t-검정"><i class="fa fa-check"></i><b>1.3</b> 대응표본 <span class="math inline">\(t\)</span>-검정</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ttest.html"><a href="ttest.html#with-r-2"><i class="fa fa-check"></i><b>1.3.1</b> With R</a></li>
<li class="chapter" data-level="1.3.2" data-path="ttest.html"><a href="ttest.html#with-sas-2"><i class="fa fa-check"></i><b>1.3.2</b> with SAS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>2</b> 분산분석</a>
<ul>
<li class="chapter" data-level="2.1" data-path="anova.html"><a href="anova.html#분산분석"><i class="fa fa-check"></i><b>2.1</b> 분산분석</a></li>
<li class="chapter" data-level="2.2" data-path="anova.html"><a href="anova.html#일원배치-분산분석"><i class="fa fa-check"></i><b>2.2</b> 일원배치 분산분석</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="anova.html"><a href="anova.html#사후분석다중검정"><i class="fa fa-check"></i><b>2.2.1</b> 사후분석(다중검정)</a></li>
<li class="chapter" data-level="2.2.2" data-path="anova.html"><a href="anova.html#with-r-3"><i class="fa fa-check"></i><b>2.2.2</b> With R</a></li>
<li class="chapter" data-level="2.2.3" data-path="anova.html"><a href="anova.html#with-sas-3"><i class="fa fa-check"></i><b>2.2.3</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="anova.html"><a href="anova.html#이원배치-분산분석"><i class="fa fa-check"></i><b>2.3</b> 이원배치 분산분석</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="anova.html"><a href="anova.html#교호작용"><i class="fa fa-check"></i><b>2.3.1</b> 교호작용</a></li>
<li class="chapter" data-level="2.3.2" data-path="anova.html"><a href="anova.html#with-r-4"><i class="fa fa-check"></i><b>2.3.2</b> With R</a></li>
<li class="chapter" data-level="2.3.3" data-path="anova.html"><a href="anova.html#with-sas-4"><i class="fa fa-check"></i><b>2.3.3</b> With SAS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nonpara.html"><a href="nonpara.html"><i class="fa fa-check"></i><b>3</b> 비모수 검정</a>
<ul>
<li class="chapter" data-level="3.1" data-path="nonpara.html"><a href="nonpara.html#정규성-검정"><i class="fa fa-check"></i><b>3.1</b> 정규성 검정</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="nonpara.html"><a href="nonpara.html#with-r-5"><i class="fa fa-check"></i><b>3.1.1</b> With R</a></li>
<li class="chapter" data-level="3.1.2" data-path="nonpara.html"><a href="nonpara.html#with-sas-5"><i class="fa fa-check"></i><b>3.1.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="nonpara.html"><a href="nonpara.html#윌콕슨-부호순위-검정"><i class="fa fa-check"></i><b>3.2</b> 윌콕슨 부호순위 검정</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="nonpara.html"><a href="nonpara.html#with-r-6"><i class="fa fa-check"></i><b>3.2.1</b> With R</a></li>
<li class="chapter" data-level="3.2.2" data-path="nonpara.html"><a href="nonpara.html#with-sas-6"><i class="fa fa-check"></i><b>3.2.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="nonpara.html"><a href="nonpara.html#윌콕슨-순위합-검정"><i class="fa fa-check"></i><b>3.3</b> 윌콕슨 순위합 검정</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="nonpara.html"><a href="nonpara.html#with-r-7"><i class="fa fa-check"></i><b>3.3.1</b> With R</a></li>
<li class="chapter" data-level="3.3.2" data-path="nonpara.html"><a href="nonpara.html#with-sas-7"><i class="fa fa-check"></i><b>3.3.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="nonpara.html"><a href="nonpara.html#크루스칼-왈리스-검정"><i class="fa fa-check"></i><b>3.4</b> 크루스칼-왈리스 검정</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="nonpara.html"><a href="nonpara.html#with-r-8"><i class="fa fa-check"></i><b>3.4.1</b> With R</a></li>
<li class="chapter" data-level="3.4.2" data-path="nonpara.html"><a href="nonpara.html#with-sas-8"><i class="fa fa-check"></i><b>3.4.2</b> With SAS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="category.html"><a href="category.html"><i class="fa fa-check"></i><b>4</b> 분할표 검정</a>
<ul>
<li class="chapter" data-level="4.1" data-path="category.html"><a href="category.html#상대위험률과-오즈비"><i class="fa fa-check"></i><b>4.1</b> 상대위험률과 오즈비</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="category.html"><a href="category.html#상대위험률"><i class="fa fa-check"></i><b>4.1.1</b> 상대위험률</a></li>
<li class="chapter" data-level="4.1.2" data-path="category.html"><a href="category.html#오즈비"><i class="fa fa-check"></i><b>4.1.2</b> 오즈비</a></li>
<li class="chapter" data-level="4.1.3" data-path="category.html"><a href="category.html#with-r-9"><i class="fa fa-check"></i><b>4.1.3</b> With R</a></li>
<li class="chapter" data-level="4.1.4" data-path="category.html"><a href="category.html#with-sas-9"><i class="fa fa-check"></i><b>4.1.4</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="category.html"><a href="category.html#독립성-검정"><i class="fa fa-check"></i><b>4.2</b> 독립성 검정</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="category.html"><a href="category.html#with-r-10"><i class="fa fa-check"></i><b>4.2.1</b> With R</a></li>
<li class="chapter" data-level="4.2.2" data-path="category.html"><a href="category.html#with-sas-10"><i class="fa fa-check"></i><b>4.2.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="category.html"><a href="category.html#동질성-검정"><i class="fa fa-check"></i><b>4.3</b> 동질성 검정</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="category.html"><a href="category.html#with-r-11"><i class="fa fa-check"></i><b>4.3.1</b> With R</a></li>
<li class="chapter" data-level="4.3.2" data-path="category.html"><a href="category.html#with-sas-11"><i class="fa fa-check"></i><b>4.3.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="category.html"><a href="category.html#fisher의-정확-검정"><i class="fa fa-check"></i><b>4.4</b> Fisher의 정확 검정</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="category.html"><a href="category.html#with-r-12"><i class="fa fa-check"></i><b>4.4.1</b> With R</a></li>
<li class="chapter" data-level="4.4.2" data-path="category.html"><a href="category.html#with-sas-12"><i class="fa fa-check"></i><b>4.4.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="category.html"><a href="category.html#맥니마-검정"><i class="fa fa-check"></i><b>4.5</b> 맥니마 검정</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="category.html"><a href="category.html#이론적-배경"><i class="fa fa-check"></i><b>4.5.1</b> 이론적 배경</a></li>
<li class="chapter" data-level="4.5.2" data-path="category.html"><a href="category.html#with-r-13"><i class="fa fa-check"></i><b>4.5.2</b> With R</a></li>
<li class="chapter" data-level="4.5.3" data-path="category.html"><a href="category.html#with-sas-13"><i class="fa fa-check"></i><b>4.5.3</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="category.html"><a href="category.html#cochran-mantel-haenzel-test"><i class="fa fa-check"></i><b>4.6</b> Cochran-Mantel-Haenzel test</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="category.html"><a href="category.html#with-r-14"><i class="fa fa-check"></i><b>4.6.1</b> With R</a></li>
<li class="chapter" data-level="4.6.2" data-path="category.html"><a href="category.html#with-sas-14"><i class="fa fa-check"></i><b>4.6.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="category.html"><a href="category.html#진단법의-평가"><i class="fa fa-check"></i><b>4.7</b> 진단법의 평가</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="category.html"><a href="category.html#민감도와-특이도"><i class="fa fa-check"></i><b>4.7.1</b> 민감도와 특이도</a></li>
<li class="chapter" data-level="4.7.2" data-path="category.html"><a href="category.html#양성예측도와-음성예측도"><i class="fa fa-check"></i><b>4.7.2</b> 양성예측도와 음성예측도</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>5</b> 회귀분석</a>
<ul>
<li class="chapter" data-level="5.1" data-path="regression.html"><a href="regression.html#상관분석"><i class="fa fa-check"></i><b>5.1</b> 상관분석</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="regression.html"><a href="regression.html#상관계수"><i class="fa fa-check"></i><b>5.1.1</b> 상관계수</a></li>
<li class="chapter" data-level="5.1.2" data-path="regression.html"><a href="regression.html#스피어만-상관계수"><i class="fa fa-check"></i><b>5.1.2</b> 스피어만 상관계수</a></li>
<li class="chapter" data-level="5.1.3" data-path="regression.html"><a href="regression.html#켄달의-타우"><i class="fa fa-check"></i><b>5.1.3</b> 켄달의 타우</a></li>
<li class="chapter" data-level="5.1.4" data-path="regression.html"><a href="regression.html#편상관계수"><i class="fa fa-check"></i><b>5.1.4</b> 1.3 편상관계수</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="regression.html"><a href="regression.html#단순선형회귀분석"><i class="fa fa-check"></i><b>5.2</b> 단순선형회귀분석</a></li>
<li class="chapter" data-level="5.3" data-path="regression.html"><a href="regression.html#다중선형회귀분석"><i class="fa fa-check"></i><b>5.3</b> 다중선형회귀분석</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="regression.html"><a href="regression.html#변수-선택"><i class="fa fa-check"></i><b>5.3.1</b> 변수 선택</a></li>
<li class="chapter" data-level="5.3.2" data-path="regression.html"><a href="regression.html#결정계수"><i class="fa fa-check"></i><b>5.3.2</b> 결정계수</a></li>
<li class="chapter" data-level="5.3.3" data-path="regression.html"><a href="regression.html#표준화-회귀계수"><i class="fa fa-check"></i><b>5.3.3</b> 표준화 회귀계수</a></li>
<li class="chapter" data-level="5.3.4" data-path="regression.html"><a href="regression.html#다중공선성"><i class="fa fa-check"></i><b>5.3.4</b> 다중공선성</a></li>
<li class="chapter" data-level="5.3.5" data-path="regression.html"><a href="regression.html#더미변수가변수"><i class="fa fa-check"></i><b>5.3.5</b> 더미변수(가변수)</a></li>
<li class="chapter" data-level="5.3.6" data-path="regression.html"><a href="regression.html#회귀모형에-대한-가정-검토"><i class="fa fa-check"></i><b>5.3.6</b> 회귀모형에 대한 가정 검토</a></li>
<li class="chapter" data-level="5.3.7" data-path="regression.html"><a href="regression.html#다중선형회귀분석---모든-변수를-다-사용하는-경우"><i class="fa fa-check"></i><b>5.3.7</b> 다중선형회귀분석 - 모든 변수를 다 사용하는 경우</a></li>
<li class="chapter" data-level="5.3.8" data-path="regression.html"><a href="regression.html#다중선형회귀분석---단계적-선택법을-사용하는-경우"><i class="fa fa-check"></i><b>5.3.8</b> 다중선형회귀분석 - 단계적 선택법을 사용하는 경우</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>6</b> 일반화 선형모형</a>
<ul>
<li class="chapter" data-level="6.1" data-path="glm.html"><a href="glm.html#the-generalized-linear-models"><i class="fa fa-check"></i><b>6.1</b> The Generalized Linear models</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="glm.html"><a href="glm.html#the-general-linear-model"><i class="fa fa-check"></i><b>6.1.1</b> The General Linear Model</a></li>
<li class="chapter" data-level="6.1.2" data-path="glm.html"><a href="glm.html#generalized-linear-models-glms"><i class="fa fa-check"></i><b>6.1.2</b> Generalized Linear Models (GLMs)</a></li>
<li class="chapter" data-level="6.1.3" data-path="glm.html"><a href="glm.html#normal-glms-as-a-special-case"><i class="fa fa-check"></i><b>6.1.3</b> Normal GLMs as a Special Case</a></li>
<li class="chapter" data-level="6.1.4" data-path="glm.html"><a href="glm.html#modelling-binomial-data"><i class="fa fa-check"></i><b>6.1.4</b> Modelling Binomial Data</a></li>
<li class="chapter" data-level="6.1.5" data-path="glm.html"><a href="glm.html#modelling-poisson-data"><i class="fa fa-check"></i><b>6.1.5</b> Modelling Poisson Data</a></li>
<li class="chapter" data-level="6.1.6" data-path="glm.html"><a href="glm.html#transformation-vs.-glms"><i class="fa fa-check"></i><b>6.1.6</b> Transformation vs. GLMs</a></li>
<li class="chapter" data-level="6.1.7" data-path="glm.html"><a href="glm.html#exponential-family"><i class="fa fa-check"></i><b>6.1.7</b> Exponential Family</a></li>
<li class="chapter" data-level="6.1.8" data-path="glm.html"><a href="glm.html#canonical-links"><i class="fa fa-check"></i><b>6.1.8</b> Canonical Links</a></li>
<li class="chapter" data-level="6.1.9" data-path="glm.html"><a href="glm.html#estimation-of-the-model-parameters"><i class="fa fa-check"></i><b>6.1.9</b> Estimation of the Model Parameters</a></li>
<li class="chapter" data-level="6.1.10" data-path="glm.html"><a href="glm.html#distribution-and-link-function"><i class="fa fa-check"></i><b>6.1.10</b> Distribution and Link Function</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="glm.html"><a href="glm.html#poisson-regression"><i class="fa fa-check"></i><b>6.2</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="glm.html"><a href="glm.html#example-danish-lung-cancer-counts"><i class="fa fa-check"></i><b>6.2.1</b> Example: Danish Lung Cancer Counts</a></li>
<li class="chapter" data-level="6.2.2" data-path="glm.html"><a href="glm.html#what-about-accounting-for-population-size"><i class="fa fa-check"></i><b>6.2.2</b> What About Accounting for Population Size?</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="glm.html"><a href="glm.html#logistic-regression"><i class="fa fa-check"></i><b>6.3</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="survival.html"><a href="survival.html"><i class="fa fa-check"></i><b>7</b> 생존분석</a>
<ul>
<li class="chapter" data-level="7.1" data-path="survival.html"><a href="survival.html#생존분석"><i class="fa fa-check"></i><b>7.1</b> 생존분석</a></li>
<li class="chapter" data-level="7.2" data-path="survival.html"><a href="survival.html#비모수적-생존함수-추정"><i class="fa fa-check"></i><b>7.2</b> 비모수적 생존함수 추정</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="survival.html"><a href="survival.html#생명표-방법"><i class="fa fa-check"></i><b>7.2.1</b> 생명표 방법</a></li>
<li class="chapter" data-level="7.2.2" data-path="survival.html"><a href="survival.html#누적한계추정법"><i class="fa fa-check"></i><b>7.2.2</b> 누적한계추정법</a></li>
<li class="chapter" data-level="7.2.3" data-path="survival.html"><a href="survival.html#생존분포-비교"><i class="fa fa-check"></i><b>7.2.3</b> 생존분포 비교</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="survival.html"><a href="survival.html#모수적-생존함수-추정과-회귀모형"><i class="fa fa-check"></i><b>7.3</b> 모수적 생존함수 추정과 회귀모형</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="survival.html"><a href="survival.html#지수분포"><i class="fa fa-check"></i><b>7.3.1</b> 지수분포</a></li>
<li class="chapter" data-level="7.3.2" data-path="survival.html"><a href="survival.html#와이블분포"><i class="fa fa-check"></i><b>7.3.2</b> 와이블분포</a></li>
<li class="chapter" data-level="7.3.3" data-path="survival.html"><a href="survival.html#감마분포"><i class="fa fa-check"></i><b>7.3.3</b> 감마분포</a></li>
<li class="chapter" data-level="7.3.4" data-path="survival.html"><a href="survival.html#로그정규분포"><i class="fa fa-check"></i><b>7.3.4</b> 로그정규분포</a></li>
<li class="chapter" data-level="7.3.5" data-path="survival.html"><a href="survival.html#로그로지스틱분포"><i class="fa fa-check"></i><b>7.3.5</b> 로그로지스틱분포</a></li>
<li class="chapter" data-level="7.3.6" data-path="survival.html"><a href="survival.html#곰페르츠분포"><i class="fa fa-check"></i><b>7.3.6</b> 곰페르츠분포</a></li>
<li class="chapter" data-level="7.3.7" data-path="survival.html"><a href="survival.html#회귀모형aft"><i class="fa fa-check"></i><b>7.3.7</b> 회귀모형(AFT)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="survival.html"><a href="survival.html#cox-비례위험모형"><i class="fa fa-check"></i><b>7.4</b> Cox 비례위험모형</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="survival.html"><a href="survival.html#시간에-따라-변화하는-공변량이-있을-경우"><i class="fa fa-check"></i><b>7.4.1</b> 시간에 따라 변화하는 공변량이 있을 경우</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="survival.html"><a href="survival.html#경쟁위험모형"><i class="fa fa-check"></i><b>7.5</b> 경쟁위험모형</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="survival.html"><a href="survival.html#원인별-누적발생함수"><i class="fa fa-check"></i><b>7.5.1</b> 원인별 누적발생함수</a></li>
<li class="chapter" data-level="7.5.2" data-path="survival.html"><a href="survival.html#원인별-위험함수"><i class="fa fa-check"></i><b>7.5.2</b> 원인별 위험함수</a></li>
<li class="chapter" data-level="7.5.3" data-path="survival.html"><a href="survival.html#누적발생함수에-대한-회귀분석"><i class="fa fa-check"></i><b>7.5.3</b> 누적발생함수에 대한 회귀분석</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="survival.html"><a href="survival.html#sas-실습"><i class="fa fa-check"></i><b>7.6</b> SAS 실습</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="survival.html"><a href="survival.html#생명표-방법-1"><i class="fa fa-check"></i><b>7.6.1</b> 생명표 방법</a></li>
<li class="chapter" data-level="7.6.2" data-path="survival.html"><a href="survival.html#누적한계추정법-1"><i class="fa fa-check"></i><b>7.6.2</b> 누적한계추정법</a></li>
<li class="chapter" data-level="7.6.3" data-path="survival.html"><a href="survival.html#생존분포-비교-1"><i class="fa fa-check"></i><b>7.6.3</b> 생존분포 비교</a></li>
<li class="chapter" data-level="7.6.4" data-path="survival.html"><a href="survival.html#parametric-model"><i class="fa fa-check"></i><b>7.6.4</b> Parametric Model</a></li>
<li class="chapter" data-level="7.6.5" data-path="survival.html"><a href="survival.html#aft-model"><i class="fa fa-check"></i><b>7.6.5</b> AFT model</a></li>
<li class="chapter" data-level="7.6.6" data-path="survival.html"><a href="survival.html#cox-비례위험모형-1"><i class="fa fa-check"></i><b>7.6.6</b> Cox 비례위험모형</a></li>
<li class="chapter" data-level="7.6.7" data-path="survival.html"><a href="survival.html#cox-비례위험모형---time-dependent-covariate"><i class="fa fa-check"></i><b>7.6.7</b> Cox 비례위험모형 - time dependent covariate</a></li>
<li class="chapter" data-level="7.6.8" data-path="survival.html"><a href="survival.html#competing-risks"><i class="fa fa-check"></i><b>7.6.8</b> Competing Risks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="psm.html"><a href="psm.html"><i class="fa fa-check"></i><b>8</b> 성향점수(propensity score)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="psm.html"><a href="psm.html#observational-study"><i class="fa fa-check"></i><b>8.1</b> Observational Study?</a>
<ul>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#randomized-controlled-trials-gold-standard"><i class="fa fa-check"></i>Randomized Controlled Trials ("gold standard")</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#characteristics-of-rcts"><i class="fa fa-check"></i>Characteristics of RCTs</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#what-is-observational-data"><i class="fa fa-check"></i>What is Observational Data?</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#confounding-due-to-selection-bias"><i class="fa fa-check"></i>Confounding due to Selection Bias</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#impact-of-selection-bias-on-analytic-inferences"><i class="fa fa-check"></i>Impact of Selection Bias on Analytic Inferences</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#statistical-adjustment-for-observational-data"><i class="fa fa-check"></i>Statistical Adjustment for Observational Data</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#addressing-selection-bias-with-exact-matching"><i class="fa fa-check"></i>Addressing Selection Bias with Exact Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#matching-on-specific-variables"><i class="fa fa-check"></i>Matching on Specific Variables</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#matching-on-specific-variables-1"><i class="fa fa-check"></i>Matching on Specific Variables</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="psm.html"><a href="psm.html#propensity-score"><i class="fa fa-check"></i><b>8.2</b> Propensity Score?</a>
<ul>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#general-procedure"><i class="fa fa-check"></i>General Procedure</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#choosing-variables-for-propensity-scores"><i class="fa fa-check"></i>Choosing Variables for Propensity Scores</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#calculate-propensity-score"><i class="fa fa-check"></i>Calculate Propensity Score</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#initial-checks-balance-across-groups"><i class="fa fa-check"></i>Initial Checks: Balance across Groups</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#check-balance-of-covariates"><i class="fa fa-check"></i>Check Balance of Covariates</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#assess-balance-with-standardized-differences"><i class="fa fa-check"></i>Assess Balance with Standardized Differences</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#balance-of-covariates-caution"><i class="fa fa-check"></i>Balance of Covariates: Caution</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#matching-and-weighting-strategies"><i class="fa fa-check"></i>Matching and Weighting Strategies</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#choices-when-matching-sample-by-propensity-score"><i class="fa fa-check"></i>Choices When Matching Sample by Propensity Score</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#which-strategy-to-chooose"><i class="fa fa-check"></i>Which Strategy to Chooose?</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#evaluate-balance-in-sample-matched-or-weighted"><i class="fa fa-check"></i>Evaluate Balance in Sample Matched or Weighted</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#visualization-of-standardized-differences"><i class="fa fa-check"></i>Visualization of Standardized Differences</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#plots-of-covariates-between-groups"><i class="fa fa-check"></i>Plots of Covariates between Groups</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="psm.html"><a href="psm.html#propensity-score-methods"><i class="fa fa-check"></i><b>8.3</b> Propensity Score Methods</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="psm.html"><a href="psm.html#propensity-score-matching"><i class="fa fa-check"></i><b>8.3.1</b> Propensity Score Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#general-procedure-for-propensity-score-matching"><i class="fa fa-check"></i>General Procedure for Propensity Score Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#greedy-matching"><i class="fa fa-check"></i>Greedy Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#mahalanobis-metric-matching"><i class="fa fa-check"></i>Mahalanobis Metric Matching</a></li>
<li class="chapter" data-level="8.3.2" data-path="psm.html"><a href="psm.html#stratification-using-propensity-score"><i class="fa fa-check"></i><b>8.3.2</b> Stratification using Propensity Score</a></li>
<li class="chapter" data-level="8.3.3" data-path="psm.html"><a href="psm.html#inverse-probability-of-treatment-weighting"><i class="fa fa-check"></i><b>8.3.3</b> Inverse Probability of Treatment Weighting</a></li>
<li class="chapter" data-level="8.3.4" data-path="psm.html"><a href="psm.html#propensity-score-adjustment-as-covariate"><i class="fa fa-check"></i><b>8.3.4</b> Propensity Score Adjustment as Covariate</a></li>
<li class="chapter" data-level="8.3.5" data-path="psm.html"><a href="psm.html#property-of-propensity-score"><i class="fa fa-check"></i><b>8.3.5</b> Property of Propensity Score</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#property-of-observational-studies"><i class="fa fa-check"></i>Property of Observational Studies</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="psm.html"><a href="psm.html#practice---sas"><i class="fa fa-check"></i><b>8.4</b> Practice - SAS</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="psm.html"><a href="psm.html#greedy-nearest-neighbor-matching"><i class="fa fa-check"></i><b>8.4.1</b> Greedy Nearest Neighbor Matching</a></li>
<li class="chapter" data-level="8.4.2" data-path="psm.html"><a href="psm.html#propensity-score-stratification"><i class="fa fa-check"></i><b>8.4.2</b> Propensity Score Stratification</a></li>
<li class="chapter" data-level="8.4.3" data-path="psm.html"><a href="psm.html#inverse-probability-treatment-weighting"><i class="fa fa-check"></i><b>8.4.3</b> Inverse Probability Treatment Weighting</a></li>
<li class="chapter" data-level="8.4.4" data-path="psm.html"><a href="psm.html#matching-with-existing-propensity-scores"><i class="fa fa-check"></i><b>8.4.4</b> Matching with Existing propensity scores</a></li>
<li class="chapter" data-level="8.4.5" data-path="psm.html"><a href="psm.html#matching-with-existing-propensity-scores-1"><i class="fa fa-check"></i><b>8.4.5</b> Matching with Existing propensity scores</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anova" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> 분산분석</h1>
<div id="분산분석" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> 분산분석</h2>
<ul>
<li>분산분석(analysis of variance: ANOVA)은 R.A. Fisher에 의해 개발된 3개 이상(2집단 가능)의 모평균에 대한 분석 방법을 말한다.</li>
</ul>
<p><img src="anova/f0.png" /></p>
<ul>
<li>실험계획법(experimental design)에서 가장 많이 사용되는 분석방법으로서, 특성값의 분산 또는 변동을 분석하는 방법. 즉, 특성값의 변동을 제곱합(sum of squares)으로 나타내고, 이 제곱합을 실험에 관련된 요인(factor)별로 분해하여 오차에 비해 큰 영향을 주는 요인이 무엇인가를 찾아내는 방법</li>
</ul>
<p><img src="anova/f1.png" /></p>
<ul>
<li><p>요인의 수에 의한 분산분석 분류</p>
<ul>
<li><p>일원배치 분산분석(one-way ANOVA): 요인의 수가 하나인 분산분석. 다른 요인은 측정값에 경미한 영향으로 무시할 수 있거나 또는 영향이 일정할 때 사용</p></li>
<li><p>이원배치 분산분석(two-way ANOVA): 측정값에 영향을 미치는 요인이 둘일 때의 분석으로 두 요인의 집단(수준)수 조합이 반복이 없는 경우와 있는경우로 분류하여 검증</p></li>
<li><p>이외 삼원배치 분산분석, 다원배치 분산분석 등이 있음</p></li>
</ul></li>
<li><p>모형에 의한 분산분석 분류</p>
<ul>
<li><p>모수 모형(fixed effect model)</p></li>
<li><p>변량 모형(random effect model)</p></li>
<li><p>혼합 모형(mixed effect model)</p></li>
</ul></li>
<li><p>변동 분해</p>
<p><img src="anova/f1.jpg" style="width:70.0%" /></p></li>
<li><p>특성값의 변동을 나타내는 제곱합(총제곱합, total sum of squares: SST)은 요인에 의한 제곱합(treatment sum of squares: SSTr)과 오차로 인한 제곱합(error sum of squares: SSE)으로 분해</p></li>
</ul>
</div>
<div id="일원배치-분산분석" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> 일원배치 분산분석</h2>
<ul>
<li><p>일원배치 분산분석(one-way ANOVA)은 <span class="math inline">\(t\)</span>-test를 확장하여 요인은 하나이고, 요인에 의해 <span class="math inline">\(k\)</span>개 집단(수준)으로 나뉜 표본들을 서로 비교 검정하는 방법</p></li>
<li><p>집단(수준)은 3개 이상(<span class="math inline">\(k \ge 3\)</span>), 특성값은 하나로써 특성값에 대한 한 종류의 요인만의 영향을 조사하고자 할 때 사용하는 방법</p></li>
<li><p>특성</p>
<ul>
<li><p>집단 수와 각 집단에서 취해지는 측정값의 반복수에는 별로 제한이 없음. 그러나 집단수는 <span class="math inline">\(3\sim 5\)</span>수준, 반복수는 <span class="math inline">\(3\sim 10\)</span> 정도가 많이 사용됨</p></li>
<li><p>반복수가 모든 수준에 대하여 같지 않아도 됨. 따라서 결측값(missing value)이 있어도 이를 추정하여 넣어 줄 필요가 없으며 그대로 해석 가능 함</p></li>
<li><p>실험의 측정은 실험 전체를 완전히 랜덤화하여 모든 특성값을 랜덤한 순서에 의하여 구해야 함</p></li>
</ul></li>
<li><p>요인 <span class="math inline">\(A\)</span>의 수준(집단)수가 <span class="math inline">\(k\)</span>개(<span class="math inline">\(A_1, A_2, \cdots, A_k\)</span>)이며, 각 수준마다 <span class="math inline">\(n_i\)</span>번씩 반복 실험을 할 경우, 일원배치 분산분석을 위한 자료 형태이다. 여기서 <span class="math inline">\(N=\sum_{i=1}^kn_i\)</span>은 총 실험횟수이다.</p>
<p><img src="anova/f2.jpg" style="width:90.0%" /></p></li>
</ul>
<p>여기서 <span class="math inline">\(i\)</span>열의 합 <span class="math inline">\(T_i=\sum_{j=1}^{n_i} y_{ij}\)</span>, <span class="math inline">\(i\)</span>열의 평균 <span class="math inline">\(\bar{y}_i=\frac{T_i}{n_i}\)</span>, 총 합계 <span class="math inline">\(T=\sum_{i=1}^k T_i\)</span>, 총 평균 <span class="math inline">\(\bar{y}=\frac{T}{N}\)</span></p>
<ul>
<li>일원배치 분산분석 - 통계적 모형</li>
</ul>
<p><span class="math display">\[\begin{aligned}
    y_{ij}&amp;=\mu_i + \epsilon_{ij}, \quad i=1,2,\ldots,k, \quad j=1,2,\ldots,n_i \\
    &amp;=\mu + \alpha_i + \epsilon_{ij}, \quad \epsilon_{ij} \sim N(0, \sigma^2)
    \end{aligned}
\]</span></p>
<p>여기서 <span class="math inline">\(\mu\)</span>: 실험전체의 모평균, <span class="math inline">\(\alpha_i\)</span>: <span class="math inline">\(i\)</span>번째 처리가 주는 주효과이다. 단, <span class="math inline">\(\sum_{i=1}^k\alpha_i=0\)</span></p>
<ul>
<li><span class="math inline">\(\epsilon_{ij}\)</span>: <span class="math inline">\(i\)</span>번째 처리의 <span class="math inline">\(j\)</span>번째 반복에서 얻은 측정값의 오차
<ul>
<li>오차 <span class="math inline">\(\epsilon_{ij}\)</span>는 처리 <span class="math inline">\(A_i\)</span>에서 <span class="math inline">\(j\)</span>번째 측정된 <span class="math inline">\(y_{ij}\)</span>가 수반하는 오차로서, 확률변수이며 다음과 같은 성질을 가짐
<ul>
<li><span class="math inline">\(\epsilon_{ij}\)</span>는 랜덤하게 변하는 값이며 모평균은 <span class="math inline">\(0\)</span>이고 분산은<span class="math inline">\(\sigma^2\)</span>이다.</li>
<li><span class="math inline">\(\epsilon_{ij}\)</span>는 정규분포 <span class="math inline">\(N(0,\sigma^2)\)</span>으로부터 확률추출된 것이라고 가정하며, 이 가정은 다음을 의미한다.</li>
</ul></li>
</ul>
<ol style="list-style-type: decimal">
<li><p>정규성: 오차 <span class="math inline">\(\epsilon_{ij}\)</span>는 정규분포를 따른다.</p></li>
<li><p>독립성: 임의의 <span class="math inline">\(\epsilon_{ij}\)</span>와 <span class="math inline">\(\epsilon_{i&#39;j&#39;}\)</span>(<span class="math inline">\(i\ne i&#39;\)</span> 또는 <span class="math inline">\(j\ne j&#39;\)</span>)는 서로 독립이다.</p></li>
<li><p>불편성: 오차 <span class="math inline">\(\epsilon_{ij}\)</span>의 기대값은 <span class="math inline">\(0\)</span>이다.</p></li>
<li><p>등분산성: 오차 <span class="math inline">\(\epsilon_{ij}\)</span>의 분산은 <span class="math inline">\(\sigma^2\)</span>으로 어떤 <span class="math inline">\(i, j\)</span>에 대해서도 일정하다.</p></li>
</ol></li>
</ul>
<p><img src="anova/f2.png" /></p>
<ul>
<li><p>분산분석을 하려면 오차항의 가정에 따라 먼저 집단간의 분산이 동질함을 검정하여야 함. 이를 위해 Levene의 분산의 동질성 검정(Levene’s equality of variances test)을 이용</p></li>
<li><p>가설의 형태</p>
<ul>
<li><p>귀무가설: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\sigma_1^2=\sigma_2^2=\cdots =\sigma_k^2\)</span> (<span class="math inline">\(k\)</span>개 집단의 분산은 동일하다).</p></li>
<li><p>대립가설: <span class="math inline">\(H_1\)</span>: 최소한 하나의 <span class="math inline">\(\sigma_i^2\)</span>은 다르다.</p></li>
</ul></li>
<li><p>검정통계량:</p>
<p><span class="math display">\[F=\frac{(N-k)\sum_{i=1}^k n_i(\bar{z}_i-\bar{z})^2}{(k-1)\sum_{i=1}^k\sum_{j=1}^{n_i}(z_{ij}-\bar{z}_i)^2}\]</span></p></li>
</ul>
<p>여기서 <span class="math inline">\(z_{ij}=|y_{ij}-\bar{y}_i|\)</span>.</p>
<ul>
<li><p>기각역: <span class="math display">\[F&gt;F(k-1,N-k;\alpha)\]</span></p></li>
<li><p>등분산이 가정되지 않는 경우 Brown-Forsythe 통계량을 계산하여 집단 평균의 동일성을 검정</p></li>
<li><p>평균에 대한 가설</p>
<ul>
<li><p>귀무가설: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1 = \mu_2 = \cdots = \mu_k\)</span> 또는 <span class="math inline">\(\alpha_1=\alpha_2=\cdots=\alpha_k=0\)</span>.</p></li>
<li><p>대립가설: <span class="math inline">\(H_1\)</span>: 최소한 하나의 <span class="math inline">\(\mu_i\)</span>는 같지 않다. 또는 최소한 하나의 <span class="math inline">\(\alpha_i=0\)</span>이 아니다.</p></li>
</ul></li>
<li><p>분산분석의 가설검정은 분산분석표(ANOVA table)를 통해 이루어짐</p></li>
<li><p>분산분석표</p>
<p><img src="anova/f3.jpg" style="width:90.0%" /></p></li>
<li><p>변동 분해</p>
<ul>
<li><p>총제곱합 <span class="math inline">\(SST(S_T)=\sum_{i=1}^k\sum_{j=1}^{n_i}(y_{ij}-\bar{y})^2\)</span></p></li>
<li><p>오차제곱합 <span class="math inline">\(SSE(S_E)=\sum_{i=1}^k\sum_{j=1}^{n_i} (y_{ij}-\bar{y}_i)^2\)</span></p></li>
<li><p>처리제곱합
<span class="math inline">\(SSTr(S_A)=\sum_{i=1}^k\sum_{j=1}^{n_i}(\bar{y}_i-\bar{y})^2\)</span></p></li>
</ul></li>
<li><p>총제곱합 <span class="math inline">\(SST\)</span>는 급내변동(variation within group)인 오차제곱합 <span class="math inline">\(SSE\)</span>와 급간변동(variation between group)인 처리제곱합 <span class="math inline">\(SSTr\)</span>의 합으로 구성됨. 즉, <span class="math display">\[SST=SSE + SSTr\]</span></p></li>
<li><p>변동의 자유도</p>
<ul>
<li><p>총변동의 자유도 <span class="math inline">\(\phi_T=N-1\)</span></p></li>
<li><p>급내변동의 자유도 <span class="math inline">\(\phi_E=N-k\)</span></p></li>
<li><p>급간변동의 자유도 <span class="math inline">\(\phi_A=k-1\)</span></p></li>
</ul></li>
<li><p>평균제곱: 제곱합을 자유도로 나눈 것</p>
<ul>
<li><p>오차평균제곱(mean squared error: MSE): <span class="math inline">\(V_E=\frac{S_E}{\phi_E}\)</span></p></li>
<li><p>처리평균제곱: <span class="math inline">\(V_A=\frac{S_A}{\phi_A}\)</span></p></li>
</ul></li>
<li><p>검정통계량 <span class="math display">\[F=\frac{V_A}{V_E} \sim F_{(k-1,N-k)}\]</span></p></li>
</ul>
<p>-기각역 <span class="math display">\[F \ge F_{(\alpha,k-1,N-k)}\]</span></p>
<div id="사후분석다중검정" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> 사후분석(다중검정)</h3>
<ul>
<li><p>분산분석은 <span class="math inline">\(k\)</span>개 집단의 평균이 유의미한 차이가 있는지 확인만 가능</p></li>
<li><p>즉, <span class="math inline">\(k\)</span>개의 집단 중 하나의 집단이 다른 집단의 평균과 차이가 있는지 아니면 여러 집단이 동시에 서로서로 차이가 있는지 확인 불가능</p></li>
<li><p>분산분석의 결과가 유의미한 경우, 다시 말해서 최소한 하나 이상의 집단의 평균이 차이가 있다고 나타난 경우, 차이가 있는 집단을 찾는 방법을 사후분석(post hoc analysis) 또는 다중검정(multiple comparison)이라고 함</p></li>
<li><p>사후검정 또는 다중검정은 반드시 분산분석의 결과가 유의미한 경우에 이루어져야 함</p></li>
<li><p>사후 검정은 두 집단씩 짝을 이루어 검정하게 되며(마치 <span class="math inline">\(t\)</span>-test 처럼) 이때 제1종 오류의 크기 <span class="math inline">\(\alpha\)</span>를 유지하는 방법에 따라 여러가지 방법으로 나누어짐</p></li>
</ul>
<p><img src="anova/ex1.jpg" style="width:80.0%" /></p>
<p><img src="anova/ex2_1.jpg" style="width:80.0%" /></p>
<p><img src="anova/ex2_2.jpg" style="width:80.0%" /></p>
<p><br /></p>
<p>예제) 면역이상에 대한 한 연구에서 자폐아, 정상아, 지진아에 대한 혈청 항원의 농도에 대해 조사하였다. 이 연구의 목적은 자폐아, 정상아, 지진아에 따라 혈청 항원의 농도에 유의한 차이가 있는가이다.</p>
<p><img src="anova/ex3.jpg" style="width:50.0%" /></p>
<p>풀이)</p>
<ol style="list-style-type: decimal">
<li><p>가설: <span class="math inline">\(H_0\)</span>: 자폐아, 정상아, 지진아에 대한 혈청 항원의 농도는 모두 같다 vs <span class="math inline">\(H_1\)</span>: Not <span class="math inline">\(H_0\)</span></p></li>
<li><p>유의수준: <span class="math inline">\(\alpha=0.05\)</span></p></li>
<li><p>기각역: <span class="math inline">\(F_0 &gt;F_{0.05}(2,68) = 3.15\)</span></p></li>
<li><p>검정통계량</p></li>
</ol>
<p><span class="math display">\[SST=\sum_i \sum_j (y_{ij} -\bar{y} )^2 = 1517167.239\]</span>
<span class="math display">\[SSt=\sum_i n_i (\bar{y}_i - \bar{y} )^2 =141234.602\]</span>
<span class="math display">\[SSE=SST-SSt =1375932.638\]</span>
<span class="math display">\[F=\frac{141234.602/2}{1375932.638/68}=3.47\]</span></p>
<ul>
<li><p>ANOVA table</p>
<p><img src="anova/ex4.jpg" style="width:80.0%" /></p></li>
<li><p>따라서 검정 통계량은 <span class="math inline">\(F=3.49\)</span></p></li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li><p><span class="math inline">\(P\)</span>-value: <span class="math display">\[P(F(2,68)&gt;3.49)=0.0361\]</span></p></li>
<li><p>결론: 검정통계량 값이 <span class="math inline">\(3.49&gt;3.15\)</span>로 유의수준 <span class="math inline">\(5\%\)</span> 하에서 귀무가설 기각한다. 따라서 세 집단의 평균이 모두 동일하지는 않다. 즉, 최소한 하나의 집단은 평균이 다르다. <span class="math inline">\(P\)</span>-value의 값 또한 유의수준 0.05보다 작으므로 귀무가설을 기각한다.</p></li>
</ol>
<p>예제) 다음은 서로 다른 항우울제의 치료 효과를 비교하기 위한 연구이다. <span class="math inline">\(36\)</span>명의 우울증 환자를 <span class="math inline">\(A\)</span>군, <span class="math inline">\(B\)</span>군, <span class="math inline">\(C\)</span>군으로 <span class="math inline">\(12\)</span>명씩 무작위 배정하여 각각 <span class="math inline">\(A\)</span>약, <span class="math inline">\(B\)</span>약, <span class="math inline">\(C\)</span>약을 2개월 동안 투여한 뒤 우울증 점수를 측정하였다. 이 세가지 약의 치료 효과를 비교하라.</p>
<p><img src="anova/ex5.jpg" style="width:80.0%" /></p>
</div>
<div id="with-r-3" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> With R</h3>
<ol style="list-style-type: decimal">
<li>데이터 입력</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="anova.html#cb1-1" aria-hidden="true" tabindex="-1"></a>anova <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span><span class="st">&#39;Patient   group   score</span></span>
<span id="cb1-2"><a href="anova.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="st">1   1   21</span></span>
<span id="cb1-3"><a href="anova.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">2   1   22</span></span>
<span id="cb1-4"><a href="anova.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">3   1   23</span></span>
<span id="cb1-5"><a href="anova.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">4   1   22</span></span>
<span id="cb1-6"><a href="anova.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="st">5   1   21</span></span>
<span id="cb1-7"><a href="anova.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="st">6   1   25</span></span>
<span id="cb1-8"><a href="anova.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="st">7   1   19</span></span>
<span id="cb1-9"><a href="anova.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="st">8   1   25</span></span>
<span id="cb1-10"><a href="anova.html#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="st">9   1   24</span></span>
<span id="cb1-11"><a href="anova.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="st">10  1   25</span></span>
<span id="cb1-12"><a href="anova.html#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="st">11  1   28</span></span>
<span id="cb1-13"><a href="anova.html#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="st">12  1   22</span></span>
<span id="cb1-14"><a href="anova.html#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="st">13  2   22</span></span>
<span id="cb1-15"><a href="anova.html#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="st">14  2   19</span></span>
<span id="cb1-16"><a href="anova.html#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="st">15  2   14</span></span>
<span id="cb1-17"><a href="anova.html#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="st">16  2   18</span></span>
<span id="cb1-18"><a href="anova.html#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="st">17  2   19</span></span>
<span id="cb1-19"><a href="anova.html#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="st">18  2   18</span></span>
<span id="cb1-20"><a href="anova.html#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="st">19  2   20</span></span>
<span id="cb1-21"><a href="anova.html#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="st">20  2   17</span></span>
<span id="cb1-22"><a href="anova.html#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="st">21  2   16</span></span>
<span id="cb1-23"><a href="anova.html#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="st">22  2   17</span></span>
<span id="cb1-24"><a href="anova.html#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="st">23  2   19</span></span>
<span id="cb1-25"><a href="anova.html#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="st">24  2   24</span></span>
<span id="cb1-26"><a href="anova.html#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="st">15  3   23</span></span>
<span id="cb1-27"><a href="anova.html#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="st">16  3   19</span></span>
<span id="cb1-28"><a href="anova.html#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="st">17  3   22</span></span>
<span id="cb1-29"><a href="anova.html#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="st">18  3   23</span></span>
<span id="cb1-30"><a href="anova.html#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="st">19  3   19</span></span>
<span id="cb1-31"><a href="anova.html#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="st">20  3   18</span></span>
<span id="cb1-32"><a href="anova.html#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="st">21  3   22</span></span>
<span id="cb1-33"><a href="anova.html#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="st">22  3   27</span></span>
<span id="cb1-34"><a href="anova.html#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="st">23  3   21</span></span>
<span id="cb1-35"><a href="anova.html#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="st">24  3   22</span></span>
<span id="cb1-36"><a href="anova.html#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="st">25  3   19</span></span>
<span id="cb1-37"><a href="anova.html#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="st">26  3   20</span></span>
<span id="cb1-38"><a href="anova.html#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>, <span class="at">header=</span>T)</span>
<span id="cb1-39"><a href="anova.html#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="anova.html#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(anova)</span></code></pre></div>
<pre><code>##   Patient group score
## 1       1     1    21
## 2       2     1    22
## 3       3     1    23
## 4       4     1    22
## 5       5     1    21
## 6       6     1    25</code></pre>
<p>2.1 정규성 검정</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="anova.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(anova<span class="sc">$</span>score,anova<span class="sc">$</span>group,shapiro.test) </span></code></pre></div>
<pre><code>## $`1`
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.95826, p-value = 0.7588
## 
## 
## $`2`
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.96468, p-value = 0.8479
## 
## 
## $`3`
## 
##  Shapiro-Wilk normality test
## 
## data:  X[[i]]
## W = 0.91146, p-value = 0.2227</code></pre>
<p>Shapiro-Wilk 정규성 검정법을 이용하여 집단별로 검정하면, p-value가 모두 유의수준 5%보다 높게 나타나 정규성 가정을 기각할 근거가 없다는 것을 알 수 있다. Q-Q plot을 통해 살펴보면 다음과 같다.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="anova.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(anova<span class="sc">$</span>score[anova<span class="sc">$</span>group<span class="sc">==</span><span class="dv">1</span>])</span>
<span id="cb5-2"><a href="anova.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(anova<span class="sc">$</span>score[anova<span class="sc">$</span>group<span class="sc">==</span><span class="dv">1</span>])</span></code></pre></div>
<p><img src="rmanual_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="anova.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(anova<span class="sc">$</span>score[anova<span class="sc">$</span>group<span class="sc">==</span><span class="dv">2</span>])</span>
<span id="cb6-2"><a href="anova.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(anova<span class="sc">$</span>score[anova<span class="sc">$</span>group<span class="sc">==</span><span class="dv">2</span>])</span></code></pre></div>
<p><img src="rmanual_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="anova.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(anova<span class="sc">$</span>score[anova<span class="sc">$</span>group<span class="sc">==</span><span class="dv">3</span>])</span>
<span id="cb7-2"><a href="anova.html#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(anova<span class="sc">$</span>score[anova<span class="sc">$</span>group<span class="sc">==</span><span class="dv">3</span>])</span></code></pre></div>
<p><img src="rmanual_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<p>2.2 등분산성 검정</p>
<ul>
<li>Bartlett test</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="anova.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(score <span class="sc">~</span> group, <span class="at">data=</span>anova)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  score by group
## Bartlett&#39;s K-squared = 0.08111, df = 2, p-value = 0.9603</code></pre>
<p>P-value가 0.9603으로 집단별 분산이 같다는 귀무가설을 기각하지 못하므로 등분산 가정을 만족한다.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="anova.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb10-2"><a href="anova.html#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="anova.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(score <span class="sc">~</span> <span class="fu">as.factor</span>(group), <span class="at">data=</span>anova)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  2       0      1
##       33</code></pre>
<p>Levene test에서도 p-value가 1로 나타나 등분산 가정을 만족한다.</p>
<ol start="3" style="list-style-type: decimal">
<li>분산분석</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="anova.html#cb12-1" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> <span class="fu">as.factor</span>(group), <span class="at">data=</span>anova)</span>
<span id="cb12-2"><a href="anova.html#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="anova.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(re)</span></code></pre></div>
<pre><code>##                  Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## as.factor(group)  2  122.9   61.44   9.652 0.000501 ***
## Residuals        33  210.1    6.37                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>ANOVA table을 살펴보면 F value는 9.652이고 P-value는 0.0005로 매우 유의하게 나타난다. 따라서 최소한 하나의 집단은 평균 차이가 있다는 것을 알 수 있다. 집단 별 평균을 살펴보면 다음과 같다.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="anova.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(anova, <span class="fu">tapply</span>(score,group,mean ))</span></code></pre></div>
<pre><code>##        1        2        3 
## 23.08333 18.58333 21.25000</code></pre>
<p>이를 Box-plot으로 살펴보면 다음과 같다.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="anova.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(score<span class="sc">~</span>group, <span class="at">data=</span>anova)</span></code></pre></div>
<p><img src="rmanual_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<ol start="4" style="list-style-type: decimal">
<li>사후검정</li>
</ol>
<p>사후검정을 위해 “DescTools” 패키지를 이용한다. 이 패키지는 Tukey의 HSD, Bonferroni, LSD, Sheffe, Duncan 등의 방법을 제공한다. 사후 검정은 모든 조합 가능한 쌍에 대해 비교를 하기 때문에 FamilyWise Error Rate (FWER)이 증가하게 되며, 사후 검정법은 이 FWER을 원하는 유의수준 <span class="math inline">\(\alpha\)</span>로 조정하기 위한 방법이다. FWER은 여러 개의 가설 검정을 할 때 적어도 하나의 가설에서 1종 오류가 발생할 가능성을 의미한다.</p>
<p>사후검정은 분산분석에서 유의한 결과가 나온 경우에 시행하며, 사후검정법 간의 결과에 서로 차이가 나타날 수 있다.</p>
<p>4.1 Fisher’s Least Significant Difference
- 최소한의 유의미한 차이를 의미하며 유의수준을 보정하지 않기때문에 FWER이 높다.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="anova.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb17-2"><a href="anova.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PostHocTest</span>(re, <span class="at">method=</span><span class="st">&quot;lsd&quot;</span>)</span></code></pre></div>
<pre><code>## 
##   Posthoc multiple comparisons of means : Fisher LSD 
##     95% family-wise confidence level
## 
## $`as.factor(group)`
##          diff     lwr.ci     upr.ci    pval    
## 2-1 -4.500000 -6.5956761 -2.4043239 0.00012 ***
## 3-1 -1.833333 -3.9290095  0.2623428 0.08432 .  
## 3-2  2.666667  0.5709905  4.7623428 0.01421 *  
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>결과를 살펴보면 1-2 집단과 2-3 집단에서 차이가 있고 1-3 집단은 차이가 없는 것으로 나타난다.</p>
<p>4.2 Bonferroni Correction
- 본페로니 방법은 모든 집단을 짝지어 t-test를 수행하며 이때 수행한 횟수에 따라 유의수준을 조정한다. 즉, 짝지어 비교를 3번 하면, 유의수준을 <span class="math inline">\(\alpha/3\)</span>의 수준으로 검정한다. FWER은 중간 정도이다.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="anova.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PostHocTest</span>(re, <span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>## 
##   Posthoc multiple comparisons of means : Bonferroni 
##     95% family-wise confidence level
## 
## $`as.factor(group)`
##          diff      lwr.ci     upr.ci    pval    
## 2-1 -4.500000 -7.09803474 -1.9019653 0.00035 ***
## 3-1 -1.833333 -4.43136807  0.7647014 0.25295    
## 3-2  2.666667  0.06863193  5.2647014 0.04264 *  
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>본페로니 방법에서도 1-2 집단간, 2-3 집단간 차이가 있는 것으로 나타난다.</p>
<p>4.3 Tuckey’s Honestly Significant Difference</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="anova.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PostHocTest</span>(re, <span class="at">method=</span><span class="st">&quot;hsd&quot;</span>)</span></code></pre></div>
<pre><code>## 
##   Posthoc multiple comparisons of means : Tukey HSD 
##     95% family-wise confidence level
## 
## $`as.factor(group)`
##          diff     lwr.ci     upr.ci    pval    
## 2-1 -4.500000 -7.0275596 -1.9724404 0.00034 ***
## 3-1 -1.833333 -4.3608929  0.6942262 0.19198    
## 3-2  2.666667  0.1391071  5.1942262 0.03688 *  
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Tukey 방법도 1-2, 2-3 그룹에서 차이를 보인다.</p>
<p>4.4 Scheffe’s method
- FWER이 가장 낮으나 보수적이어서 2종 오류의 가능성도 높음</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="anova.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PostHocTest</span>(re, <span class="at">method=</span><span class="st">&quot;scheffe&quot;</span>)</span></code></pre></div>
<pre><code>## 
##   Posthoc multiple comparisons of means: Scheffe Test 
##     95% family-wise confidence level
## 
## $`as.factor(group)`
##          diff      lwr.ci     upr.ci    pval    
## 2-1 -4.500000 -7.14022200 -1.8597780 0.00054 ***
## 3-1 -1.833333 -4.47355534  0.8068887 0.22038    
## 3-2  2.666667  0.02644466  5.3068887 0.04732 *  
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Scheffe 방법도 1-2, 2-3 그룹에서 차이를 보인다.</p>
</div>
<div id="with-sas-3" class="section level3" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> With SAS</h3>
<blockquote>
<p>SAS Code</p>
</blockquote>
<pre><code>DATA anova;
INPUT patient group score @@;
CARDS;
1   1   21  13  2   22  15  3   23
2   1   22  14  2   19  16  3   19
3   1   23  15  2   14  17  3   22
4   1   22  16  2   18  18  3   23
5   1   21  17  2   19  19  3   19
6   1   25  18  2   18  20  3   18
7   1   19  19  2   20  21  3   22
8   1   25  20  2   17  22  3   27
9   1   24  21  2   16  23  3   21
10  1   25  22  2   17  24  3   22
11  1   28  23  2   19  25  3   19
12  1   22  24  2   24  26  3   20
;
run;</code></pre>
<pre><code>proc means data=anova;
class group;
var score;
run;</code></pre>
<p><img src="anova/ex6.jpg" style="width:70.0%" /></p>
<p><img src="anova/ex8.jpg" style="width:90.0%" /></p>
<pre><code>PROC ANOVA data=anova;
CLASS group;
MODEL score=group;
means group /hovtest welch tukey duncan lines;
RUN;</code></pre>
<p><img src="anova/ex8_1.jpg" style="width:60.0%" /></p>
<p><img src="anova/ex9.jpg" style="width:60.0%" /></p>
<p><img src="anova/ex10.jpg" style="width:70.0%" /></p>
<p><img src="anova/ex11.jpg" style="width:80.0%" /></p>
</div>
</div>
<div id="이원배치-분산분석" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> 이원배치 분산분석</h2>
<ul>
<li><p>이원배치 분산분석(two-way ANOVA)은 특성값에 영향을 미치는 두 요인의
효과에 대하여 조사하고자 할 때 이용되는 방법</p></li>
<li><p>이원배치 분산분석은 각 처리수준 조합내에서 반복이 있는 경우와 반복이
없는 경우로 나누어지며, 여기서는 반복이 있는 경우를 살펴본다.</p></li>
<li><p>이원배치 분산분석 개요</p>
<ol style="list-style-type: decimal">
<li><p>등분산 검정</p></li>
<li><p>교호작용 효과(interaction effect) 검정</p></li>
<li><p>교호작용이 없다면 주효과(main effect) 검정</p></li>
<li><p>교호작용이 있다면 교호작용을 반영한 교차 검정</p></li>
</ol></li>
<li><p>요인 <span class="math inline">\(A\)</span>의 수준(집단)수가 <span class="math inline">\(a\)</span>, 요인 <span class="math inline">\(B\)</span>의 수준이 <span class="math inline">\(b\)</span>라고 하고 각
수준 조합에서 <span class="math inline">\(n\)</span>번씩 반복 실험을 할 경우, 이원배치 분산분석을 위한
자료 형태는 다음과 같다.</p>
<p><img src="anova/f4.jpg" style="width:90.0%" /></p></li>
</ul>
<p>이원배치 분산분석 - 통계적 모형
<span class="math display">\[\begin{aligned}
            y_{ijk}&amp;=\mu_{ij} + \epsilon_{ijk}, \quad i=1,2,\ldots,a, \quad j=1,2,\ldots,b, \quad k=1,2,\ldots,n \\
            &amp;=\mu + \alpha_i + \beta_j + (\alpha\beta)_{ij}+\epsilon_{ijk}
        , \quad \epsilon_{ijk} \sim N(0, \sigma^2)
\end{aligned}
\]</span></p>
<ul>
<li><p>여기서 조건은 다음과 같다.</p>
<ul>
<li><p><span class="math inline">\(\mu\)</span>: 실험전체의 모평균</p></li>
<li><p><span class="math inline">\(\alpha_i\)</span>: 요인 <span class="math inline">\(A\)</span>의 <span class="math inline">\(i\)</span>번째 처리가 주는 주효과</p></li>
<li><p><span class="math inline">\(\beta_j\)</span>: 요인 <span class="math inline">\(B\)</span>의 <span class="math inline">\(j\)</span>번째 처리가 주는 주효과</p></li>
<li><p>(<span class="math inline">\(\alpha\beta)_{ij}\)</span>: 요인 <span class="math inline">\(A\)</span>의 <span class="math inline">\(i\)</span>번째 처리와 요인 <span class="math inline">\(B\)</span>의 <span class="math inline">\(j\)</span>번째
처리의 교호작용 효과</p></li>
<li><p><span class="math inline">\(\epsilon_{ijk}\)</span>: 요인 <span class="math inline">\(A\)</span>의 <span class="math inline">\(i\)</span>번째 처리와 요인 <span class="math inline">\(B\)</span>의 <span class="math inline">\(j\)</span>번째 처리
내 <span class="math inline">\(k\)</span>번째 반복에서 얻은 측정값의 오차</p></li>
</ul></li>
<li><p>분산분석을 하려면 오차항의 가정에 따라 먼저 집단간의 분산이 동질함을
검정하여야 한다. 이를 위해 Levene의 분산의 동질성 검정(Levene’s
equality of variances test)을 이용</p></li>
<li><p>가설의 형태</p>
<ul>
<li><p>귀무가설: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\sigma_{11}^2=\sigma_{12}^2=\cdots =\sigma_{ij}^2\)</span>(<span class="math inline">\(i,j\)</span> 집단의
분산은 동일하다).</p></li>
<li><p>대립가설: <span class="math inline">\(H_1\)</span>: 최소한 하나의 <span class="math inline">\(\sigma_{ij}^2\)</span>은 다르다.</p></li>
</ul></li>
<li><p>검정통계량:
<span class="math display">\[F=\frac{ab(n-1)\sum_{i=1}^a\sum_{j=1}^b n(\bar{z}_{ij}-\bar{z})^2}{(ab-1)\sum_{i=1}^a\sum_{j=1}^{b}\sum_{k=1}^n(z_{ijk}-\bar{z}_{ij})^2}\]</span></p></li>
</ul>
<p>여기서 <span class="math inline">\(z_{ijk}=|y_{ijk}-\bar{y}_{ij}|\)</span>.</p>
<ul>
<li><p>기각역: <span class="math display">\[F&gt;F_{\alpha}(ab-1,ab(n-1))\]</span></p></li>
<li><p>등분산이 가정되지 않는 경우 비모수(nonparameteric) 검정법을 이용함</p></li>
<li><p>평균에 대한 가설</p>
<ul>
<li><p>귀무가설1: <span class="math inline">\(\alpha_1=\alpha_2=\cdots=\alpha_a=0\)</span></p></li>
<li><p>귀무가설2: <span class="math inline">\(\beta_1=\beta_2=\cdots=\beta_b=0\)</span></p></li>
<li><p>귀무가설3:
<span class="math inline">\(\alpha\beta_{11}=\alpha\beta_{12}=\cdots=\alpha\beta_{ij}=0\)</span></p></li>
<li><p>대립가설: <span class="math inline">\(H_1\)</span>: Not <span class="math inline">\(H_0\)</span></p></li>
</ul></li>
<li><p>분산분석표</p>
<p><img src="anova/f5.jpg" style="width:90.0%" /></p></li>
<li><p>변동 분해</p>
<ul>
<li><p><span class="math inline">\(SST=\sum_i\sum_j\sum_k (y_{ijk}-\bar{y})^2\)</span></p></li>
<li><p><span class="math inline">\(SSA=bn\sum_i(\bar{y}_{i.}-\bar{y})^2\)</span></p></li>
<li><p><span class="math inline">\(SSB=an\sum_j(\bar{y}_{.j}-\bar{y})^2\)</span></p></li>
<li><p><span class="math inline">\(SSAB=n\sum_i\sum_j(\bar{y}_{ij}-\bar{y}_{i.}-\bar{y}_{.j}+\bar{y})^2\)</span></p></li>
<li><p><span class="math inline">\(SSE(S_E)=\sum_i\sum_j\sum_k (y_{ijk}-\bar{y}_{ij})^2\)</span></p></li>
</ul></li>
<li><p>총제곱합 <span class="math inline">\(SST\)</span>는 <span class="math inline">\(A\)</span>요인 수준간의 변동 <span class="math inline">\(SSA\)</span>, <span class="math inline">\(B\)</span>요인 수준간의 변동
<span class="math inline">\(SSB\)</span>와 요인 <span class="math inline">\(A,B\)</span>의 교호작용에 의한 변동 <span class="math inline">\(SSAB\)</span>, 집단내의 변동
<span class="math inline">\(SSE\)</span>로 분해하여 얻어짐. 즉, <span class="math display">\[SST=SSA + SSB+SSAB+SSE\]</span></p></li>
<li><p>변동의 자유도</p>
<ul>
<li><p><span class="math inline">\(SST\)</span>: <span class="math inline">\(abn-1\)</span></p></li>
<li><p><span class="math inline">\(SSA\)</span>: <span class="math inline">\(a-1\)</span></p></li>
<li><p><span class="math inline">\(SSB\)</span>: <span class="math inline">\(b-1\)</span></p></li>
<li><p><span class="math inline">\(SSAB\)</span>: <span class="math inline">\((a-1)(b-1)\)</span></p></li>
<li><p><span class="math inline">\(SSE\)</span>: <span class="math inline">\(ab(n-1)\)</span></p></li>
</ul></li>
<li><p>평균제곱</p>
<ul>
<li><p><span class="math inline">\(MSA\)</span>: <span class="math inline">\(SSA/(a-1)\)</span></p></li>
<li><p><span class="math inline">\(MSB\)</span>: <span class="math inline">\(SSB/(b-1)\)</span></p></li>
<li><p><span class="math inline">\(MSAB\)</span>: <span class="math inline">\(SSAB/((a-1)(b-1))\)</span></p></li>
<li><p><span class="math inline">\(MSE\)</span>: <span class="math inline">\(SSE/(ab(n-1))\)</span></p></li>
</ul></li>
<li><p>검정통계량 <span class="math display">\[F_1=\frac{MSA}{MSE} \sim F_{(a-1,ab(n-1))}\]</span>
<span class="math display">\[F_2=\frac{MSB}{MSB} \sim F_{(b-1,ab(n-1))}\]</span>
<span class="math display">\[F_3=\frac{MSAB}{MSE} \sim F_{((a-1)(b-1),ab(n-1))}\]</span></p></li>
</ul>
<div id="교호작용" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> 교호작용</h3>
<ul>
<li><p>만약 요인 <span class="math inline">\(A\)</span>의 효과가 요인 <span class="math inline">\(B\)</span>의 수준에 따라 다르게 나타날 때(혹은
요인 <span class="math inline">\(B\)</span>의 효과가 요인 <span class="math inline">\(A\)</span>의 수준에 따라 다르게 나타날 때) 두
요인간에 교호작용(상호작용, interaction)이 있음</p></li>
<li><p>교호작용 예</p>
<p><img src="anova/f6.jpg" style="width:50.0%" /></p></li>
<li><p>이원배치 분산분석 검정 순서</p>
<ol style="list-style-type: decimal">
<li><p>교호작용이 유의한지 검정</p></li>
<li><p>만약, 교호작용이 유의하다면, 그대로 해석하고 분석 종료</p></li>
<li><p>혹은 두 요인의 수준을 조합하여 새로운 변수를 생성 후 일원배치
분산분석 시행</p></li>
<li><p>만약, 교호작용이 유의하지 않다면, 모형에서 교호작용 항을 제거하고
다시 분석</p></li>
</ol></li>
</ul>
<p><br /></p>
<p>예제) 세 종류의 호르몬 처리와 성별에 따라 혈액 칼슘 값에 차이가 있는지를
알아보기 위해 남녀 각 <span class="math inline">\(15\)</span>명씩을 선정하여 이들을 세 그룹으로 나누어 세
가지 호르몬 처리를 한 후 혈액 칼슘을 측정하였다. 호르몬 처리 및 성별에
따라 혈액 칼슘 값이 차이가 있는지 검정하라.</p>
<p><img src="anova/ex12.jpg" style="width:80.0%" /></p>
</div>
<div id="with-r-4" class="section level3" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> With R</h3>
<ol style="list-style-type: decimal">
<li>데이터 입력</li>
</ol>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="anova.html#cb28-1" aria-hidden="true" tabindex="-1"></a>anova2 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span><span class="st">&#39;gender   trt rep calcium</span></span>
<span id="cb28-2"><a href="anova.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt1    1   16.87</span></span>
<span id="cb28-3"><a href="anova.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt1    2   16.18</span></span>
<span id="cb28-4"><a href="anova.html#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt1    3   17.12</span></span>
<span id="cb28-5"><a href="anova.html#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt1    4   16.83</span></span>
<span id="cb28-6"><a href="anova.html#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt1    5   17.19</span></span>
<span id="cb28-7"><a href="anova.html#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt2    1   19.07</span></span>
<span id="cb28-8"><a href="anova.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt2    2   18.77</span></span>
<span id="cb28-9"><a href="anova.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt2    3   17.63</span></span>
<span id="cb28-10"><a href="anova.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt2    4   16.99</span></span>
<span id="cb28-11"><a href="anova.html#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt2    5   18.04</span></span>
<span id="cb28-12"><a href="anova.html#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt3    1   32.45</span></span>
<span id="cb28-13"><a href="anova.html#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt3    2   28.71</span></span>
<span id="cb28-14"><a href="anova.html#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt3    3   34.65</span></span>
<span id="cb28-15"><a href="anova.html#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt3    4   28.79</span></span>
<span id="cb28-16"><a href="anova.html#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="st">male    trt3    5   24.46</span></span>
<span id="cb28-17"><a href="anova.html#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt1    1   15.86</span></span>
<span id="cb28-18"><a href="anova.html#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt1    2   14.92</span></span>
<span id="cb28-19"><a href="anova.html#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt1    3   15.63</span></span>
<span id="cb28-20"><a href="anova.html#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt1    4   15.24</span></span>
<span id="cb28-21"><a href="anova.html#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt1    5   14.8</span></span>
<span id="cb28-22"><a href="anova.html#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt2    1   17.2</span></span>
<span id="cb28-23"><a href="anova.html#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt2    2   17.64</span></span>
<span id="cb28-24"><a href="anova.html#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt2    3   17.89</span></span>
<span id="cb28-25"><a href="anova.html#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt2    4   16.78</span></span>
<span id="cb28-26"><a href="anova.html#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt2    5   16.72</span></span>
<span id="cb28-27"><a href="anova.html#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt3    1   30.54</span></span>
<span id="cb28-28"><a href="anova.html#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt3    2   32.41</span></span>
<span id="cb28-29"><a href="anova.html#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt3    3   28.97</span></span>
<span id="cb28-30"><a href="anova.html#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt3    4   28.46</span></span>
<span id="cb28-31"><a href="anova.html#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="st">female  trt3    5   29.65</span></span>
<span id="cb28-32"><a href="anova.html#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span>, <span class="at">header=</span>T)</span>
<span id="cb28-33"><a href="anova.html#cb28-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-34"><a href="anova.html#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(anova2)</span></code></pre></div>
<pre><code>##   gender  trt rep calcium
## 1   male trt1   1   16.87
## 2   male trt1   2   16.18
## 3   male trt1   3   17.12
## 4   male trt1   4   16.83
## 5   male trt1   5   17.19
## 6   male trt2   1   19.07</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>평균 비교</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="anova.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(calcium <span class="sc">~</span> gender, <span class="at">data=</span>anova2, <span class="at">FUN=</span><span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<pre><code>##   gender  calcium
## 1 female 20.84733
## 2   male 21.58333</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="anova.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(calcium <span class="sc">~</span> trt, <span class="at">data=</span>anova2, <span class="at">FUN=</span><span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<pre><code>##    trt calcium
## 1 trt1  16.064
## 2 trt2  17.673
## 3 trt3  29.909</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="anova.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>(calcium <span class="sc">~</span> gender<span class="sc">+</span>trt, <span class="at">data=</span>anova2, <span class="at">FUN=</span><span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<pre><code>##   gender  trt calcium
## 1 female trt1  15.290
## 2   male trt1  16.838
## 3 female trt2  17.246
## 4   male trt2  18.100
## 5 female trt3  30.006
## 6   male trt3  29.812</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>이원배치 분산분석</li>
</ol>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="anova.html#cb36-1" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">aov</span>(calcium <span class="sc">~</span> gender <span class="sc">*</span> trt, <span class="at">data=</span>anova2)</span>
<span id="cb36-2"><a href="anova.html#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="anova.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(re)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## gender       1    4.1     4.1   1.278    0.269    
## trt          2 1146.6   573.3 180.355 3.47e-15 ***
## gender:trt   2    3.8     1.9   0.605    0.554    
## Residuals   24   76.3     3.2                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석표를 살펴보면 gender와 trt의 교호작용에 대한 P-value는 0.554로 유의하지 않기 때문에 교호작용은 없는 것으로 판단된다.
이 경우, 교호작용을 제외한 주효과 모형을 다시 적합하여 분석한다.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="anova.html#cb38-1" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">aov</span>(calcium <span class="sc">~</span> gender <span class="sc">+</span> trt, <span class="at">data=</span>anova2)</span>
<span id="cb38-2"><a href="anova.html#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="anova.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(re)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## gender       1    4.1     4.1   1.318    0.261    
## trt          2 1146.6   573.3 186.009 3.94e-16 ***
## Residuals   26   80.1     3.1                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>교호작용을 제외한 분산분석표를 살펴보면, gender의 P-value는 0.261로 유의하지 않고, 즉, 성별에 따른 calcium은 차이가 없게 나타났다.
trt의 경우에는 P-value가 3.94e-16으로 매우 유의하게 나타났다. 따라서 trt에 따라서 calcium은 차이가 있다고 할 수 있다.</p>
<ol start="4" style="list-style-type: decimal">
<li>교호작용이 유의한 경우</li>
</ol>
<p>위의 예제에서는 교호작용이 유의하지 않게 나타났다. 만일 교호작용이 유의하게 나타난다면 어떻게 해야 하는가. 아래의 예제를 살펴보자.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="anova.html#cb40-1" aria-hidden="true" tabindex="-1"></a>interac <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span><span class="st">&#39;country gender ind</span></span>
<span id="cb40-2"><a href="anova.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="st">A F 88</span></span>
<span id="cb40-3"><a href="anova.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="st">A F 103</span></span>
<span id="cb40-4"><a href="anova.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="st">A F 111</span></span>
<span id="cb40-5"><a href="anova.html#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="st">A F 77</span></span>
<span id="cb40-6"><a href="anova.html#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="st">A F 104</span></span>
<span id="cb40-7"><a href="anova.html#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="st">A M 65</span></span>
<span id="cb40-8"><a href="anova.html#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="st">A M 54</span></span>
<span id="cb40-9"><a href="anova.html#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="st">A M 55</span></span>
<span id="cb40-10"><a href="anova.html#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="st">A M 54</span></span>
<span id="cb40-11"><a href="anova.html#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="st">A M 51</span></span>
<span id="cb40-12"><a href="anova.html#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="st">K F 55</span></span>
<span id="cb40-13"><a href="anova.html#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="st">K F 50</span></span>
<span id="cb40-14"><a href="anova.html#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="st">K F 52</span></span>
<span id="cb40-15"><a href="anova.html#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="st">K F 61</span></span>
<span id="cb40-16"><a href="anova.html#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="st">K F 70</span></span>
<span id="cb40-17"><a href="anova.html#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="st">K M 39</span></span>
<span id="cb40-18"><a href="anova.html#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="st">K M 35</span></span>
<span id="cb40-19"><a href="anova.html#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="st">K M 31</span></span>
<span id="cb40-20"><a href="anova.html#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="st">K M 32</span></span>
<span id="cb40-21"><a href="anova.html#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="st">K M 34&#39;</span>,  <span class="at">header=</span>T)</span>
<span id="cb40-22"><a href="anova.html#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="anova.html#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(interac)</span></code></pre></div>
<pre><code>##   country gender ind
## 1       A      F  88
## 2       A      F 103
## 3       A      F 111
## 4       A      F  77
## 5       A      F 104
## 6       A      M  65</code></pre>
<p>국가와 성별을 요인으로 두고 ind의 차이가 있는지 살펴보자.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="anova.html#cb42-1" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">aov</span>(ind <span class="sc">~</span> <span class="fu">as.factor</span>(country) <span class="sc">*</span> <span class="fu">as.factor</span>(gender), <span class="at">data=</span>interac)</span>
<span id="cb42-2"><a href="anova.html#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="anova.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(re)</span></code></pre></div>
<pre><code>##                                      Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## as.factor(country)                    1   4590    4590  62.455 6.50e-07 ***
## as.factor(gender)                     1   5152    5152  70.096 3.06e-07 ***
## as.factor(country):as.factor(gender)  1    378     378   5.149   0.0374 *  
## Residuals                            16   1176      74                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>분산분석표를 살펴보면 country와 gender간 교호작용의 P-value가 0.0374로 유의한 것을 알 수 있다. 이는 국가와 성별의 조합에 의한 ind의 값이 차이가 있다는 것을 의미한다. 따라서 해당 조합을 통한 일원배치 분산분석으로 접근하거나 또는 국가 혹은 성별을 고정시킨 상태에서 다른 요인의 효과를 일원배치 분산분석을 통해 검정한다.</p>
<p>먼저 해당 조합을 고려한 일원배치 분석을 생각해보자. 2개 국가와 2개의 성별 조합은 총 4개의 집단으로 구성된다.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="anova.html#cb44-1" aria-hidden="true" tabindex="-1"></a>interac<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">paste</span>(interac<span class="sc">$</span>country, interac<span class="sc">$</span>gender)</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="anova.html#cb45-1" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">aov</span>(ind <span class="sc">~</span> <span class="fu">as.factor</span>(group), <span class="at">data=</span>interac)</span>
<span id="cb45-2"><a href="anova.html#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="anova.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(re)</span></code></pre></div>
<pre><code>##                  Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## as.factor(group)  3  10121    3374    45.9 4.39e-08 ***
## Residuals        16   1176      74                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="anova.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">PostHocTest</span>(re, <span class="at">method=</span><span class="st">&quot;bonferroni&quot;</span>)</span></code></pre></div>
<pre><code>## 
##   Posthoc multiple comparisons of means : Bonferroni 
##     95% family-wise confidence level
## 
## $`as.factor(group)`
##          diff    lwr.ci     upr.ci    pval    
## A M-A F -40.8 -57.11172 -24.488282 7.3e-06 ***
## K F-A F -39.0 -55.31172 -22.688282 1.3e-05 ***
## K M-A F -62.4 -78.71172 -46.088282 2.3e-08 ***
## K F-A M   1.8 -14.51172  18.111718  1.0000    
## K M-A M -21.6 -37.91172  -5.288282  0.0064 ** 
## K M-K F -23.4 -39.71172  -7.088282  0.0032 ** 
## 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>이번에는 한 요인을 고정한 상태에서 다른 요인의 차이가 있는지 살펴보자.
이를 위해 ‘phia’ 패키지가 필요하다.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="anova.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phia)</span>
<span id="cb49-2"><a href="anova.html#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="anova.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">6</span>)  <span class="co"># 4.11e-05 처럼 표기되는 것을 막아준다.</span></span>
<span id="cb49-4"><a href="anova.html#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="anova.html#cb49-5" aria-hidden="true" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="fu">aov</span>(ind <span class="sc">~</span> <span class="fu">as.factor</span>(country) <span class="sc">*</span> <span class="fu">as.factor</span>(gender), <span class="at">data=</span>interac)</span></code></pre></div>
<p>먼저 country를 고정시킨 후 gender의 결과를 살펴보자.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="anova.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testInteractions</span>(</span>
<span id="cb50-2"><a href="anova.html#cb50-2" aria-hidden="true" tabindex="-1"></a>    re,</span>
<span id="cb50-3"><a href="anova.html#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixed =</span> <span class="st">&quot;as.factor(country)&quot;</span>,</span>
<span id="cb50-4"><a href="anova.html#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">across =</span> <span class="st">&quot;as.factor(gender)&quot;</span>,</span>
<span id="cb50-5"><a href="anova.html#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> interac</span>
<span id="cb50-6"><a href="anova.html#cb50-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## F Test: 
## P-value adjustment method: holm
##           Value Df Sum of Sq      F      Pr(&gt;F)    
## A          40.8  1    4161.6 56.620 0.000002433 ***
## K          23.4  1    1368.9 18.625    0.000533 ***
## Residuals       16    1176.0                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>결과표를 살펴보면 A국과 K국 모두 성별 차이가 통계적으로 유의미(p &lt; .05)하다. 다음으로 성별을 고정시켰을 때, 국가간 차이를 확인해보자.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="anova.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">testInteractions</span>(</span>
<span id="cb52-2"><a href="anova.html#cb52-2" aria-hidden="true" tabindex="-1"></a>    re,</span>
<span id="cb52-3"><a href="anova.html#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixed =</span> <span class="st">&quot;as.factor(gender)&quot;</span>,</span>
<span id="cb52-4"><a href="anova.html#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">across =</span> <span class="st">&quot;as.factor(country)&quot;</span>,</span>
<span id="cb52-5"><a href="anova.html#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> interac</span>
<span id="cb52-6"><a href="anova.html#cb52-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## F Test: 
## P-value adjustment method: holm
##           Value Df Sum of Sq      F      Pr(&gt;F)    
## F          39.0  1    3802.5 51.735 0.000004285 ***
## M          21.6  1    1166.4 15.869    0.001068 ** 
## Residuals       16    1176.0                       
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>성별을 고정한 경우 국가간의 차이는 모두 유의한 것으로 나타난다. 이는 4개의 그룹으로 묶어서 일원배치 분산분석을 하는 경우의 결과와 동일한 방향을 나타낸다.</p>
</div>
<div id="with-sas-4" class="section level3" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> With SAS</h3>
<blockquote>
<p>SAS Code</p>
</blockquote>
<pre><code>DATA calcium;
format gender $ 8.;
DO gender=&#39;male&#39; , &#39; female&#39;;
DO trt=&#39;trt1&#39;,&#39;trt2&#39;,&#39;trt3&#39;;
DO rep=1,2,3,4,5;
INPUT calcium @@;
OUTPUT;
END; END;END;
CARDS;
16.87 16.18 17.12 16.83 17.19
19.07 18.77 17.63 16.99 18.04
 32.45 28.71 34.65 28.79 24.46
15.86 14.92 15.63 15.24 14.80
17.20 17.64 17.89 16.78 16.72
30.54 32.41 28.97 28.46 29.65
;
RUN;</code></pre>
<pre><code>proc means data=calcium;
class gender trt;
var calcium;
run;</code></pre>
<p><img src="anova/ex14_1.jpg" style="width:70.0%" /></p>
<pre><code>PROC GLM data=calcium;
CLASS gender trt;
MODEL calcium=gender trt gender*trt;
MEANS trt/ TUKEY;
RUN;</code></pre>
<p><img src="anova/ex14.jpg" style="width:60.0%" /></p>
<pre><code>PROC GLM data=calcium;
CLASS gender trt;
MODEL calcium=gender trt ;
MEANS trt/ TUKEY;
RUN;</code></pre>
<p><img src="anova/ex15.jpg" style="width:60.0%" /></p>
<p><img src="anova/ex16.jpg" style="width:70.0%" /></p>
<!-------------------------------------->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ttest.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nonpara.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rmanual.pdf", "rmanual.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
