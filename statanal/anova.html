<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 분산분석 | Statistical Analysis</title>
  <meta name="description" content="This is a Statistical Analysis" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 분산분석 | Statistical Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a Statistical Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 분산분석 | Statistical Analysis" />
  
  <meta name="twitter:description" content="This is a Statistical Analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2021-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ttest.html"/>
<link rel="next" href="nonpara.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>1</b> 평균차이 검정</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ttest.html"><a href="ttest.html#일표본-t-검정"><i class="fa fa-check"></i><b>1.1</b> 일표본 <span class="math inline">\(t\)</span>-검정</a></li>
<li class="chapter" data-level="1.2" data-path="ttest.html"><a href="ttest.html#독립표본-t-검정"><i class="fa fa-check"></i><b>1.2</b> 독립표본 <span class="math inline">\(t\)</span>-검정</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ttest.html"><a href="ttest.html#두-모분산-비의-검정"><i class="fa fa-check"></i><b>1.2.1</b> 두 모분산 비의 검정</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ttest.html"><a href="ttest.html#대응표본-t-검정"><i class="fa fa-check"></i><b>1.3</b> 대응표본 <span class="math inline">\(t\)</span>-검정</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>2</b> 분산분석</a>
<ul>
<li class="chapter" data-level="2.1" data-path="anova.html"><a href="anova.html#분산분석"><i class="fa fa-check"></i><b>2.1</b> 분산분석</a></li>
<li class="chapter" data-level="2.2" data-path="anova.html"><a href="anova.html#일원배치-분산분석"><i class="fa fa-check"></i><b>2.2</b> 일원배치 분산분석</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="anova.html"><a href="anova.html#사후분석다중검정"><i class="fa fa-check"></i><b>2.2.1</b> 사후분석(다중검정)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="anova.html"><a href="anova.html#이원배치-분산분석"><i class="fa fa-check"></i><b>2.3</b> 이원배치 분산분석</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="anova.html"><a href="anova.html#교호작용"><i class="fa fa-check"></i><b>2.3.1</b> 교호작용</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nonpara.html"><a href="nonpara.html"><i class="fa fa-check"></i><b>3</b> 비모수 검정</a>
<ul>
<li class="chapter" data-level="3.1" data-path="nonpara.html"><a href="nonpara.html#정규성-검정"><i class="fa fa-check"></i><b>3.1</b> 정규성 검정</a></li>
<li class="chapter" data-level="3.2" data-path="nonpara.html"><a href="nonpara.html#윌콕슨-부호순위-검정"><i class="fa fa-check"></i><b>3.2</b> 윌콕슨 부호순위 검정</a></li>
<li class="chapter" data-level="3.3" data-path="nonpara.html"><a href="nonpara.html#윌콕슨-순위합-검정"><i class="fa fa-check"></i><b>3.3</b> 윌콕슨 순위합 검정</a></li>
<li class="chapter" data-level="3.4" data-path="nonpara.html"><a href="nonpara.html#크루스칼-왈리스-검정"><i class="fa fa-check"></i><b>3.4</b> 크루스칼-왈리스 검정</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="category.html"><a href="category.html"><i class="fa fa-check"></i><b>4</b> 교차분석</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="category.html"><a href="category.html#상대위험률과-오즈비"><i class="fa fa-check"></i><b>4.0.1</b> 상대위험률과 오즈비</a></li>
<li class="chapter" data-level="4.1" data-path="category.html"><a href="category.html#독립성-검정"><i class="fa fa-check"></i><b>4.1</b> 독립성 검정</a></li>
<li class="chapter" data-level="4.2" data-path="category.html"><a href="category.html#동질성-검정"><i class="fa fa-check"></i><b>4.2</b> 동질성 검정</a></li>
<li class="chapter" data-level="4.3" data-path="category.html"><a href="category.html#fisher의-정확-검정"><i class="fa fa-check"></i><b>4.3</b> Fisher의 정확 검정</a></li>
<li class="chapter" data-level="4.4" data-path="category.html"><a href="category.html#맥니마-검정"><i class="fa fa-check"></i><b>4.4</b> 맥니마 검정</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="anova" class="section level1" number="2">
<h1><span class="header-section-number">Chapter 2</span> 분산분석</h1>
<div id="분산분석" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> 분산분석</h2>
<ul>
<li><p>분산분석(analysis of variance: ANOVA)은 R.A. Fisher에 의해 개발된
3개 이상(2집단 가능)의 모평균에 대한 분석 방법</p></li>
<li><p>실험계획법(experimental design)에서 가장 많이 사용되는
분석방법으로서, 특성값의 분산 또는 변동을 분석하는 방법. 즉,
특성값의 변동을 제곱합(sum of squares)으로 나타내고, 이 제곱합을
실험에 관련된 요인(factor)별로 분해하여 오차에 비해 큰 영향을 주는
요인이 무엇인가를 찾아내는 방법</p></li>
<li><p>요인의 수에 의한 분산분석 분류</p>
<ul>
<li><p>일원배치 분산분석(one-way ANOVA): 요인의 수가 하나인 분산분석.
다른 요인은 측정값에 경미한 영향으로 무시할 수 있거나 또는
영향이 일정할 때 사용</p></li>
<li><p>이원배치 분산분석(two-way ANOVA): 측정값에 영향을 미치는 요인이
둘일 때의 분석으로 두 요인의 집단(수준)수 조합이 반복이 없는
경우와 있는경우로 분류하여 검증</p></li>
<li><p>이외 삼원배치 분산분석, 다원배치 분산분석 등이 있음</p></li>
</ul></li>
<li><p>모형에 의한 분산분석 분류</p>
<ul>
<li><p>모수 모형(fixed effect model)</p></li>
<li><p>변량 모형(random effect model)</p></li>
<li><p>혼합 모형(mixed effect model)</p></li>
</ul></li>
<li><p>변동 분해</p>
<p><img src="anova/f1.jpg" style="width:70.0%" /></p></li>
<li><p>특성값의 변동을 나타내는 제곱합(총제곱합, total sum of squares:
SST)은 요인에 의한 제곱합(treatment sum of squares: SSTr)과 오차로
인한 제곱합(error sum of squares: SSE)으로 분해</p></li>
</ul>
</div>
<div id="일원배치-분산분석" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> 일원배치 분산분석</h2>
<ul>
<li><p>일원배치 분산분석(one-way ANOVA)석은 <span class="math inline">\(t\)</span>-test를 확장하여 요인은
하나이고, 요인에 의해 <span class="math inline">\(k\)</span>개 집단(수준)으로 나뉜 표본들을 서로 비교
검정하는 방법</p></li>
<li><p>집단(수준)은 3개 이상(<span class="math inline">\(k \ge 3\)</span>), 특성값은 하나로써 특성값에 대한 한
종류의 요인만의 영향을 조사하고자 할 때 사용하는 방법</p></li>
<li><p>특성</p>
<ul>
<li><p>집단 수와 각 집단에서 취해지는 측정값의 반복수에는 별로 제한이
없음. 그러나 집단수는 <span class="math inline">\(3\sim 5\)</span>수준, 반복수는 <span class="math inline">\(3\sim 10\)</span> 정도가
많이 사용됨</p></li>
<li><p>반복수가 모든 수준에 대하여 같지 않아도 됨. 따라서
결측값(missing value)이 있어도 이를 추정하여 넣어 줄 필요가
없으며 그대로 해석 가능 함</p></li>
<li><p>실험의 측정은 실험 전체를 완전히 랜덤화하여 모든 특성값을 랜덤한
순서에 의하여 구해야 함</p></li>
</ul></li>
<li><p>요인 <span class="math inline">\(A\)</span>의 수준(집단)수가 <span class="math inline">\(k\)</span>개(<span class="math inline">\(A_1, A_2, \cdots, A_k\)</span>)이며, 각
수준마다 <span class="math inline">\(n_i\)</span>번씩 반복 실험을 할 경우, 일원배치 분산분석을 위한
자료 형태. 여기서 <span class="math inline">\(N=\sum_{i=1}^kn_i\)</span>은 총 실험횟수</p>
<p><img src="anova/f2.jpg" style="width:90.0%" /></p></li>
<li><p>여기서 <span class="math inline">\(i\)</span>열의 합 <span class="math inline">\(T_i=\sum_{j=1}^{n_i} y_{ij}\)</span>, <span class="math inline">\(i\)</span>열의 평균
<span class="math inline">\(\bar{y}_i=\frac{T_i}{n_i}\)</span>, 총 합계 <span class="math inline">\(T=\sum_{i=1}^k T_i\)</span>, 총 평균
<span class="math inline">\(\bar{y}=\frac{T}{N}\)</span></p></li>
</ul>
<p>일원배치 분산분석 - 통계적 모형 <span class="math display">\[\begin{aligned}
    y_{ij}&amp;=&amp;\mu_i + \epsilon_{ij}, \quad i=1,2,\ldots,k, \quad j=1,2,\ldots,n_i \\
    &amp;=&amp;\mu + \alpha_i + \epsilon_{ij}
    \end{aligned}\]</span></p>
<ul>
<li><p><span class="math inline">\(\epsilon_{ij} \sim N(0, \sigma^2)\)</span>, 서로 독립</p></li>
<li><p><span class="math inline">\(\mu\)</span>: 실험전체의 모평균</p></li>
<li><p><span class="math inline">\(\alpha_i\)</span>: <span class="math inline">\(i\)</span>번째 처리가 주는 주효과. 단, <span class="math inline">\(\sum_{i=1}^k\alpha_i=0\)</span></p></li>
<li><p><span class="math inline">\(\epsilon_{ij}\)</span>: <span class="math inline">\(i\)</span>번째 처리의 <span class="math inline">\(j\)</span>번째 반복에서 얻은 측정값의 오차</p></li>
<li><p>오차 <span class="math inline">\(\epsilon_{ij}\)</span>는 처리 <span class="math inline">\(A_i\)</span>에서 <span class="math inline">\(j\)</span>번째 측정된 <span class="math inline">\(y_{ij}\)</span>가
수반하는 오차로서, 확률변수이며 다음과 같은 성질을 가짐</p></li>
<li><p><span class="math inline">\(\epsilon_{ij}\)</span>는 랜덤하게 변하는 값이며 모평균은 <span class="math inline">\(0\)</span>이고 분산은
<span class="math inline">\(\sigma^2\)</span>이다.</p></li>
<li><p><span class="math inline">\(\epsilon_{ij}\)</span>는 정규분포 <span class="math inline">\(N(0,\sigma^2)\)</span>으로부터 확률추출된
것이라고 가정하며, 이 가정은 다음을 의미한다.</p>
<ol style="list-style-type: decimal">
<li><p>정규성: 오차 <span class="math inline">\(\epsilon_{ij}\)</span>는 정규분포를 따른다.</p></li>
<li><p>독립성: 임의의 <span class="math inline">\(\epsilon_{ij}\)</span>와 <span class="math inline">\(\epsilon_{i&#39;j&#39;}\)</span>(<span class="math inline">\(i\ne i&#39;\)</span>
또는 <span class="math inline">\(j\ne j&#39;\)</span>)는 서로 독립이다.</p></li>
<li><p>불편성: 오차 <span class="math inline">\(\epsilon_{ij}\)</span>의 기대값은 <span class="math inline">\(0\)</span>이다.</p></li>
<li><p>등분산성: 오차 <span class="math inline">\(\epsilon_{ij}\)</span>의 분산은 <span class="math inline">\(\sigma^2\)</span>으로 어떤
<span class="math inline">\(i, j\)</span>에 대해서도 일정하다.</p></li>
</ol></li>
<li><p>분산분석을 하려면 오차항의 가정에 따라 먼저 집단간의 분산이 동질함을
검정하여야 함. 이를 위해 Levene의 분산의 동질성 검정(Levene’s
equality of variances test)을 이용</p></li>
<li><p>귀무가설: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\sigma_1^2=\sigma_2^2=\cdots =\sigma_k^2\)</span>(<span class="math inline">\(k\)</span>개
집단의 분산은 동일하다).</p></li>
<li><p>대립가설: <span class="math inline">\(H_1\)</span>: 최소한 하나의 <span class="math inline">\(\sigma_i^2\)</span>은 다르다.</p></li>
<li><p>검정통계량:
<span class="math display">\[F=\frac{(N-k)\sum_{i=1}^k n_i(\bar{z}_i-\bar{z})^2}{(k-1)\sum_{i=1}^k\sum_{j=1}^{n_i}(z_{ij}-\bar{z}_i)^2}\]</span></p></li>
<li><p>여기서 <span class="math inline">\(z_{ij}=|y_{ij}-\bar{y}_i|\)</span>.</p></li>
<li><p>기각역: <span class="math display">\[F&gt;F(k-1,N-k;\alpha)\]</span></p></li>
<li><p>등분산이 가정되지 않는 경우 Brown-Forsythe 통계량을 계산하여 집단
평균의 동일성을 검정</p></li>
<li><p>평균에 대한 가설</p></li>
<li><p>귀무가설: <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\mu_1 = \mu_2 = \cdots = \mu_k\)</span> 또는
<span class="math inline">\(\alpha_1=\alpha_2=\cdots=\alpha_k=0\)</span>.</p></li>
<li><p>대립가설: <span class="math inline">\(H_1\)</span>: 최소한 하나의 <span class="math inline">\(\mu_i\)</span>는 같지 않다. 또는 최소한
하나의 <span class="math inline">\(\alpha_i=0\)</span>이 아니다.</p></li>
<li><p>분산분석의 가설검정은 분산분석표(ANOVA table)를 통해 이루어짐</p></li>
<li><p>분산분석표</p>
<p><img src="anova/f3.jpg" style="width:90.0%" /></p></li>
<li><p>변동 분해</p></li>
<li><p>총제곱합 <span class="math inline">\(SST(S_T)=\sum_{i=1}^k\sum_{j=1}^{n_i}(y_{ij}-\bar{y})^2\)</span></p></li>
<li><p>오차제곱합
<span class="math inline">\(SSE(S_E)=\sum_{i=1}^k\sum_{j=1}^{n_i} (y_{ij}-\bar{y}_i)^2\)</span></p></li>
<li><p>처리제곱합
<span class="math inline">\(SSTr(S_A)=\sum_{i=1}^k\sum_{j=1}^{n_i}(\bar{y}_i-\bar{y})^2\)</span></p></li>
<li><p>총제곱합 <span class="math inline">\(SST\)</span>는 급내변동(variation within group)인 오차제곱합
<span class="math inline">\(SSE\)</span>와 급간변동(variation between group)인 처리제곱합 <span class="math inline">\(SSTr\)</span>의
합으로 구성됨. 즉, <span class="math display">\[SST=SSE + SSTr\]</span></p></li>
<li><p>변동의 자유도</p></li>
<li><p>총변동의 자유도 <span class="math inline">\(\phi_T=N-1\)</span></p></li>
<li><p>급내변동의 자유도 <span class="math inline">\(\phi_E=N-k\)</span></p></li>
<li><p>급간변동의 자유도 <span class="math inline">\(\phi_A=k-1\)</span></p></li>
<li><p>평균제곱: 제곱합을 자유도로 나눈 것</p></li>
<li><p>오차평균제곱(mean squared error: MSE): <span class="math inline">\(V_E=\frac{S_E}{\phi_E}\)</span></p></li>
<li><p>처리평균제곱: <span class="math inline">\(V_A=\frac{S_A}{\phi_A}\)</span></p></li>
<li><p>검정통계량 <span class="math display">\[F=\frac{V_A}{V_E} \sim F_{(k-1,N-k)}\]</span></p></li>
<li><p>기각역 <span class="math display">\[F \ge F_{(\alpha,k-1,N-k)}\]</span></p></li>
</ul>
<div id="사후분석다중검정" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> 사후분석(다중검정)</h3>
<ul>
<li><p>분산분석은 <span class="math inline">\(k\)</span>개 집단의 평균이 유의미한 차이가 있는지 확인만 가능</p></li>
<li><p>즉, <span class="math inline">\(k\)</span>개의 집단 중 하나의 집단이 다른 집단의 평균과 차이가 있는지
아니면 여러 집단이 동시에 서로서로 차이가 있는지 확인 불가능</p></li>
<li><p>분산분석의 결과가 유의미한 경우, 다시 말해서 최소한 하나 이상의
집단의 평균이 차이가 있다고 나타난 경우, 차이가 있는 집단을 찾는
방법을 사후분석(post hoc analysis) 또는 다중검정(multiple
comparison)이라고 함</p></li>
<li><p>사후검정 또는 다중검정은 반드시 분산분석의 결과가 유의미한 경우에
이루어져야 함</p></li>
<li><p>사후 검정은 두 집단씩 짝을 이루어 검정하게 되며(마치 <span class="math inline">\(t\)</span>-test 처럼)
이때 제1종 오류의 크기 <span class="math inline">\(\alpha\)</span>를 유지하는 방법에 따라 여러가지
방법으로 나누어짐</p></li>
</ul>
<p><img src="anova/ex1.jpg" style="width:80.0%" /></p>
<p><img src="anova/ex2_1.jpg" style="width:80.0%" /></p>
<p><img src="anova/ex2_2.jpg" style="width:80.0%" /></p>
<p>면역이상에 대한 한 연구에서 자폐아, 정상아, 지진아에 대한 혈청 항원의
농도에 대해 조사하였다. 이 연구의 목적은 자폐아, 정상아, 지진아에 따라
혈청 항원의 농도에 유의한 차이가 있는가이다.</p>
<p><img src="anova/ex3.jpg" style="width:50.0%" /></p>
<ul>
<li><p>풀이) <span class="math display">\[SST=\sum_i \sum_j (y_{ij} -\bar{y} )^2 = 1517167.239\]</span>
<span class="math display">\[SSt=\sum_i n_i (\bar{y}_i - \bar{y} )^2 =141234.602\]</span>
<span class="math display">\[SSE=SST-SSt =1375932.638\]</span>
<span class="math display">\[F=\frac{141234.602/2}{1375932.638/68}=3.47\]</span></p></li>
<li><p>ANOVA table</p>
<p><img src="anova/ex4.jpg" style="width:80.0%" /></p></li>
<li><p>가설</p></li>
<li><p><span class="math inline">\(H_0\)</span>: 자폐아, 정상아, 지진아에 대한 혈청 항원의 농도는 모두 같다</p></li>
<li><p><span class="math inline">\(H_1\)</span>: Not <span class="math inline">\(H_0\)</span></p></li>
<li><p>임계값 <span class="math display">\[F_{0.05}(2,68) = 3.15\]</span></p></li>
<li><p>기각역 <span class="math display">\[F_0 &gt; 3.15\]</span></p></li>
<li><p>검정통계량 값이 <span class="math inline">\(3.49&gt;3.15\)</span>로 유의수준 <span class="math inline">\(5\%\)</span> 하에서 귀무가설 기각.
따라서 세 집단의 평균이 모두 동일하지는 않음</p></li>
<li><p><span class="math inline">\(P\)</span>-value <span class="math display">\[P(F&gt;3.49)=0.0361\]</span></p></li>
<li><p><span class="math inline">\(P\)</span>-value의 값이 유의수준 0.05보다 작으므로 귀무가설 기각</p></li>
</ul>
<p>다음은 서로 다른 항우울제의 치료 효과를 비교하기 위한 연구이다. <span class="math inline">\(36\)</span>명의
우울증 환자를 <span class="math inline">\(A\)</span>군, <span class="math inline">\(B\)</span>군, <span class="math inline">\(C\)</span>군으로 <span class="math inline">\(12\)</span>명씩 무작위 배정하여 각각
<span class="math inline">\(A\)</span>약, <span class="math inline">\(B\)</span>약, <span class="math inline">\(C\)</span>약을 2개월 동안 투여한 뒤 우울증 점수를 측정하였다. 이
세가지 약의 치료 효과를 비교하라.</p>
<p><img src="anova/ex5.jpg" style="width:80.0%" /></p>
<p>SAS Code</p>
<p><img src="anova/ex7.jpg" style="width:55.0%" /></p>
<p><img src="anova/ex6.jpg" style="width:70.0%" /></p>
<p><img src="anova/ex8.jpg" style="width:90.0%" /></p>
<p><img src="anova/ex8_1.jpg" style="width:90.0%" /></p>
<p><img src="anova/ex9.jpg" style="width:90.0%" /></p>
<p><img src="anova/ex10.jpg" style="width:70.0%" /></p>
<p><img src="anova/ex11.jpg" style="width:80.0%" /></p>
</div>
</div>
<div id="이원배치-분산분석" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> 이원배치 분산분석</h2>
<ul>
<li><p>이원배치 분산분석(two-way ANOVA)은 특성값에 영향을 미치는 두 요인의
효과에 대하여 조사하고자 할 때 이용되는 방법</p></li>
<li><p>이원배치 분산분석은 각 처리수준 조합내에서 반복이 있는 경우와 반복이
없는 경우로 나누어지며, 여기서는 반복이 있는 경우를 살펴봄</p></li>
<li><p>이원배치 분산분석 개요</p>
<ol style="list-style-type: decimal">
<li><p>등분산 검정</p></li>
<li><p>교호작용 효과(interaction effect) 검정</p></li>
<li><p>교호작용이 없다면 주효과(main effect) 검정</p></li>
<li><p>교호작용이 있다면 교호작용을 반영한 교차 검정</p></li>
</ol></li>
<li><p>요인 <span class="math inline">\(A\)</span>의 수준(집단)수가 <span class="math inline">\(a\)</span>, 요인 <span class="math inline">\(B\)</span>의 수준이 <span class="math inline">\(b\)</span>라고 하고 각
수준 조합에서 <span class="math inline">\(n\)</span>번씩 반복 실험을 할 경우, 이원배치 분산분석을 위한
자료 형태</p>
<p><img src="anova/f4.jpg" style="width:90.0%" /></p></li>
</ul>
<p>이원배치 분산분석 - 통계적 모형 <span class="math display">\[\begin{aligned}
            y_{ijk}&amp;=&amp;\mu_{ij} + \epsilon_{ijk}, \quad i=1,2,\ldots,a, \quad j=1,2,\ldots,b, \quad k=1,2,\ldots,n \\
            &amp;=&amp;\mu + \alpha_i + \beta_j + (\alpha\beta)_{ij}+\epsilon_{ijk}
        \end{aligned}\]</span></p>
<ul>
<li><p><span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma^2)\)</span>, 서로 독립</p></li>
<li><p><span class="math inline">\(\mu\)</span>: 실험전체의 모평균</p></li>
<li><p><span class="math inline">\(\alpha_i\)</span>: 요인 <span class="math inline">\(A\)</span>의 <span class="math inline">\(i\)</span>번째 처리가 주는 주효과</p></li>
<li><p><span class="math inline">\(\beta_j\)</span>: 요인 <span class="math inline">\(B\)</span>의 <span class="math inline">\(j\)</span>번째 처리가 주는 주효과</p></li>
<li><p>(<span class="math inline">\(\alpha\beta)_{ij}\)</span>: 요인 <span class="math inline">\(A\)</span>의 <span class="math inline">\(i\)</span>번째 처리와 요인 <span class="math inline">\(B\)</span>의 <span class="math inline">\(j\)</span>번째
처리의 교호작용 효과</p></li>
<li><p><span class="math inline">\(\epsilon_{ijk}\)</span>: 요인 <span class="math inline">\(A\)</span>의 <span class="math inline">\(i\)</span>번째 처리와 요인 <span class="math inline">\(B\)</span>의 <span class="math inline">\(j\)</span>번째 처리
내 <span class="math inline">\(k\)</span>번째 반복에서 얻은 측정값의 오차</p></li>
<li><p>분산분석을 하려면 오차항의 가정에 따라 먼저 집단간의 분산이 동질함을
검정하여야 함. 이를 위해 Levene의 분산의 동질성 검정(Levene’s
equality of variances test)을 이용</p></li>
<li><p>귀무가설: <span class="math inline">\(H_0\)</span>:
<span class="math inline">\(\sigma_{11}^2=\sigma_{12}^2=\cdots =\sigma_{ij}^2\)</span>(<span class="math inline">\(i,j\)</span> 집단의
분산은 동일하다).</p></li>
<li><p>대립가설: <span class="math inline">\(H_1\)</span>: 최소한 하나의 <span class="math inline">\(\sigma_{ij}^2\)</span>은 다르다.</p></li>
<li><p>검정통계량:
<span class="math display">\[F=\frac{ab(n-1)\sum_{i=1}^a\sum_{j=1}^b n(\bar{z}_{ij}-\bar{z})^2}{(ab-1)\sum_{i=1}^a\sum_{j=1}^{b}\sum_{k=1}^n(z_{ijk}-\bar{z}_{ij})^2}\]</span></p></li>
<li><p>여기서 <span class="math inline">\(z_{ijk}=|y_{ijk}-\bar{y}_{ij}|\)</span>.</p></li>
<li><p>기각역: <span class="math display">\[F&gt;F(ab-1,ab(n-1);\alpha)\]</span></p></li>
<li><p>등분산이 가정되지 않는 경우 비모수(nonparameteric) 검정법을 이용함</p></li>
<li><p>평균에 대한 가설</p></li>
<li><p>귀무가설1: <span class="math inline">\(\alpha_1=\alpha_2=\cdots=\alpha_a=0\)</span></p></li>
<li><p>귀무가설2: <span class="math inline">\(\beta_1=\beta_2=\cdots=\beta_b=0\)</span></p></li>
<li><p>귀무가설3:
<span class="math inline">\(\alpha\beta_{11}=\alpha\beta_{12}=\cdots=\alpha\beta_{ij}=0\)</span></p></li>
<li><p>대립가설: <span class="math inline">\(H_1\)</span>: Not <span class="math inline">\(H_0\)</span></p></li>
<li><p>분산분석표</p>
<p><img src="anova/f5.jpg" style="width:90.0%" /></p></li>
<li><p>변동 분해</p></li>
<li><p><span class="math inline">\(SST=\sum_i\sum_j\sum_k (y_{ijk}-\bar{y})^2\)</span></p></li>
<li><p><span class="math inline">\(SSA=bn\sum_i(\bar{y}_{i.}-\bar{y})^2\)</span></p></li>
<li><p><span class="math inline">\(SSB=an\sum_j(\bar{y}_{.j}-\bar{y})^2\)</span></p></li>
<li><p><span class="math inline">\(SSAB=n\sum_i\sum_j(\bar{y}_{ij}-\bar{y}_{i.}-\bar{y}_{.j}+\bar{y})^2\)</span></p></li>
<li><p><span class="math inline">\(SSE(S_E)=\sum_i\sum_j\sum_k (y_{ijk}-\bar{y}_{ij})^2\)</span></p></li>
<li><p>총제곱합 <span class="math inline">\(SST\)</span>는 <span class="math inline">\(A\)</span>요인 수준간의 변동 <span class="math inline">\(SSA\)</span>, <span class="math inline">\(B\)</span>요인 수준간의 변동
<span class="math inline">\(SSB\)</span>와 요인 <span class="math inline">\(A,B\)</span>의 교호작용에 의한 변동 <span class="math inline">\(SSAB\)</span>, 집단내의 변동
<span class="math inline">\(SSE\)</span>로 분해하여 얻어짐. 즉, <span class="math display">\[SST=SSA + SSB+SSAB+SSE\]</span></p></li>
<li><p>변동의 자유도</p></li>
<li><p><span class="math inline">\(SST\)</span>: <span class="math inline">\(abn-1\)</span></p></li>
<li><p><span class="math inline">\(SSA\)</span>: <span class="math inline">\(a-1\)</span>, <span class="math inline">\(SSB\)</span>: <span class="math inline">\(b-1\)</span></p></li>
<li><p><span class="math inline">\(SSAB\)</span>: <span class="math inline">\((a-1)(b-1)\)</span>, <span class="math inline">\(SSE\)</span>: <span class="math inline">\(ab(n-1)\)</span></p></li>
<li><p>평균제곱</p></li>
<li><p><span class="math inline">\(MSA\)</span>: <span class="math inline">\(SSA/(a-1)\)</span></p></li>
<li><p><span class="math inline">\(MSB\)</span>: <span class="math inline">\(SSB/(b-1)\)</span></p></li>
<li><p><span class="math inline">\(MSAB\)</span>: <span class="math inline">\(SSAB/((a-1)(b-1))\)</span></p></li>
<li><p><span class="math inline">\(MSE\)</span>: <span class="math inline">\(SSE/(ab(n-1))\)</span></p></li>
<li><p>검정통계량 <span class="math display">\[F_1=\frac{MSA}{MSE} \sim F_{(a-1,ab(n-1))}\]</span>
<span class="math display">\[F_2=\frac{MSB}{MSB} \sim F_{(b-1,ab(n-1))}\]</span>
<span class="math display">\[F_3=\frac{MSAB}{MSE} \sim F_{((a-1)(b-1),ab(n-1))}\]</span></p></li>
</ul>
<div id="교호작용" class="section level3" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> 교호작용</h3>
<ul>
<li><p>만약 요인 <span class="math inline">\(A\)</span>의 효과가 요인 <span class="math inline">\(B\)</span>의 수준에 따라 다르게 나타날 때(혹은
요인 <span class="math inline">\(B\)</span>의 효과가 요인 <span class="math inline">\(A\)</span>의 수준에 따라 다르게 나타날 때) 두
요인간에 교호작용(상호작용, interaction)이 있음</p></li>
<li><p>교호작용 예</p>
<p><img src="anova/f6.jpg" style="width:50.0%" /></p></li>
<li><p>이원배치 분산분석 검정 순서</p></li>
<li><p>교호작용이 유의한지 검정</p></li>
<li><p>만약, 교호작용이 유의하다면, 그대로 해석하고 분석 종료</p></li>
<li><p>혹은 두 요인의 수준을 조합하여 새로운 변수를 생성 후 일원배치
분산분석 시행</p></li>
<li><p>만약, 교호작용이 유의하지 않다면, 모형에서 교호작용 항을 제거하고
다시 분석</p></li>
</ul>
<p>세 종류의 호르몬 처리와 성별에 따라 혈액 칼슘 값에 차이가 있는지를
알아보기 위해 남녀 각 <span class="math inline">\(15\)</span>명씩을 선정하여 이들을 세 그룹으로 나누어 세
가지 호르몬 처리를 한 후 혈액 칼슘을 측정하였다. 호르몬 처리 및 성별에
따라 혈액 칼슘 값이 차이가 있는지 검정하라.</p>
<p><img src="anova/ex12.jpg" style="width:80.0%" /></p>
<p>SAS Code</p>
<p><img src="anova/ex13.jpg" style="width:50.0%" /></p>
<p><img src="anova/ex14_1.jpg" style="width:70.0%" /></p>
<p><img src="anova/ex14.jpg" style="width:60.0%" /></p>
<p><img src="anova/ex15.jpg" style="width:60.0%" /></p>
<p><img src="anova/ex16.jpg" style="width:70.0%" /></p>
<!-------------------------------------->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ttest.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nonpara.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rmanual.pdf", "rmanual.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
