<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 성향점수(propensity score) | Statistical Analysis</title>
  <meta name="description" content="This is a Statistical Analysis" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 성향점수(propensity score) | Statistical Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a Statistical Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 성향점수(propensity score) | Statistical Analysis" />
  
  <meta name="twitter:description" content="This is a Statistical Analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2023-02-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="glm.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>1</b> 평균차이 검정</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ttest.html"><a href="ttest.html#일표본-t-검정"><i class="fa fa-check"></i><b>1.1</b> 일표본 <span class="math inline">\(t\)</span>-검정</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="ttest.html"><a href="ttest.html#with-r"><i class="fa fa-check"></i><b>1.1.1</b> With R</a></li>
<li class="chapter" data-level="1.1.2" data-path="ttest.html"><a href="ttest.html#with-sas"><i class="fa fa-check"></i><b>1.1.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="ttest.html"><a href="ttest.html#독립표본-t-검정"><i class="fa fa-check"></i><b>1.2</b> 독립표본 <span class="math inline">\(t\)</span>-검정</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ttest.html"><a href="ttest.html#두-모분산-비의-검정"><i class="fa fa-check"></i><b>1.2.1</b> 두 모분산 비의 검정</a></li>
<li class="chapter" data-level="1.2.2" data-path="ttest.html"><a href="ttest.html#with-r-1"><i class="fa fa-check"></i><b>1.2.2</b> With R</a></li>
<li class="chapter" data-level="1.2.3" data-path="ttest.html"><a href="ttest.html#with-sas-1"><i class="fa fa-check"></i><b>1.2.3</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ttest.html"><a href="ttest.html#대응표본-t-검정"><i class="fa fa-check"></i><b>1.3</b> 대응표본 <span class="math inline">\(t\)</span>-검정</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="ttest.html"><a href="ttest.html#with-r-2"><i class="fa fa-check"></i><b>1.3.1</b> With R</a></li>
<li class="chapter" data-level="1.3.2" data-path="ttest.html"><a href="ttest.html#with-sas-2"><i class="fa fa-check"></i><b>1.3.2</b> with SAS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>2</b> 분산분석</a>
<ul>
<li class="chapter" data-level="2.1" data-path="anova.html"><a href="anova.html#분산분석"><i class="fa fa-check"></i><b>2.1</b> 분산분석</a></li>
<li class="chapter" data-level="2.2" data-path="anova.html"><a href="anova.html#일원배치-분산분석"><i class="fa fa-check"></i><b>2.2</b> 일원배치 분산분석</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="anova.html"><a href="anova.html#사후분석다중검정"><i class="fa fa-check"></i><b>2.2.1</b> 사후분석(다중검정)</a></li>
<li class="chapter" data-level="2.2.2" data-path="anova.html"><a href="anova.html#with-r-3"><i class="fa fa-check"></i><b>2.2.2</b> With R</a></li>
<li class="chapter" data-level="2.2.3" data-path="anova.html"><a href="anova.html#with-sas-3"><i class="fa fa-check"></i><b>2.2.3</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="anova.html"><a href="anova.html#이원배치-분산분석"><i class="fa fa-check"></i><b>2.3</b> 이원배치 분산분석</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="anova.html"><a href="anova.html#교호작용"><i class="fa fa-check"></i><b>2.3.1</b> 교호작용</a></li>
<li class="chapter" data-level="2.3.2" data-path="anova.html"><a href="anova.html#with-r-4"><i class="fa fa-check"></i><b>2.3.2</b> With R</a></li>
<li class="chapter" data-level="2.3.3" data-path="anova.html"><a href="anova.html#with-sas-4"><i class="fa fa-check"></i><b>2.3.3</b> With SAS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nonpara.html"><a href="nonpara.html"><i class="fa fa-check"></i><b>3</b> 비모수 검정</a>
<ul>
<li class="chapter" data-level="3.1" data-path="nonpara.html"><a href="nonpara.html#정규성-검정"><i class="fa fa-check"></i><b>3.1</b> 정규성 검정</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="nonpara.html"><a href="nonpara.html#with-r-5"><i class="fa fa-check"></i><b>3.1.1</b> With R</a></li>
<li class="chapter" data-level="3.1.2" data-path="nonpara.html"><a href="nonpara.html#with-sas-5"><i class="fa fa-check"></i><b>3.1.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="nonpara.html"><a href="nonpara.html#윌콕슨-부호순위-검정"><i class="fa fa-check"></i><b>3.2</b> 윌콕슨 부호순위 검정</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="nonpara.html"><a href="nonpara.html#with-r-6"><i class="fa fa-check"></i><b>3.2.1</b> With R</a></li>
<li class="chapter" data-level="3.2.2" data-path="nonpara.html"><a href="nonpara.html#with-sas-6"><i class="fa fa-check"></i><b>3.2.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="nonpara.html"><a href="nonpara.html#윌콕슨-순위합-검정"><i class="fa fa-check"></i><b>3.3</b> 윌콕슨 순위합 검정</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="nonpara.html"><a href="nonpara.html#with-r-7"><i class="fa fa-check"></i><b>3.3.1</b> With R</a></li>
<li class="chapter" data-level="3.3.2" data-path="nonpara.html"><a href="nonpara.html#with-sas-7"><i class="fa fa-check"></i><b>3.3.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="nonpara.html"><a href="nonpara.html#크루스칼-왈리스-검정"><i class="fa fa-check"></i><b>3.4</b> 크루스칼-왈리스 검정</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="nonpara.html"><a href="nonpara.html#with-r-8"><i class="fa fa-check"></i><b>3.4.1</b> With R</a></li>
<li class="chapter" data-level="3.4.2" data-path="nonpara.html"><a href="nonpara.html#with-sas-8"><i class="fa fa-check"></i><b>3.4.2</b> With SAS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="category.html"><a href="category.html"><i class="fa fa-check"></i><b>4</b> 분할표 검정</a>
<ul>
<li class="chapter" data-level="4.1" data-path="category.html"><a href="category.html#상대위험률과-오즈비"><i class="fa fa-check"></i><b>4.1</b> 상대위험률과 오즈비</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="category.html"><a href="category.html#상대위험률"><i class="fa fa-check"></i><b>4.1.1</b> 상대위험률</a></li>
<li class="chapter" data-level="4.1.2" data-path="category.html"><a href="category.html#오즈비"><i class="fa fa-check"></i><b>4.1.2</b> 오즈비</a></li>
<li class="chapter" data-level="4.1.3" data-path="category.html"><a href="category.html#with-r-9"><i class="fa fa-check"></i><b>4.1.3</b> With R</a></li>
<li class="chapter" data-level="4.1.4" data-path="category.html"><a href="category.html#with-sas-9"><i class="fa fa-check"></i><b>4.1.4</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="category.html"><a href="category.html#독립성-검정"><i class="fa fa-check"></i><b>4.2</b> 독립성 검정</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="category.html"><a href="category.html#with-r-10"><i class="fa fa-check"></i><b>4.2.1</b> With R</a></li>
<li class="chapter" data-level="4.2.2" data-path="category.html"><a href="category.html#with-sas-10"><i class="fa fa-check"></i><b>4.2.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="category.html"><a href="category.html#동질성-검정"><i class="fa fa-check"></i><b>4.3</b> 동질성 검정</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="category.html"><a href="category.html#with-r-11"><i class="fa fa-check"></i><b>4.3.1</b> With R</a></li>
<li class="chapter" data-level="4.3.2" data-path="category.html"><a href="category.html#with-sas-11"><i class="fa fa-check"></i><b>4.3.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="category.html"><a href="category.html#fisher의-정확-검정"><i class="fa fa-check"></i><b>4.4</b> Fisher의 정확 검정</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="category.html"><a href="category.html#with-r-12"><i class="fa fa-check"></i><b>4.4.1</b> With R</a></li>
<li class="chapter" data-level="4.4.2" data-path="category.html"><a href="category.html#with-sas-12"><i class="fa fa-check"></i><b>4.4.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="category.html"><a href="category.html#맥니마-검정"><i class="fa fa-check"></i><b>4.5</b> 맥니마 검정</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="category.html"><a href="category.html#이론적-배경"><i class="fa fa-check"></i><b>4.5.1</b> 이론적 배경</a></li>
<li class="chapter" data-level="4.5.2" data-path="category.html"><a href="category.html#with-r-13"><i class="fa fa-check"></i><b>4.5.2</b> With R</a></li>
<li class="chapter" data-level="4.5.3" data-path="category.html"><a href="category.html#with-sas-13"><i class="fa fa-check"></i><b>4.5.3</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="category.html"><a href="category.html#cochran-mantel-haenzel-test"><i class="fa fa-check"></i><b>4.6</b> Cochran-Mantel-Haenzel test</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="category.html"><a href="category.html#with-r-14"><i class="fa fa-check"></i><b>4.6.1</b> With R</a></li>
<li class="chapter" data-level="4.6.2" data-path="category.html"><a href="category.html#with-sas-14"><i class="fa fa-check"></i><b>4.6.2</b> With SAS</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="category.html"><a href="category.html#진단법의-평가"><i class="fa fa-check"></i><b>4.7</b> 진단법의 평가</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="category.html"><a href="category.html#민감도와-특이도"><i class="fa fa-check"></i><b>4.7.1</b> 민감도와 특이도</a></li>
<li class="chapter" data-level="4.7.2" data-path="category.html"><a href="category.html#양성예측도와-음성예측도"><i class="fa fa-check"></i><b>4.7.2</b> 양성예측도와 음성예측도</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>5</b> 회귀분석</a>
<ul>
<li class="chapter" data-level="5.1" data-path="regression.html"><a href="regression.html#상관분석"><i class="fa fa-check"></i><b>5.1</b> 상관분석</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="regression.html"><a href="regression.html#상관계수"><i class="fa fa-check"></i><b>5.1.1</b> 상관계수</a></li>
<li class="chapter" data-level="5.1.2" data-path="regression.html"><a href="regression.html#스피어만-상관계수"><i class="fa fa-check"></i><b>5.1.2</b> 스피어만 상관계수</a></li>
<li class="chapter" data-level="5.1.3" data-path="regression.html"><a href="regression.html#켄달의-타우"><i class="fa fa-check"></i><b>5.1.3</b> 켄달의 타우</a></li>
<li class="chapter" data-level="5.1.4" data-path="regression.html"><a href="regression.html#편상관계수"><i class="fa fa-check"></i><b>5.1.4</b> 편상관계수</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="regression.html"><a href="regression.html#단순선형회귀분석"><i class="fa fa-check"></i><b>5.2</b> 단순선형회귀분석</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="regression.html"><a href="regression.html#최소제곱법"><i class="fa fa-check"></i><b>5.2.1</b> 최소제곱법</a></li>
<li class="chapter" data-level="5.2.2" data-path="regression.html"><a href="regression.html#회귀계수-추정"><i class="fa fa-check"></i><b>5.2.2</b> 회귀계수 추정</a></li>
<li class="chapter" data-level="5.2.3" data-path="regression.html"><a href="regression.html#회귀계수-가설검정"><i class="fa fa-check"></i><b>5.2.3</b> 회귀계수 가설검정</a></li>
<li class="chapter" data-level="5.2.4" data-path="regression.html"><a href="regression.html#결정계수"><i class="fa fa-check"></i><b>5.2.4</b> 결정계수</a></li>
<li class="chapter" data-level="5.2.5" data-path="regression.html"><a href="regression.html#예제"><i class="fa fa-check"></i><b>5.2.5</b> 예제</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="regression.html"><a href="regression.html#다중선형회귀분석"><i class="fa fa-check"></i><b>5.3</b> 다중선형회귀분석</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="regression.html"><a href="regression.html#변수-선택"><i class="fa fa-check"></i><b>5.3.1</b> 변수 선택</a></li>
<li class="chapter" data-level="5.3.2" data-path="regression.html"><a href="regression.html#결정계수-1"><i class="fa fa-check"></i><b>5.3.2</b> 결정계수</a></li>
<li class="chapter" data-level="5.3.3" data-path="regression.html"><a href="regression.html#표준화-회귀계수"><i class="fa fa-check"></i><b>5.3.3</b> 표준화 회귀계수</a></li>
<li class="chapter" data-level="5.3.4" data-path="regression.html"><a href="regression.html#다중공선성"><i class="fa fa-check"></i><b>5.3.4</b> 다중공선성</a></li>
<li class="chapter" data-level="5.3.5" data-path="regression.html"><a href="regression.html#더미변수가변수"><i class="fa fa-check"></i><b>5.3.5</b> 더미변수(가변수)</a></li>
<li class="chapter" data-level="5.3.6" data-path="regression.html"><a href="regression.html#회귀모형에-대한-가정-검토"><i class="fa fa-check"></i><b>5.3.6</b> 회귀모형에 대한 가정 검토</a></li>
<li class="chapter" data-level="5.3.7" data-path="regression.html"><a href="regression.html#예제-1"><i class="fa fa-check"></i><b>5.3.7</b> 예제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>6</b> 일반화 선형모형</a>
<ul>
<li class="chapter" data-level="6.1" data-path="glm.html"><a href="glm.html#the-generalized-linear-models"><i class="fa fa-check"></i><b>6.1</b> The Generalized Linear models</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="glm.html"><a href="glm.html#the-general-linear-model"><i class="fa fa-check"></i><b>6.1.1</b> The General Linear Model</a></li>
<li class="chapter" data-level="6.1.2" data-path="glm.html"><a href="glm.html#generalized-linear-models-glms"><i class="fa fa-check"></i><b>6.1.2</b> Generalized Linear Models (GLMs)</a></li>
<li class="chapter" data-level="6.1.3" data-path="glm.html"><a href="glm.html#normal-glms-as-a-special-case"><i class="fa fa-check"></i><b>6.1.3</b> Normal GLMs as a Special Case</a></li>
<li class="chapter" data-level="6.1.4" data-path="glm.html"><a href="glm.html#modelling-binomial-data"><i class="fa fa-check"></i><b>6.1.4</b> Modelling Binomial Data</a></li>
<li class="chapter" data-level="6.1.5" data-path="glm.html"><a href="glm.html#modelling-poisson-data"><i class="fa fa-check"></i><b>6.1.5</b> Modelling Poisson Data</a></li>
<li class="chapter" data-level="6.1.6" data-path="glm.html"><a href="glm.html#transformation-vs.-glms"><i class="fa fa-check"></i><b>6.1.6</b> Transformation vs. GLMs</a></li>
<li class="chapter" data-level="6.1.7" data-path="glm.html"><a href="glm.html#exponential-family"><i class="fa fa-check"></i><b>6.1.7</b> Exponential Family</a></li>
<li class="chapter" data-level="6.1.8" data-path="glm.html"><a href="glm.html#canonical-links"><i class="fa fa-check"></i><b>6.1.8</b> Canonical Links</a></li>
<li class="chapter" data-level="6.1.9" data-path="glm.html"><a href="glm.html#estimation-of-the-model-parameters"><i class="fa fa-check"></i><b>6.1.9</b> Estimation of the Model Parameters</a></li>
<li class="chapter" data-level="6.1.10" data-path="glm.html"><a href="glm.html#distribution-and-link-function"><i class="fa fa-check"></i><b>6.1.10</b> Distribution and Link Function</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="glm.html"><a href="glm.html#medical-cost-data-analysis"><i class="fa fa-check"></i><b>6.2</b> Medical Cost Data Analysis</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="glm.html"><a href="glm.html#health-care-cost"><i class="fa fa-check"></i><b>6.2.1</b> health care cost</a></li>
<li class="chapter" data-level="6.2.2" data-path="glm.html"><a href="glm.html#regression-analysis-with-log-transformation"><i class="fa fa-check"></i><b>6.2.2</b> Regression analysis with log transformation</a></li>
<li class="chapter" data-level="6.2.3" data-path="glm.html"><a href="glm.html#gamma-generalized-linear-models"><i class="fa fa-check"></i><b>6.2.3</b> Gamma generalized linear models</a></li>
<li class="chapter" data-level="6.2.4" data-path="glm.html"><a href="glm.html#transformation-vs.-glms-1"><i class="fa fa-check"></i><b>6.2.4</b> Transformation vs. GLMs</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="glm.html"><a href="glm.html#binary-and-categorical-data-analysis"><i class="fa fa-check"></i><b>6.3</b> Binary and Categorical data Analysis</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="glm.html"><a href="glm.html#overview-of-logistic-regression-model"><i class="fa fa-check"></i><b>6.3.1</b> Overview of Logistic Regression Model</a></li>
<li class="chapter" data-level="6.3.2" data-path="glm.html"><a href="glm.html#binary-outcomes"><i class="fa fa-check"></i><b>6.3.2</b> Binary Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="glm.html"><a href="glm.html#poisson-regression"><i class="fa fa-check"></i><b>6.4</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="glm.html"><a href="glm.html#example-danish-lung-cancer-counts"><i class="fa fa-check"></i><b>6.4.1</b> Example: Danish Lung Cancer Counts</a></li>
<li class="chapter" data-level="6.4.2" data-path="glm.html"><a href="glm.html#what-about-accounting-for-population-size"><i class="fa fa-check"></i><b>6.4.2</b> What About Accounting for Population Size?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="psm.html"><a href="psm.html"><i class="fa fa-check"></i><b>7</b> 성향점수(propensity score)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="psm.html"><a href="psm.html#observational-study"><i class="fa fa-check"></i><b>7.1</b> Observational Study?</a>
<ul>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#randomized-controlled-trials-gold-standard"><i class="fa fa-check"></i>Randomized Controlled Trials ("gold standard")</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#characteristics-of-rcts"><i class="fa fa-check"></i>Characteristics of RCTs</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#what-is-observational-data"><i class="fa fa-check"></i>What is Observational Data?</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#confounding-due-to-selection-bias"><i class="fa fa-check"></i>Confounding due to Selection Bias</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#impact-of-selection-bias-on-analytic-inferences"><i class="fa fa-check"></i>Impact of Selection Bias on Analytic Inferences</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#statistical-adjustment-for-observational-data"><i class="fa fa-check"></i>Statistical Adjustment for Observational Data</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#addressing-selection-bias-with-exact-matching"><i class="fa fa-check"></i>Addressing Selection Bias with Exact Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#matching-on-specific-variables"><i class="fa fa-check"></i>Matching on Specific Variables</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#matching-on-specific-variables-1"><i class="fa fa-check"></i>Matching on Specific Variables</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="psm.html"><a href="psm.html#propensity-score"><i class="fa fa-check"></i><b>7.2</b> Propensity Score?</a>
<ul>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#general-procedure"><i class="fa fa-check"></i>General Procedure</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#choosing-variables-for-propensity-scores"><i class="fa fa-check"></i>Choosing Variables for Propensity Scores</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#calculate-propensity-score"><i class="fa fa-check"></i>Calculate Propensity Score</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#initial-checks-balance-across-groups"><i class="fa fa-check"></i>Initial Checks: Balance across Groups</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#check-balance-of-covariates"><i class="fa fa-check"></i>Check Balance of Covariates</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#assess-balance-with-standardized-differences"><i class="fa fa-check"></i>Assess Balance with Standardized Differences</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#balance-of-covariates-caution"><i class="fa fa-check"></i>Balance of Covariates: Caution</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#matching-and-weighting-strategies"><i class="fa fa-check"></i>Matching and Weighting Strategies</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#choices-when-matching-sample-by-propensity-score"><i class="fa fa-check"></i>Choices When Matching Sample by Propensity Score</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#which-strategy-to-chooose"><i class="fa fa-check"></i>Which Strategy to Chooose?</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#evaluate-balance-in-sample-matched-or-weighted"><i class="fa fa-check"></i>Evaluate Balance in Sample Matched or Weighted</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#visualization-of-standardized-differences"><i class="fa fa-check"></i>Visualization of Standardized Differences</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#plots-of-covariates-between-groups"><i class="fa fa-check"></i>Plots of Covariates between Groups</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="psm.html"><a href="psm.html#propensity-score-methods"><i class="fa fa-check"></i><b>7.3</b> Propensity Score Methods</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="psm.html"><a href="psm.html#propensity-score-matching"><i class="fa fa-check"></i><b>7.3.1</b> Propensity Score Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#general-procedure-for-propensity-score-matching"><i class="fa fa-check"></i>General Procedure for Propensity Score Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#greedy-matching"><i class="fa fa-check"></i>Greedy Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#mahalanobis-metric-matching"><i class="fa fa-check"></i>Mahalanobis Metric Matching</a></li>
<li class="chapter" data-level="7.3.2" data-path="psm.html"><a href="psm.html#stratification-using-propensity-score"><i class="fa fa-check"></i><b>7.3.2</b> Stratification using Propensity Score</a></li>
<li class="chapter" data-level="7.3.3" data-path="psm.html"><a href="psm.html#inverse-probability-of-treatment-weighting"><i class="fa fa-check"></i><b>7.3.3</b> Inverse Probability of Treatment Weighting</a></li>
<li class="chapter" data-level="7.3.4" data-path="psm.html"><a href="psm.html#propensity-score-adjustment-as-covariate"><i class="fa fa-check"></i><b>7.3.4</b> Propensity Score Adjustment as Covariate</a></li>
<li class="chapter" data-level="7.3.5" data-path="psm.html"><a href="psm.html#property-of-propensity-score"><i class="fa fa-check"></i><b>7.3.5</b> Property of Propensity Score</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#property-of-observational-studies"><i class="fa fa-check"></i>Property of Observational Studies</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="psm.html"><a href="psm.html#practice---sas"><i class="fa fa-check"></i><b>7.4</b> Practice - SAS</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="psm.html"><a href="psm.html#greedy-nearest-neighbor-matching"><i class="fa fa-check"></i><b>7.4.1</b> Greedy Nearest Neighbor Matching</a></li>
<li class="chapter" data-level="7.4.2" data-path="psm.html"><a href="psm.html#propensity-score-stratification"><i class="fa fa-check"></i><b>7.4.2</b> Propensity Score Stratification</a></li>
<li class="chapter" data-level="7.4.3" data-path="psm.html"><a href="psm.html#inverse-probability-treatment-weighting"><i class="fa fa-check"></i><b>7.4.3</b> Inverse Probability Treatment Weighting</a></li>
<li class="chapter" data-level="7.4.4" data-path="psm.html"><a href="psm.html#matching-with-existing-propensity-scores"><i class="fa fa-check"></i><b>7.4.4</b> Matching with Existing propensity scores</a></li>
<li class="chapter" data-level="7.4.5" data-path="psm.html"><a href="psm.html#matching-with-existing-propensity-scores-1"><i class="fa fa-check"></i><b>7.4.5</b> Matching with Existing propensity scores</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="psm" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> 성향점수(propensity score)<a href="psm.html#psm" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="observational-study" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Observational Study?<a href="psm.html#observational-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="randomized-controlled-trials-gold-standard" class="section level3 unnumbered hasAnchor">
<h3>Randomized Controlled Trials ("gold standard")<a href="psm.html#randomized-controlled-trials-gold-standard" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/f0.jpg" style="width:85.0%" /></p>
</div>
<div id="characteristics-of-rcts" class="section level3 unnumbered hasAnchor">
<h3>Characteristics of RCTs<a href="psm.html#characteristics-of-rcts" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Randomization ensures subjects in both treatment groups are equally
matched on all factors.</p></li>
<li><p>Allow causal inference.</p></li>
<li><p>High cost</p></li>
<li><p>Often short duration and/or underpowered.</p></li>
<li><p>Problems with generalizability:</p>
<ul>
<li><p>Treatment is "ideal" (high compliance, careful follow-up means
that any problems may be caught early).</p></li>
<li><p>Many people who are given the treatments in "real life" are
excluded from the trials.</p></li>
</ul></li>
<li><p>Some situations cannot be randomized.</p></li>
</ul>
</div>
<div id="what-is-observational-data" class="section level3 unnumbered hasAnchor">
<h3>What is Observational Data?<a href="psm.html#what-is-observational-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The choice of treatment is not under the control of the researcher - the
researcher can only ‘observe’ what treatment was given.<br />
Examples:</p>
<ul>
<li><p>Data obtained using chart review</p></li>
<li><p>Electronic medical records</p></li>
<li><p>Survey data or health study data</p></li>
<li><p>Administrative data</p></li>
<li><p>Insurance claims data</p></li>
</ul>
</div>
<div id="confounding-due-to-selection-bias" class="section level3 unnumbered hasAnchor">
<h3>Confounding due to Selection Bias<a href="psm.html#confounding-due-to-selection-bias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/f1.jpg" style="width:100.0%" /></p>
</div>
<div id="impact-of-selection-bias-on-analytic-inferences" class="section level3 unnumbered hasAnchor">
<h3>Impact of Selection Bias on Analytic Inferences<a href="psm.html#impact-of-selection-bias-on-analytic-inferences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/f2.jpg" style="width:100.0%" /></p>
</div>
<div id="statistical-adjustment-for-observational-data" class="section level3 unnumbered hasAnchor">
<h3>Statistical Adjustment for Observational Data<a href="psm.html#statistical-adjustment-for-observational-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Conventional multivariate analysis<br />
</p>
<ul>
<li>Multivariate regression analysis<br />
</li>
<li>Generalized linear model<br />
</li>
<li>Cox’s proportional hazards model<br />
</li>
<li>Conditional logistic regression<br />
</li>
<li>Generalize estimating equation</li>
</ul></li>
<li><p>Exact matching</p></li>
<li><p>Propensity score methods</p></li>
<li><p>And others</p></li>
</ul>
</div>
<div id="addressing-selection-bias-with-exact-matching" class="section level3 unnumbered hasAnchor">
<h3>Addressing Selection Bias with Exact Matching<a href="psm.html#addressing-selection-bias-with-exact-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Goal: Match patients so well that you could imagine that they were
randomly assigned to each group.</p></li>
<li><p>For each patient in the treatment group, find at least one untreated
patient from the comparison group who is identical or as similar as
possible on all baseline characteristics.</p></li>
<li><p>By matching patients at the individual level, the treatment and
comparison groups will be matched at the group level.</p></li>
</ul>
</div>
<div id="matching-on-specific-variables" class="section level3 unnumbered hasAnchor">
<h3>Matching on Specific Variables<a href="psm.html#matching-on-specific-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/f3.jpg" style="width:100.0%" /></p>
</div>
<div id="matching-on-specific-variables-1" class="section level3 unnumbered hasAnchor">
<h3>Matching on Specific Variables<a href="psm.html#matching-on-specific-variables-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/f4.jpg" style="width:100.0%" /></p>
</div>
</div>
<div id="propensity-score" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Propensity Score?<a href="psm.html#propensity-score" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Isn’t there an easier way?<br />
<span class="math inline">\(\rightarrow\)</span> Propensity score methods</p></li>
<li><p>Rosenbaum and Rubin (1983) realized the bias from covariates can be
eliminated by controlling for a scalar-valued funtion (a "balancing
score") calculated from the baseline covariates, i.e., the
propensity score.</p></li>
<li><p>The propensity score is a way of summarizing the information in all
the prognostic variables.</p></li>
<li><p>Create a single composite score of all observed, measured potential
confounders of the association between treatment and outcome</p></li>
<li><p>Propensity score is the conditional probability of treatment given
the observed covariates <span class="math inline">\(X\)</span> <span class="math display">\[PS = P(Z=1 | X)\]</span></p></li>
<li><p>Match or weight on this one-dimensional score alone.</p></li>
<li><p>Do this without knowledge of the outcome variable</p></li>
<li><p>Propensity score assumption</p></li>
<li><p>Given a set of covariates:<br />
</p>
<ul>
<li>Treatment assignment and outcome are independent<br />
</li>
<li>Everyone has a nonzero chance of receiving the treatment</li>
</ul></li>
<li><p>Propensity scores can:<br />
</p>
<ul>
<li>Help find matches from comparison group so that <strong>measured</strong>
confounders are equally distributed between treatment <span class="math inline">\(\&amp;\)</span>
comparison groups<br />
</li>
<li>Improve precision of treatment effect estimates</li>
</ul></li>
<li><p>Propensity scores cannot:<br />
</p>
<ul>
<li>Account for <strong>unmeasured</strong> and <strong>unmeasurable</strong> confounders</li>
</ul></li>
</ul>
<div id="general-procedure" class="section level3 unnumbered hasAnchor">
<h3>General Procedure<a href="psm.html#general-procedure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Choose variables to include in propensity score</p></li>
<li><p>Ensure that propensity score is balanced across treatment and
comparison groups</p></li>
<li><p>Ensure that covariates are balanced across treatment and comparison
groups within blocks of the propensity score</p></li>
<li><p>Choose a matching or weighting strategy</p></li>
<li><p>Ensure that covariates are balanced across treatment and comparison
groups in sample matched or weighted by propensity score</p></li>
<li><p>Proceed with analyses based on sample matched or weighted by
propensity score</p></li>
</ol>
</div>
<div id="choosing-variables-for-propensity-scores" class="section level3 unnumbered hasAnchor">
<h3>Choosing Variables for Propensity Scores<a href="psm.html#choosing-variables-for-propensity-scores" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Include:<br />

<ul>
<li>Theoretically related to treatment and outcome<br />
</li>
<li>Available <span class="math inline">\(\&amp;\)</span> easy/reliable to collect on everyone<br />
</li>
<li>Correlated with unmeasured confounders<br />
</li>
</ul></li>
<li>Do not include:<br />

<ul>
<li>Variables hypothesized to be associated with treatment but not
with outcome<br />
</li>
<li>Variables that may be affected by the treatment<br />
</li>
<li>Variables that predict treatment status perfectly</li>
</ul></li>
</ul>
</div>
<div id="calculate-propensity-score" class="section level3 unnumbered hasAnchor">
<h3>Calculate Propensity Score<a href="psm.html#calculate-propensity-score" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Maximum likelihood estimation<br />

<ul>
<li>Logistic regression<br />
</li>
<li>Probit regression<br />
</li>
<li>Discriminant analysis<br />
</li>
</ul></li>
<li>Generalized boosting methods<br />

<ul>
<li>Classification and regression trees (CART)<br />
</li>
<li>Neural networks</li>
</ul></li>
<li>Generalized method of moments (covariate balancing propensity score
(CBPS))</li>
</ul>
</div>
<div id="initial-checks-balance-across-groups" class="section level3 unnumbered hasAnchor">
<h3>Initial Checks: Balance across Groups<a href="psm.html#initial-checks-balance-across-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/f5.jpg" style="width:100.0%" /></p>
</div>
<div id="check-balance-of-covariates" class="section level3 unnumbered hasAnchor">
<h3>Check Balance of Covariates<a href="psm.html#check-balance-of-covariates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Ideally, for each unique value of the propensity score, the
distribution of <span class="math inline">\(X\)</span> (composite of all covariates) is the same for
the treatment and comparison groups.</p></li>
<li><p>This is practically impossible, so we check the balance of each
observed covariate within blocks of the propensity score.</p></li>
<li><p>Some imbalance between the groups is usually expected.</p></li>
<li><p>Focus on balance of covariates that are more theoretically
important.</p></li>
<li><p>Consider interactions/correlations between covariates.</p></li>
<li><p>Drop 1 or 2 covariates that are less important.</p></li>
<li><p>Re-categorize variables.</p></li>
<li><p>Include higher order terms or splines of variables.</p></li>
</ul>
</div>
<div id="assess-balance-with-standardized-differences" class="section level3 unnumbered hasAnchor">
<h3>Assess Balance with Standardized Differences<a href="psm.html#assess-balance-with-standardized-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Account for means and variances</p></li>
<li><p>Not sensitive to sample size</p></li>
<li><p>Do not use statistical test such as t-test.</p></li>
</ul>
<p><img src="psm/f6.jpg" style="width:100.0%" /></p>
</div>
<div id="balance-of-covariates-caution" class="section level3 unnumbered hasAnchor">
<h3>Balance of Covariates: Caution<a href="psm.html#balance-of-covariates-caution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Propensity scores only balance measured confounders.</p></li>
<li><p>Balance in measured variables does not indicate balance in
unmeasured variables.</p></li>
<li><p>Unmeasured confounders will bias treatment effect estimates.</p></li>
<li><p>Do not use c-statistics, area under the curve, or any other model
fit statistics to measure propensity score performance.<br />
</p>
<ul>
<li>They do not measure reduction in confounding.</li>
</ul></li>
</ul>
</div>
<div id="matching-and-weighting-strategies" class="section level3 unnumbered hasAnchor">
<h3>Matching and Weighting Strategies<a href="psm.html#matching-and-weighting-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/f7.jpg" style="width:100.0%" /></p>
</div>
<div id="choices-when-matching-sample-by-propensity-score" class="section level3 unnumbered hasAnchor">
<h3>Choices When Matching Sample by Propensity Score<a href="psm.html#choices-when-matching-sample-by-propensity-score" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>How close of a match is acceptable?</p></li>
<li><p>Should every treated individual have one or many matches in the
comparison group?</p></li>
<li><p>Should treated individuals be matched with or without replacement?</p></li>
<li><p>Should matching be greedy or optimal?</p></li>
</ul>
</div>
<div id="which-strategy-to-chooose" class="section level3 unnumbered hasAnchor">
<h3>Which Strategy to Chooose?<a href="psm.html#which-strategy-to-chooose" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>No best method</p></li>
<li><p>Without examining outcome, evaluate covariate balance in several
strategies.</p></li>
<li><p>Choose the method that has the best balance and still meets the
analytic goal.</p></li>
</ul>
</div>
<div id="evaluate-balance-in-sample-matched-or-weighted" class="section level3 unnumbered hasAnchor">
<h3>Evaluate Balance in Sample Matched or Weighted<a href="psm.html#evaluate-balance-in-sample-matched-or-weighted" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Standardized differences</p></li>
<li><p>Graphs<br />
</p>
<ul>
<li>Quantile-quantile plots<br />
</li>
<li>Plots of covariates in treated and comparison groups</li>
</ul></li>
<li><p>Ratios of variance</p></li>
</ul>
</div>
<div id="visualization-of-standardized-differences" class="section level3 unnumbered hasAnchor">
<h3>Visualization of Standardized Differences<a href="psm.html#visualization-of-standardized-differences" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/f8.jpg" style="width:90.0%" /></p>
</div>
<div id="plots-of-covariates-between-groups" class="section level3 unnumbered hasAnchor">
<h3>Plots of Covariates between Groups<a href="psm.html#plots-of-covariates-between-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Plot density of weighted continuous covariate in treated group
against density in comparison group</p></li>
<li><p>Subjective comparison</p></li>
</ul>
<p><img src="psm/f9.jpg" style="width:60.0%" /></p>
</div>
</div>
<div id="propensity-score-methods" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Propensity Score Methods<a href="psm.html#propensity-score-methods" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="propensity-score-matching" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Propensity Score Matching<a href="psm.html#propensity-score-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Create a matched sample based on logit(PS)</p></li>
<li><p>Assess balance between treated and untreated subjects in the matched
sample.<br />
</p>
<ul>
<li>The test of a good propensity score model is how well it balances
the measured variables between treated and untreated subjects.</li>
</ul></li>
<li><p>For unbalanced variables, add interactions or higher order terms to
the propensity score logistic regression, recalculate the propensity
score and repeat the process.</p></li>
</ol>
</div>
<div id="general-procedure-for-propensity-score-matching" class="section level3 unnumbered hasAnchor">
<h3>General Procedure for Propensity Score Matching<a href="psm.html#general-procedure-for-propensity-score-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/f10.jpg" style="width:100.0%" /></p>
</div>
<div id="greedy-matching" class="section level3 unnumbered hasAnchor">
<h3>Greedy Matching<a href="psm.html#greedy-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Nearest neighbor: <span class="math inline">\(C(P_i)=min_j |P_i-P_j|, \,\,\, j\in I_0\)</span><br />
</p>
<ul>
<li>The nonparticipant with the value of <span class="math inline">\(P_j\)</span> that is closest to
<span class="math inline">\(P_i\)</span> is selected as the match.</li>
</ul></li>
<li><p>Caliper: A variation of nearest neighbor: A match for persion <span class="math inline">\(i\)</span> is
selected only if <span class="math inline">\(|P_i-P_j|&lt;\epsilon, \,\,\, j\in I_0\)</span> where
<span class="math inline">\(\epsilon\)</span> is a pre-specified tolerance. Recommended caliper size:
<span class="math inline">\(0.25\sigma_p\)</span>.</p></li>
<li><p>1-to-1 Nearest neighbor within caliper (common practice)</p></li>
<li><p>1-to-n Nearest neighbor within caliper</p></li>
</ul>
</div>
<div id="mahalanobis-metric-matching" class="section level3 unnumbered hasAnchor">
<h3>Mahalanobis Metric Matching<a href="psm.html#mahalanobis-metric-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Mahalanobis without PS: Randomly ordering subjects, calculate the
distance between the first participant and all nonparticipants. The
distance, <span class="math inline">\(d(i,j)\)</span> can be defined by the Mahalanobis distance
<span class="math display">\[d(i,j)=(u-v)^TC^{-1}(u-v)\]</span> where <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are values of the
matching variables for participant <span class="math inline">\(i\)</span> and nonparticipant <span class="math inline">\(j\)</span>, and
<span class="math inline">\(C\)</span> is the sample covariance matrix of the matching variables from
the full set of nonparticipants.</p></li>
<li><p>Mahalanobis metric matching with PS added (to <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>).</p></li>
<li><p>Nearest available Mahalanobis metric matching within calipers
defined by the prepensity score.</p></li>
</ul>
</div>
<div id="stratification-using-propensity-score" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Stratification using Propensity Score<a href="psm.html#stratification-using-propensity-score" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>PS stratification splits the dataset into several strata on the
basis of the individual’s PS alone, without reference to treatment
(exposure) group.</p></li>
<li><p>A treatment effect is then estimated within each stratum, and an
overall estimated treatment effect is calculated by taking a
(weighted) average across strata.</p></li>
<li><p>Equal number of individuals in each stratum (5 or 10 strata).</p></li>
<li><p>Alternatively, split the range of possible PS into equal parts -
fewer individuals in the more extreme strata.</p></li>
<li><p>Advantage: potential heterogeneity of "treatment" effects across
strata.</p></li>
</ul>
</div>
<div id="inverse-probability-of-treatment-weighting" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Inverse Probability of Treatment Weighting<a href="psm.html#inverse-probability-of-treatment-weighting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Uses the whole dataset but reweights individuals to increase the
weights of those who received unexpected exposures.</p></li>
<li><p>This procedure can be thought of as producing additional
observations for those parts of the target population from which
there were few observations.</p></li>
<li><p>It effectively generates a pseudopopulation with near-perfect
covariate balance between treatment groups.</p></li>
<li><p>Propensity score close to 0 (for the treated) or 1 (for the control)
may be problematic for IPTW - trimming or truncating large weights.</p></li>
<li><p>The weights:<br />
<span class="math display">\[W = \frac{Z}{PS} + \frac{1-Z}{1-PS}\]</span> where <span class="math inline">\(Z=1\)</span> for the
treatment group and 0 for the control group.<br />
</p></li>
<li><p>Treatment group:<br />
<span class="math display">\[W = \frac{1}{PS}\]</span> weight = 1/(probability of receiving
treatment)<br />
</p></li>
<li><p>Control group:<br />
<span class="math display">\[W = \frac{1}{1-PS}\]</span> weight = 1/(1-probability of receiving
treatment)</p></li>
</ul>
</div>
<div id="propensity-score-adjustment-as-covariate" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Propensity Score Adjustment as Covariate<a href="psm.html#propensity-score-adjustment-as-covariate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Including the PS as an additional covariate in the regression model.</p></li>
<li><p>Alternatively, one could have only the PS and treatment in a model
of the outcome of interest.</p></li>
<li><p>Showed excellent agreement across all PS methods and covariate
adjustment.</p></li>
</ul>
<p><img src="psm/f11.jpg" style="width:60.0%" /></p>
<ul>
<li><p>Covariate adjustment, matching, IPTW, and use of the PS as a
covariate all showed similar results.</p></li>
<li><p>Stratification showed a wider CI with 5 strata and an unstable
results with 10 strata.</p></li>
</ul>
<p><img src="psm/f12.jpg" style="width:50.0%" /></p>
<ul>
<li><p>Different PS methods and covariate adjustment mostly produced
similar results.</p></li>
<li><p>IPTW: smaller treatment effect with a wider CI - trimming,
truncating, doubly robust</p></li>
</ul>
<p><img src="psm/f13.jpg" style="width:50.0%" /></p>
<ul>
<li>Showed substantial disagreement between the methods, although the
results were nonsignificant for almost all methods.</li>
</ul>
<p><img src="psm/f14.jpg" style="width:50.0%" /></p>
<ul>
<li><p>PS matching appears to be a reliable method, in that it provides
excellent covariate balance in most circumstances.</p></li>
<li><p>PS stratification tends to work well when covariate imbalance is not
very marked.</p></li>
<li><p>Inverse probability weighting offers a conceptually simple method
that is easy to implement in practice and retains all study
participants.</p></li>
<li><p>Covariate adjustment is the conventional method for correcting for
covariate imbalance, selection bias, and potential confounding and
provided reliable and statistically efficient estimates. Adding the
PS as an additional covariate produces results very similar to
covariate adjustment.</p></li>
</ul>
</div>
<div id="property-of-propensity-score" class="section level3 hasAnchor" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> Property of Propensity Score<a href="psm.html#property-of-propensity-score" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Available data is probably missing key covariates (e.g., living
arrangements, smoling history)</p></li>
<li><p>Definition of the baseline time may be difficult (it suhould be the
time at which the decision about treatment was made).</p></li>
<li><p>Reduced dimensionality of covariates (important for rare outcomes)</p></li>
<li><p>Can demonstrate that the two groups are similar on all measured
covariates</p></li>
</ul>
</div>
<div id="property-of-observational-studies" class="section level3 unnumbered hasAnchor">
<h3>Property of Observational Studies<a href="psm.html#property-of-observational-studies" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Researcher has no control over assignment of subjects to treatments.</p></li>
<li><p>Researcher often has no control over what covariates are available,
their definitions, or the quality of their measurement.</p></li>
<li><p>Useful when it is not feasible to use an RCT<br />
</p>
<ul>
<li>Unethical to withhold treatment<br />
</li>
<li>Exposure believed to be harmful<br />
</li>
<li>Patients will not agree to be randomized<br />
</li>
<li>RCT too expensive</li>
</ul></li>
<li><p>Generalizable (all patients, all providers)</p></li>
<li><p>Allows studies of rare events, and studies with long follow-up times</p></li>
</ul>
</div>
</div>
<div id="practice---sas" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Practice - SAS<a href="psm.html#practice---sas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="greedy-nearest-neighbor-matching" class="section level3 hasAnchor" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Greedy Nearest Neighbor Matching<a href="psm.html#greedy-nearest-neighbor-matching" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>ods graphics on;\
proc psmatch data=bb.School region=treated;\
class Music Gender;\
psmodel Music(Treated=&#39;Yes&#39;)= Gender Absence;\
match method=greedy(k=2) caliper=0.25;\
assess ps var=(Gender Absence) / plots=all weight=none;\
output out(obs=match)=matchdata matchid=MatchID;\
run;\

proc sort data=matchdata;\
by matchid;\
run;</code></pre>
<p>Examples: PSMATCH Procedure<br />
"<a href="https://documentation.sas.com/?docsetId=statug&amp;docsetVersion=14.2\" class="uri">https://documentation.sas.com/?docsetId=statug&amp;docsetVersion=14.2\</a>
&amp;docsetTarget=statug_psmatch_examples.htm&amp;locale=ko"</p>
<p><img src="psm/p1.jpg" style="width:80.0%" /></p>
</div>
<div id="propensity-score-stratification" class="section level3 hasAnchor" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Propensity Score Stratification<a href="psm.html#propensity-score-stratification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>proc psmatch data=bb.drugs region=allobs;\
class Drug Gender;\
psmodel Drug(Treated=&#39;Drug\_X&#39;)= Gender Age Bmi;\
strata nstrata=5;\
assess ps var=(Gender Age Bmi) / varinfo plots=(boxplot barchart);\
output out(obs=all)=OutEx2;\
run;</code></pre>
<p><img src="psm/p2.jpg" style="width:80.0%" /></p>
</div>
<div id="inverse-probability-treatment-weighting" class="section level3 hasAnchor" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Inverse Probability Treatment Weighting<a href="psm.html#inverse-probability-treatment-weighting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>proc psmatch data=bb.drugs region=allobs;\
class Drug Gender;\
psmodel Drug(Treated=&#39;Drug\_X&#39;)= Gender Age Bmi;\
assess lps var=(Gender Age Bmi) / varinfo plots=(boxplot barchart)
weight=atewgt;\
output out(obs=all)=OutEx1 atewgt=atewgt;\
run;</code></pre>
<p><img src="psm/p3.jpg" style="width:80.0%" /></p>
</div>
<div id="matching-with-existing-propensity-scores" class="section level3 hasAnchor" number="7.4.4">
<h3><span class="header-section-number">7.4.4</span> Matching with Existing propensity scores<a href="psm.html#matching-with-existing-propensity-scores" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<pre><code>ods select none;\
proc logistic data=bb.drugs;\
class Drug Gender;\
model Drug(Event=&#39;Drug\_X&#39;)= Gender Age Bmi / link=cloglog;\
output out=drug1 p=pscore;\
run;\</code></pre>
<pre><code>ods select all;\
proc psmatch data=Drug1 region=cs;\
class Drug Gender;\
psdata treatvar=Drug(Treated=&#39;Drug\_X&#39;) ps=pscore;\
match method=optimal(k=1) exact=Gender stat=lps caliper=0.5;\
assess lps var=(Gender Age Bmi) / weight=none;\
output out(obs=match)=OutEx7 lps=\_Lps matchid=\_MatchID;\
run;</code></pre>
</div>
<div id="matching-with-existing-propensity-scores-1" class="section level3 hasAnchor" number="7.4.5">
<h3><span class="header-section-number">7.4.5</span> Matching with Existing propensity scores<a href="psm.html#matching-with-existing-propensity-scores-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="psm/p4.jpg" style="width:80.0%" /></p>
<!-------------------------------------->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glm.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Statistical Analysis.pdf", "Statistical Analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
