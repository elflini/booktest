<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 생존분석 | Statistical Analysis</title>
  <meta name="description" content="This is a Statistical Analysis" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 생존분석 | Statistical Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a Statistical Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 생존분석 | Statistical Analysis" />
  
  <meta name="twitter:description" content="This is a Statistical Analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2021-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="glm.html"/>
<link rel="next" href="psm.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="ttest.html"><a href="ttest.html"><i class="fa fa-check"></i><b>1</b> 평균차이 검정</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ttest.html"><a href="ttest.html#일표본-t-검정"><i class="fa fa-check"></i><b>1.1</b> 일표본 <span class="math inline">\(t\)</span>-검정</a></li>
<li class="chapter" data-level="1.2" data-path="ttest.html"><a href="ttest.html#독립표본-t-검정"><i class="fa fa-check"></i><b>1.2</b> 독립표본 <span class="math inline">\(t\)</span>-검정</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="ttest.html"><a href="ttest.html#두-모분산-비의-검정"><i class="fa fa-check"></i><b>1.2.1</b> 두 모분산 비의 검정</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="ttest.html"><a href="ttest.html#대응표본-t-검정"><i class="fa fa-check"></i><b>1.3</b> 대응표본 <span class="math inline">\(t\)</span>-검정</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>2</b> 분산분석</a>
<ul>
<li class="chapter" data-level="2.1" data-path="anova.html"><a href="anova.html#분산분석"><i class="fa fa-check"></i><b>2.1</b> 분산분석</a></li>
<li class="chapter" data-level="2.2" data-path="anova.html"><a href="anova.html#일원배치-분산분석"><i class="fa fa-check"></i><b>2.2</b> 일원배치 분산분석</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="anova.html"><a href="anova.html#사후분석다중검정"><i class="fa fa-check"></i><b>2.2.1</b> 사후분석(다중검정)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="anova.html"><a href="anova.html#이원배치-분산분석"><i class="fa fa-check"></i><b>2.3</b> 이원배치 분산분석</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="anova.html"><a href="anova.html#교호작용"><i class="fa fa-check"></i><b>2.3.1</b> 교호작용</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="nonpara.html"><a href="nonpara.html"><i class="fa fa-check"></i><b>3</b> 비모수 검정</a>
<ul>
<li class="chapter" data-level="3.1" data-path="nonpara.html"><a href="nonpara.html#정규성-검정"><i class="fa fa-check"></i><b>3.1</b> 정규성 검정</a></li>
<li class="chapter" data-level="3.2" data-path="nonpara.html"><a href="nonpara.html#윌콕슨-부호순위-검정"><i class="fa fa-check"></i><b>3.2</b> 윌콕슨 부호순위 검정</a></li>
<li class="chapter" data-level="3.3" data-path="nonpara.html"><a href="nonpara.html#윌콕슨-순위합-검정"><i class="fa fa-check"></i><b>3.3</b> 윌콕슨 순위합 검정</a></li>
<li class="chapter" data-level="3.4" data-path="nonpara.html"><a href="nonpara.html#크루스칼-왈리스-검정"><i class="fa fa-check"></i><b>3.4</b> 크루스칼-왈리스 검정</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="category.html"><a href="category.html"><i class="fa fa-check"></i><b>4</b> 교차분석</a>
<ul>
<li class="chapter" data-level="4.1" data-path="category.html"><a href="category.html#상대위험률과-오즈비"><i class="fa fa-check"></i><b>4.1</b> 상대위험률과 오즈비</a></li>
<li class="chapter" data-level="4.2" data-path="category.html"><a href="category.html#독립성-검정"><i class="fa fa-check"></i><b>4.2</b> 독립성 검정</a></li>
<li class="chapter" data-level="4.3" data-path="category.html"><a href="category.html#동질성-검정"><i class="fa fa-check"></i><b>4.3</b> 동질성 검정</a></li>
<li class="chapter" data-level="4.4" data-path="category.html"><a href="category.html#fisher의-정확-검정"><i class="fa fa-check"></i><b>4.4</b> Fisher의 정확 검정</a></li>
<li class="chapter" data-level="4.5" data-path="category.html"><a href="category.html#맥니마-검정"><i class="fa fa-check"></i><b>4.5</b> 맥니마 검정</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>5</b> 회귀분석</a>
<ul>
<li class="chapter" data-level="5.1" data-path="regression.html"><a href="regression.html#상관분석"><i class="fa fa-check"></i><b>5.1</b> 상관분석</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="regression.html"><a href="regression.html#상관계수"><i class="fa fa-check"></i><b>5.1.1</b> 상관계수</a></li>
<li class="chapter" data-level="5.1.2" data-path="regression.html"><a href="regression.html#스피어만-상관계수"><i class="fa fa-check"></i><b>5.1.2</b> 스피어만 상관계수</a></li>
<li class="chapter" data-level="5.1.3" data-path="regression.html"><a href="regression.html#켄달의-타우"><i class="fa fa-check"></i><b>5.1.3</b> 켄달의 타우</a></li>
<li class="chapter" data-level="5.1.4" data-path="regression.html"><a href="regression.html#편상관계수"><i class="fa fa-check"></i><b>5.1.4</b> 1.3 편상관계수</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="regression.html"><a href="regression.html#단순선형회귀분석"><i class="fa fa-check"></i><b>5.2</b> 단순선형회귀분석</a></li>
<li class="chapter" data-level="5.3" data-path="regression.html"><a href="regression.html#다중선형회귀분석"><i class="fa fa-check"></i><b>5.3</b> 다중선형회귀분석</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="regression.html"><a href="regression.html#변수-선택"><i class="fa fa-check"></i><b>5.3.1</b> 변수 선택</a></li>
<li class="chapter" data-level="5.3.2" data-path="regression.html"><a href="regression.html#결정계수"><i class="fa fa-check"></i><b>5.3.2</b> 결정계수</a></li>
<li class="chapter" data-level="5.3.3" data-path="regression.html"><a href="regression.html#표준화-회귀계수"><i class="fa fa-check"></i><b>5.3.3</b> 표준화 회귀계수</a></li>
<li class="chapter" data-level="5.3.4" data-path="regression.html"><a href="regression.html#다중공선성"><i class="fa fa-check"></i><b>5.3.4</b> 다중공선성</a></li>
<li class="chapter" data-level="5.3.5" data-path="regression.html"><a href="regression.html#더미변수가변수"><i class="fa fa-check"></i><b>5.3.5</b> 더미변수(가변수)</a></li>
<li class="chapter" data-level="5.3.6" data-path="regression.html"><a href="regression.html#회귀모형에-대한-가정-검토"><i class="fa fa-check"></i><b>5.3.6</b> 회귀모형에 대한 가정 검토</a></li>
<li class="chapter" data-level="5.3.7" data-path="regression.html"><a href="regression.html#다중선형회귀분석---모든-변수를-다-사용하는-경우"><i class="fa fa-check"></i><b>5.3.7</b> 다중선형회귀분석 - 모든 변수를 다 사용하는 경우</a></li>
<li class="chapter" data-level="5.3.8" data-path="regression.html"><a href="regression.html#다중선형회귀분석---단계적-선택법을-사용하는-경우"><i class="fa fa-check"></i><b>5.3.8</b> 다중선형회귀분석 - 단계적 선택법을 사용하는 경우</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>6</b> 일반화 선형모형</a>
<ul>
<li class="chapter" data-level="6.1" data-path="glm.html"><a href="glm.html#the-generalized-linear-models"><i class="fa fa-check"></i><b>6.1</b> The Generalized Linear models</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="glm.html"><a href="glm.html#the-general-linear-model"><i class="fa fa-check"></i><b>6.1.1</b> The General Linear Model</a></li>
<li class="chapter" data-level="6.1.2" data-path="glm.html"><a href="glm.html#generalized-linear-models-glms"><i class="fa fa-check"></i><b>6.1.2</b> Generalized Linear Models (GLMs)</a></li>
<li class="chapter" data-level="6.1.3" data-path="glm.html"><a href="glm.html#normal-glms-as-a-special-case"><i class="fa fa-check"></i><b>6.1.3</b> Normal GLMs as a Special Case</a></li>
<li class="chapter" data-level="6.1.4" data-path="glm.html"><a href="glm.html#modelling-binomial-data"><i class="fa fa-check"></i><b>6.1.4</b> Modelling Binomial Data</a></li>
<li class="chapter" data-level="6.1.5" data-path="glm.html"><a href="glm.html#modelling-poisson-data"><i class="fa fa-check"></i><b>6.1.5</b> Modelling Poisson Data</a></li>
<li class="chapter" data-level="6.1.6" data-path="glm.html"><a href="glm.html#transformation-vs.-glms"><i class="fa fa-check"></i><b>6.1.6</b> Transformation vs. GLMs</a></li>
<li class="chapter" data-level="6.1.7" data-path="glm.html"><a href="glm.html#exponential-family"><i class="fa fa-check"></i><b>6.1.7</b> Exponential Family</a></li>
<li class="chapter" data-level="6.1.8" data-path="glm.html"><a href="glm.html#canonical-links"><i class="fa fa-check"></i><b>6.1.8</b> Canonical Links</a></li>
<li class="chapter" data-level="6.1.9" data-path="glm.html"><a href="glm.html#estimation-of-the-model-parameters"><i class="fa fa-check"></i><b>6.1.9</b> Estimation of the Model Parameters</a></li>
<li class="chapter" data-level="6.1.10" data-path="glm.html"><a href="glm.html#distribution-and-link-function"><i class="fa fa-check"></i><b>6.1.10</b> Distribution and Link Function</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="glm.html"><a href="glm.html#poisson-regression"><i class="fa fa-check"></i><b>6.2</b> Poisson Regression</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="glm.html"><a href="glm.html#example-danish-lung-cancer-counts"><i class="fa fa-check"></i><b>6.2.1</b> Example: Danish Lung Cancer Counts</a></li>
<li class="chapter" data-level="6.2.2" data-path="glm.html"><a href="glm.html#what-about-accounting-for-population-size"><i class="fa fa-check"></i><b>6.2.2</b> What About Accounting for Population Size?</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="glm.html"><a href="glm.html#logistic-regression"><i class="fa fa-check"></i><b>6.3</b> Logistic regression</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="survival.html"><a href="survival.html"><i class="fa fa-check"></i><b>7</b> 생존분석</a>
<ul>
<li class="chapter" data-level="7.1" data-path="survival.html"><a href="survival.html#생존분석"><i class="fa fa-check"></i><b>7.1</b> 생존분석</a></li>
<li class="chapter" data-level="7.2" data-path="survival.html"><a href="survival.html#비모수적-생존함수-추정"><i class="fa fa-check"></i><b>7.2</b> 비모수적 생존함수 추정</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="survival.html"><a href="survival.html#생명표-방법"><i class="fa fa-check"></i><b>7.2.1</b> 생명표 방법</a></li>
<li class="chapter" data-level="7.2.2" data-path="survival.html"><a href="survival.html#누적한계추정법"><i class="fa fa-check"></i><b>7.2.2</b> 누적한계추정법</a></li>
<li class="chapter" data-level="7.2.3" data-path="survival.html"><a href="survival.html#생존분포-비교"><i class="fa fa-check"></i><b>7.2.3</b> 생존분포 비교</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="survival.html"><a href="survival.html#모수적-생존함수-추정과-회귀모형"><i class="fa fa-check"></i><b>7.3</b> 모수적 생존함수 추정과 회귀모형</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="survival.html"><a href="survival.html#지수분포"><i class="fa fa-check"></i><b>7.3.1</b> 지수분포</a></li>
<li class="chapter" data-level="7.3.2" data-path="survival.html"><a href="survival.html#와이블분포"><i class="fa fa-check"></i><b>7.3.2</b> 와이블분포</a></li>
<li class="chapter" data-level="7.3.3" data-path="survival.html"><a href="survival.html#감마분포"><i class="fa fa-check"></i><b>7.3.3</b> 감마분포</a></li>
<li class="chapter" data-level="7.3.4" data-path="survival.html"><a href="survival.html#로그정규분포"><i class="fa fa-check"></i><b>7.3.4</b> 로그정규분포</a></li>
<li class="chapter" data-level="7.3.5" data-path="survival.html"><a href="survival.html#로그로지스틱분포"><i class="fa fa-check"></i><b>7.3.5</b> 로그로지스틱분포</a></li>
<li class="chapter" data-level="7.3.6" data-path="survival.html"><a href="survival.html#곰페르츠분포"><i class="fa fa-check"></i><b>7.3.6</b> 곰페르츠분포</a></li>
<li class="chapter" data-level="7.3.7" data-path="survival.html"><a href="survival.html#회귀모형aft"><i class="fa fa-check"></i><b>7.3.7</b> 회귀모형(AFT)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="survival.html"><a href="survival.html#cox-비례위험모형"><i class="fa fa-check"></i><b>7.4</b> Cox 비례위험모형</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="survival.html"><a href="survival.html#시간에-따라-변화하는-공변량이-있을-경우"><i class="fa fa-check"></i><b>7.4.1</b> 시간에 따라 변화하는 공변량이 있을 경우</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="survival.html"><a href="survival.html#경쟁위험모형"><i class="fa fa-check"></i><b>7.5</b> 경쟁위험모형</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="survival.html"><a href="survival.html#원인별-누적발생함수"><i class="fa fa-check"></i><b>7.5.1</b> 원인별 누적발생함수</a></li>
<li class="chapter" data-level="7.5.2" data-path="survival.html"><a href="survival.html#원인별-위험함수"><i class="fa fa-check"></i><b>7.5.2</b> 원인별 위험함수</a></li>
<li class="chapter" data-level="7.5.3" data-path="survival.html"><a href="survival.html#누적발생함수에-대한-회귀분석"><i class="fa fa-check"></i><b>7.5.3</b> 누적발생함수에 대한 회귀분석</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="survival.html"><a href="survival.html#sas-실습"><i class="fa fa-check"></i><b>7.6</b> SAS 실습</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="survival.html"><a href="survival.html#생명표-방법-1"><i class="fa fa-check"></i><b>7.6.1</b> 생명표 방법</a></li>
<li class="chapter" data-level="7.6.2" data-path="survival.html"><a href="survival.html#누적한계추정법-1"><i class="fa fa-check"></i><b>7.6.2</b> 누적한계추정법</a></li>
<li class="chapter" data-level="7.6.3" data-path="survival.html"><a href="survival.html#생존분포-비교-1"><i class="fa fa-check"></i><b>7.6.3</b> 생존분포 비교</a></li>
<li class="chapter" data-level="7.6.4" data-path="survival.html"><a href="survival.html#parametric-model"><i class="fa fa-check"></i><b>7.6.4</b> Parametric Model</a></li>
<li class="chapter" data-level="7.6.5" data-path="survival.html"><a href="survival.html#aft-model"><i class="fa fa-check"></i><b>7.6.5</b> AFT model</a></li>
<li class="chapter" data-level="7.6.6" data-path="survival.html"><a href="survival.html#cox-비례위험모형-1"><i class="fa fa-check"></i><b>7.6.6</b> Cox 비례위험모형</a></li>
<li class="chapter" data-level="7.6.7" data-path="survival.html"><a href="survival.html#cox-비례위험모형---time-dependent-covariate"><i class="fa fa-check"></i><b>7.6.7</b> Cox 비례위험모형 - time dependent covariate</a></li>
<li class="chapter" data-level="7.6.8" data-path="survival.html"><a href="survival.html#competing-risks"><i class="fa fa-check"></i><b>7.6.8</b> Competing Risks</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="psm.html"><a href="psm.html"><i class="fa fa-check"></i><b>8</b> 성향점수(propensity score)</a>
<ul>
<li class="chapter" data-level="8.1" data-path="psm.html"><a href="psm.html#observational-study"><i class="fa fa-check"></i><b>8.1</b> Observational Study?</a>
<ul>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#randomized-controlled-trials-gold-standard"><i class="fa fa-check"></i>Randomized Controlled Trials ("gold standard")</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#characteristics-of-rcts"><i class="fa fa-check"></i>Characteristics of RCTs</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#what-is-observational-data"><i class="fa fa-check"></i>What is Observational Data?</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#confounding-due-to-selection-bias"><i class="fa fa-check"></i>Confounding due to Selection Bias</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#impact-of-selection-bias-on-analytic-inferences"><i class="fa fa-check"></i>Impact of Selection Bias on Analytic Inferences</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#statistical-adjustment-for-observational-data"><i class="fa fa-check"></i>Statistical Adjustment for Observational Data</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#addressing-selection-bias-with-exact-matching"><i class="fa fa-check"></i>Addressing Selection Bias with Exact Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#matching-on-specific-variables"><i class="fa fa-check"></i>Matching on Specific Variables</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#matching-on-specific-variables-1"><i class="fa fa-check"></i>Matching on Specific Variables</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="psm.html"><a href="psm.html#propensity-score"><i class="fa fa-check"></i><b>8.2</b> Propensity Score?</a>
<ul>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#general-procedure"><i class="fa fa-check"></i>General Procedure</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#choosing-variables-for-propensity-scores"><i class="fa fa-check"></i>Choosing Variables for Propensity Scores</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#calculate-propensity-score"><i class="fa fa-check"></i>Calculate Propensity Score</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#initial-checks-balance-across-groups"><i class="fa fa-check"></i>Initial Checks: Balance across Groups</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#check-balance-of-covariates"><i class="fa fa-check"></i>Check Balance of Covariates</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#assess-balance-with-standardized-differences"><i class="fa fa-check"></i>Assess Balance with Standardized Differences</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#balance-of-covariates-caution"><i class="fa fa-check"></i>Balance of Covariates: Caution</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#matching-and-weighting-strategies"><i class="fa fa-check"></i>Matching and Weighting Strategies</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#choices-when-matching-sample-by-propensity-score"><i class="fa fa-check"></i>Choices When Matching Sample by Propensity Score</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#which-strategy-to-chooose"><i class="fa fa-check"></i>Which Strategy to Chooose?</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#evaluate-balance-in-sample-matched-or-weighted"><i class="fa fa-check"></i>Evaluate Balance in Sample Matched or Weighted</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#visualization-of-standardized-differences"><i class="fa fa-check"></i>Visualization of Standardized Differences</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#plots-of-covariates-between-groups"><i class="fa fa-check"></i>Plots of Covariates between Groups</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="psm.html"><a href="psm.html#propensity-score-methods"><i class="fa fa-check"></i><b>8.3</b> Propensity Score Methods</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="psm.html"><a href="psm.html#propensity-score-matching"><i class="fa fa-check"></i><b>8.3.1</b> Propensity Score Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#general-procedure-for-propensity-score-matching"><i class="fa fa-check"></i>General Procedure for Propensity Score Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#greedy-matching"><i class="fa fa-check"></i>Greedy Matching</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#mahalanobis-metric-matching"><i class="fa fa-check"></i>Mahalanobis Metric Matching</a></li>
<li class="chapter" data-level="8.3.2" data-path="psm.html"><a href="psm.html#stratification-using-propensity-score"><i class="fa fa-check"></i><b>8.3.2</b> Stratification using Propensity Score</a></li>
<li class="chapter" data-level="8.3.3" data-path="psm.html"><a href="psm.html#inverse-probability-of-treatment-weighting"><i class="fa fa-check"></i><b>8.3.3</b> Inverse Probability of Treatment Weighting</a></li>
<li class="chapter" data-level="8.3.4" data-path="psm.html"><a href="psm.html#propensity-score-adjustment-as-covariate"><i class="fa fa-check"></i><b>8.3.4</b> Propensity Score Adjustment as Covariate</a></li>
<li class="chapter" data-level="8.3.5" data-path="psm.html"><a href="psm.html#property-of-propensity-score"><i class="fa fa-check"></i><b>8.3.5</b> Property of Propensity Score</a></li>
<li class="chapter" data-level="" data-path="psm.html"><a href="psm.html#property-of-observational-studies"><i class="fa fa-check"></i>Property of Observational Studies</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="psm.html"><a href="psm.html#practice---sas"><i class="fa fa-check"></i><b>8.4</b> Practice - SAS</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="psm.html"><a href="psm.html#greedy-nearest-neighbor-matching"><i class="fa fa-check"></i><b>8.4.1</b> Greedy Nearest Neighbor Matching</a></li>
<li class="chapter" data-level="8.4.2" data-path="psm.html"><a href="psm.html#propensity-score-stratification"><i class="fa fa-check"></i><b>8.4.2</b> Propensity Score Stratification</a></li>
<li class="chapter" data-level="8.4.3" data-path="psm.html"><a href="psm.html#inverse-probability-treatment-weighting"><i class="fa fa-check"></i><b>8.4.3</b> Inverse Probability Treatment Weighting</a></li>
<li class="chapter" data-level="8.4.4" data-path="psm.html"><a href="psm.html#matching-with-existing-propensity-scores"><i class="fa fa-check"></i><b>8.4.4</b> Matching with Existing propensity scores</a></li>
<li class="chapter" data-level="8.4.5" data-path="psm.html"><a href="psm.html#matching-with-existing-propensity-scores-1"><i class="fa fa-check"></i><b>8.4.5</b> Matching with Existing propensity scores</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="survival" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> 생존분석</h1>
<div id="생존분석" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> 생존분석</h2>
<ul>
<li><p>생존시간(survival time) 자료를 분석하는 통계적 방법</p></li>
<li><p>넓은 의미에서 생존시간이란 어떤 정의된 시점부터 특정한 사건(event)이
관측될 때까지의 시간을 의미(time to event)</p></li>
<li><p>여기서 사건은 환자의 사망뿐 아니라 어떤 처리에 대한 반응이나 질병의
재발 등이 될수 있음. 따라서 환자가 수술시부터 사망할 때까지의 시간,
어떤 처리를 받은 후 특정 반응을 나타낼 때까지 걸린 시간, 처치 후
재발할 때까지의 시간 등이 모두 생존시간으로 정의 될 수 있음</p></li>
<li><p>생존분석에는 1년 또는 3년 생존율, 환자의 절반 정도가 생존하는 시간,
실험군과 대조군의 생존분포 비교, 생존에 영향을 미칠 수 있는 여러
예후인자(prognostic factor)들 중 유의한 영향을 미치는 인자 분석 등이
있음</p></li>
<li><p>생존시간 데이터가 다른 데이터와 구별되는 이유 중 하나는
중도절단자료(censored data)를 포함</p></li>
<li><p>중도절단(censoring)은 크게 세 가지 형태로 구분</p></li>
<li><p>제 1 형태 (Type I censoring)</p></li>
<li><p>연구자에 의해 중도절단 시간이 고정된 경우. 예를 들어 임상시험에서
연구종료시점을 미리 정해 놓았을 때 환자들은 각기 다른 시간에 시험에
들어오게 되므로 연구 종료시점까지 사망이 관측되지 않는 환자의 경우
중도절단이 됨</p></li>
<li><p>제 2 형태 (Type II censoring)</p></li>
<li><p>사전에 관측할 사망자수를 정해 놓는 경우 발생. 예컨대 100마리의 동물
중 90마리가 사망하는 시점까지만 관측하는 경우</p></li>
<li><p>임의중도절단 (random censoring)</p></li>
<li><p>연구자가 제어하지 못하는 이유로 중도절단되는 경우</p></li>
<li><p>거주지 변경 등의 원인으로 추적 불가능 (loss to follow up)</p></li>
<li><p>환자의 치료겨부 또는 기타 사유로 치료 중단 (drop out)</p></li>
<li><p>다른 이유로 인한 사망 (unrelated event)</p></li>
<li><p>Event 없이 연구 종료</p>
<p><img src="survival/d1.jpg" style="width:95.0%" /></p></li>
<li><p>완전한 자료와 중도절단자료</p>
<p><img src="survival/d2.jpg" style="width:80.0%" /></p></li>
<li><p>생존시간 <span class="math inline">\(T_1, T_2, \ldots, T_n\)</span>은 서로 독립이고 동일한 분포 <span class="math inline">\(F\)</span>를
갖는 확률변수</p></li>
<li><p>중도절단시간 <span class="math inline">\(C_1, C_2, \ldots, C_n\)</span>은 서로 독립이고 동일한 분포
<span class="math inline">\(G\)</span>를 갖는 확률변수</p></li>
<li><p>생존시간 <span class="math inline">\(T_1, T_2, \ldots, T_n\)</span>을 모두 관측하지 못하는 대신
<span class="math display">\[X_i = min(T_i, C_i)\]</span> <span class="math display">\[\delta_i =I(T_i &lt; C_i )\]</span></p></li>
<li><p>로 정의되는
<span class="math inline">\((T_1, \delta_i), (T_2, \delta_2), \ldots, (T_n , \delta_n )\)</span>을 관측</p></li>
<li><p>임의중도절단의 경우 일반적으로 생존시간 <span class="math inline">\(T_i\)</span>와 중도절단시간 <span class="math inline">\(C_i\)</span>가
서로 독립 가정</p></li>
<li><p>생존시간을 <span class="math inline">\(T(\ge 0)\)</span>라 하고 <span class="math inline">\(T\)</span>가 확률밀도함수 <span class="math inline">\(f(t)\)</span>와 분포함수
<span class="math inline">\(F(t)\)</span>를 가질 때,</p></li>
<li><p>생존함수(survival function) <span class="math inline">\(S(t)\)</span> <span class="math display">\[S(t)=P(T&gt;t)=1-F(t)\]</span></p></li>
<li><p>생존함수는 환자가 <span class="math inline">\(t\)</span>시간 이상 생존할 확률</p></li>
<li><p>위험함수(hazard function) <span class="math inline">\(h(t)\)</span>
<span class="math display">\[h(t)=\lim_{dt \rightarrow 0} P(t&lt;T&lt;t+dt|T \ge t)/dt=f(t)/S(t)\]</span></p></li>
<li><p>위험함수는 어떤 환자가 <span class="math inline">\(t\)</span> 시점까지는 생존했다가 <span class="math inline">\(t\)</span> 시점 바로
직후에 사망하게 되는 순간위험률</p></li>
</ul>
</div>
<div id="비모수적-생존함수-추정" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> 비모수적 생존함수 추정</h2>
<ul>
<li><p>생존시간의 분포를 특정하지 않는 경우 비모수적 방법(nonparameteric
method)으로 생존 함수 추정 가능</p></li>
<li><p>중도절단이 없는 경우, 생존시간 <span class="math inline">\(x_1, \ldots, x_n\)</span>을 순서대로 배열한
것을 <span class="math inline">\(t_1&lt;t_2&lt;\cdots&lt;t_n\)</span>이라 하면</p></li>
<li><p>경험적 분포함수 (empirical distribution function) <span class="math display">\[\begin{aligned}
        S(t_i) &amp;=&amp; P(T&gt;t_i) \\
        &amp;=&amp; \text{생존시간이 } t_i \text{이상인 관측치수} / \text{총 관측치수}\\
        &amp;=&amp; 1- t_i \text{까지의 사망자수} / n
                \end{aligned}\]</span></p></li>
<li><p>경험적 분포함수를 중단절단자료가 있는 경우로 확장한 방법이
생명표(life table)를 이용한 방법과 누적한계추정법(product-limit
method)</p></li>
<li><p>생명표 방법은 시간의 단위로 묶어서 생존함수를 추정하며,
누적한계추정법은 환자 개개인의 생존시간을 관측하여 각 시점에서의
생존함수를 추정</p></li>
</ul>
<div id="생명표-방법" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> 생명표 방법</h3>
<ul>
<li><p>환자의 수가 상당히 많을 때에는 그들 개개의 생존시간을 고려하는 대신
생존시간을 몇 개의 구간으로 나누어 생존자료를 요약하는 방법이 필요</p></li>
<li><p>보험통계와 같이 데이터의 수집단계에서부터 생존시간이 1년 단위의
구간별로 나뉘어서 주어지는 경우에도 생명표 방법(life table method)이
주로 사용됨</p></li>
<li><p>생존시간을 <span class="math inline">\(k+1\)</span>개의 구간 <span class="math inline">\([t_{i-1}, t_i), \,\,\, i=1, \ldots, k+1\)</span>
으로 나눔. 이 때 <span class="math inline">\(t_0=0\)</span>이고 <span class="math inline">\(t_{k+1}=\infty\)</span></p></li>
<li><p><span class="math inline">\(i\)</span>번째 구간의 시작지점에서의 생존자수를 <span class="math inline">\(n_i\)</span>, <span class="math inline">\(i\)</span>번째 구간에서의
사망자수를 <span class="math inline">\(d_i\)</span>, <span class="math inline">\(c_i\)</span>는 <span class="math inline">\(i\)</span>번째 구간에서 중도절단된 인원수</p></li>
<li><p>구간 내에서의 생존률 <span class="math inline">\(p_i=P\)</span>(<span class="math inline">\(i\)</span>번째 구간에서 내내 생존<span class="math inline">\(|i\)</span>번째
구간의 시작점에서 생존)<span class="math inline">\(=P(T&gt;t_i|T&gt;t_{i-1})\)</span>, 구간 내 사망률은
<span class="math inline">\(q_i = 1-p_i\)</span></p></li>
<li><p>생명표의 형태</p>
<p><img src="survival/d3.jpg" style="width:90.0%" /></p></li>
<li><p><span class="math inline">\(i\)</span>번째 구간의 시작시점에서의 인원수(위험그룹인원수) <span class="math inline">\(n_i\)</span>는
<span class="math inline">\(n_i=n_{i-1}-d_{i-1}-c_{i-1}\)</span>이며, 유효인원수(effective sample size)
<span class="math inline">\(n_i&#39;\)</span>는 구간에서의 위험그룹인원수에서 중도절단된 인원수의 <span class="math inline">\(1/2\)</span>을
뺀 <span class="math inline">\(n_i&#39;=n_i-c_i/2\)</span></p></li>
<li><p>중도절단이 발생한 경우에는 그룹내내 위험에 노출된 것이 아니라
절반가량 노출되었다고 생각하여 이와 같이 인원수를 조정</p></li>
<li><p><span class="math inline">\(i\)</span>번째 구간에서의 사망률 <span class="math inline">\(q_i\)</span>의 추정값은 <span class="math inline">\(\hat{q}_i=d_i/n_i&#39;\)</span>,
생존률 <span class="math inline">\(p_i\)</span>의 추정값은 <span class="math inline">\(\hat{p}_i=1-\hat{q}_i=1-d_i/n_i&#39;\)</span></p></li>
<li><p>생존함수 <span class="math display">\[\begin{aligned}
        S(t_i)&amp;=&amp;P(T&gt;t_i)\\
        &amp;=&amp;P(T&gt;t_1)P(T&gt;t_2|T&gt;t_1)\cdots P(T&gt;t_i|T&gt;t_{i-1})\\
        &amp;=&amp;p_1p_2\cdots p_i
        \end{aligned}\]</span></p></li>
<li><p>생존함수 추정
<span class="math display">\[\hat{S}(t_i)=\prod_{k=1}^i \hat{p}_{k}=\prod_{k=1}^i(1-d_k/n_k&#39;)\]</span></p></li>
<li><p>이 때 <span class="math inline">\(\hat{S}(0)=1\)</span></p></li>
<li><p>그린우드의 공식 (Greenwood formula) - 분산 추정량
<span class="math display">\[\hat{Var}(\hat{S}(t_i))=\hat{S}^2(t_i)\sum_{k=1}^i \frac{d_k}{n_k&#39;(n_k&#39;-d_k)}\]</span></p></li>
<li><p>Example</p>
<p><img src="survival/ex0.jpg" style="width:90.0%" /></p></li>
<li><p>Survival curve</p>
<p><img src="survival/ex0.png" style="width:90.0%" /></p></li>
</ul>
</div>
<div id="누적한계추정법" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> 누적한계추정법</h3>
<ul>
<li><p>생존함수를 추정하는 대표적인 방법 중 하나로 연구자의 이름을 따서
카플란-마미어(Kaplan-Meier) 추정법이라고도 함</p></li>
<li><p>생존시간 또는 중도절단시간 <span class="math inline">\(x_1, \ldots, x_n\)</span>을 순서대로 배열한 것을
<span class="math inline">\(t_1&lt;t_2&lt;\cdots&lt;t_n\)</span>이라 하고 <span class="math inline">\(\delta_i\)</span>를 생존시간 <span class="math inline">\(t_i\)</span>의
중도절단여부를 표현. 이때 중도절단인 경우 <span class="math inline">\(\delta_i=0\)</span>, 그렇지 않은
경우 <span class="math inline">\(\delta_i=1\)</span></p></li>
<li><p>시점 <span class="math inline">\(t_i\)</span>에서 위험에 노출된 인원수, 즉 <span class="math inline">\(t_i\)</span> 바로 직전까지
중도절단되지 않고 생존해 있던 인원수를 <span class="math inline">\(n_i\)</span>라고 하고 사망한 사람의
수를 <span class="math inline">\(d_i\)</span>라고 했을 때 생존함수 <span class="math inline">\(S(t)\)</span>의 누적한계추정량은
<span class="math display">\[\hat{S}(t)=\prod_{t_i\le t} (1-d_i/n_i)^{\delta_i}\]</span></p></li>
<li><p>누정한계추정량은 중도절단시간에서는 변하지 않고 사망이 관측되는 시점
<span class="math inline">\(x_i\)</span>에서 <span class="math inline">\((n_i-d_i)/n_i\)</span>를 곱해준 만큼씩 감소하는 단계함수</p></li>
<li><p>중도절단의 효과는 각 단계에서의 크기 <span class="math inline">\(n_i\)</span>의 값에서 나타남</p></li>
<li><p>사망시간과 중도절단시간이 동일한 경우에는 사망이 중도절단보다 먼저
관측되었다고 판단</p></li>
<li><p>마지막 생존시간 <span class="math inline">\(t_n\)</span>이 중도절단된 경우에는 <span class="math inline">\(t_n\)</span> 이상의 기간에
대해서는 누적한계추정값을 정의하지 않음</p></li>
<li><p>분산 추정량
<span class="math display">\[\hat{Var}(\hat{S}(t))=\hat{S}^2(t)\sum_{i:t_i\le t} \frac{d_i}{n_i(n_i-d_i)}\]</span></p></li>
<li><p>누정한계추정량은 일치성(consistency)과 근사적 정규성(asymptotic
normality)을 만족하는 등 표본이 클 때 통계적 성질이 우수함</p></li>
<li><p>자료 표현법</p>
<p><img src="survival/ex5.jpg" style="width:80.0%" /></p>
<p><img src="survival/ex6.jpg" style="width:80.0%" /></p></li>
<li><p>Example : <span class="math inline">\(n=21\)</span></p>
<p><img src="survival/ex01.jpg" /></p></li>
<li><p>Example</p>
<p><img src="survival/ex01.png" /></p></li>
</ul>
</div>
<div id="생존분포-비교" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> 생존분포 비교</h3>
<ul>
<li><p>첫 번째 그룹의 생존시간 <span class="math inline">\(T_{11}, T_{12}, \ldots, T_{1n_1}\)</span>은 서로
독립이며 동일한 생존함수 <span class="math inline">\(S_1\)</span>을 갖고, 중도절단 시간
<span class="math inline">\(C_{11}, C_{12}, \ldots, C_{1n_1}\)</span>도 서로 독립이며 동일한 분포함수
<span class="math inline">\(G_1\)</span>을 갖는다고 하자. 마찬가지로 두 번째 그룹의 생존시간
<span class="math inline">\(T_{21}, T_{22}, \ldots, T_{2n_2}\)</span>은 서로 독립이며 동일한 생존함수
<span class="math inline">\(S_2\)</span>을 갖고, 중도절단 시간 <span class="math inline">\(C_{21}, C_{22}, \ldots, C_{2n_2}\)</span>도
서로 독립이며 동일한 분포함수 <span class="math inline">\(G_2\)</span>을 갖는다고 하자.</p></li>
<li><p>관측값의 형태</p></li>
<li><p>그룹 1:
<span class="math inline">\((x_{11},\delta_{11}), (x_{12},\delta_{12}), \ldots, (x_{1n_1},\delta_{1n_1})\)</span></p></li>
<li><p>그룹 2:
<span class="math inline">\((x_{21},\delta_{21}), (x_{22},\delta_{22}), \ldots, (x_{2n_1},\delta_{2n_2})\)</span></p></li>
<li><p>여기서 <span class="math inline">\(x_{ij}=min(T_{ij},C_{ij})\)</span>이고 <span class="math inline">\(\delta_{ij}\)</span>는 중도절단을
나타내는 가변수(<span class="math inline">\(\delta_{ij}=0\)</span>: 중도절단)</p></li>
<li><p>특정시점에서의 생존률 비교</p></li>
<li><p>가설
<span class="math inline">\(H_0 : S_1(t_k )= S_2(t_k) \,\,\, vs. \,\,\, H_1 : S_1(t_k) \ne S_2(t_k)\)</span></p></li>
<li><p>검정통계량
<span class="math display">\[Z=\frac{\hat{S}_1(t_k)-\hat{S}_2(t_k)}{\sqrt{\hat{Var}(\hat{S}_1(t_k))+\hat{Var}(\hat{S}_2(t_k))}} \sim N(0,1)\]</span></p></li>
<li><p>생존함수의 총괄적 비교</p></li>
<li><p>가설 : <span class="math inline">\(H_0 : S_1=S_2 \,\,\, vs. \,\,\, H_1 : S_1 \ne S_2\)</span></p></li>
<li><p>두 생존분포의 비교에 주로 사용되는 기법은 Mantel-Haenszel의 로그
순위 검정법(log-rank test)</p></li>
<li><p><span class="math inline">\(t_1 &lt; t_2 &lt; \cdots &lt; t_k\)</span>를 두 그룹의 자료를 섞었을 때 관측된
사망시간을 순서대로 놓은 것이라고 하면, 모든 <span class="math inline">\(t_i\)</span>에서 다음과 같은
<span class="math inline">\(2\)</span>차원 분할표를 작성함</p>
<p><img src="survival/lo5.jpg" style="width:90.0%" /></p></li>
<li><p>검정통계량
<span class="math display">\[T=\frac{\left(  \sum_{i=1}^k (d_{1i}-E_{1i})    \right)^2}{\sum_{i=1}^k V_{1i}} \sim \chi(1)\]</span></p></li>
<li><p><span class="math inline">\(E(d_{1i})=E_{1i}=n_{1i}d_i/n_i\)</span>,
<span class="math inline">\(Var(d_{i1})=V_{1i}=\frac{n_{1i}n_{2i}}{n_1-1}\frac{d_i(n_i-d_i)}{n_i^2}\)</span></p></li>
<li><p>로그 순위 통계량은 각 시점에서 동일한 비중을 가짐. 따라서 대안으로
다음과 같은 각 시점의 가중치를 다르게 한 통계량을 고려할 수 있음
<span class="math display">\[T=\frac{\left(  \sum_{i=1}^k w_i(d_{1i}-E_{1i})    \right)^2}{\sum_{i=1}^k w_i^2V_{1i}} \sim \chi(1)\]</span></p></li>
<li><p><span class="math inline">\(w=1\)</span>인 경우 로그 순위 통계량이 됨</p></li>
<li><p><span class="math inline">\(w_i=n_i\)</span>이면 Gehan의 검정통계량이 되며, 이때 가중값은 각 시점에서
위험에 쳐해 있는 인원수에 비례함</p></li>
<li><p>두 그룹의 위험률의 비가 상수일 때 즉, 교차하지 않을 때 로그 순위
검정법이 선호되며, 그렇지 않은 경우에는 다른 가중치를 주는 방법을
선호</p></li>
<li><p><span class="math inline">\(k(\ge 3)\)</span>개의 그룹이 모두 동일한 생존분포를 가지는지 알아내기 위한
검정법도 존재. 크루스칼-왈리스 검정법을 중도절단자료의 경우로
확장시킨 형태와 유사</p></li>
</ul>
</div>
</div>
<div id="모수적-생존함수-추정과-회귀모형" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> 모수적 생존함수 추정과 회귀모형</h2>
<div id="지수분포" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> 지수분포</h3>
<ul>
<li><p>생존시간의 분포형태가 알려져 있을 경우에는 비모수적인 방법보다
모수적인 방법을 이용하는 것이 더 효율적</p></li>
<li><p>생존시간의 분포가 지수분포(exponential distribution)인 경우 :</p></li>
<li><p>모수적 위험함수의 가장 단순한 형태로써 위험률이 시간에 대해 일정함</p></li>
<li><p>확률밀도함수: <span class="math inline">\(f(t)=\lambda e^{-\lambda t}\)</span></p>
<p><img src="survival/exp1.png" style="width:80.0%" /></p></li>
<li><p>생존함수: <span class="math inline">\(S(t)=e^{-\lambda t}\)</span></p>
<p><img src="survival/exp2.png" style="width:100.0%" /></p></li>
<li><p>위험함수: <span class="math inline">\(h(t)=\lambda\)</span></p>
<p><img src="survival/exp3.png" style="width:80.0%" /></p></li>
</ul>
</div>
<div id="와이블분포" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> 와이블분포</h3>
<ul>
<li><p>지수분포의 일반화된 형태로 생존분석에서 가장 많이 사용되는 분포</p></li>
<li><p>확률밀도함수: <span class="math inline">\(f(t)=\lambda p(\lambda t)^{p-1} exp(-(\lambda t)^p)\)</span></p>
<p><img src="survival/we1.png" style="width:90.0%" /></p></li>
<li><p>생존함수: <span class="math inline">\(S(t)=exp(-(\lambda t)^p)\)</span></p>
<p><img src="survival/we2.png" style="width:90.0%" /></p></li>
<li><p>위험함수: <span class="math inline">\(h(t)=\lambda p(\lambda t)^{p-1}\)</span></p>
<p><img src="survival/we3.png" style="width:90.0%" /></p></li>
</ul>
</div>
<div id="감마분포" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> 감마분포</h3>
<ul>
<li><p>확률밀도함수:
<span class="math inline">\(f(t)=\frac{\lambda^k}{\Gamma(k)}t^{k-1}exp(-\lambda t)\)</span></p>
<p><img src="survival/ga1.png" style="width:90.0%" /></p></li>
<li><p>생존함수</p>
<p><img src="survival/ga2.png" style="width:90.0%" /></p></li>
<li><p>위험함수</p>
<p><img src="survival/ga3.png" style="width:90.0%" /></p></li>
</ul>
</div>
<div id="로그정규분포" class="section level3" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> 로그정규분포</h3>
<ul>
<li><p>확률밀도함수:
<span class="math inline">\(f(t)=\frac{1}{\sqrt{2\pi}}pt^{-1}exp(\frac{-p^2 (log\lambda t)^2}{2})\)</span></p>
<p><img src="survival/ln1.png" style="width:90.0%" /></p></li>
<li><p>생존함수: <span class="math inline">\(S(t)=1-\Phi(plog\lambda t)\)</span></p>
<p><img src="survival/ln2.png" style="width:90.0%" /></p></li>
<li><p>위험함수</p>
<p><img src="survival/ln3.png" style="width:90.0%" /></p></li>
</ul>
</div>
<div id="로그로지스틱분포" class="section level3" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> 로그로지스틱분포</h3>
<ul>
<li><p>와이블분포와 함게 생존분석에 자주 사용되는 분포</p></li>
<li><p>확률밀도함수:
<span class="math inline">\(f(t)=\lambda p(\lambda t)^{p-1}[1+(\lambda t)^p]^{-2}\)</span></p>
<p><img src="survival/lg1.png" style="width:90.0%" /></p></li>
<li><p>생존함수: <span class="math inline">\(S(t)=\frac{1}{1+(\lambda t)^p}\)</span></p>
<p><img src="survival/lg2.png" style="width:90.0%" /></p></li>
<li><p>위험함수: <span class="math inline">\(h(t)=\frac{\lambda p(\lambda t)^{p-1}}{1+(\lambda t)^p}\)</span></p>
<p><img src="survival/lg3.png" style="width:90.0%" /></p></li>
</ul>
</div>
<div id="곰페르츠분포" class="section level3" number="7.3.6">
<h3><span class="header-section-number">7.3.6</span> 곰페르츠분포</h3>
<ul>
<li><p>로그(위험함수)가 시간에 대한 선형함수 형태</p></li>
<li><p>위험함수: <span class="math inline">\(h(t)=exp(\lambda +\gamma t)\)</span></p>
<p><img src="survival/go1.png" style="width:70.0%" /></p></li>
</ul>
</div>
<div id="회귀모형aft" class="section level3" number="7.3.7">
<h3><span class="header-section-number">7.3.7</span> 회귀모형(AFT)</h3>
<ul>
<li><p>곰페르츠와 와이블분포는 특정조건에서 지수분포로 되며, 지수분포와
같지 않을 때 두 분포의 위험함수는 시간이 증가함에 따라 단조증가 또는
단조감소하는 형태를 가짐</p></li>
<li><p>생존시간에 영향을 미치는 요인(공변량)들 <span class="math inline">\(x_1, \ldots , x_p\)</span>가 있을
때 각 분포의 위험함수에 대한 회귀모형</p></li>
<li><p>지수분포 : <span class="math inline">\(logh(t)=\alpha_0 + \alpha_1 x_1 + \cdots + \alpha_px_p\)</span></p></li>
<li><p>곰페르츠분포 :
<span class="math inline">\(logh(t)=\alpha t + \alpha_0 + \alpha_1 x_1 + \cdots + \alpha_px_p\)</span></p></li>
<li><p>와이블분포 :
<span class="math inline">\(logh(t)=\alpha logt +\alpha_0 + \alpha_1 x_1 + \cdots + \alpha_px_p\)</span></p></li>
<li><p><span class="math inline">\(x\)</span>가 한 단위 증가할 때 <span class="math inline">\(logh(t)\)</span>가 <span class="math inline">\(\alpha\)</span>만큼 증가하는 모형</p></li>
<li><p>AFT 모형은 공변량의 영향으로 사망시간이 가속화된다는 의미로,
생존시간에 영향을 주는 <span class="math inline">\(p\)</span>개의 공변량 <span class="math inline">\(x_1, \ldots, x_p\)</span>가 있을 때의
생존시간을 <span class="math inline">\(T\)</span>로 하고 이들 공변량의 값이 <span class="math inline">\(0\)</span>인 경우의 생존시간을
<span class="math inline">\(T_0\)</span>로 했을 때 다음의 모형을 가정
<span class="math display">\[T=exp(\beta_0 + \beta_1 x_1 + \cdots + \beta_p x_p )T_0^\sigma\]</span></p></li>
<li><p>양변에 로그를 취하면
<span class="math display">\[logT=\beta_0 +\beta_1 x_1 + \cdots + \beta_p x_p +\sigma e\]</span></p></li>
<li><p>여기서 <span class="math inline">\(e\)</span>는 오차항, <span class="math inline">\(\sigma\)</span>는 척도모수(scale parameter),
<span class="math inline">\(\beta_0\)</span>는 위치모수(location parameter)</p>
<p><img src="survival/lo14.jpg" style="width:80.0%" /></p></li>
</ul>
<p>다음은 <span class="math inline">\(40\)</span>명의 폐암환자들의 생존시간을 조사한 것이다. <span class="math inline">\(40\)</span>명의 환자 중
<span class="math inline">\(21\)</span>명은 처리 1 (standard)에, 나머지 <span class="math inline">\(19\)</span>명은 처리 2 (test)에
할당되었으며, 생존시간에 영향을 미칠 것으로 생각되는 공변량들은 다음과
같다.<br />
<span class="math inline">\(x_1\)</span>: 진단시의 환자상태 (performance status: 0점-100점)<br />
<span class="math inline">\(x_2\)</span>: 환자의 나이 (단위: 년)<br />
<span class="math inline">\(x_3\)</span>: 진단 후 연구참여시까지의 시간 (단위: 월)<br />
TYPE: 종양의 유형 (squamous=1, small=2, adeno=3, large=4)</p>
<p><img src="survival/lo15.jpg" style="width:50.0%" /></p>
<p>Results</p>
<p><img src="survival/lo17.jpg" style="width:70.0%" /></p>
<p>Results - 지수분포: <span class="math inline">\(t\,\,\, vs. \,\,\, -logS(t)\)</span></p>
<p><img src="survival/ex9.png" style="width:70.0%" /></p>
<p>Results - 와이블분포: <span class="math inline">\(logt\,\,\, vs. \,\,\, log(-logS(t))\)</span></p>
<p><img src="survival/ex10.png" style="width:70.0%" /></p>
<p>Results - 로그-정규분포: <span class="math inline">\(logt\,\,\, vs. \,\,\, \Phi^{-1}(1-S(t))\)</span></p>
<p><img src="survival/ex11.png" style="width:70.0%" /></p>
<p>Results - 로그-로지스틱분포: <span class="math inline">\(logt\,\,\, vs. \,\,\, log[(1-S(t))/S(t)]\)</span></p>
<p><img src="survival/ex12.png" style="width:70.0%" /></p>
</div>
</div>
<div id="cox-비례위험모형" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Cox 비례위험모형</h2>
<ul>
<li><p>모수적 모형은 가정이 타당할 때는 효울적이지만 어떤 모형이 적당한가에
대한 사전 지식 없이 사용하기 어려움</p></li>
<li><p>Cox의 비례위험모형(proportional hazards model)은
준모수적(semi-parameteric) 방법으로써 생존시간의 분포에 대한 가정을
필요로 하지 않음</p></li>
<li><p>Cox PH 모형은 시간에 따라 바뀌는 공변량(time-dependent variable)의
경우에도 분석할 수 있음</p></li>
<li><p>생존자료의 분석에서 자주 사용되는 모형으로 Cox 회귀분석(Cox
regressin analysis) 이라고도 함</p></li>
<li><p>생존시간을 <span class="math inline">\(T\)</span>, 영향을 주는 <span class="math inline">\(p\)</span>개의 공변량 <span class="math inline">\(x_1, \ldots, x_p\)</span>이 있을
때, Cox PH model:
<span class="math display">\[h(t)=h_0(t)exp(\beta_1 x_1+\cdots +\beta_p x_p)\]</span></p></li>
<li><p>여기서 <span class="math inline">\(h(t)\)</span>는 공변량들을 고려했을 때의 위험함수(hazard function),
<span class="math inline">\(h_0(t)\)</span>는 기저위험함수(baseline hazard function) (예를 들어
공변량의 값들이 모두 0일 때의 위험함수의 값)</p></li>
<li><p>양변에 로그를 취하고 <span class="math inline">\(\alpha(t)=logh_0(t)\)</span>로 놓으면
<span class="math display">\[log h(t)=\alpha(t)+\beta_1x_1+\cdots+\beta_px_p\]</span></p></li>
<li><p>만약 <span class="math inline">\(\alpha(t)=\alpha_0\)</span>로 놓으면 지수모형과 같은 형태</p></li>
<li><p>만약 <span class="math inline">\(\alpha(t)=\alpha_0 + \alpha t\)</span>로 놓으면 곰페르츠 모형과 같은
형태</p></li>
<li><p>만약 <span class="math inline">\(\alpha(t)=\alpha_0 + \alpha logt\)</span>로 놓으면 와이블 모형과 같은
형태</p></li>
<li><p>Cox 모형은 분포의 선택이 필요하지 않으며, <span class="math inline">\(\alpha(t)\)</span>의 형태가 어떤
것이든 무관</p></li>
<li><p>"비례위험모형"의 의미는 어느 환자의 위험률과 다른 환자의 위험률의
비가 시간에 대해 일정하다는 것을 의미</p></li>
<li><p>예를 들어, <span class="math inline">\(i\)</span>번째 환자와 <span class="math inline">\(j\)</span>번째 환자의 위험함수의 비는
<span class="math display">\[h_i(t)/h_j(t)=exp(\beta_1(x_{i1}-x_{j1})+\cdots+\beta_p(x_{ip}-x_{jp}))\]</span></p></li>
<li><p>가 되어 기저위험함수는 상쇄되어 없어지고 위험함수의 비는 시간에
대해서 상수로 됨</p></li>
<li><p>비례위험의 가정이 맞다면, 두 환자에 대해 시간 <span class="math inline">\(t\)</span>에 따른
<span class="math inline">\(log\hat{h}(t)\)</span> 또는 <span class="math inline">\(log(-log\hat{S}(t))\)</span>의 그래프가 평행하게
되어야 함</p></li>
</ul>
<p>다음은 <span class="math inline">\(40\)</span>명의 폐암환자들의 생존시간을 조사한 것이다. <span class="math inline">\(40\)</span>명의 환자 중
<span class="math inline">\(21\)</span>명은 처리 1 (standard)에, 나머지 <span class="math inline">\(19\)</span>명은 처리 2 (test)에
할당되었으며, 생존시간에 영향을 미칠 것으로 생각되는 공변량들은 다음과
같다.<br />
<span class="math inline">\(x_1\)</span>: 진단시의 환자상태 (performance status: 0점-100점)<br />
<span class="math inline">\(x_2\)</span>: 환자의 나이 (단위: 년)<br />
<span class="math inline">\(x_3\)</span>: 진단 후 연구참여시까지의 시간 (단위: 월)<br />
TYPE: 종양의 유형 (squamous=1, small=2, adeno=3, large=4)</p>
<p><img src="survival/lo15.jpg" style="width:50.0%" /></p>
<p><img src="survival/lo20.jpg" style="width:90.0%" /></p>
<p><img src="survival/ex13.png" style="width:70.0%" /></p>
<div id="시간에-따라-변화하는-공변량이-있을-경우" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> 시간에 따라 변화하는 공변량이 있을 경우</h3>
<ul>
<li><p>일반적으로 공변량(covariate)이 시간에 의존하지 않고 일정한 경우에
대한 모형을 다루었음</p></li>
<li><p>환자의 혈압이나 백혈구의 수, 혈청표지의 수준 등은 중요한 요인이면서
연구 도중 변화하는 공변량임</p></li>
<li><p>심장이식과 같이 연구기간 동안 시간에 따라 상태가 달라지는 공변량이
존재</p></li>
<li><p>시간에 따라 변화하는 공변량을 고려한 Cox PH 모형
<span class="math display">\[log h(t)=\alpha(t)+\beta_1 x_1 +\cdots +\beta_p x_p + \beta_{p+1}x_{p+1}(t)\]</span></p></li>
</ul>
<p>Results</p>
<p><img src="survival/lo22.jpg" style="width:80.0%" /></p>
<p><img src="survival/lo23.jpg" style="width:80.0%" /></p>
<p>Results</p>
<p><img src="survival/dist.png" style="width:80.0%" /></p>
</div>
</div>
<div id="경쟁위험모형" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> 경쟁위험모형</h2>
<ul>
<li><p>생존 자료의 통계적 분석 상의 문제점 : 각 실험 개체에 대해 생존시간과
중도절단이 하나만 관측됨</p></li>
<li><p>생존 자료의 통계적 분석을 위해 추가되는 가정 : 생존시간의 분포와
중도절단까지 시간의 분포가 서로 독립을 가정</p></li>
<li><p>모든 원인에 대한 암 사망률이 아닌 특정 원인에 대한 암 사망률이
관심있는 경우 : 암환자의 특정원인에 의한 암 사망까지의 시간과 다른
원인에 의한 암 사망까지의 시간은 독립인가 아닌가?</p></li>
<li><p>각 실험개체들이 두개 이상의 원인에 의한 사건 발생 위험에 노출되는
상황에서 만들어진 자료에 대한 분석 : 특정 원인에 의한 사건에 대한
분석을 위해 “경쟁위험”을 고려한 방법으로 접근</p></li>
<li><p>각 개체들이 둘 이상의 위험에 노출이 되었고 그 중 하나의 사건이
발생하면 다른 사건들이 발생할 위험들이 사라지는 경우 이 위험들을
경쟁위험(competing risks)이라 함</p></li>
<li><p>ex) HIV 양성반응을 가지는 사람들은 AIDS에 걸릴 위험과 (AIDS에 걸리기
전) 사망할 위험에 동시에 노출됨. 이때 각 사람들은 두 가지 경우 중
하나만 발생하므로 이 두 사건은 다른 사건에 대해 경쟁위험임</p>
<p><img src="survival/comp1.png" style="width:60.0%" /></p></li>
<li><p>두 개의 경쟁위험과 두 개의 치료집단을 가지는 자료의 경우</p>
<p><img src="survival/comp2.png" style="width:80.0%" /></p></li>
<li><p>두 경쟁위험을 묶어서 하나의 event로 계산한 생존곡선의 추정과 검정은
통계적으로 올바름 - 동일한 개체의 "경쟁"효과로 생기는 통계적 문제
해결</p></li>
<li><p>두 event 중 하나의 event 발생에 대한 치료효과의 차이를 연구하는
임상학자에게는 유용하지 않음</p></li>
<li><p>한 event의 발생 패턴을 보기 위해 다른 사상의 발생을 중도절단으로
처리하는 경우</p>
<p><img src="survival/comp3.png" style="width:80.0%" /></p></li>
<li><p><img src="survival/comp4.png" style="width:80.0%" /></p></li>
<li><p>두 사상의 발생패턴 모두 치료집단 간에 차이가 나서 나온
결과라기보다는 각 사상별 생존곡선을 추정하기 위해 사용된 방법에
문제가 있는 것으로 보임</p></li>
</ul>
<div id="원인별-누적발생함수" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> 원인별 누적발생함수</h3>
<ul>
<li><p>원인별 위험함수(cause-specific hazard function)
<span class="math display">\[\lambda_j(t)=\lim_{h-&gt;0}\frac{P(t&lt;T&lt;t+h , \epsilon=j |T \ge t)}{h}, \,\,\, j=1, \ldots, K\]</span></p></li>
<li><p>원인별 위험함수는 다른 모든 사건 원인들이 존재할 때, <span class="math inline">\(t\)</span> 시점에서
특정원인 <span class="math inline">\(j\)</span>에 의한 실패가 일어날 확률을 의미</p></li>
<li><p>Overall hazard function <span class="math display">\[\lambda(t)=\sum_{j=1}^K \lambda_j(t)\]</span></p></li>
<li><p>Overall hazard function은 <span class="math inline">\(t\)</span> 시점에 어떤 원인에 의해서든지 실패할
확률을 의미</p></li>
<li><p>원인별 누적발생함수(cause-specific cumulative incidence
function(CIF))
<span class="math display">\[F_j(t)=P(T \le t, \epsilon=j)=\int_0^t \lambda_j(t) S(t)dt, \,\,\, j=1,\ldots, K\]</span></p></li>
<li><p>여기서 <span class="math inline">\(S(t)\)</span>는
<span class="math display">\[S(t)=exp \left\lbrace  -\int_o^t \sum_{j=1}^K \lambda_j(t)dt \right\rbrace\]</span></p></li>
<li><p>CIF는 모든 다른 실패 원인이 존재할 때, <span class="math inline">\(t\)</span> 시점까지 원인 <span class="math inline">\(j\)</span>에 의해
실패할 확률을 의미</p></li>
<li><p><span class="math inline">\(j\)</span>번째 누적발생함수는 다른 원인별 위험함수와 서로 연관되어 있음</p></li>
<li><p>누적발생함수 추정량
<span class="math display">\[\hat{F}_j(t)=\sum_{m:t_m \le t}\hat{\lambda}_j (t_m)\hat{S}(t_{m-1})\]</span></p></li>
<li><p>여기서
<span class="math display">\[\hat{\lambda}_j (t_m)=\frac{d_{jm}}{n_m}, \,\,\,\,\, \hat{S}(t_{m-1})=\prod_{i=1}^{m-1} \left( 1-\frac{d_i}{n_i}\right)\]</span></p></li>
<li><p><span class="math inline">\(t_m\)</span>: 모든 원인에 의한 사건 시점을 합친 것들 중에 <span class="math inline">\(m\)</span>번째 실패 시간</p></li>
<li><p><span class="math inline">\(d_{jm}\)</span>: <span class="math inline">\(t_m\)</span> 시점에 원인 <span class="math inline">\(j\)</span> 의한 실패수</p></li>
<li><p><span class="math inline">\(d_m=\sum_{j=1}^K d_{jm}\)</span>: <span class="math inline">\(t_m\)</span> 시점에서의 모든 원인의 실패수</p></li>
<li><p><span class="math inline">\(n_m\)</span>: <span class="math inline">\(t_m\)</span> 시점에서 위험 그룹에 속해 있는 개체수</p></li>
<li><p>Ordering of the functions</p>
<p><img src="survival/comp5.png" style="width:70.0%" /></p></li>
</ul>
</div>
<div id="원인별-위험함수" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> 원인별 위험함수</h3>
<ul>
<li><p>원인별 위험함수(cause-specific hazard function(CSH))를 설명하기 위해
다음의 비례위험모형을 가정
<span class="math display">\[\lambda_j(t;x_i)=\lambda_{j0}(t)exp(\beta&#39;_jx_i) , \,\,\, j=1,\ldots, K\]</span></p></li>
<li><p>여기서 <span class="math inline">\(j\)</span>번째 원인별 위험함수는 실패 원인에 따라 정의되며, 관심
원인을 제외한 나머지 원인은 모두 중도절단으로 처리</p></li>
<li><p>원인별 위험함수에서 추정된 회귀계수는 다른 원인의 위험률이 전혀
반영되지 않음</p></li>
<li><p>경쟁위험모형에서는 원인들이 서로 독립적이지 않는 한, 해석 상의
문제점이 발생 할 수 있음</p></li>
</ul>
</div>
<div id="누적발생함수에-대한-회귀분석" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> 누적발생함수에 대한 회귀분석</h3>
<ul>
<li><p>일반적으로 누적발생함수(CIF)에 대한 공변량의 효과와 원인별
위험함수(CSH)에 대한 공변량의 효과는 서로 다르게 나타남</p></li>
<li><p>CIF <span class="math inline">\(F_j(t)\)</span>는 <span class="math inline">\(j\)</span>번째 원인의 위험함수뿐만 아니라다른 원인들의
위험함수들의 결합 형태이므로 다른 원인들의 위험함수의 영향을 받음</p></li>
<li><p>Fine and Gray (1999)는 subdistribution에 근거한 회귀모형을 통해
누적발생함수를 추정하고자 하였으며, 여기서 subdistribution은
<span class="math inline">\(\lim_{t-&gt;\infty}F_j(t)=Pr(\epsilon=j)\)</span>로부터 유래한 것으로 <span class="math inline">\(K\)</span>개의
원인별 분포함수라는 의미임</p></li>
<li><p>공변량을 포함한 subdistribution 위험함수 <span class="math display">\[\begin{aligned}
        \lambda  _{j}^s (t; x) &amp;=&amp; 
        \lim _{h-&gt;0} \left\lbrace \frac{Pr[t  \le T_j  &lt; t+h , | (T \ge t) \cup (T \le t, \epsilon \ne j), x} {h}   \right\rbrace \\
        &amp;=&amp; \frac{d F_j (t,x)/ dt} {1-F_j (t), x} = - \frac{d log (1-F_j (t,x))} {dt}
        \end{aligned}\]</span></p></li>
<li><p>여기서 <span class="math inline">\(x\)</span>는 공변량 벡터이며, 원인별 위험함수와 가장 큰 차이점은
위험함수의 정의임</p></li>
<li><p>subdistribution에서는 다른 유형으로 이미 사망한 사람도 위험 그룹에
포함함</p></li>
<li><p>subdistribution에 근거한 회귀모형
<span class="math display">\[\lambda_j^s (t, x)=\lambda_{j0}^s (t) exp(x(t)\beta)\]</span>
<span class="math display">\[F_j(t,x)=1-exp\left( -\int_0^t \lambda_j^s (t,x) dt \right)=1-exp \left(-\int_0^t \lambda_{j0}^s (t) exp(x(t)\beta) dt \right)\]</span></p></li>
<li><p>회귀계수 <span class="math inline">\(\beta\)</span>가 양수이면 <span class="math inline">\(F_j(t,x)\)</span>는 공변량 <span class="math inline">\(x\)</span>에 대해 단조
증가함수가 되므로, 공변량 <span class="math inline">\(x\)</span>가 증가함에 따라 동일한 시점에서
<span class="math inline">\(F_j(t,x)\)</span>도 증가</p></li>
<li><p>즉, 회귀계수 <span class="math inline">\(\beta\)</span>가 양수이면 공변량 <span class="math inline">\(x\)</span>가 증가함에 따라
<span class="math inline">\(t\)</span>시점까지 원인 <span class="math inline">\(j\)</span>에 의해 failure가 발생할 확률도 증가</p></li>
<li><p>중도절단시점에 대한 정의</p></li>
<li><p>Administrative censoring time</p></li>
<li><p>Inverse probability censoring weighting (IPCW)</p></li>
<li><p>Multiple imputation</p></li>
<li><p>IPCW 방법에서는 중도절단 시간을 추정하기 위해 다음을 정의
<span class="math display">\[r_i(t)=I(C_i \ge T_i \wedge t)\]</span></p></li>
<li><p>즉, <span class="math inline">\(t\)</span> 시점까지 <span class="math inline">\(i\)</span>번째 개체가 (i) 중도절단되지 않았거나 또는 (ii)
사건발생을 경험하였다면 <span class="math inline">\(1\)</span>의 값을 가지며, 중도절단이 먼저 일어나면
<span class="math inline">\(0\)</span>의 값을 가짐</p></li>
<li><p>중도절단에 대한 생존함수 <span class="math inline">\(G(t)\)</span>의 추정량 <span class="math inline">\(\hat{G}(t)\)</span>는 자료
<span class="math inline">\((X_i , 1-\delta_i)\)</span>, <span class="math inline">\(X_i=min(T_i, C_i)\)</span>를 이용하여 <span class="math inline">\(KM\)</span> 추정량을
통해 구함. 이를 이용하여 다음의 가중값을 정의
<span class="math display">\[w_i(t)=r_i(t)\frac{\hat{G}(t)}{\hat{G}(X_i \wedge t)}\]</span></p></li>
</ul>
</div>
</div>
<div id="sas-실습" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> SAS 실습</h2>
<div id="생명표-방법-1" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> 생명표 방법</h3>
<p>다음은 협심증(angina pectoris)이 있는 <span class="math inline">\(2,418\)</span>명의 남성들에 대한
생존자료이다. 진단시점부터 사망할 때까지의 시간이 생존시간으로
계산되었으며, <span class="math inline">\(1\)</span>년 간격으로 표가 작성되었다. 이 생명표에서 경과기간에
따른 생존확률을 구해보자.</p>
<p><img src="survival/ex1.jpg" style="width:60.0%" /></p>
<p>SAS Code</p>
<p><img src="survival/ex2.jpg" style="width:60.0%" /></p>
<p><img src="survival/ex3.jpg" style="width:100.0%" /></p>
<p><img src="survival/ex4.jpg" style="width:100.0%" /></p>
<p>Results - Survival function</p>
<p><img src="survival/ex5.png" style="width:60.0%" /></p>
<p>Results - Hazard function</p>
<p><img src="survival/ex6.png" style="width:60.0%" /></p>
</div>
<div id="누적한계추정법-1" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> 누적한계추정법</h3>
<p>다음은 신장이식수술을 받은 <span class="math inline">\(15\)</span>명 환자들의 호전기간(remission duration)
(단위: 일)이다. 여기서 <span class="math inline">\(+\)</span>로 표시된 것은 중도절단된 자료이다. 생존함수를
추정하라.</p>
<p><img src="survival/lo1.jpg" style="width:90.0%" /></p>
<p>SAS Code</p>
<p><img src="survival/lo2.jpg" style="width:80.0%" /></p>
<p><img src="survival/lo3.jpg" style="width:55.0%" /></p>
<p><img src="survival/lo4.jpg" style="width:55.0%" /></p>
<p><img src="survival/ex7.png" style="width:70.0%" /></p>
</div>
<div id="생존분포-비교-1" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> 생존분포 비교</h3>
<p>다음은 <span class="math inline">\(30\)</span>명의 2기-4기 사이의 흑생종(melanoma) 환자들에 대한 연구로서
BCG와 CP(coryne-bacterium parvum) 면역법의 생존시간 연장효과를 비교하기
위해 얻은 자료이다. 환자들 중 11명은 BCG처리를 받았으며 나머지 19명은
CP처리를 받았다. 두 그룹의 환자에 대한 생존시가늘 조사하여 중도절단된
자료는 <span class="math inline">\(+\)</span>로 표시하였다. 두 그룹 간에 생존분포의 차이가 있는지 알아보자.</p>
<p><img src="survival/lo6.jpg" style="width:90.0%" /></p>
<p>SAS Code</p>
<p><img src="survival/lo7.jpg" style="width:60.0%" /></p>
<p><img src="survival/lo8.jpg" style="width:70.0%" /></p>
<p><img src="survival/lo9.jpg" style="width:60.0%" /></p>
<p><img src="survival/lo10.jpg" style="width:70.0%" /></p>
<p><img src="survival/lo11.jpg" style="width:60.0%" /></p>
<p><img src="survival/lo12.jpg" style="width:80.0%" /></p>
<p>Results - Survival functions</p>
<p><img src="survival/ex8.png" style="width:70.0%" /></p>
<p>Results - Log rank and Gehan(Wilcoxon) tests</p>
<p><img src="survival/lo13.jpg" style="width:70.0%" /></p>
</div>
<div id="parametric-model" class="section level3" number="7.6.4">
<h3><span class="header-section-number">7.6.4</span> Parametric Model</h3>
<p>다음은 <span class="math inline">\(40\)</span>명의 폐암환자들의 생존시간을 조사한 것이다. <span class="math inline">\(40\)</span>명의 환자 중
<span class="math inline">\(21\)</span>명은 처리 1 (standard)에, 나머지 <span class="math inline">\(19\)</span>명은 처리 2 (test)에
할당되었으며, 생존시간에 영향을 미칠 것으로 생각되는 공변량들은 다음과
같다.<br />
<span class="math inline">\(x_1\)</span>: 진단시의 환자상태 (performance status: 0점-100점)<br />
<span class="math inline">\(x_2\)</span>: 환자의 나이 (단위: 년)<br />
<span class="math inline">\(x_3\)</span>: 진단 후 연구참여시까지의 시간 (단위: 월)<br />
TYPE: 종양의 유형 (squamous=1, small=2, adeno=3, large=4)</p>
<p><img src="survival/lo15.jpg" style="width:50.0%" /></p>
<p>SAS Code</p>
<p><img src="survival/lo16.jpg" style="width:60.0%" /></p>
<p>Results - 지수분포: <span class="math inline">\(t\,\,\, vs. \,\,\, -logS(t)\)</span></p>
<p><img src="survival/ex9.png" style="width:70.0%" /></p>
<p>Results - 와이블분포: <span class="math inline">\(logt\,\,\, vs. \,\,\, log(-logS(t))\)</span></p>
<p><img src="survival/ex10.png" style="width:70.0%" /></p>
<p>Results - 로그-정규분포: <span class="math inline">\(logt\,\,\, vs. \,\,\, \Phi^{-1}(1-S(t))\)</span></p>
<p><img src="survival/ex11.png" style="width:70.0%" /></p>
<p>Results - 로그-로지스틱분포: <span class="math inline">\(logt\,\,\, vs. \,\,\, log[(1-S(t))/S(t)]\)</span></p>
<p><img src="survival/ex12.png" style="width:70.0%" /></p>
<p>SAS Code - 지수분포</p>
<p><img src="survival/para1.png" style="width:45.0%" /></p>
<p>Results - 지수분포: <span class="math inline">\(t\,\,\, vs. \,\,\, f(t)\)</span> and
<span class="math inline">\(t\,\,\, vs. \,\,\, S(t)\)</span></p>
<p><img src="survival/para2.png" style="width:70.0%" /></p>
<p>Results - 지수분포: <span class="math inline">\(t\,\,\, vs. \,\,\, f(t)\)</span> and
<span class="math inline">\(t\,\,\, vs. \,\,\, h(t)\)</span></p>
<p><img src="survival/para3.png" style="width:70.0%" /></p>
<p>SAS Code - 와이블분포</p>
<p><img src="survival/para4.png" style="width:45.0%" /></p>
<p>Results - 와이블분포: <span class="math inline">\(t\,\,\, vs. \,\,\, f(t)\)</span> and
<span class="math inline">\(t\,\,\, vs. \,\,\, S(t)\)</span></p>
<p><img src="survival/para5.png" style="width:70.0%" /></p>
<p>Results -와이블분포: <span class="math inline">\(t\,\,\, vs. \,\,\, f(t)\)</span> and
<span class="math inline">\(t\,\,\, vs. \,\,\, h(t)\)</span></p>
<p><img src="survival/para6.png" style="width:70.0%" /></p>
<p>SAS Code - 로그노말분포</p>
<p><img src="survival/para7.png" style="width:45.0%" /></p>
<p>Results - 로그노말분포: <span class="math inline">\(t\,\,\, vs. \,\,\, f(t)\)</span> and
<span class="math inline">\(t\,\,\, vs. \,\,\, S(t)\)</span></p>
<p><img src="survival/para8.png" style="width:70.0%" /></p>
<p>Results -로그노말분포: <span class="math inline">\(t\,\,\, vs. \,\,\, f(t)\)</span> and
<span class="math inline">\(t\,\,\, vs. \,\,\, h(t)\)</span></p>
<p><img src="survival/para9.png" style="width:70.0%" /></p>
<p>SAS Code - 로그로지스틱분포</p>
<p><img src="survival/para10.png" style="width:45.0%" /></p>
<p>Results - 로그로지스틱분포: <span class="math inline">\(t\,\,\, vs. \,\,\, f(t)\)</span> and
<span class="math inline">\(t\,\,\, vs. \,\,\, S(t)\)</span></p>
<p><img src="survival/para11.png" style="width:70.0%" /></p>
<p>Results -로그로지스틱분포: <span class="math inline">\(t\,\,\, vs. \,\,\, f(t)\)</span> and
<span class="math inline">\(t\,\,\, vs. \,\,\, h(t)\)</span></p>
<p><img src="survival/para12.png" style="width:70.0%" /></p>
<p>Results - AIC</p>
<p><img src="survival/para13.png" style="width:90.0%" /></p>
</div>
<div id="aft-model" class="section level3" number="7.6.5">
<h3><span class="header-section-number">7.6.5</span> AFT model</h3>
<p>SAS Code</p>
<p><img src="survival/aft.png" style="width:80.0%" /></p>
<p>Results - 지수 AFT</p>
<p><img src="survival/aft1.png" style="width:90.0%" /></p>
<p>Results - 와이블 AFT</p>
<p><img src="survival/aft2.png" style="width:90.0%" /></p>
<p>Results - 로그노말 AFT</p>
<p><img src="survival/aft3.png" style="width:90.0%" /></p>
<p>Results - 로그로지스틱 AFT</p>
<p><img src="survival/aft4.png" style="width:90.0%" /></p>
<p>Results - AIC</p>
<p><img src="survival/aft5.png" style="width:90.0%" /></p>
</div>
<div id="cox-비례위험모형-1" class="section level3" number="7.6.6">
<h3><span class="header-section-number">7.6.6</span> Cox 비례위험모형</h3>
<p>다음은 <span class="math inline">\(40\)</span>명의 폐암환자들의 생존시간을 조사한 것이다. <span class="math inline">\(40\)</span>명의 환자 중
<span class="math inline">\(21\)</span>명은 처리 1 (standard)에, 나머지 <span class="math inline">\(19\)</span>명은 처리 2 (test)에
할당되었으며, 생존시간에 영향을 미칠 것으로 생각되는 공변량들은 다음과
같다.<br />
<span class="math inline">\(x_1\)</span>: 진단시의 환자상태 (performance status: 0점-100점)<br />
<span class="math inline">\(x_2\)</span>: 환자의 나이 (단위: 년)<br />
<span class="math inline">\(x_3\)</span>: 진단 후 연구참여시까지의 시간 (단위: 월)<br />
TYPE: 종양의 유형 (squamous=1, small=2, adeno=3, large=4)</p>
<p><img src="survival/lo15.jpg" style="width:50.0%" /></p>
<p>SAS Code</p>
<p><img src="survival/lo19.jpg" style="width:70.0%" /></p>
<p><img src="survival/lo20.jpg" style="width:90.0%" /></p>
<p>Results - 비례성 검토</p>
<p><img src="survival/lo20_1.jpg" style="width:80.0%" /></p>
<p>SAS Code - 비례성검토를 위한 plot</p>
<p><img src="survival/lo21.jpg" style="width:80.0%" /></p>
<p><img src="survival/ex13.png" style="width:90.0%" /></p>
</div>
<div id="cox-비례위험모형---time-dependent-covariate" class="section level3" number="7.6.7">
<h3><span class="header-section-number">7.6.7</span> Cox 비례위험모형 - time dependent covariate</h3>
<p>다음은 Stanford 심장 이식 프로그램 대기자에 대한 생존 자료이다.<br />
surv1: survival time, dead: censoring(0), death(1)<br />
plant: receved tranplant 1=yes<br />
surg: prior bypass surgery 1=yes<br />
ageaccpt: year of acceptance</p>
<p><img src="survival/trans1.png" style="width:100.0%" /></p>
<p>SAS Code</p>
<p><img src="survival/trans2.png" style="width:80.0%" /></p>
<p>Results - 시간을 고려하지 않은 경우</p>
<p><img src="survival/trans3.png" style="width:90.0%" /></p>
<p>Results - 시간을 고려한 경우</p>
<p><img src="survival/trans4.png" style="width:70.0%" /></p>
</div>
<div id="competing-risks" class="section level3" number="7.6.8">
<h3><span class="header-section-number">7.6.8</span> Competing Risks</h3>
<p>다음은 급성 백혈병(acute leukemia) 치료를 위한 골수이식술에 대한 생존
자료이다.<br />
Group: ALL, AML low-risk, AML high-risk<br />
T: disease-free survival time in days<br />
Status: censoring(0), relapse(1), death(2)<br />
Waittime: waiting time for transplant</p>
<p><img src="survival/cc1.png" style="width:60.0%" /></p>
<p>SAS Code</p>
<p><img src="survival/cc2.png" style="width:60.0%" /></p>
<p><img src="survival/cc3.png" style="width:90.0%" /></p>
<p>Results - Fine and Gray Model</p>
<p><img src="survival/cc4.png" style="width:90.0%" /></p>
<p>Results - CIF</p>
<p><img src="survival/cc5.png" style="width:70.0%" /></p>
<p>SAS Code</p>
<p><img src="survival/cc6.png" style="width:80.0%" /></p>
<p>Results - CIF</p>
<p><img src="survival/cc7.png" style="width:70.0%" /></p>
<p>Results - Gray’s Test</p>
<p><img src="survival/cc8.png" style="width:90.0%" /></p>
<!-------------------------------------->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="psm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["rmanual.pdf", "rmanual.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
