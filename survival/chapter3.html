<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Cox 비례위험모형(PH model) | Survival Analysis</title>
  <meta name="description" content="This is a manual for Survival Analysis" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Cox 비례위험모형(PH model) | Survival Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a manual for Survival Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Cox 비례위험모형(PH model) | Survival Analysis" />
  
  <meta name="twitter:description" content="This is a manual for Survival Analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2023-04-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter2.html"/>
<link rel="next" href="chapter4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<link href="libs/tabwid-1.0.0/scrool.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Survival Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Survival Analysis?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#basic-concept-of-study-design"><i class="fa fa-check"></i><b>1.2</b> Basic Concept of Study Design</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chapter1.html"><a href="chapter1.html#study-designs"><i class="fa fa-check"></i><b>1.2.1</b> Study designs</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapter1.html"><a href="chapter1.html#clinical-trials"><i class="fa fa-check"></i><b>1.2.2</b> Clinical trials</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#중도절단censoring"><i class="fa fa-check"></i><b>1.3</b> 중도절단(Censoring)</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="chapter1.html"><a href="chapter1.html#right-censoring"><i class="fa fa-check"></i><b>1.3.1</b> Right censoring</a></li>
<li class="chapter" data-level="1.3.2" data-path="chapter1.html"><a href="chapter1.html#left-censoring"><i class="fa fa-check"></i><b>1.3.2</b> Left censoring</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#failure-time-distribution"><i class="fa fa-check"></i><b>1.4</b> Failure Time Distribution</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chapter1.html"><a href="chapter1.html#생존함수survival-function"><i class="fa fa-check"></i><b>1.4.1</b> 생존함수(survival function)</a></li>
<li class="chapter" data-level="1.4.2" data-path="chapter1.html"><a href="chapter1.html#continuous-survival-time"><i class="fa fa-check"></i><b>1.4.2</b> Continuous survival time</a></li>
<li class="chapter" data-level="1.4.3" data-path="chapter1.html"><a href="chapter1.html#discrete-survival-time"><i class="fa fa-check"></i><b>1.4.3</b> Discrete survival time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> 비모수적 생존함수 추정</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#누적한계추정법"><i class="fa fa-check"></i><b>2.1</b> 누적한계추정법</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#분산-추정량---greenwoods-estimate-of-varhatst"><i class="fa fa-check"></i><b>2.1.1</b> 분산 추정량 - Greenwood’s estimate of <span class="math inline">\(Var(\hat{S}(t))\)</span></a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#r-예제"><i class="fa fa-check"></i><b>2.1.2</b> R 예제</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter2.html"><a href="chapter2.html#sas-예제"><i class="fa fa-check"></i><b>2.1.3</b> SAS 예제</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#생명표-방법"><i class="fa fa-check"></i><b>2.2</b> 생명표 방법</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter2.html"><a href="chapter2.html#sas-예제-1"><i class="fa fa-check"></i><b>2.2.1</b> SAS 예제</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#생존분포-비교"><i class="fa fa-check"></i><b>2.3</b> 생존분포 비교</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter2.html"><a href="chapter2.html#r-예제-1"><i class="fa fa-check"></i><b>2.3.1</b> R 예제</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter2.html"><a href="chapter2.html#sas-예제-2"><i class="fa fa-check"></i><b>2.3.2</b> SAS 예제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Cox 비례위험모형(PH model)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#cox-ph-model"><i class="fa fa-check"></i><b>3.1</b> Cox PH model</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="chapter3.html"><a href="chapter3.html#위험비hazard-ratio-계산"><i class="fa fa-check"></i><b>3.1.1</b> 위험비(hazard ratio) 계산</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#콕스-ph-모형을-이용한-보정된-생존곡선"><i class="fa fa-check"></i><b>3.2</b> 콕스 PH 모형을 이용한 보정된 생존곡선</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#비례위험-가정-평가"><i class="fa fa-check"></i><b>3.3</b> 비례위험 가정 평가</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter3.html"><a href="chapter3.html#그래프를-이용하는-방법"><i class="fa fa-check"></i><b>3.3.1</b> 그래프를 이용하는 방법</a></li>
<li class="chapter" data-level="" data-path="chapter3.html"><a href="chapter3.html#로그-로그-생존곡선-그림"><i class="fa fa-check"></i>로그-로그 생존곡선 그림</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter3.html"><a href="chapter3.html#적합도-검정"><i class="fa fa-check"></i><b>3.3.2</b> 적합도 검정</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#시간의존-공변량"><i class="fa fa-check"></i><b>3.4</b> 시간의존 공변량</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> 경쟁위험(Competing Risks)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#경쟁위험"><i class="fa fa-check"></i><b>4.2</b> 경쟁위험</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#원인별-누적발생함수"><i class="fa fa-check"></i><b>4.3</b> 원인별 누적발생함수</a></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#누적조건부확률함수"><i class="fa fa-check"></i><b>4.4</b> 누적조건부확률함수</a></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#누적발생함수-비교"><i class="fa fa-check"></i><b>4.5</b> 누적발생함수 비교</a></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#cause-specific-hazard-chs-model"><i class="fa fa-check"></i><b>4.6</b> Cause-specific hazard (CHS) model</a></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#fine-and-gray-subdistribution-model"><i class="fa fa-check"></i><b>4.7</b> Fine and Gray (subdistribution) model</a></li>
<li class="chapter" data-level="4.8" data-path="chapter4.html"><a href="chapter4.html#proportional-odds-model-using-cpf"><i class="fa fa-check"></i><b>4.8</b> Proportional odds model (using CPF)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> 모수적 생존함수 추정</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#지수분포"><i class="fa fa-check"></i><b>5.1</b> 지수분포</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#와이블분포"><i class="fa fa-check"></i><b>5.2</b> 와이블분포</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#감마분포"><i class="fa fa-check"></i><b>5.3</b> 감마분포</a></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#로그정규분포"><i class="fa fa-check"></i><b>5.4</b> 로그정규분포</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#로그로지스틱분포"><i class="fa fa-check"></i><b>5.5</b> 로그로지스틱분포</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#곰페르츠분포"><i class="fa fa-check"></i><b>5.6</b> 곰페르츠분포</a></li>
<li class="chapter" data-level="5.7" data-path="chapter5.html"><a href="chapter5.html#가속실패시간모형aft"><i class="fa fa-check"></i><b>5.7</b> 가속실패시간모형(AFT)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> 기타 이슈</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#aic-and-bic"><i class="fa fa-check"></i><b>6.1</b> AIC and BIC</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter6.html"><a href="chapter6.html#visual-inspection"><i class="fa fa-check"></i><b>6.1.1</b> Visual inspection</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter6.html"><a href="chapter6.html#aic-akaike-information-criterion"><i class="fa fa-check"></i><b>6.1.2</b> AIC (Akaike information criterion)</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter6.html"><a href="chapter6.html#bic"><i class="fa fa-check"></i><b>6.1.3</b> BIC</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#추정방법에-따른-차이"><i class="fa fa-check"></i><b>6.2</b> 추정방법에 따른 차이</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="chapter6.html"><a href="chapter6.html#piecewise"><i class="fa fa-check"></i><b>6.2.1</b> Piecewise</a></li>
<li class="chapter" data-level="6.2.2" data-path="chapter6.html"><a href="chapter6.html#splines"><i class="fa fa-check"></i><b>6.2.2</b> Splines</a></li>
<li class="chapter" data-level="6.2.3" data-path="chapter6.html"><a href="chapter6.html#mixture-cured-model"><i class="fa fa-check"></i><b>6.2.3</b> Mixture cured model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#crossover-treatment-switching"><i class="fa fa-check"></i><b>6.3</b> Crossover / Treatment switching</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chapter6.html"><a href="chapter6.html#crossover-보정방법"><i class="fa fa-check"></i><b>6.3.1</b> Crossover 보정방법</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Survival Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter3" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Cox 비례위험모형(PH model)<a href="chapter3.html#chapter3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<ul>
<li><p>모수적 모형은 분포에 대한 가정이 타당할 때는 효율적이지만 어떤 모형이 적당한가에 대한 사전 지식 없이 사용하기 어려움</p></li>
<li><p>Cox의 비례위험모형(proportional hazards model)은
준모수적(semi-parameteric) 방법으로써 생존시간의 분포에 대한 가정을
필요로 하지 않음</p></li>
<li><p>Cox PH 모형은 시간에 따라 바뀌는 공변량(time-dependent variable)의
경우에도 분석할 수 있음</p></li>
<li><p>생존자료의 분석에서 자주 사용되는 모형으로 Cox 회귀분석(Cox
regressin analysis) 이라고도 함</p></li>
</ul>
<p><br></p>
<div id="cox-ph-model" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Cox PH model<a href="chapter3.html#cox-ph-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>생존시간을 <span class="math inline">\(T\)</span>, 영향을 주는 <span class="math inline">\(p\)</span>개의 공변량 <span class="math inline">\(x_1, \ldots, x_p\)</span>이 있을
때, Cox PH model:
<span class="math display">\[h(t)=h_0(t)exp(\beta_1 x_1+\cdots +\beta_p x_p)\]</span></p></li>
<li><p>여기서 <span class="math inline">\(h(t)\)</span>는 공변량들을 고려했을 때의 위험함수(hazard function),
<span class="math inline">\(h_0(t)\)</span>는 기저위험함수(baseline hazard function) (예를 들어
공변량의 값들이 모두 0일 때의 위험함수의 값)</p></li>
<li><p>콕스 PH 모형의 기저위험함수 <span class="math inline">\(h_0(t)\)</span>는 모수적 가정을 하지 않으므로 준모수적 방법이며, 콕스 모형의 중요한 특징 중 하나임</p></li>
<li><p>콕스 모형이 널리 사용되는 가장 중요한 이유는 기저위험함수의 분포에 대한 가정 없이도 회귀계수 및 위험비를 잘 추정해주고, 다양한 데이터에서 보정된 생존곡선을 그릴 수 있는 장점 때문</p></li>
<li><p>콕스 모형은 매우 강건(robust)하기 때문에 정확한 모수적인 모형의 추정 결과와 근접한 결과를 얻을 수 있음</p>
<ul>
<li>기저위험함수에 대한 정확한 모수적 모형을 알 수 있는 경우에, 콕스 모형을 통한 분석 결과는 모수적 모형의 결과와 매우 유사함</li>
</ul></li>
</ul>
<p><br></p>
<div id="위험비hazard-ratio-계산" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> 위험비(hazard ratio) 계산<a href="chapter3.html#위험비hazard-ratio-계산" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>위험비는 어떤 대상의 위함을 다른 대상의 위험으로 나눈 값</p></li>
<li><p>어떤 대상의 설명변수들을 <span class="math inline">\(X^*\)</span>라 하고 다른 대상의 설명변수들을 <span class="math inline">\(X\)</span>라고 하면 추정된 위험비는 다음과 같음</p></li>
</ul>
<p><span class="math display">\[
\hat{HR}=\frac{\hat{h}(t,X^*)}{\hat{h}(t,X)}
\]</span></p>
<ul>
<li>위험비의 식을 기저위험함수와 지수식의 곱으로 표현하면, 기저위험함수는 약분되어 사라지고 지수식만 남게 됨</li>
</ul>
<p><span class="math display">\[
\hat{HR}=exp(\sum_{i=1}^p \hat{\beta}(X_i^*-X_i))
\]</span></p>
<ul>
<li><p>위험비의 계산에서 시간에 따라 변화하는 기저위험함수가 사라지고 설명변수와 회귀계수만 남게 됨</p></li>
<li><p>즉, 위험비는 시간이 변하더라도 변하지 않고 일정함을 의미함. 따라서 콕스의 위험비를 "비례위험"이라고 함</p></li>
<li><p>AutoReg 패키지에 포함되어 있는 anderson 데이터를 사용하여 콕스 PH 모형을 적합 하면 다음과 같음</p></li>
</ul>
<blockquote>
<blockquote>
<p>anderson 데이터는 백혈병 환자 42명의 데이터로 대조군(rx=1)과 치료군(rx=0)의 재발(status=1)까지의 시간[time, 단위: 주수(week)]을 기록한 생존데이터이다. 이 데이터에는 성별(sex 0:Female, 1:Male)과 로그백혈구 수(logWBC)가 포함되어 있다.</p>
</blockquote>
</blockquote>
<ul>
<li>필요 패키지 로드</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter3.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(autoReg)</span>
<span id="cb1-2"><a href="chapter3.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-3"><a href="chapter3.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb1-4"><a href="chapter3.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(howto)</span>
<span id="cb1-5"><a href="chapter3.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb1-6"><a href="chapter3.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ftExtra)</span>
<span id="cb1-7"><a href="chapter3.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="chapter3.html#cb2-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx<span class="sc">+</span>logWBC,<span class="at">data=</span>anderson)</span>
<span id="cb2-2"><a href="chapter3.html#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(time, status) ~ rx + logWBC, data = anderson)
## 
##   n= 42, number of events= 30 
## 
##          coef exp(coef) se(coef)     z Pr(&gt;|z|)    
## rx     1.3861    3.9991   0.4248 3.263   0.0011 ** 
## logWBC 1.6909    5.4243   0.3359 5.034  4.8e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##        exp(coef) exp(-coef) lower .95 upper .95
## rx         3.999     0.2501     1.739     9.195
## logWBC     5.424     0.1844     2.808    10.478
## 
## Concordance= 0.852  (se = 0.04 )
## Likelihood ratio test= 46.71  on 2 df,   p=7e-11
## Wald test            = 33.6  on 2 df,   p=5e-08
## Score (logrank) test = 46.07  on 2 df,   p=1e-10</code></pre>
<ul>
<li>위 모형과 같이 rx의 변화에 따른 위험비는 다음과 같음. 이때 모형에 같이 적용된 logWBC는 두 개체간 같은 값을 가진다고 가정함</li>
</ul>
<p><span class="math display">\[
\hat{HR}=exp(1.3861(1-0)+1.6909(logWBC-logWBC))=exp(1.3861)=3.999
\]</span></p>
<ul>
<li>따라서 rx=0인 경우보다 rx=1인 경우에 위험도는 3.999배 높다고 할 수 있음</li>
<li>마찬가지로 rx가 같은 경우 logWBC 값이 1 증가할 경우 위험도는 5.424배 높아짐</li>
</ul>
<p>**** 추가설명 {-}</p>
<ul>
<li><p>양변에 로그를 취하고 <span class="math inline">\(\alpha(t)=logh_0(t)\)</span>로 놓으면
<span class="math display">\[log h(t)=\alpha(t)+\beta_1x_1+\cdots+\beta_px_p\]</span></p></li>
<li><p>만약 <span class="math inline">\(\alpha(t)=\alpha_0\)</span>로 놓으면 지수모형과 같은 형태</p></li>
<li><p>만약 <span class="math inline">\(\alpha(t)=\alpha_0 + \alpha t\)</span>로 놓으면 곰페르츠 모형과 같은
형태</p></li>
<li><p>만약 <span class="math inline">\(\alpha(t)=\alpha_0 + \alpha logt\)</span>로 놓으면 와이블 모형과 같은
형태</p></li>
<li><p>Cox 모형은 분포의 선택이 필요하지 않으며, <span class="math inline">\(\alpha(t)\)</span>의 형태가 어떤
것이든 무관</p></li>
<li><p>"비례위험모형"의 의미는 어느 환자의 위험률과 다른 환자의 위험률의
비가 시간에 대해 일정하다는 것을 의미</p></li>
<li><p>예를 들어, <span class="math inline">\(i\)</span>번째 환자와 <span class="math inline">\(j\)</span>번째 환자의 위험함수의 비는</p></li>
</ul>
<p><span class="math display">\[h_i(t)/h_j(t)=exp(\beta_1(x_{i1}-x_{j1})+\cdots+\beta_p(x_{ip}-x_{jp}))\]</span></p>
<p>가 되어 기저위험함수는 상쇄되어 없어지고 위험함수의 비는 시간에
대해서 상수로 됨</p>
<ul>
<li>비례위험의 가정이 맞다면, 두 환자에 대해 시간 <span class="math inline">\(t\)</span>에 따른
<span class="math inline">\(log\hat{H}(t)\)</span> 또는 <span class="math inline">\(log(-log\hat{S}(t))\)</span>의 그래프가 평행하게
되어야 함</li>
</ul>
<p><img src="survival2/f7.png" /></p>
<p><br></p>
</div>
</div>
<div id="콕스-ph-모형을-이용한-보정된-생존곡선" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> 콕스 PH 모형을 이용한 보정된 생존곡선<a href="chapter3.html#콕스-ph-모형을-이용한-보정된-생존곡선" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>anderson 데이터에서 rx에 따른 생존곡선은 다음과 같음</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="chapter3.html#cb4-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx,<span class="at">data=</span>anderson)</span>
<span id="cb4-2"><a href="chapter3.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d1-1.png" width="672" /></p>
<ul>
<li><p>logWBC의 효과를 보정하고 rx에 따른 생존곡선을 그리려면 먼저 그림을 그릴 새로운 데이터를 생성해야 함</p></li>
<li><p>이때, rx의 값과 logWBC의 값을 정해주어야 하며, logWBC의 중앙값을 적용함</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="chapter3.html#cb5-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx<span class="sc">+</span>logWBC,<span class="at">data=</span>anderson)</span>
<span id="cb5-2"><a href="chapter3.html#cb5-2" aria-hidden="true" tabindex="-1"></a>rx<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb5-3"><a href="chapter3.html#cb5-3" aria-hidden="true" tabindex="-1"></a>logWBC<span class="ot">=</span><span class="fu">median</span>(anderson<span class="sc">$</span>logWBC)</span>
<span id="cb5-4"><a href="chapter3.html#cb5-4" aria-hidden="true" tabindex="-1"></a>newdata<span class="ot">=</span><span class="fu">data.frame</span>(rx,logWBC)</span>
<span id="cb5-5"><a href="chapter3.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">survfit</span>(fit,<span class="at">newdata=</span>newdata),<span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb5-6"><a href="chapter3.html#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;rx=0&quot;</span>,<span class="st">&quot;rx=1&quot;</span>), <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d2-1.png" width="672" /></p>
<ul>
<li>R의 autoReg 패키지 내 adjustedPlot을 이용하여 보정된 생존곡선을 그리는 것이 가능함</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="chapter3.html#cb6-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx<span class="sc">+</span>logWBC,<span class="at">data=</span>anderson)</span>
<span id="cb6-2"><a href="chapter3.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedPlot</span>(fit2,<span class="at">xnames=</span><span class="st">&quot;rx&quot;</span>)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d3-1.png" width="672" /></p>
<ul>
<li>설명 변수가 여러 개 있는 경우에도 보정된 생존곡선이 가능</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="chapter3.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cancer,<span class="at">package=</span><span class="st">&quot;survival&quot;</span>)</span>
<span id="cb7-2"><a href="chapter3.html#cb7-2" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx<span class="sc">+</span>sex<span class="sc">+</span>age<span class="sc">+</span>differ,<span class="at">data=</span>colon)</span>
<span id="cb7-3"><a href="chapter3.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">adjustedPlot</span>(fit,<span class="at">xnames=</span><span class="fu">c</span>(<span class="st">&quot;rx&quot;</span>))</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d4-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="비례위험-가정-평가" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 비례위험 가정 평가<a href="chapter3.html#비례위험-가정-평가" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>비례위험 가정을 평가하는 방법으로 1) 그래프를 이용하는 방법, 2) 적합도 검정을 이용하는 방법, 3) 시간의존 공변량을 사용하는 방법 등이 있음</li>
</ul>
<div id="그래프를-이용하는-방법" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> 그래프를 이용하는 방법<a href="chapter3.html#그래프를-이용하는-방법" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>비례위험 가정을 평가하는 방법 중 그래프를 이용하는 방법은 1) 로그-로그(log-log) 생존곡선을 비교하는 방법, 2) 관찰생존곡선-기대생존곡선을 비교하는 방법이 있다.</li>
</ul>
</div>
<div id="로그-로그-생존곡선-그림" class="section level3 unnumbered hasAnchor">
<h3>로그-로그 생존곡선 그림<a href="chapter3.html#로그-로그-생존곡선-그림" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>두 그룹 간의 생존을 비교할 때 콕스비례위험 가정하에 두 그룹의 생존은 다음과 같음 관계를 가짐</p></li>
<li><p><span class="math inline">\(S_0\)</span>를 첫번째 그룹의 생존, <span class="math inline">\(S_1\)</span>을 두 번째 그룹의 생존, <span class="math inline">\(exp(\beta)\)</span>를 비례위험상수라 하면</p></li>
</ul>
<p><span class="math display">\[
S_1(t)=S_0(t)^{exp(\beta)}
\]</span></p>
<ul>
<li>양변에 로그를 취하면</li>
</ul>
<p><span class="math display">\[
log(S_1(t))=exp(\beta) \times log(S_0(t))
\]</span></p>
<ul>
<li>생존함수는 1보다 작으므로 생존함수의 로그는 음수값이 됨. 양변에 -1을 곱한 후 다시 양변의 로그를 취하면</li>
</ul>
<p><span class="math display">\[
log(-log(S_1(t)))=\beta + log(-log(S_0(t)))
\]</span></p>
<ul>
<li>따라서 비례위험 가정이 맞으면, 로그-로그 곡선은 <span class="math inline">\(\beta\)</span> 크기만큼 차이를 두고 평행해야 함</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="chapter3.html#cb8-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx,<span class="at">data=</span>anderson)</span>
<span id="cb8-2"><a href="chapter3.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loglogplot</span>(fit)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d5-1.png" width="672" /></p>
<ul>
<li>anderson 데이터에서 sex를 설명변수로 하는 모형의 비례위험가정을 살펴보면</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapter3.html#cb9-1" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">=</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>sex,<span class="at">data=</span>anderson)</span>
<span id="cb9-2"><a href="chapter3.html#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loglogplot</span>(fit1)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d6-1.png" width="672" /></p>
<ul>
<li><p>남자(sex=0)와 여자(sex=1)의 로그-로그 생존곡선이 서로 교차하기 때문에 비례위험 가정이 맞지 않음</p></li>
<li><p>logWBC에 대해서, logWBC는 연속형 변수이기 때문에 그룹으로 나누어 살펴보아야 함</p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapter3.html#cb10-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">=</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>logWBC,<span class="at">data=</span>anderson)</span>
<span id="cb10-2"><a href="chapter3.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loglogplot</span>(fit2)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d7-1.png" width="672" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="chapter3.html#cb11-1" aria-hidden="true" tabindex="-1"></a>fit3<span class="ot">=</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx<span class="sc">+</span>logWBC,<span class="at">data=</span>anderson)</span>
<span id="cb11-2"><a href="chapter3.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loglogplot</span>(fit3,<span class="at">no=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d8-1.png" width="672" /></p>
<ul>
<li><p>로그-로그 생존곡선을 이용하여 비례위험 가정을 평가하는 방법은 직관적이기는 하지만 통계적 유의성을 평가할 수 없음</p></li>
<li><p>특히, 데이터의 수가 적은 경우 문제가 되며, 여러 변수에 대하여 한꺼번에 로그-로그 생존곡선을 그리는 경우 각 그룹에 속한 데이터의 개수가 더 작아지므로 가능하면 하나의 변수를 평가하는 것이 바람직함</p></li>
</ul>
<p><br></p>
<div id="관측-기대값-그림" class="section level4 unnumbered hasAnchor">
<h4>관측-기대값 그림<a href="chapter3.html#관측-기대값-그림" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>관측-기대값 그림(observed versus expected plot)은 적합도 검정(goodness of fit, GOF) 검정을 그래프로 그린 것이며, 로그-로그 생존곡선의 대안이 될 수 있음</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapter3.html#cb12-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx,<span class="at">data=</span>anderson)</span>
<span id="cb12-2"><a href="chapter3.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">OEplot</span>(fit)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d9-1.png" width="672" /></p>
<ul>
<li><p>점선으로 나타낸 기대값과 실선으로 나타난 관측값 곡선이 가까우면 비례위험 가정에 적합하며, 두 곡선에 차이가 있으면 비례위험 가정이 위배된다고 할 수 있음</p></li>
<li><p>로그-로그 생존곡선이 "얼마나 평행해야 평행한 것인가?"라는 한계가 있는 것과 마찬가지로 관측-기대값 그림 또한 "얼마나 가까워야 가까운 것인가?"라는 문제가 있음</p></li>
<li><p>관측값과 기대값의 차이가 심하게 나타날 때 비례위험 가정에 위반된다고 평가하는 것이 바람직 함</p></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter3.html#cb13-1" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>sex,<span class="at">data=</span>anderson)</span>
<span id="cb13-2"><a href="chapter3.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">OEplot</span>(fit1)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d10-1.png" width="672" /></p>
<ul>
<li>성별에 대해서는 비례위험 가정을 만족하지 못할 가능성을 시사해 줌</li>
</ul>
<p><br></p>
</div>
</div>
<div id="적합도-검정" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> 적합도 검정<a href="chapter3.html#적합도-검정" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>적합도 검정은 관심 있는 설명변수의 비례위험 가정에 대한 검정통계량과 p값을 제공해주기 때문에 그래프를 이용한 방법에 비해 보다 객관적인 결과를 제시함</p></li>
<li><p>적합도 검정에는 Schoenfeld 잔차를 사용하며, Schoenfeld 잔차는 대상환자 각각에 대하여 이벤트 발생 시 관찰된 예측변수 값에서 예측변수의 가중평균을 빼서 계산</p></li>
<li><p>적합도 검정은 특정 예측변수에 대한 Schoenfeld 잔차가 생존시간에 관계없이 일정한지를 검정</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter3.html#cb14-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span>rx<span class="sc">+</span>sex<span class="sc">+</span>logWBC,<span class="at">data=</span>anderson)</span>
<span id="cb14-2"><a href="chapter3.html#cb14-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">cox.zph</span>(fit)</span>
<span id="cb14-3"><a href="chapter3.html#cb14-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div>
<pre><code>##        chisq df    p
## rx     0.036  1 0.85
## sex    5.420  1 0.02
## logWBC 0.142  1 0.71
## GLOBAL 5.879  3 0.12</code></pre>
<ul>
<li>rx와 logWBC에 대한 p값은 유의하지 않으나 sex에 대한 p값은 유의한 것으로 나타남</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter3.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxzphplot</span>(x)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d12-1.png" width="672" /></p>
<ul>
<li>이 중 sex에 대한 plot만 그려보면</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="chapter3.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coxzphplot</span>(x, <span class="at">var=</span><span class="st">&quot;sex&quot;</span>, <span class="at">add.lm=</span>T)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/d13-1.png" width="672" /></p>
<ul>
<li>loess(blue) 회귀곡선에 빨간색의 직선회귀선을 그린 그림으로, 시간이 경과함에 따라서 sex의 위험이 감소하는 것으로 나타남. 이는 시간의 흐름에 따라 sex의 위험이 일정하지 않은, 비례위험 가정을 만족하지 않은 것을 뜻 함</li>
</ul>
<p><br></p>
</div>
</div>
<div id="시간의존-공변량" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> 시간의존 공변량<a href="chapter3.html#시간의존-공변량" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>콕스 PH 모형의 중요한 가정은 연구가 시작될 때 공변량이 정해지며 시간이 지나도 공변량은 변하지 않는다는 것임</p></li>
<li><p>하지만 어떤 경우에는 공변량이 시간에 따라 변할 수 있으며, 이를 시간의존 공변량(time-dependent covariate)이라고 함</p></li>
<li><p>예를 들어, 백혈병 환자의 사망 시점이 관심 있는 반응변수일 때 골수이식과 같은 중간사건(intermediate event)의 발생 여부는 사망시간을 예측하는 데 매우 중요한 영향을 미칠 수 있음</p>
<ul>
<li>여기서 중간사건은 연구 기간 동안 그 발생 여부가 서로 다르며 발생 시점 또한 다름</li>
<li>따라서, 중간사건은 시간의존 공변량으로 간주할 수 있음</li>
</ul></li>
<li><p>시간에 따라 변화하는 공변량을 고려한 Cox PH 모형</p></li>
</ul>
<p><span class="math display">\[
log h(t)=\alpha(t)+\beta_1 x_1 +\cdots +\beta_p x_p + \beta_{p+1}x_{p+1}(t)
\]</span></p>
<p><br></p>
<div id="스탠포드-심장이식-연구" class="section level4 unnumbered hasAnchor">
<h4>스탠포드 심장이식 연구<a href="chapter3.html#스탠포드-심장이식-연구" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p>시간의존 공변량을 다룰 때 주의할 점은 미래의 공변량 값으로 생존을 예측할 수 없다는 것임</p></li>
<li><p>1971년 Clark 등의 연구에서, 심장이식 프로그램에 등록된 환자의 생존에 대해, 심장이식을 받은 환자는 심장이식을 받지 않은 환자에 비해 유의하게 생존이 증가함을 시사함</p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter3.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(heart,<span class="at">package=</span><span class="st">&quot;survival&quot;</span>) </span>
<span id="cb18-2"><a href="chapter3.html#cb18-2" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(futime,fustat)<span class="sc">~</span>transplant<span class="sc">+</span>age<span class="sc">+</span>surgery,<span class="at">data=</span>jasa)</span>
<span id="cb18-3"><a href="chapter3.html#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(futime, fustat) ~ transplant + age + surgery, 
##     data = jasa)
## 
##   n= 103, number of events= 75 
## 
##                coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## transplant -1.71711   0.17958  0.27853 -6.165 7.05e-10 ***
## age         0.05889   1.06065  0.01505  3.913 9.12e-05 ***
## surgery    -0.41902   0.65769  0.37118 -1.129    0.259    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##            exp(coef) exp(-coef) lower .95 upper .95
## transplant    0.1796     5.5684    0.1040     0.310
## age           1.0607     0.9428    1.0298     1.092
## surgery       0.6577     1.5205    0.3177     1.361
## 
## Concordance= 0.732  (se = 0.031 )
## Likelihood ratio test= 45.85  on 3 df,   p=6e-10
## Wald test            = 47.15  on 3 df,   p=3e-10
## Score (logrank) test = 52.63  on 3 df,   p=2e-11</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapter3.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gaze</span>(fit) <span class="sc">%&gt;%</span> <span class="fu">myft</span>() <span class="sc">%&gt;%</span> <span class="fu">highlight</span>(<span class="at">i=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Usage of empty symbol &#39;&#39; with footnote should not happen, use `add_footer_lines()` instead, it does not require any symbol. This usage will be forbidden in the next release. Please, wait for 10 seconds!</code></pre>
<template id="0cc220ff-27bb-486f-9847-76679c2f73df"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-dae21bc0{}.cl-dadc2850{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dadc2851{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:rgba(255, 255, 0, 1.00);}.cl-dadc2852{font-family:'Arial';font-size:6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:rgba(255, 255, 0, 1.00);position: relative;bottom:3pt;}.cl-dadc2853{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dadc2854{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-dadc4f60{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dadc4f61{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dadc4f62{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dadc4f63{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dadc7670{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc7671{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc7672{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc7673{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc7674{width:64.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc7675{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc7676{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc7677{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc7678{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc7679{width:64.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc767a{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d80{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d81{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d82{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d83{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d84{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d85{width:64.4pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d86{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d87{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d88{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d89{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadc9d8a{width:64.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc490{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc491{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc492{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc493{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc494{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc495{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc496{width:64.4pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc497{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc498{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc499{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadcc49a{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadceba0{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dadceba1{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-dae21bc0'>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-dadcc496"><p class="cl-dadc4f60"><span class="cl-dadc2850"> </span></p></td><td class="cl-dadcc497"><p class="cl-dadc4f60"><span class="cl-dadc2850">coef</span></p></td><td class="cl-dadceba1"><p class="cl-dadc4f60"><span class="cl-dadc2850">se(coef)</span></p></td><td class="cl-dadcc497"><p class="cl-dadc4f60"><span class="cl-dadc2850">z</span></p></td><td class="cl-dadcc49a"><p class="cl-dadc4f60"><span class="cl-dadc2850">Pr(&gt;|z|)</span></p></td><td class="cl-dadcc498"><p class="cl-dadc4f60"><span class="cl-dadc2850">HR</span></p></td><td class="cl-dadcc499"><p class="cl-dadc4f60"><span class="cl-dadc2850">lower</span></p></td><td class="cl-dadceba0"><p class="cl-dadc4f60"><span class="cl-dadc2850">upper</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-dadc7674"><p class="cl-dadc4f61"><span class="cl-dadc2851">transplant</span><span class="cl-dadc2852"></span></p></td><td class="cl-dadc7675"><p class="cl-dadc4f62"><span class="cl-dadc2851">-1.717</span><span class="cl-dadc2852"></span></p></td><td class="cl-dadc7672"><p class="cl-dadc4f62"><span class="cl-dadc2851">0.279</span></p></td><td class="cl-dadc7675"><p class="cl-dadc4f62"><span class="cl-dadc2851">-6.165</span></p></td><td class="cl-dadc7676"><p class="cl-dadc4f62"><span class="cl-dadc2851">&lt;.001</span></p></td><td class="cl-dadc7673"><p class="cl-dadc4f62"><span class="cl-dadc2851">0.180</span></p></td><td class="cl-dadc7670"><p class="cl-dadc4f62"><span class="cl-dadc2851">0.104</span></p></td><td class="cl-dadc7671"><p class="cl-dadc4f62"><span class="cl-dadc2851">0.310</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-dadc7679"><p class="cl-dadc4f61"><span class="cl-dadc2853">age</span></p></td><td class="cl-dadc9d80"><p class="cl-dadc4f62"><span class="cl-dadc2853">0.059</span></p></td><td class="cl-dadc9d82"><p class="cl-dadc4f62"><span class="cl-dadc2853">0.015</span></p></td><td class="cl-dadc9d80"><p class="cl-dadc4f62"><span class="cl-dadc2853">3.913</span></p></td><td class="cl-dadc767a"><p class="cl-dadc4f62"><span class="cl-dadc2853">&lt;.001</span></p></td><td class="cl-dadc9d81"><p class="cl-dadc4f62"><span class="cl-dadc2853">1.061</span></p></td><td class="cl-dadc7678"><p class="cl-dadc4f62"><span class="cl-dadc2853">1.030</span></p></td><td class="cl-dadc7677"><p class="cl-dadc4f62"><span class="cl-dadc2853">1.092</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-dadc9d85"><p class="cl-dadc4f61"><span class="cl-dadc2853">surgery</span></p></td><td class="cl-dadc9d84"><p class="cl-dadc4f62"><span class="cl-dadc2853">-0.419</span></p></td><td class="cl-dadc9d87"><p class="cl-dadc4f62"><span class="cl-dadc2853">0.371</span></p></td><td class="cl-dadc9d84"><p class="cl-dadc4f62"><span class="cl-dadc2853">-1.129</span></p></td><td class="cl-dadc9d88"><p class="cl-dadc4f62"><span class="cl-dadc2853">.259</span></p></td><td class="cl-dadc9d89"><p class="cl-dadc4f62"><span class="cl-dadc2853">0.658</span></p></td><td class="cl-dadc9d83"><p class="cl-dadc4f62"><span class="cl-dadc2853">0.318</span></p></td><td class="cl-dadc9d86"><p class="cl-dadc4f62"><span class="cl-dadc2853">1.361</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-dadc9d8a"><p class="cl-dadc4f63"><span class="cl-dadc2854"></span><span class="cl-dadc2850">n=103, events=75, Likelihood ratio test=45.85 on 3 df (p&lt;.001)</span></p></td></tr></tfoot></table></div></template>
<div class="flextable-shadow-host" id="38d39aa5-39df-495e-905d-2d837ab912b9"></div>
<script>
var dest = document.getElementById("38d39aa5-39df-495e-905d-2d837ab912b9");
var template = document.getElementById("0cc220ff-27bb-486f-9847-76679c2f73df");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p><br></p>
<ul>
<li>이 연구에서 가장 중요한 공변량 transplant는 심장이식을 받은 경우 1, 받지 않은 경우 0으로 입력되었으며, 공변량 transplant의 위험률(hazard ratio)는 0.18로 매우 낮은 p값을 보임
<ul>
<li>이 결과는 심장이식이 환자의 수명을 늘리는 데 매우 효과적임을 시사함</li>
<li>하지만, 이 연구의 문제는 심장이식이 시간에 따라 변화하는 공변량이라는 점이며, 환자가 심장이식을 받기 위해서는 심장이식을 받을 수 있을 만큼 오래 살아야 함을 의미함</li>
<li>따라서 이 결과는 오래 산 환자(심장이식 받음)가 오래 살지 못한 환자에 비해 오래 살았다는 것을 보여준 것에 지나지 않음</li>
</ul></li>
<li>이러한 문제에 대한 간단한 해결방법은 랜드마크 시간을 정해 환자를 두 군으로 나누는 것임
<ul>
<li>랜드마크 시간전에 심장이식을 받은 환자들은 환자군으로 하고 심장이식을 받지 못한 환자들은 대조군으로 함</li>
<li>이때 중요한 점은 1) 랜드마크 시간까지 생존한 환자들만 연구에 포함시키고 2) 모든 환자들(특히 대조군에 속한 환자들)은 랜드마크 시간 이후에 이식을 받더라도 대조군에 계속 남아 있어야 함</li>
</ul></li>
<li>랜드마크 30일을 기준으로 한 분석 결과</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapter3.html#cb22-1" aria-hidden="true" tabindex="-1"></a>ind30 <span class="ot">&lt;-</span> jasa<span class="sc">$</span>futime <span class="sc">&gt;=</span> <span class="dv">30</span></span>
<span id="cb22-2"><a href="chapter3.html#cb22-2" aria-hidden="true" tabindex="-1"></a>transplant30 <span class="ot">&lt;-</span> (jasa<span class="sc">$</span>transplant<span class="sc">==</span><span class="dv">1</span>) <span class="sc">&amp;</span> (jasa<span class="sc">$</span>wait.time<span class="sc">&lt;</span><span class="dv">30</span>)</span>
<span id="cb22-3"><a href="chapter3.html#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="chapter3.html#cb22-4" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(futime,fustat)<span class="sc">~</span>transplant30<span class="sc">+</span>age<span class="sc">+</span>surgery,<span class="at">data=</span>jasa,<span class="at">subset=</span>ind30)</span>
<span id="cb22-5"><a href="chapter3.html#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="fu">gaze</span>(fit1) <span class="sc">%&gt;%</span><span class="fu">myft</span>( ) <span class="sc">%&gt;%</span> <span class="fu">highlight</span>(<span class="at">i=</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Usage of empty symbol &#39;&#39; with footnote should not happen, use `add_footer_lines()` instead, it does not require any symbol. This usage will be forbidden in the next release. Please, wait for 10 seconds!</code></pre>
<template id="8202a712-b26f-42f0-8d59-e7084fc88b53"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
.katex-display {
    margin: 0 0 !important;
}
</style><div class="tabwid"><style>.cl-e10668b2{}.cl-e101adb8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e101adb9{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:rgba(255, 255, 0, 1.00);}.cl-e101adba{font-family:'Arial';font-size:6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:rgba(255, 255, 0, 1.00);position: relative;bottom:3pt;}.cl-e101adbb{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e101adbc{font-family:'Arial';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-e101adbd{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e101adbe{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e101adbf{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2pt;padding-top:2pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e101adc0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e101d4c8{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4c9{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4ca{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4cb{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4cc{width:102.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4cd{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4ce{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4cf{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4d0{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4d1{width:102.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101d4d2{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbe2{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbe3{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbe4{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbe5{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbe6{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbe7{width:102.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbe8{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbe9{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbea{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbeb{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e101fbec{width:102.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222e8{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222e9{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222ea{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222eb{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222ec{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222ed{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222ee{width:102.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222ef{width:48.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222f0{width:45.6pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222f1{width:46.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10222f2{width:56.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10249f8{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e10249f9{width:60.3pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-e10668b2'>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-e10222ee"><p class="cl-e101adbd"><span class="cl-e101adb8"> </span></p></td><td class="cl-e10222ef"><p class="cl-e101adbd"><span class="cl-e101adb8">coef</span></p></td><td class="cl-e10249f9"><p class="cl-e101adbd"><span class="cl-e101adb8">se(coef)</span></p></td><td class="cl-e10222ef"><p class="cl-e101adbd"><span class="cl-e101adb8">z</span></p></td><td class="cl-e10222f2"><p class="cl-e101adbd"><span class="cl-e101adb8">Pr(&gt;|z|)</span></p></td><td class="cl-e10222f0"><p class="cl-e101adbd"><span class="cl-e101adb8">HR</span></p></td><td class="cl-e10222f1"><p class="cl-e101adbd"><span class="cl-e101adb8">lower</span></p></td><td class="cl-e10249f8"><p class="cl-e101adbd"><span class="cl-e101adb8">upper</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e101d4cc"><p class="cl-e101adbe"><span class="cl-e101adb9">transplant30TRUE</span><span class="cl-e101adba"></span></p></td><td class="cl-e101d4cd"><p class="cl-e101adbf"><span class="cl-e101adb9">-0.042</span><span class="cl-e101adba"></span></p></td><td class="cl-e101d4ca"><p class="cl-e101adbf"><span class="cl-e101adb9">0.284</span></p></td><td class="cl-e101d4cd"><p class="cl-e101adbf"><span class="cl-e101adb9">-0.148</span></p></td><td class="cl-e101d4ce"><p class="cl-e101adbf"><span class="cl-e101adb9">.882</span></p></td><td class="cl-e101d4cb"><p class="cl-e101adbf"><span class="cl-e101adb9">0.959</span></p></td><td class="cl-e101d4c8"><p class="cl-e101adbf"><span class="cl-e101adb9">0.550</span></p></td><td class="cl-e101d4c9"><p class="cl-e101adbf"><span class="cl-e101adb9">1.672</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e101d4d1"><p class="cl-e101adbe"><span class="cl-e101adbb">age</span></p></td><td class="cl-e101fbe2"><p class="cl-e101adbf"><span class="cl-e101adbb">0.037</span></p></td><td class="cl-e101fbe4"><p class="cl-e101adbf"><span class="cl-e101adbb">0.017</span></p></td><td class="cl-e101fbe2"><p class="cl-e101adbf"><span class="cl-e101adbb">2.170</span></p></td><td class="cl-e101d4d2"><p class="cl-e101adbf"><span class="cl-e101adbb">.030</span></p></td><td class="cl-e101fbe3"><p class="cl-e101adbf"><span class="cl-e101adbb">1.038</span></p></td><td class="cl-e101d4d0"><p class="cl-e101adbf"><span class="cl-e101adbb">1.004</span></p></td><td class="cl-e101d4cf"><p class="cl-e101adbf"><span class="cl-e101adbb">1.073</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e101fbe7"><p class="cl-e101adbe"><span class="cl-e101adbb">surgery</span></p></td><td class="cl-e101fbe6"><p class="cl-e101adbf"><span class="cl-e101adbb">-0.820</span></p></td><td class="cl-e101fbe9"><p class="cl-e101adbf"><span class="cl-e101adbb">0.413</span></p></td><td class="cl-e101fbe6"><p class="cl-e101adbf"><span class="cl-e101adbb">-1.985</span></p></td><td class="cl-e101fbea"><p class="cl-e101adbf"><span class="cl-e101adbb">.047</span></p></td><td class="cl-e101fbeb"><p class="cl-e101adbf"><span class="cl-e101adbb">0.441</span></p></td><td class="cl-e101fbe5"><p class="cl-e101adbf"><span class="cl-e101adbb">0.196</span></p></td><td class="cl-e101fbe8"><p class="cl-e101adbf"><span class="cl-e101adbb">0.990</span></p></td></tr></tbody><tfoot><tr style="overflow-wrap:break-word;"><td  colspan="8"class="cl-e101fbec"><p class="cl-e101adc0"><span class="cl-e101adbc"></span><span class="cl-e101adb8">n=79, events=52, Likelihood ratio test=9.5 on 3 df (p=.023)</span></p></td></tr></tfoot></table></div></template>
<div class="flextable-shadow-host" id="f9a9b81f-6342-4504-a82a-b50a968d7477"></div>
<script>
var dest = document.getElementById("f9a9b81f-6342-4504-a82a-b50a968d7477");
var template = document.getElementById("8202a712-b26f-42f0-8d59-e7084fc88b53");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<p><br></p>
<ul>
<li>transplant30의 위험률은 0.96(95% CI: 0.55-1.67, p=.882)으로 유의하지 않게 나타남
<ul>
<li>랜드마크 분석에 따르면 심장이식을 받은 환자와 받지 않은 환자 간의 생존차이는 없다고 할 수 있음</li>
<li>랜드마크 방법은 적용하기 쉽지만 랜드마크의 크기를 어떻게 정하는지에 대한 뚜렷한 기준이 없음</li>
</ul></li>
<li>보다 나은 방법은 transplant를 시간의존 공변량으로 사용하는 것임
<ul>
<li>transplant 변수를 시간의존 공변량으로 사용하기 위한 변환</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapter3.html#cb24-1" aria-hidden="true" tabindex="-1"></a>tdata<span class="ot">=</span>jasa[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,<span class="dv">11</span><span class="sc">:</span><span class="dv">14</span>)] <span class="co">#tdata는 변환 중 임시데이터</span></span>
<span id="cb24-2"><a href="chapter3.html#cb24-2" aria-hidden="true" tabindex="-1"></a>tdata<span class="sc">$</span>futime<span class="ot">=</span><span class="fu">pmax</span>(.<span class="dv">5</span>,tdata<span class="sc">$</span>futime) <span class="co">#futime이 0인 경우 0.5로 바뀜</span></span>
<span id="cb24-3"><a href="chapter3.html#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="chapter3.html#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="do">##wait.time과 futime이 같은 경우 wait.time에서 0.5를 뺀다.</span></span>
<span id="cb24-5"><a href="chapter3.html#cb24-5" aria-hidden="true" tabindex="-1"></a>indx<span class="ot">=</span>{tdata<span class="sc">$</span>wait.time<span class="sc">==</span>tdata<span class="sc">$</span>futime}<span class="sc">&amp;</span>{<span class="sc">!</span><span class="fu">is.na</span>(tdata<span class="sc">$</span>wait.time)}</span>
<span id="cb24-6"><a href="chapter3.html#cb24-6" aria-hidden="true" tabindex="-1"></a>tdata<span class="sc">$</span>id<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(tdata)</span>
<span id="cb24-7"><a href="chapter3.html#cb24-7" aria-hidden="true" tabindex="-1"></a>sdata<span class="ot">=</span><span class="fu">tmerge</span>(tdata,tdata,<span class="at">id=</span>id,</span>
<span id="cb24-8"><a href="chapter3.html#cb24-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">death=</span><span class="fu">event</span>(futime,fustat),</span>
<span id="cb24-9"><a href="chapter3.html#cb24-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">trans=</span><span class="fu">tdc</span>(wait.time))</span>
<span id="cb24-10"><a href="chapter3.html#cb24-10" aria-hidden="true" tabindex="-1"></a>final<span class="ot">=</span>sdata[,<span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">11</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)]</span>
<span id="cb24-11"><a href="chapter3.html#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(final)</span></code></pre></div>
<pre><code>##   id tstart tstop death trans surgery      age
## 1  1      0    49     1     0       0 30.84463
## 2  2      0     5     1     0       0 51.83573
## 3  3      0    15     1     1       0 54.29706
## 4  4      0    35     0     0       0 40.26283
## 5  4     35    38     1     1       0 40.26283
## 6  5      0    17     1     0       0 20.78576</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapter3.html#cb26-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(tstart,tstop,death)<span class="sc">~</span>trans<span class="sc">+</span>surgery<span class="sc">+</span>age,<span class="at">data=</span>final)</span>
<span id="cb26-2"><a href="chapter3.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(tstart, tstop, death) ~ trans + surgery + 
##     age, data = final)
## 
##   n= 169, number of events= 75 
## 
##             coef exp(coef) se(coef)      z Pr(&gt;|z|)  
## trans   -0.07894   0.92410  0.30608 -0.258   0.7965  
## surgery -0.77035   0.46285  0.35959 -2.142   0.0322 *
## age      0.03138   1.03187  0.01392  2.253   0.0242 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##         exp(coef) exp(-coef) lower .95 upper .95
## trans      0.9241     1.0821    0.5072    1.6836
## surgery    0.4629     2.1605    0.2287    0.9365
## age        1.0319     0.9691    1.0041    1.0604
## 
## Concordance= 0.6  (se = 0.036 )
## Likelihood ratio test= 10.78  on 3 df,   p=0.01
## Wald test            = 9.72  on 3 df,   p=0.02
## Score (logrank) test = 10.05  on 3 df,   p=0.02</code></pre>
<ul>
<li>시간의존 공변량을 이용한 분석 결과, 심장이식의 HR=0.9241, p=0.7965로 심장이식이 생존을 증가시킨다는 근거를 찾을 수 없음</li>
</ul>
<p><br></p>
<p><br></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Survival Analysis.pdf", "Survival Analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
