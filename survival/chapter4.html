<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 경쟁위험(Competing Risks) | Survival Analysis</title>
  <meta name="description" content="This is a manual for Survival Analysis" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 경쟁위험(Competing Risks) | Survival Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a manual for Survival Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 경쟁위험(Competing Risks) | Survival Analysis" />
  
  <meta name="twitter:description" content="This is a manual for Survival Analysis" />
  

<meta name="author" content="Jin Hyun Nam" />


<meta name="date" content="2023-04-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter3.html"/>
<link rel="next" href="chapter5.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Survival Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>머리말</a></li>
<li class="chapter" data-level="1" data-path="chapter1.html"><a href="chapter1.html"><i class="fa fa-check"></i><b>1</b> Survival Analysis?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="chapter1.html"><a href="chapter1.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="chapter1.html"><a href="chapter1.html#basic-concept-of-study-design"><i class="fa fa-check"></i><b>1.2</b> Basic Concept of Study Design</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="chapter1.html"><a href="chapter1.html#study-designs"><i class="fa fa-check"></i><b>1.2.1</b> Study designs</a></li>
<li class="chapter" data-level="1.2.2" data-path="chapter1.html"><a href="chapter1.html#clinical-trials"><i class="fa fa-check"></i><b>1.2.2</b> Clinical trials</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chapter1.html"><a href="chapter1.html#중도절단censoring"><i class="fa fa-check"></i><b>1.3</b> 중도절단(Censoring)</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="chapter1.html"><a href="chapter1.html#right-censoring"><i class="fa fa-check"></i><b>1.3.1</b> Right censoring</a></li>
<li class="chapter" data-level="1.3.2" data-path="chapter1.html"><a href="chapter1.html#left-censoring"><i class="fa fa-check"></i><b>1.3.2</b> Left censoring</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="chapter1.html"><a href="chapter1.html#failure-time-distribution"><i class="fa fa-check"></i><b>1.4</b> Failure Time Distribution</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="chapter1.html"><a href="chapter1.html#생존함수survival-function"><i class="fa fa-check"></i><b>1.4.1</b> 생존함수(survival function)</a></li>
<li class="chapter" data-level="1.4.2" data-path="chapter1.html"><a href="chapter1.html#continuous-survival-time"><i class="fa fa-check"></i><b>1.4.2</b> Continuous survival time</a></li>
<li class="chapter" data-level="1.4.3" data-path="chapter1.html"><a href="chapter1.html#discrete-survival-time"><i class="fa fa-check"></i><b>1.4.3</b> Discrete survival time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter2.html"><a href="chapter2.html"><i class="fa fa-check"></i><b>2</b> 비모수적 생존함수 추정</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter2.html"><a href="chapter2.html#누적한계추정법"><i class="fa fa-check"></i><b>2.1</b> 누적한계추정법</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="chapter2.html"><a href="chapter2.html#분산-추정량---greenwoods-estimate-of-varhatst"><i class="fa fa-check"></i><b>2.1.1</b> 분산 추정량 - Greenwood’s estimate of <span class="math inline">\(Var(\hat{S}(t))\)</span></a></li>
<li class="chapter" data-level="2.1.2" data-path="chapter2.html"><a href="chapter2.html#r-예제"><i class="fa fa-check"></i><b>2.1.2</b> R 예제</a></li>
<li class="chapter" data-level="2.1.3" data-path="chapter2.html"><a href="chapter2.html#sas-예제"><i class="fa fa-check"></i><b>2.1.3</b> SAS 예제</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="chapter2.html"><a href="chapter2.html#생명표-방법"><i class="fa fa-check"></i><b>2.2</b> 생명표 방법</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="chapter2.html"><a href="chapter2.html#sas-예제-1"><i class="fa fa-check"></i><b>2.2.1</b> SAS 예제</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="chapter2.html"><a href="chapter2.html#생존분포-비교"><i class="fa fa-check"></i><b>2.3</b> 생존분포 비교</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="chapter2.html"><a href="chapter2.html#r-예제-1"><i class="fa fa-check"></i><b>2.3.1</b> R 예제</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter2.html"><a href="chapter2.html#sas-예제-2"><i class="fa fa-check"></i><b>2.3.2</b> SAS 예제</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter3.html"><a href="chapter3.html"><i class="fa fa-check"></i><b>3</b> Cox 비례위험모형(PH model)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="chapter3.html"><a href="chapter3.html#cox-ph-model"><i class="fa fa-check"></i><b>3.1</b> Cox PH model</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="chapter3.html"><a href="chapter3.html#위험비hazard-ratio-계산"><i class="fa fa-check"></i><b>3.1.1</b> 위험비(hazard ratio) 계산</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="chapter3.html"><a href="chapter3.html#콕스-ph-모형을-이용한-보정된-생존곡선"><i class="fa fa-check"></i><b>3.2</b> 콕스 PH 모형을 이용한 보정된 생존곡선</a></li>
<li class="chapter" data-level="3.3" data-path="chapter3.html"><a href="chapter3.html#비례위험-가정-평가"><i class="fa fa-check"></i><b>3.3</b> 비례위험 가정 평가</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="chapter3.html"><a href="chapter3.html#그래프를-이용하는-방법"><i class="fa fa-check"></i><b>3.3.1</b> 그래프를 이용하는 방법</a></li>
<li class="chapter" data-level="" data-path="chapter3.html"><a href="chapter3.html#로그-로그-생존곡선-그림"><i class="fa fa-check"></i>로그-로그 생존곡선 그림</a></li>
<li class="chapter" data-level="3.3.2" data-path="chapter3.html"><a href="chapter3.html#적합도-검정"><i class="fa fa-check"></i><b>3.3.2</b> 적합도 검정</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter3.html"><a href="chapter3.html#시간의존-공변량"><i class="fa fa-check"></i><b>3.4</b> 시간의존 공변량</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter4.html"><a href="chapter4.html"><i class="fa fa-check"></i><b>4</b> 경쟁위험(Competing Risks)</a>
<ul>
<li class="chapter" data-level="4.1" data-path="chapter4.html"><a href="chapter4.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="chapter4.html"><a href="chapter4.html#경쟁위험"><i class="fa fa-check"></i><b>4.2</b> 경쟁위험</a></li>
<li class="chapter" data-level="4.3" data-path="chapter4.html"><a href="chapter4.html#원인별-누적발생함수"><i class="fa fa-check"></i><b>4.3</b> 원인별 누적발생함수</a></li>
<li class="chapter" data-level="4.4" data-path="chapter4.html"><a href="chapter4.html#누적조건부확률함수"><i class="fa fa-check"></i><b>4.4</b> 누적조건부확률함수</a></li>
<li class="chapter" data-level="4.5" data-path="chapter4.html"><a href="chapter4.html#누적발생함수-비교"><i class="fa fa-check"></i><b>4.5</b> 누적발생함수 비교</a></li>
<li class="chapter" data-level="4.6" data-path="chapter4.html"><a href="chapter4.html#cause-specific-hazard-chs-model"><i class="fa fa-check"></i><b>4.6</b> Cause-specific hazard (CHS) model</a></li>
<li class="chapter" data-level="4.7" data-path="chapter4.html"><a href="chapter4.html#fine-and-gray-subdistribution-model"><i class="fa fa-check"></i><b>4.7</b> Fine and Gray (subdistribution) model</a></li>
<li class="chapter" data-level="4.8" data-path="chapter4.html"><a href="chapter4.html#proportional-odds-model-using-cpf"><i class="fa fa-check"></i><b>4.8</b> Proportional odds model (using CPF)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter5.html"><a href="chapter5.html"><i class="fa fa-check"></i><b>5</b> 모수적 생존함수 추정</a>
<ul>
<li class="chapter" data-level="5.1" data-path="chapter5.html"><a href="chapter5.html#지수분포"><i class="fa fa-check"></i><b>5.1</b> 지수분포</a></li>
<li class="chapter" data-level="5.2" data-path="chapter5.html"><a href="chapter5.html#와이블분포"><i class="fa fa-check"></i><b>5.2</b> 와이블분포</a></li>
<li class="chapter" data-level="5.3" data-path="chapter5.html"><a href="chapter5.html#감마분포"><i class="fa fa-check"></i><b>5.3</b> 감마분포</a></li>
<li class="chapter" data-level="5.4" data-path="chapter5.html"><a href="chapter5.html#로그정규분포"><i class="fa fa-check"></i><b>5.4</b> 로그정규분포</a></li>
<li class="chapter" data-level="5.5" data-path="chapter5.html"><a href="chapter5.html#로그로지스틱분포"><i class="fa fa-check"></i><b>5.5</b> 로그로지스틱분포</a></li>
<li class="chapter" data-level="5.6" data-path="chapter5.html"><a href="chapter5.html#곰페르츠분포"><i class="fa fa-check"></i><b>5.6</b> 곰페르츠분포</a></li>
<li class="chapter" data-level="5.7" data-path="chapter5.html"><a href="chapter5.html#가속실패시간모형aft"><i class="fa fa-check"></i><b>5.7</b> 가속실패시간모형(AFT)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter6.html"><a href="chapter6.html"><i class="fa fa-check"></i><b>6</b> 기타 이슈</a>
<ul>
<li class="chapter" data-level="6.1" data-path="chapter6.html"><a href="chapter6.html#aic-and-bic"><i class="fa fa-check"></i><b>6.1</b> AIC and BIC</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="chapter6.html"><a href="chapter6.html#visual-inspection"><i class="fa fa-check"></i><b>6.1.1</b> Visual inspection</a></li>
<li class="chapter" data-level="6.1.2" data-path="chapter6.html"><a href="chapter6.html#aic-akaike-information-criterion"><i class="fa fa-check"></i><b>6.1.2</b> AIC (Akaike information criterion)</a></li>
<li class="chapter" data-level="6.1.3" data-path="chapter6.html"><a href="chapter6.html#bic"><i class="fa fa-check"></i><b>6.1.3</b> BIC</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="chapter6.html"><a href="chapter6.html#추정방법에-따른-차이"><i class="fa fa-check"></i><b>6.2</b> 추정방법에 따른 차이</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="chapter6.html"><a href="chapter6.html#piecewise"><i class="fa fa-check"></i><b>6.2.1</b> Piecewise</a></li>
<li class="chapter" data-level="6.2.2" data-path="chapter6.html"><a href="chapter6.html#splines"><i class="fa fa-check"></i><b>6.2.2</b> Splines</a></li>
<li class="chapter" data-level="6.2.3" data-path="chapter6.html"><a href="chapter6.html#mixture-cured-model"><i class="fa fa-check"></i><b>6.2.3</b> Mixture cured model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chapter6.html"><a href="chapter6.html#crossover-treatment-switching"><i class="fa fa-check"></i><b>6.3</b> Crossover / Treatment switching</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="chapter6.html"><a href="chapter6.html#crossover-보정방법"><i class="fa fa-check"></i><b>6.3.1</b> Crossover 보정방법</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Survival Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter4" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> 경쟁위험(Competing Risks)<a href="chapter4.html#chapter4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Overview<a href="chapter4.html#overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>생존 자료의 통계적 분석 상의 문제점: 각 실험 개체에 대해 생존시간과
중도절단이 하나만 관측됨</p></li>
<li><p>생존 자료의 통계적 분석을 위해 추가되는 가정: 생존시간의 분포와
중도절단까지 시간의 분포가 서로 독립을 가정</p></li>
<li><p>모든 원인에 대한 암 사망률이 아닌 특정 원인에 대한 암 사망률이
관심있는 경우: 암환자의 특정원인에 의한 암 사망까지의 시간과 다른
원인에 의한 암 사망까지의 시간은 독립인가 아닌가?</p></li>
<li><p>각 실험개체들이 두개 이상의 원인에 의한 사건 발생 위험에 노출되는
상황에서 만들어진 자료에 대한 분석: 특정 원인에 의한 사건에 대한
분석을 위해 “경쟁사건(competing event)”을 고려한 방법으로 접근</p></li>
<li><p>각 개체들이 둘 이상의 위험에 노출이 되었고 그 중 하나의 사건이
발생하면 다른 사건들이 발생할 위험들이 사라지는 경우 이 위험들을
경쟁위험(competing risks)이라 함</p></li>
<li><p>ex) HIV 양성반응을 가지는 사람들은 AIDS에 걸릴 위험과(AIDS에 걸리기
전) 사망할 위험에 동시에 노출됨. 이때 각 사람들은 두 가지 경우 중
하나만 발생하므로 이 두 사건은 다른 사건에 대해 경쟁위험임</p></li>
</ul>
<p><img src="survival/comp1.png" style="width:60.0%" /></p>
<p><br></p>
<ul>
<li>Example: 두 개의 경쟁위험과 두 개의 치료집단을 가지는 자료의 경우</li>
</ul>
<p><img src="survival/comp2.png" style="width:80.0%" /></p>
<p><br></p>
<ul>
<li><p>두 경쟁위험을 묶어서 하나의 event로 계산한 생존곡선의 추정과 검정</p>
<ul>
<li>통계적으로 올바름</li>
<li>동일한 개체의 "경쟁"효과로 생기는 통계적 문제 해결</li>
</ul></li>
<li><p>두 event 중 하나의 event 발생에 대한 치료효과의 차이를 연구하는
임상학자에게는 유용하지 않음</p></li>
<li><p>한 event의 발생 패턴을 보기 위해 다른 사상의 발생을 중도절단으로
처리하는 경우</p></li>
</ul>
<p><img src="survival/comp3.png" style="width:80.0%" /></p>
<p><br></p>
<p><img src="survival/comp4.png" style="width:80.0%" /></p>
<p><br></p>
<ul>
<li>두 사상의 발생패턴 모두 치료집단 간에 차이가 나서 나온
결과라기보다는 각 사상별 생존곡선을 추정하기 위해 사용된 방법에
문제가 있는 것으로 보임</li>
</ul>
<p><br></p>
</div>
<div id="경쟁위험" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> 경쟁위험<a href="chapter4.html#경쟁위험" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>경쟁위험 생존 데이터는 콕스 모형, 모수적 모형, 누적발생률을 사용하는 모형에 적합 가능</p></li>
<li><p>경쟁위험 데이터를 다루는 전형적인 방법은 원인별(cause-specific) 접근법이며, 각 이벤트 별로 생존분석을 하되 다른 종류의 이벤트는 중도절단 된 것으로 처리하는 방법</p>
<ul>
<li>경쟁위험이 서로 독립이라는 가정이 필요</li>
<li>각 이벤트 별로 적합된 콕스모형 또는 생존곡선은 경쟁위험이 있을 경우 해석상의 문제가 발생</li>
</ul></li>
<li><p>경쟁위험이 서로 독립이라는 가정이 맞지 않는 경우</p>
<ul>
<li><strong>경쟁위험을 동시에 분석할 수 있는 직접적인 방법이 없음</strong></li>
<li>간접적으로 민감도분석을 수행가능
<ul>
<li>경쟁위험 사건들을 모두 이벤트가 없는 것으로 처리</li>
<li>경쟁위험 사건들을 우리가 관심있는 이벤트를 경험한 것으로 처리</li>
</ul></li>
</ul></li>
<li><p>KM 생존곡선의 대안으로 누적발생함수(cumulative incidence function, CIF)로 이벤트의 주변확률(marginal probability)을 추정</p>
<ul>
<li>CIF는 KM과 달리 승법극한(product-limit) 추정량이 아님</li>
<li>경쟁위험의 독립성 가정이 필요하기는 하지만, 독립성 여부와는 관계없이 생존곡선에 대한 의미있는 해석이 가능</li>
</ul></li>
<li><p>CIF의 변형으로 조건부확률함수(conditional probability function, CPF)는 시간 <span class="math inline">\(t\)</span>에 따라 다른 경쟁위험을 경험하지 않은 대상에서 위험의 조건부확률을 제공</p></li>
</ul>
<p><br></p>
<ul>
<li><p><strong>경쟁위험의 예</strong></p></li>
<li><p>경쟁위험은 한 대상환자에서 한 가지 이상의 이벤트(실패)가 발생할 수 있지만 그 중 하나의 이벤트만 일어날 때 발생</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>어떤 환자는 폐암으로 사망하거나 심혈관질환(예를 들어, 뇌졸중)으로 사망할 수 있으나 두 가지 사망이 동시에 일어날 수는 없음
<ul>
<li>뇌졸중으로 인한 사망가능성을 열어놓은 채 어떤 물질에 노출된 환자의 폐암으로 인한 사망률과 노출되지 않은 환자의 폐암으로 인한 사망률의 차이가 있는지 연구할 수 있음</li>
<li>다른 예측변수들의 영향을 통제한 상태에서 폐암으로 인한 사망률과 뇌졸중으로 인한 사망률을 비교할 수 있음</li>
</ul></li>
<li>진행암 환자가 수술 후 병원감염으로 사망하거나 병원감염이 일어나기 전 수술로 인해 사망
<ul>
<li>감염관리에 관심이 있는 연구자에게는 원내감염이 주된 관심사이기 때문에 수술 후 사망은 원내감염으로 인한 사망의 경쟁위험이 됨</li>
</ul></li>
<li>비전이성 골육종 환자에서 화학요법 및 수술 후 추적 관찰 중 국소재발이나 폐전이 또는 다른 장기에 전이를 일으킬 수 있음
<ul>
<li>경쟁위험은 국소재발, 폐전이, 다른 장기로 전이가 됨</li>
<li>각 실패의 위험비를 추정하거나, 폐전이의 실패율을 국소재발이나 다른 장기 전이의 실패율과 비교할 수 있음</li>
<li>세가지 유형은 사망사건이 아니기 때문에 재발이 가능하며, 첫 번째 발생한 사건만을 목료로 하면 경쟁위험 모형을 적용할 수 있음</li>
</ul></li>
</ol>
<ul>
<li><p><strong>Byar 데이터(howto)</strong></p>
<ul>
<li><p>3기(전립선 밖으로 국소확장) 또는 4기(타장기 전이 또는 acid phosphatase 효소의 상승)의 전림선암 환자를 대상으로 위약 또는 3가지 용량의 에스트로젠(diethylstilbesterol)을 사용한 무작위 임상시험 데이터</p></li>
<li><p>생존의 경우 0, 전립선암으로 인한 사망은 1, 심혈관질환으로 인한 사망은 2, 기타 원인으로 인한 사망은 3으로 기록</p></li>
<li><p>나이, 몸무게, 수행상태, 심혈관질환의 과거력, 혈중 헤모글리빈 농도, 원발성 종괴의 크기, 병기와 조직학적 지표 등</p></li>
<li><p>경쟁위험이 있는 상태에서 위험인자의 영향을 보정한 후 치료의 효과를 평가하는 것이 일차적인 목표</p></li>
<li><p>임상적으로 전립선암으로 인한 사망과 심혈관질환으로 인한 사망, 기타 원인에 의한 사망은 서로 독립적으로 간주 가능</p></li>
</ul></li>
</ul>
<p><br></p>
</div>
<div id="원인별-누적발생함수" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> 원인별 누적발생함수<a href="chapter4.html#원인별-누적발생함수" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>경쟁위험 데이터에 대한 전형적인 접근방법은 각각의 경쟁위험(실패 또는 이벤트)을 분리하여 각각의 모형에 적합시키는 방법
<ul>
<li>이때 다른 경쟁위험들은 중도절단된 것으로 간주</li>
<li>만일 한 가지 실패 유형만이 일차적 관심사라면 경쟁위험들은 중도절단된 것으로 처리하고 그 실패유형에 대한 위험비를 추정</li>
</ul></li>
<li><strong>원인별 위험함수(cause-specific hazard function)</strong></li>
</ul>
<p><span class="math display">\[
h_j(t)=\lim_{h-&gt;0}\frac{P(t&lt;T&lt;t+h , \epsilon=j |T \ge t)}{h}, \,\,\, j=1, \ldots, K
\]</span></p>
<ul>
<li><p>원인별 위험함수는 다른 모든 사건 원인들이 존재할 때, <span class="math inline">\(t\)</span> 시점에서
특정원인 <span class="math inline">\(j\)</span>에 의한 실패가 일어날 확률을 의미</p></li>
<li><p><strong>Overall hazard function</strong></p></li>
</ul>
<p><span class="math display">\[
h(t)=\sum_{j=1}^K h_j(t)
\]</span></p>
<ul>
<li><p>Overall hazard function은 <span class="math inline">\(t\)</span> 시점에 어떤 원인에 의해서든지 실패할 확률을 의미</p></li>
<li><p><strong>원인별 누적발생함수(cause-specific cumulative incidence
function; CIF)</strong></p></li>
</ul>
<p><span class="math display">\[
F_j(t)=P(T \le t, \epsilon=j)=\int_0^t h_j(t) S(t)dt, \,\,\, j=1,\ldots, K
\]</span></p>
<p>여기서 <span class="math inline">\(S(t)\)</span>는</p>
<p><span class="math display">\[
S(t)=exp \left\lbrace  -\int_o^t \sum_{j=1}^K h_j(t)dt \right\rbrace
\]</span></p>
<ul>
<li><p>CIF는 모든 다른 실패 원인이 존재할 때, <span class="math inline">\(t\)</span> 시점까지 원인 <span class="math inline">\(j\)</span>에 의해
실패할 확률을 의미</p></li>
<li><p><span class="math inline">\(j\)</span>번째 누적발생함수는 다른 원인별 위험함수와 서로 연관되어 있음</p></li>
</ul>
<p><br></p>
<ul>
<li><p>경쟁위험이 하나인 경우 즉, 하나의 사건만 관심사항이라면 <strong>CIF=1-KM</strong>으로 나타남</p></li>
<li><p>경쟁위험이 둘 이상인 경우 CIF는 원인별 위험함수에서 추정되며, 경쟁위험이 있는 경우 서로 독립이라는 가정이 필요 없음</p></li>
<li><p><strong>cif 추정 방법</strong></p></li>
</ul>
<ol style="list-style-type: decimal">
<li>관심 있는 이벤트를 <span class="math inline">\(j\)</span>라고 할 때 정렬된 실패시간 <span class="math inline">\(t_m\)</span>에서의 위험률을 계산</li>
</ol>
<p><span class="math display">\[
\hat{h}_j (t_m)=\frac{d_{jm}}{n_m}
\]</span></p>
<p>이때 <span class="math inline">\(d_{jm}\)</span>은 시간 <span class="math inline">\(t_m\)</span>에서 발생한 이벤트 <span class="math inline">\(j\)</span>의 개수이며 <span class="math inline">\(n_m\)</span>은 <span class="math inline">\(t_m\)</span>에서의 위험대상 수임</p>
<ol start="2" style="list-style-type: decimal">
<li>실패시간 <span class="math inline">\(t_m\)</span>에서 실패가 발생하려면 대상환자가 실패가 일어나기 전 시간까지 살아 있어야 하므로 <span class="math inline">\(S(t_{m-1})\)</span>을 추정
<ul>
<li><span class="math inline">\(S(t_{m-1})\)</span>은 바로 전의 실패시간 <span class="math inline">\(t_{m-1}\)</span>에서 경쟁위험이 모두 없는 총 생존확률을 의미</li>
<li>이때, 생존확률은 경쟁위험을 센서링이 아닌 이벤트로 발생한 것으로 간주하여 KM 방법과 동일하게 계산</li>
</ul></li>
</ol>
<p><span class="math display">\[
\hat{S}(t_{m-1})=\prod_{i=1}^{m-1} \left( 1-\frac{d_i}{n_i}\right)^{\delta_i}
\]</span></p>
<p>여기서 <span class="math inline">\(d_i=\sum_{j=1}^K d_{ji}\)</span>: <span class="math inline">\(t_{i}\)</span> 시점에서의 모든 원인의 실패수</p>
<ol start="3" style="list-style-type: decimal">
<li>시간 <span class="math inline">\(t_m\)</span>에서의 이벤트 <span class="math inline">\(j\)</span>의 실패발생률 <span class="math inline">\(\hat{I}_j(t_m)\)</span>을 추정</li>
</ol>
<p><span class="math display">\[
\hat{I}_j(t_m)=\hat{h}_j (t_m)\hat{S}(t_{m-1})
\]</span></p>
<ol start="4" style="list-style-type: decimal">
<li>시간 <span class="math inline">\(t_m\)</span>에서의 이벤트 j의 누적발생률(<span class="math inline">\(CIF_j\)</span>)은 실패시간 <span class="math inline">\(t_1\)</span> 부터 <span class="math inline">\(t_j\)</span>까지의 실패방샐률의 누적합계로 산출</li>
</ol>
<p><span class="math display">\[
\hat{CIF}_j(t_m)=\sum_{m:t_m \le t}\hat{h}_j (t_m)\hat{S}(t_{m-1})
\]</span></p>
<ul>
<li><p>경쟁위험이 없는 경우 CIF=1-KM이지만 경쟁위험이 있는 경우에는 <span class="math inline">\(\hat{CIF}_j(t_m) \ne 1-KM_c\)</span>임</p></li>
<li><p>경쟁위험이 없는 경우 KM curve와 CI curve</p></li>
<li><p>필요 패키지 로드</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapter4.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(autoReg)</span>
<span id="cb1-2"><a href="chapter4.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span></code></pre></div>
<pre><code>## Warning: 패키지 &#39;survival&#39;는 R 버전 4.2.3에서 작성되었습니다</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapter4.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb3-2"><a href="chapter4.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(howto)</span>
<span id="cb3-3"><a href="chapter4.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span></code></pre></div>
<pre><code>## Warning: 패키지 &#39;flextable&#39;는 R 버전 4.2.3에서 작성되었습니다</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="chapter4.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ftExtra)</span>
<span id="cb5-2"><a href="chapter4.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## Warning: 패키지 &#39;tibble&#39;는 R 버전 4.2.3에서 작성되었습니다</code></pre>
<pre><code>## Warning: 패키지 &#39;dplyr&#39;는 R 버전 4.2.3에서 작성되었습니다</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="chapter4.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="chapter4.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="chapter4.html#cb8-3" aria-hidden="true" tabindex="-1"></a>km<span class="ot">=</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status)<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>anderson)</span>
<span id="cb8-4"><a href="chapter4.html#cb8-4" aria-hidden="true" tabindex="-1"></a>km1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">x=</span>km<span class="sc">$</span>time,<span class="at">y=</span><span class="dv">1</span><span class="sc">-</span>km<span class="sc">$</span>surv)</span>
<span id="cb8-5"><a href="chapter4.html#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="chapter4.html#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb8-7"><a href="chapter4.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_step</span>(<span class="at">data=</span>km1,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))<span class="sc">+</span></span>
<span id="cb8-8"><a href="chapter4.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Time&#39;</span>,<span class="at">y=</span><span class="st">&#39;1-KM&#39;</span>)<span class="sc">+</span></span>
<span id="cb8-9"><a href="chapter4.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>,<span class="at">x=</span><span class="dv">20</span>,<span class="at">y=</span><span class="fl">0.5</span>,<span class="at">label=</span><span class="st">&#39;1-KM&#39;</span>)<span class="sc">+</span></span>
<span id="cb8-10"><a href="chapter4.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapter4.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmprsk)</span>
<span id="cb9-2"><a href="chapter4.html#cb9-2" aria-hidden="true" tabindex="-1"></a>cif <span class="ot">&lt;-</span> <span class="fu">with</span>(anderson,cmprsk<span class="sc">::</span><span class="fu">cuminc</span>(<span class="fu">as.numeric</span>(time),status))</span>
<span id="cb9-3"><a href="chapter4.html#cb9-3" aria-hidden="true" tabindex="-1"></a>cif1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">x=</span>cif<span class="sc">$</span><span class="st">&#39;1 1&#39;</span><span class="sc">$</span>time, <span class="at">y=</span>cif<span class="sc">$</span><span class="st">&#39;1 1&#39;</span><span class="sc">$</span>est)</span>
<span id="cb9-4"><a href="chapter4.html#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="chapter4.html#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb9-6"><a href="chapter4.html#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_step</span>(<span class="at">data=</span>cif1,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))<span class="sc">+</span></span>
<span id="cb9-7"><a href="chapter4.html#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;Time&#39;</span>,<span class="at">y=</span><span class="st">&#39;CIF&#39;</span>)<span class="sc">+</span></span>
<span id="cb9-8"><a href="chapter4.html#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>,<span class="at">x=</span><span class="dv">20</span>,<span class="at">y=</span><span class="fl">0.5</span>,<span class="at">label=</span><span class="st">&#39;CIF&#39;</span>)<span class="sc">+</span></span>
<span id="cb9-9"><a href="chapter4.html#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p><br></p>
<ul>
<li><p><strong>경쟁위험이 있는 경우 CIF</strong></p>
<ul>
<li>가상의 두경부암 환자 26명에게 모두 방사선 치료를 하였으며, 암에 의해 사망(status=1)하거나, 다른 원인에 의해 사망(status=2)하거나 생존(status=0) 하였다.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapter4.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb10-2"><a href="chapter4.html#cb10-2" aria-hidden="true" tabindex="-1"></a>time<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.7</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">9</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">10</span>,<span class="fl">10.8</span>,<span class="fl">17.1</span>,<span class="fl">20.3</span>,<span class="fl">1.5</span>,<span class="fl">2.8</span>,<span class="fl">3.8</span>,<span class="fl">4.7</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">11.2</span>,</span>
<span id="cb10-3"><a href="chapter4.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fl">3.2</span>,<span class="fl">7.6</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">15</span>,<span class="fl">24.4</span>)</span>
<span id="cb10-4"><a href="chapter4.html#cb10-4" aria-hidden="true" tabindex="-1"></a>status<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">12</span>),<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">8</span>),<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb10-5"><a href="chapter4.html#cb10-5" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span><span class="fu">tibble</span>(time,status)</span>
<span id="cb10-6"><a href="chapter4.html#cb10-6" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 26 × 2
##     time status
##    &lt;dbl&gt;  &lt;dbl&gt;
##  1   0.7      1
##  2   3        1
##  3   4        1
##  4   9        1
##  5   6        1
##  6   6        1
##  7   6        1
##  8   9        1
##  9  10        1
## 10  10.8      1
## # ℹ 16 more rows</code></pre>
<ul>
<li>CIF 추정값은 다음과 같음</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapter4.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(howto)</span>
<span id="cb12-2"><a href="chapter4.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb12-3"><a href="chapter4.html#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(officer)</span></span>
<span id="cb12-4"><a href="chapter4.html#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#library(ftExtra)</span></span>
<span id="cb12-5"><a href="chapter4.html#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="chapter4.html#cb12-6" aria-hidden="true" tabindex="-1"></a>result<span class="ot">=</span><span class="fu">data2CIC</span>(df,<span class="at">cause=</span><span class="dv">1</span>,<span class="at">add.CPC=</span><span class="cn">FALSE</span>)</span>
<span id="cb12-7"><a href="chapter4.html#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(result)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;t&quot;</span>,<span class="st">&quot;n&quot;</span>,<span class="st">&quot;d&quot;</span>,<span class="st">&quot;h(t)&quot;</span>,<span class="st">&quot;s(t-1)&quot;</span>,<span class="st">&quot;I(t)&quot;</span>,<span class="st">&quot;CIF&quot;</span>)</span>
<span id="cb12-8"><a href="chapter4.html#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(result)</span></code></pre></div>
<div class="tabwid"><style>.cl-c82126c0{}.cl-c81a507a{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c81cf8e8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c81d08e2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c81d08ec{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c81d08ed{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-c82126c0'><thead><tr style="overflow-wrap:break-word;"><th class="cl-c81d08e2"><p class="cl-c81cf8e8"><span class="cl-c81a507a">t</span></p></th><th class="cl-c81d08e2"><p class="cl-c81cf8e8"><span class="cl-c81a507a">n</span></p></th><th class="cl-c81d08e2"><p class="cl-c81cf8e8"><span class="cl-c81a507a">d</span></p></th><th class="cl-c81d08e2"><p class="cl-c81cf8e8"><span class="cl-c81a507a">h(t)</span></p></th><th class="cl-c81d08e2"><p class="cl-c81cf8e8"><span class="cl-c81a507a">s(t-1)</span></p></th><th class="cl-c81d08e2"><p class="cl-c81cf8e8"><span class="cl-c81a507a">I(t)</span></p></th><th class="cl-c81d08e2"><p class="cl-c81cf8e8"><span class="cl-c81a507a">CIF</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">26</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a"></span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.7</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">26</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.038</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.038</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.038</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1.5</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">25</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.962</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.038</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">2.8</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">24</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.923</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.038</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">3.0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">23</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.043</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.885</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.038</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.077</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">3.2</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">22</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.846</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.077</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">3.8</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">21</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.846</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.077</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">4.0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">20</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.050</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.806</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.040</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.117</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">4.7</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">19</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.766</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.117</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">6.0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">18</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">3</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.167</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.725</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.121</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.238</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">7.0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">15</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.604</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.238</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">7.6</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">14</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.564</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.238</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">9.0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">13</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">2</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.154</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.564</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.087</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.325</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">10.0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">11</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.091</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.477</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.043</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.368</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">10.8</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">7</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.143</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.347</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.050</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.418</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">11.0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">6</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.298</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.418</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">11.2</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">5</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.298</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.418</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">15.0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">4</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.238</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.418</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">17.1</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">3</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.333</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.238</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.079</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.497</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">20.3</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">2</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.500</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.159</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.079</span></p></td><td class="cl-c81d08ec"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.577</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c81d08ed"><p class="cl-c81cf8e8"><span class="cl-c81a507a">24.4</span></p></td><td class="cl-c81d08ed"><p class="cl-c81cf8e8"><span class="cl-c81a507a">1</span></p></td><td class="cl-c81d08ed"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0</span></p></td><td class="cl-c81d08ed"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ed"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.079</span></p></td><td class="cl-c81d08ed"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.000</span></p></td><td class="cl-c81d08ed"><p class="cl-c81cf8e8"><span class="cl-c81a507a">0.577</span></p></td></tr></tbody></table></div>
<p><br></p>
<ul>
<li><p>가장 높은 CIF 값은 마지막으로 관찰된 이벤트가 일어난 <span class="math inline">\(t=20.3\)</span>주의 0.577으로 나타남</p></li>
<li><p>따라서 20개월에서 암으로 인한 사망의 누적위험(즉 주변확률)은 경쟁위험이 있는 상태에서 <span class="math inline">\(57.7\%\)</span>임</p></li>
<li><p><strong>CIF와 1-KM 비교</strong></p>
<ul>
<li>1-KM은 암으로 인한 사망으로 인한 실패 확률을 과대추정함</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapter4.html#cb13-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">=</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(time,status<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>df)</span>
<span id="cb13-2"><a href="chapter4.html#cb13-2" aria-hidden="true" tabindex="-1"></a>df1<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">x=</span>fit<span class="sc">$</span>time,<span class="at">y=</span><span class="dv">1</span><span class="sc">-</span>fit<span class="sc">$</span>surv)</span>
<span id="cb13-3"><a href="chapter4.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb13-4"><a href="chapter4.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_step</span>(<span class="at">data=</span>result,<span class="fu">aes</span>(<span class="at">x=</span>t,<span class="at">y=</span>CIF))<span class="sc">+</span></span>
<span id="cb13-5"><a href="chapter4.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_step</span>(<span class="at">data=</span>df1,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">color=</span><span class="st">&#39;red&#39;</span>)<span class="sc">+</span></span>
<span id="cb13-6"><a href="chapter4.html#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;months&#39;</span>,<span class="at">y=</span><span class="st">&#39;proportion dying&#39;</span>)<span class="sc">+</span></span>
<span id="cb13-7"><a href="chapter4.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>,<span class="at">x=</span><span class="dv">14</span>,<span class="at">y=</span><span class="fl">0.38</span>,<span class="at">label=</span><span class="st">&#39;CIF&#39;</span>)<span class="sc">+</span></span>
<span id="cb13-8"><a href="chapter4.html#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>,<span class="at">x=</span><span class="dv">14</span>,<span class="at">y=</span><span class="fl">0.5</span>,<span class="at">label=</span><span class="st">&#39;1-KM&#39;</span>,<span class="at">color=</span><span class="st">&#39;red&#39;</span>)<span class="sc">+</span></span>
<span id="cb13-9"><a href="chapter4.html#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="누적조건부확률함수" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> 누적조건부확률함수<a href="chapter4.html#누적조건부확률함수" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>경쟁위험에 대한 또다른 접근방법으로 누적조건부확률함수(cumulative conditional probability function, CPF)가 있음</p></li>
<li><p>CPF는 <span class="math inline">\(t\)</span> 시간까지 다른 경쟁위험을 경험하지 못한 대상에서 관심 이벤트 <span class="math inline">\(j\)</span>를 경험할 조건부 확률</p></li>
</ul>
<p><span class="math display">\[
CPF=Pr(T_j \le t | T \ge t)
\]</span>
여기서 <span class="math inline">\(T_j\)</span>는 이벤트 <span class="math inline">\(j\)</span>가 일어날 때까지의 시간, <span class="math inline">\(T\)</span>는 다른 경쟁위험 이벤트가 일어날때까지의 시간</p>
<ul>
<li>이벤트 타입 <span class="math inline">\(j\)</span>에 대해 <span class="math inline">\(CPF\)</span>는 <span class="math inline">\(CIF_j\)</span>를 <span class="math inline">\(1-CIF_{j&#39;}\)</span>으로 나눈 값으로 <span class="math inline">\(CIF_{j&#39;}\)</span>은 경쟁위험 <span class="math inline">\(j\)</span> 이외에 다른 위험들의 누적발생률임</li>
</ul>
<p><span class="math display">\[
CPF=\frac{CIF_j}{1-CIF_{j&#39;}}
\]</span></p>
<ul>
<li>위의 예제에서 CPF를 계산하면 다음과 같음</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chapter4.html#cb14-1" aria-hidden="true" tabindex="-1"></a>result2<span class="ot">=</span><span class="fu">data2CIC</span>(df,<span class="at">cause=</span><span class="dv">1</span>)</span>
<span id="cb14-2"><a href="chapter4.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(result2)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;t&quot;</span>,<span class="st">&quot;n&quot;</span>,<span class="st">&quot;S(t)&quot;</span>,<span class="st">&quot;CIF1&quot;</span>,<span class="st">&quot;CIF2&quot;</span>,<span class="st">&quot;CPF&quot;</span>)</span>
<span id="cb14-3"><a href="chapter4.html#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">flextable</span>(result2)</span></code></pre></div>
<div class="tabwid"><style>.cl-c957abc2{}.cl-c9513b84{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-c9539316{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-c9539f64{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c9539f6e{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-c9539f6f{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-c957abc2'><thead><tr style="overflow-wrap:break-word;"><th class="cl-c9539f64"><p class="cl-c9539316"><span class="cl-c9513b84">t</span></p></th><th class="cl-c9539f64"><p class="cl-c9539316"><span class="cl-c9513b84">n</span></p></th><th class="cl-c9539f64"><p class="cl-c9539316"><span class="cl-c9513b84">S(t)</span></p></th><th class="cl-c9539f64"><p class="cl-c9539316"><span class="cl-c9513b84">CIF1</span></p></th><th class="cl-c9539f64"><p class="cl-c9539316"><span class="cl-c9513b84">CIF2</span></p></th><th class="cl-c9539f64"><p class="cl-c9539316"><span class="cl-c9513b84">CPF</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.0</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">26</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84"></span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.000</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.000</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.7</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">26</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">1.000</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.038</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.000</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.038</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">1.5</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">25</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.962</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.038</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.038</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.040</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">2.8</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">24</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.923</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.038</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.077</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.042</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">3.0</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">23</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.885</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.077</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.077</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.083</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">3.2</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">22</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.846</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.077</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.077</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.083</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">3.8</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">21</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.846</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.077</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.117</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.087</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">4.0</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">20</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.806</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.117</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.117</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.133</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">4.7</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">19</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.766</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.117</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.158</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.139</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">6.0</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">18</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.725</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.238</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.158</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.283</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">7.0</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">15</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.604</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.238</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.198</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.297</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">7.6</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">14</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.564</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.238</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.198</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.297</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">9.0</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">13</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.564</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.325</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.198</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.405</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">10.0</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">11</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.477</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.368</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.285</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.515</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">10.8</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">7</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.347</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.418</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.285</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.584</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">11.0</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">6</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.298</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.418</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.285</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.584</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">11.2</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">5</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.298</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.418</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.344</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.637</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">15.0</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">4</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.238</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.418</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.344</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.637</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">17.1</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">3</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.238</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.497</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.344</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.758</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">20.3</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">2</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.159</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.577</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.344</span></p></td><td class="cl-c9539f6e"><p class="cl-c9539316"><span class="cl-c9513b84">0.879</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-c9539f6f"><p class="cl-c9539316"><span class="cl-c9513b84">24.4</span></p></td><td class="cl-c9539f6f"><p class="cl-c9539316"><span class="cl-c9513b84">1</span></p></td><td class="cl-c9539f6f"><p class="cl-c9539316"><span class="cl-c9513b84">0.079</span></p></td><td class="cl-c9539f6f"><p class="cl-c9539316"><span class="cl-c9513b84">0.577</span></p></td><td class="cl-c9539f6f"><p class="cl-c9539316"><span class="cl-c9513b84">0.344</span></p></td><td class="cl-c9539f6f"><p class="cl-c9539316"><span class="cl-c9513b84">0.879</span></p></td></tr></tbody></table></div>
<p><br></p>
<ul>
<li><strong>CIF와 1-KM, CPF 비교</strong></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="chapter4.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb15-2"><a href="chapter4.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_step</span>(<span class="at">data=</span>result,<span class="fu">aes</span>(<span class="at">x=</span>t,<span class="at">y=</span>CIF))<span class="sc">+</span></span>
<span id="cb15-3"><a href="chapter4.html#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_step</span>(<span class="at">data=</span>df1,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">lty=</span><span class="dv">2</span>,<span class="at">color=</span><span class="st">&#39;red&#39;</span>)<span class="sc">+</span></span>
<span id="cb15-4"><a href="chapter4.html#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_step</span>(<span class="at">data=</span>result2,<span class="fu">aes</span>(<span class="at">x=</span>t,<span class="at">y=</span>CPF),<span class="at">lty=</span><span class="dv">3</span>, <span class="at">color=</span><span class="st">&#39;blue&#39;</span>)<span class="sc">+</span></span>
<span id="cb15-5"><a href="chapter4.html#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">x=</span><span class="st">&#39;months&#39;</span>,<span class="at">y=</span><span class="st">&#39;proportion dying&#39;</span>)<span class="sc">+</span></span>
<span id="cb15-6"><a href="chapter4.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>,<span class="at">x=</span><span class="dv">14</span>,<span class="at">y=</span><span class="fl">0.38</span>,<span class="at">label=</span><span class="st">&#39;CIF&#39;</span>)<span class="sc">+</span></span>
<span id="cb15-7"><a href="chapter4.html#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>,<span class="at">x=</span><span class="dv">14</span>,<span class="at">y=</span><span class="fl">0.5</span>,<span class="at">label=</span><span class="st">&#39;1-KM&#39;</span>,<span class="at">color=</span><span class="st">&#39;red&#39;</span>)<span class="sc">+</span></span>
<span id="cb15-8"><a href="chapter4.html#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&#39;text&#39;</span>,<span class="at">x=</span><span class="dv">14</span>,<span class="at">y=</span><span class="fl">0.6</span>,<span class="at">label=</span><span class="st">&#39;CPF&#39;</span>,<span class="at">color=</span><span class="st">&#39;blue&#39;</span>)<span class="sc">+</span></span>
<span id="cb15-9"><a href="chapter4.html#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><br></p>
<ul>
<li>Ordering of the functions</li>
</ul>
<p><img src="survival/comp5.png" style="width:70.0%" /></p>
<p><br></p>
<ul>
<li>Byar Example</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapter4.html#cb16-1" aria-hidden="true" tabindex="-1"></a>cif_Byar <span class="ot">&lt;-</span> <span class="fu">with</span>(Byar,cmprsk<span class="sc">::</span><span class="fu">cuminc</span>(dtime,status2))</span>
<span id="cb16-2"><a href="chapter4.html#cb16-2" aria-hidden="true" tabindex="-1"></a>cif</span></code></pre></div>
<pre><code>## Estimates and Variances:
## $est
##             5        10        15       20        25        30
## 1 1 0.2142857 0.4345684 0.6021037 0.658946 0.8105256 0.8105256
## 
## $var
##               5          10         15          20          25          30
## 1 1 0.004117292 0.006173271 0.00656581 0.006319894 0.005626118 0.005626118</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapter4.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cif_Byar, <span class="at">curvlab=</span><span class="fu">c</span>(<span class="st">&quot;전립선암 사망&quot;</span>, <span class="st">&quot;심혈관 사망&quot;</span>, <span class="st">&quot;기타 사망&quot;</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.4</span>))</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapter4.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb19-2"><a href="chapter4.html#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="chapter4.html#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcompetingrisks</span>(cif_Byar, <span class="at">multiple_panels=</span>F, <span class="at">conf.int=</span>T)</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="누적발생함수-비교" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> 누적발생함수 비교<a href="chapter4.html#누적발생함수-비교" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Gray test (1988)</li>
<li>Log-rank test와 유사한 형태로 검정</li>
<li>가설</li>
</ul>
<p><span class="math display">\[
H_0 : F_{1k}=F_1^0, \,\,\, k=1,\ldots, K
\]</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapter4.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcmprsk</span>(dtime<span class="sc">+</span>status2<span class="sc">~</span>Rx,<span class="at">data=</span>Byar,</span>
<span id="cb20-2"><a href="chapter4.html#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">id=</span><span class="fu">c</span>(<span class="st">&quot;alive&quot;</span>,<span class="st">&quot;cancer death&quot;</span>,<span class="st">&quot;CVD death&quot;</span>,<span class="st">&quot;Other death&quot;</span>),</span>
<span id="cb20-3"><a href="chapter4.html#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">strata=</span><span class="fu">c</span>(<span class="st">&quot;placebo or 0.2mg DES&quot;</span>,<span class="st">&quot;1.0mg or 5.0mg DES&quot;</span>))</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="cause-specific-hazard-chs-model" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Cause-specific hazard (CHS) model<a href="chapter4.html#cause-specific-hazard-chs-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>원인별 위험함수(cause-specific hazard function(CSH))를 설명하기 위해
다음의 비례위험모형을 가정</li>
</ul>
<p><span class="math display">\[
h_j(t;x)=h_{j0}(t)exp(\beta&#39;_jx) , \,\,\, j=1,\ldots, K
\]</span></p>
<p><span class="math display">\[
log(h_j(t;x_i))=log(h_{j0}(t))+\beta_1x_1+\cdots+\beta_px_p
\]</span></p>
<p>여기서 <span class="math inline">\(j\)</span>번째 원인별 위험함수는 실패 원인에 따라 정의되며, 관심
원인을 제외한 나머지 원인은 모두 중도절단으로 처리</p>
<ul>
<li><p>원인별 위험함수에서 추정된 회귀계수는 다른 원인의 위험률이 전혀
반영되지 않음</p></li>
<li><p>경쟁위험모형에서는 원인들이 서로 독립적이지 않는 한, 해석 상의
문제점이 발생 할 수 있음</p></li>
<li><p>Byar 데이터를 3개의 경쟁위험과 8개의 예측변수가 있는 콕스모형에 적합</p>
<ul>
<li>경쟁위험은 전립선암으로 인한 사망, 심혈관질환으로 인한 사망, 기타 원인에 의한 사망 3가지</li>
<li>Rx, Age, Wt, PF, Hx, Hb, SZ, SG 8개의 예측변수</li>
</ul></li>
</ul>
<ol style="list-style-type: decimal">
<li>전립선암에 의한 사망에 대한 원인별 위험함수</li>
</ol>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapter4.html#cb21-1" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(dtime,status2<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span>Rx<span class="sc">+</span>Age<span class="sc">+</span>Wt<span class="sc">+</span>PF<span class="sc">+</span>Hx<span class="sc">+</span>Hb<span class="sc">+</span>SZ<span class="sc">+</span>SG,<span class="at">data=</span>Byar)</span>
<span id="cb21-2"><a href="chapter4.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(dtime, status2 == 1) ~ Rx + Age + Wt + PF + 
##     Hx + Hb + SZ + SG, data = Byar)
## 
##   n= 483, number of events= 125 
##    (결측으로 인하여 19개의 관측치가 삭제되었습니다.)
## 
##         coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## Rx  -0.42272   0.65526  0.20191 -2.094   0.0363 *  
## Age -0.12008   0.88685  0.16017 -0.750   0.4534    
## Wt   0.12922   1.13794  0.15095  0.856   0.3920    
## PF   0.40026   1.49222  0.27350  1.463   0.1433    
## Hx  -0.09905   0.90569  0.20024 -0.495   0.6208    
## Hb   0.40709   1.50244  0.19608  2.076   0.0379 *  
## SZ   1.17240   3.22974  0.21591  5.430 5.64e-08 ***
## SG   2.18090   8.85428  0.28288  7.709 1.26e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##     exp(coef) exp(-coef) lower .95 upper .95
## Rx     0.6553     1.5261    0.4411    0.9734
## Age    0.8868     1.1276    0.6479    1.2139
## Wt     1.1379     0.8788    0.8465    1.5297
## PF     1.4922     0.6701    0.8730    2.5506
## Hx     0.9057     1.1041    0.6117    1.3410
## Hb     1.5024     0.6656    1.0230    2.2065
## SZ     3.2297     0.3096    2.1154    4.9312
## SG     8.8543     0.1129    5.0858   15.4151
## 
## Concordance= 0.807  (se = 0.02 )
## Likelihood ratio test= 162.4  on 8 df,   p=&lt;2e-16
## Wald test            = 124  on 8 df,   p=&lt;2e-16
## Score (logrank) test = 184.7  on 8 df,   p=&lt;2e-16</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>CVD에 대한 원인별 위험함수</li>
</ol>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chapter4.html#cb23-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(dtime,status2<span class="sc">==</span><span class="dv">2</span>)<span class="sc">~</span>Rx<span class="sc">+</span>Age<span class="sc">+</span>Wt<span class="sc">+</span>PF<span class="sc">+</span>Hx<span class="sc">+</span>Hb<span class="sc">+</span>SZ<span class="sc">+</span>SG,<span class="at">data=</span>Byar)</span>
<span id="cb23-2"><a href="chapter4.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(dtime, status2 == 2) ~ Rx + Age + Wt + PF + 
##     Hx + Hb + SZ + SG, data = Byar)
## 
##   n= 483, number of events= 139 
##    (결측으로 인하여 19개의 관측치가 삭제되었습니다.)
## 
##         coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## Rx   0.05977   1.06159  0.19829  0.301   0.7631    
## Age  0.34558   1.41281  0.13514  2.557   0.0106 *  
## Wt   0.06326   1.06531  0.14951  0.423   0.6722    
## PF   0.46220   1.58757  0.27077  1.707   0.0878 .  
## Hx   1.10438   3.01736  0.18561  5.950 2.68e-09 ***
## Hb   0.02565   1.02598  0.20384  0.126   0.8999    
## SZ  -0.15487   0.85652  0.36091 -0.429   0.6678    
## SG  -0.04148   0.95937  0.18508 -0.224   0.8227    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##     exp(coef) exp(-coef) lower .95 upper .95
## Rx     1.0616     0.9420    0.7197     1.566
## Age    1.4128     0.7078    1.0840     1.841
## Wt     1.0653     0.9387    0.7947     1.428
## PF     1.5876     0.6299    0.9338     2.699
## Hx     3.0174     0.3314    2.0972     4.341
## Hb     1.0260     0.9747    0.6881     1.530
## SZ     0.8565     1.1675    0.4222     1.738
## SG     0.9594     1.0424    0.6675     1.379
## 
## Concordance= 0.671  (se = 0.024 )
## Likelihood ratio test= 56.56  on 8 df,   p=2e-09
## Wald test            = 54.35  on 8 df,   p=6e-09
## Score (logrank) test = 60.28  on 8 df,   p=4e-10</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>기타 원인에 의한 사망에 대한 원인별 위험함수</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapter4.html#cb25-1" aria-hidden="true" tabindex="-1"></a>fit3<span class="ot">=</span><span class="fu">coxph</span>(<span class="fu">Surv</span>(dtime,status2<span class="sc">==</span><span class="dv">3</span>)<span class="sc">~</span>Rx<span class="sc">+</span>Age<span class="sc">+</span>Wt<span class="sc">+</span>PF<span class="sc">+</span>Hx<span class="sc">+</span>Hb<span class="sc">+</span>SZ<span class="sc">+</span>SG,<span class="at">data=</span>Byar)</span>
<span id="cb25-2"><a href="chapter4.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(dtime, status2 == 3) ~ Rx + Age + Wt + PF + 
##     Hx + Hb + SZ + SG, data = Byar)
## 
##   n= 483, number of events= 80 
##    (결측으로 인하여 19개의 관측치가 삭제되었습니다.)
## 
##         coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## Rx  -0.06391   0.93809  0.25556 -0.250  0.80251    
## Age  0.66893   1.95214  0.17085  3.915 9.03e-05 ***
## Wt   0.57182   1.77149  0.19355  2.954  0.00313 ** 
## PF   0.12830   1.13690  0.40911  0.314  0.75382    
## Hx   0.05426   1.05576  0.23974  0.226  0.82096    
## Hb   0.48641   1.62647  0.23501  2.070  0.03848 *  
## SZ   0.71725   2.04879  0.37282  1.924  0.05437 .  
## SG  -0.77145   0.46234  0.26247 -2.939  0.00329 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##     exp(coef) exp(-coef) lower .95 upper .95
## Rx     0.9381     1.0660    0.5685    1.5480
## Age    1.9521     0.5123    1.3966    2.7286
## Wt     1.7715     0.5645    1.2122    2.5887
## PF     1.1369     0.8796    0.5099    2.5349
## Hx     1.0558     0.9472    0.6599    1.6890
## Hb     1.6265     0.6148    1.0261    2.5781
## SZ     2.0488     0.4881    0.9866    4.2545
## SG     0.4623     2.1629    0.2764    0.7734
## 
## Concordance= 0.713  (se = 0.029 )
## Likelihood ratio test= 39.45  on 8 df,   p=4e-06
## Wald test            = 41.64  on 8 df,   p=2e-06
## Score (logrank) test = 43.32  on 8 df,   p=8e-07</code></pre>
<p><br></p>
</div>
<div id="fine-and-gray-subdistribution-model" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Fine and Gray (subdistribution) model<a href="chapter4.html#fine-and-gray-subdistribution-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>일반적으로 누적발생함수(CIF)에 대한 공변량의 효과와 원인별
위험함수(CSH)에 대한 공변량의 효과는 서로 다르게 나타남</p></li>
<li><p>CIF <span class="math inline">\(F_j(t)\)</span>는 <span class="math inline">\(j\)</span>번째 원인의 위험함수뿐만 아니라 다른 원인들의
위험함수들의 결합 형태이므로 다른 원인들의 위험함수의 영향을 받음</p></li>
<li><p>Fine and Gray (1999)는 subdistribution에 근거한 회귀모형을 통해
누적발생함수를 추정하고자 하였으며, 여기서 subdistribution은
<span class="math inline">\(\lim_{t-&gt;\infty}F_j(t)=Pr(\epsilon=j)\)</span>로부터 유래한 것으로 <span class="math inline">\(K\)</span>개의
원인별 분포함수라는 의미임</p></li>
<li><p>공변량을 포함한 subdistribution 위험함수</p></li>
</ul>
<p><span class="math display">\[
\begin{aligned}
h_{j}^s (t; x) =&amp;
\lim _{h-&gt;0} \left\lbrace \frac{Pr[t  \le T_j  &lt; t+h , | (T \ge t) \cup (T \le t, \epsilon \ne j), x} {h}   \right\rbrace \\
=&amp; \frac{d F_j (t,x)/ dt} {1-F_j (t), x} = - \frac{d log (1-F_j (t,x))} {dt}
\end{aligned}
\]</span></p>
<p>여기서 <span class="math inline">\(x\)</span>는 공변량 벡터이며, 원인별 위험함수와 가장 큰 차이점은
위험함수의 정의임</p>
<ul>
<li><p>subdistribution에서는 다른 유형으로 이미 사망한 사람도 위험 그룹에
포함함</p></li>
<li><p>subdistribution hazard model</p></li>
</ul>
<p><span class="math display">\[
h_j^s (t; x)=h_{j0}^s (t) exp(x(t)\beta)
\]</span></p>
<p><span class="math display">\[
log(h_j^s(t;x))=log(h_{j0}^s (t))+\beta_1x_1(t)+\cdots+\beta_px_p(t)
\]</span></p>
<ul>
<li>Subdistribution hazard model 원리</li>
</ul>
<p><span class="math display">\[
F_j(t,x)=1-exp\left( -\int_0^t h_j^s (t,x) dt \right)=1-exp \left(-\int_0^t h_{j0}^s (t) exp(x(t)\beta) dt \right)
\]</span></p>
<ul>
<li><p>회귀계수 <span class="math inline">\(\beta\)</span>가 양수이면 <span class="math inline">\(F_j(t,x)\)</span>는 공변량 <span class="math inline">\(x\)</span>에 대해 단조
증가함수가 되므로, 공변량 <span class="math inline">\(x\)</span>가 증가함에 따라 동일한 시점에서
<span class="math inline">\(F_j(t,x)\)</span>도 증가</p></li>
<li><p>즉, 회귀계수 <span class="math inline">\(\beta\)</span>가 양수이면 공변량 <span class="math inline">\(x\)</span>가 증가함에 따라
<span class="math inline">\(t\)</span>시점까지 원인 <span class="math inline">\(j\)</span>에 의해 failure가 발생할 확률도 증가</p></li>
<li><p>Byar 데이터를 이용한 subdistribution model</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>전립선암에 의한 사망에 대한 원인별 위험함수</li>
</ol>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chapter4.html#cb27-1" aria-hidden="true" tabindex="-1"></a>Byar1 <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(Byar)</span>
<span id="cb27-2"><a href="chapter4.html#cb27-2" aria-hidden="true" tabindex="-1"></a>cov1 <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(<span class="sc">~</span>Rx<span class="sc">+</span>Age<span class="sc">+</span>Wt<span class="sc">+</span>PF<span class="sc">+</span>Hx<span class="sc">+</span>Hb<span class="sc">+</span>SZ<span class="sc">+</span>SG, <span class="at">data=</span>Byar1)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb27-3"><a href="chapter4.html#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="chapter4.html#cb27-4" aria-hidden="true" tabindex="-1"></a>sdhr1 <span class="ot">&lt;-</span> cmprsk<span class="sc">::</span><span class="fu">crr</span>(<span class="at">ftime=</span>Byar1<span class="sc">$</span>dtime, <span class="at">fstatus=</span>Byar1<span class="sc">$</span>status2, cov1, <span class="at">failcode=</span><span class="dv">1</span>, <span class="at">cencode=</span><span class="dv">0</span>)</span>
<span id="cb27-5"><a href="chapter4.html#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="chapter4.html#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sdhr1)</span></code></pre></div>
<pre><code>## Competing Risks Regression
## 
## Call:
## cmprsk::crr(ftime = Byar1$dtime, fstatus = Byar1$status2, cov1 = cov1, 
##     failcode = 1, cencode = 0)
## 
##        coef exp(coef) se(coef)       z p-value
## Rx  -0.1489     0.862    0.216 -0.6895 4.9e-01
## Age -0.1892     0.828    0.161 -1.1727 2.4e-01
## Wt   0.0108     1.011    0.160  0.0675 9.5e-01
## PF   0.3171     1.373    0.278  1.1399 2.5e-01
## Hx  -0.2408     0.786    0.205 -1.1763 2.4e-01
## Hb   0.3299     1.391    0.210  1.5686 1.2e-01
## SZ   0.7851     2.193    0.229  3.4349 5.9e-04
## SG   2.1818     8.862    0.288  7.5831 3.4e-14
## 
##     exp(coef) exp(-coef)  2.5% 97.5%
## Rx      0.862      1.161 0.564  1.32
## Age     0.828      1.208 0.603  1.14
## Wt      1.011      0.989 0.739  1.38
## PF      1.373      0.728 0.796  2.37
## Hx      0.786      1.272 0.526  1.17
## Hb      1.391      0.719 0.921  2.10
## SZ      2.193      0.456 1.401  3.43
## SG      8.862      0.113 5.042 15.58
## 
## Num. cases = 475
## Pseudo Log-likelihood = -652 
## Pseudo likelihood ratio test = 140  on 8 df,</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapter4.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model=crrFormula(dtime+status2~Rx+Age+Wt+PF+Hx+Hb+SZ+SG,data=Byar1)</span></span>
<span id="cb29-2"><a href="chapter4.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#model</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>CVD에 대한 원인별 위험함수</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapter4.html#cb30-1" aria-hidden="true" tabindex="-1"></a>sdhr2 <span class="ot">&lt;-</span> cmprsk<span class="sc">::</span><span class="fu">crr</span>(<span class="at">ftime=</span>Byar1<span class="sc">$</span>dtime, <span class="at">fstatus=</span>Byar1<span class="sc">$</span>status2, cov1, <span class="at">failcode=</span><span class="dv">2</span>, <span class="at">cencode=</span><span class="dv">0</span>)</span>
<span id="cb30-2"><a href="chapter4.html#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="chapter4.html#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sdhr2)</span></code></pre></div>
<pre><code>## Competing Risks Regression
## 
## Call:
## cmprsk::crr(ftime = Byar1$dtime, fstatus = Byar1$status2, cov1 = cov1, 
##     failcode = 2, cencode = 0)
## 
##        coef exp(coef) se(coef)       z p-value
## Rx   0.1004     1.106    0.199  0.5049 6.1e-01
## Age  0.1878     1.207    0.136  1.3804 1.7e-01
## Wt  -0.0103     0.990    0.148 -0.0697 9.4e-01
## PF   0.3339     1.396    0.274  1.2183 2.2e-01
## Hx   1.0988     3.001    0.188  5.8305 5.5e-09
## Hb  -0.2345     0.791    0.211 -1.1113 2.7e-01
## SZ  -0.4958     0.609    0.375 -1.3236 1.9e-01
## SG  -0.2300     0.795    0.193 -1.1922 2.3e-01
## 
##     exp(coef) exp(-coef)  2.5% 97.5%
## Rx      1.106      0.904 0.749  1.63
## Age     1.207      0.829 0.924  1.58
## Wt      0.990      1.010 0.741  1.32
## PF      1.396      0.716 0.816  2.39
## Hx      3.001      0.333 2.074  4.34
## Hb      0.791      1.264 0.523  1.20
## SZ      0.609      1.642 0.292  1.27
## SG      0.795      1.259 0.544  1.16
## 
## Num. cases = 475
## Pseudo Log-likelihood = -799 
## Pseudo likelihood ratio test = 55.6  on 8 df,</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>기타 원인에 의한 사망에 대한 원인별 위험함수</li>
</ol>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="chapter4.html#cb32-1" aria-hidden="true" tabindex="-1"></a>sdhr3 <span class="ot">&lt;-</span> cmprsk<span class="sc">::</span><span class="fu">crr</span>(<span class="at">ftime=</span>Byar1<span class="sc">$</span>dtime, <span class="at">fstatus=</span>Byar1<span class="sc">$</span>status2, cov1, <span class="at">failcode=</span><span class="dv">3</span>, <span class="at">cencode=</span><span class="dv">0</span>)</span>
<span id="cb32-2"><a href="chapter4.html#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="chapter4.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sdhr3)</span></code></pre></div>
<pre><code>## Competing Risks Regression
## 
## Call:
## cmprsk::crr(ftime = Byar1$dtime, fstatus = Byar1$status2, cov1 = cov1, 
##     failcode = 3, cencode = 0)
## 
##       coef exp(coef) se(coef)      z p-value
## Rx  -0.172     0.842    0.257 -0.668 0.50000
## Age  0.562     1.754    0.192  2.934 0.00330
## Wt   0.470     1.600    0.195  2.417 0.01600
## PF  -0.511     0.600    0.461 -1.109 0.27000
## Hx  -0.271     0.763    0.242 -1.120 0.26000
## Hb   0.344     1.411    0.231  1.493 0.14000
## SZ   0.339     1.404    0.373  0.911 0.36000
## SG  -0.971     0.379    0.259 -3.752 0.00018
## 
##     exp(coef) exp(-coef)  2.5% 97.5%
## Rx      0.842      1.187 0.509 1.394
## Age     1.754      0.570 1.205 2.553
## Wt      1.600      0.625 1.093 2.343
## PF      0.600      1.667 0.243 1.481
## Hx      0.763      1.311 0.475 1.225
## Hb      1.411      0.709 0.898 2.218
## SZ      1.404      0.712 0.676 2.916
## SG      0.379      2.641 0.228 0.629
## 
## Num. cases = 475
## Pseudo Log-likelihood = -456 
## Pseudo likelihood ratio test = 33.6  on 8 df,</code></pre>
<ul>
<li>다른 경쟁위험을 censoring으로 처리한 경우</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapter4.html#cb34-1" aria-hidden="true" tabindex="-1"></a>modelCox <span class="ot">=</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(dtime,statusCancer)<span class="sc">~</span>Rx<span class="sc">+</span>Age<span class="sc">+</span>Wt<span class="sc">+</span>PF<span class="sc">+</span>Hx<span class="sc">+</span>Hb<span class="sc">+</span>SZ<span class="sc">+</span>SG, <span class="at">data=</span>Byar1)</span>
<span id="cb34-2"><a href="chapter4.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelCox) </span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(dtime, statusCancer) ~ Rx + Age + Wt + PF + 
##     Hx + Hb + SZ + SG, data = Byar1)
## 
##   n= 475, number of events= 121 
## 
##         coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## Rx  -0.36428   0.69470  0.20667 -1.763   0.0780 .  
## Age -0.08657   0.91707  0.16493 -0.525   0.5997    
## Wt   0.10733   1.11331  0.15481  0.693   0.4881    
## PF   0.42238   1.52558  0.27422  1.540   0.1235    
## Hx  -0.08853   0.91527  0.20243 -0.437   0.6618    
## Hb   0.42463   1.52903  0.19703  2.155   0.0312 *  
## SZ   1.13777   3.11979  0.22137  5.140 2.75e-07 ***
## SG   2.22480   9.25161  0.29162  7.629 2.36e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##     exp(coef) exp(-coef) lower .95 upper .95
## Rx     0.6947     1.4395    0.4633     1.042
## Age    0.9171     1.0904    0.6638     1.267
## Wt     1.1133     0.8982    0.8219     1.508
## PF     1.5256     0.6555    0.8913     2.611
## Hx     0.9153     1.0926    0.6155     1.361
## Hb     1.5290     0.6540    1.0392     2.250
## SZ     3.1198     0.3205    2.0216     4.815
## SG     9.2516     0.1081    5.2238    16.385
## 
## Concordance= 0.807  (se = 0.02 )
## Likelihood ratio test= 158.9  on 8 df,   p=&lt;2e-16
## Wald test            = 119.2  on 8 df,   p=&lt;2e-16
## Score (logrank) test = 180.3  on 8 df,   p=&lt;2e-16</code></pre>
<p><br></p>
</div>
<div id="proportional-odds-model-using-cpf" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Proportional odds model (using CPF)<a href="chapter4.html#proportional-odds-model-using-cpf" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chapter4.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Cprob)</span>
<span id="cb36-2"><a href="chapter4.html#cb36-2" aria-hidden="true" tabindex="-1"></a>tis<span class="ot">=</span><span class="fu">seq</span>(<span class="fu">median</span>(Byar<span class="sc">$</span>dtime), <span class="fu">max</span>(Byar<span class="sc">$</span>dtime), <span class="at">length=</span><span class="dv">50</span>)</span>
<span id="cb36-3"><a href="chapter4.html#cb36-3" aria-hidden="true" tabindex="-1"></a>fitcpf <span class="ot">&lt;-</span> <span class="fu">cpfpo</span>(<span class="fu">Hist</span>(dtime,status2)<span class="sc">~</span>Rx<span class="sc">+</span>Age<span class="sc">+</span>Wt<span class="sc">+</span>PF<span class="sc">+</span>Hx<span class="sc">+</span>Hb<span class="sc">+</span>SZ<span class="sc">+</span>SG, <span class="at">data=</span>Byar1, <span class="at">tis=</span>tis)</span>
<span id="cb36-4"><a href="chapter4.html#cb36-4" aria-hidden="true" tabindex="-1"></a>fitcpf</span></code></pre></div>
<pre><code>## Test for non-significant effect 
##                   stat       pvalue
## (Intercept) -5.2683850 1.376292e-07
## Rx          -1.8737312 6.096749e-02
## Age          0.3561029 7.217635e-01
## Wt           0.1372952 8.907975e-01
## PF           1.6571722 9.748467e-02
## Hx          -0.0993502 9.208602e-01
## Hb           1.8132344 6.979568e-02
## SZ           4.5533324 5.280274e-06
## SG           7.7916658 6.661338e-15
## 
##  Test for constant fit 
##                    coef   exp.coef   SE.coef       stat       pvalue
## (Intercept) -2.24152166  0.1062966 0.4254666 -2.8900885 3.851334e-03
## Rx          -0.74932287  0.4726865 0.3999095  0.5516556 5.811844e-01
## Age          0.10805810  1.1141125 0.3034463  0.1704421 8.646624e-01
## Wt           0.03429300  1.0348878 0.2497757  0.1570184 8.752303e-01
## PF           0.98580630  2.6799719 0.5948726 -0.9861095 3.240794e-01
## Hx          -0.03349128  0.9670633 0.3371033 -0.5441290 5.863527e-01
## Hb           0.55042468  1.7339892 0.3035596 -0.9270893 3.538802e-01
## SZ           1.92402389  6.8484605 0.4225529  5.2315388 1.681047e-07
## SG           2.84547522 17.2097351 0.3651947 -7.1634186 7.869261e-13</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="chapter4.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb38-2"><a href="chapter4.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(fitcpf, <span class="at">scales=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">&quot;free&quot;</span>))</span></code></pre></div>
<p><img src="Survival-Analysis_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p><br></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Survival Analysis.pdf", "Survival Analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
